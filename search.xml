<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é¢å‘å…«è‚¡æ–‡é¢è¯•ä¸“åœº</title>
      <link href="/posts/47540.html"/>
      <url>/posts/47540.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="é¢å‘å…«è‚¡æ–‡é¢è¯•ä¸“åœº"><a href="#é¢å‘å…«è‚¡æ–‡é¢è¯•ä¸“åœº" class="headerlink" title="é¢å‘å…«è‚¡æ–‡é¢è¯•ä¸“åœº"></a>é¢å‘å…«è‚¡æ–‡é¢è¯•ä¸“åœº</h1><h2 id="å…ˆå¹¿åº¦ï¼Œå†æ·±åº¦ï¼Œä¸“ç²¾ä¸€ä¸ªç‚¹ï¼Œèƒ½å¤Ÿç¡¬æ§é¢è¯•å®˜çš„"><a href="#å…ˆå¹¿åº¦ï¼Œå†æ·±åº¦ï¼Œä¸“ç²¾ä¸€ä¸ªç‚¹ï¼Œèƒ½å¤Ÿç¡¬æ§é¢è¯•å®˜çš„" class="headerlink" title="å…ˆå¹¿åº¦ï¼Œå†æ·±åº¦ï¼Œä¸“ç²¾ä¸€ä¸ªç‚¹ï¼Œèƒ½å¤Ÿç¡¬æ§é¢è¯•å®˜çš„"></a>å…ˆå¹¿åº¦ï¼Œå†æ·±åº¦ï¼Œä¸“ç²¾ä¸€ä¸ªç‚¹ï¼Œèƒ½å¤Ÿç¡¬æ§é¢è¯•å®˜çš„</h2><ul><li><p><strong>å¹¿åº¦ï¼š</strong><code>MySQLã€Redisã€MQã€JUCã€JVM</code>ï¼Œå¸¸è§çš„æ¡†æ¶ã€ä¸­é—´ä»¶åŸºç¡€åŸºç¡€å…«è‚¡æ–‡</p></li><li><p><strong>æ·±åº¦ï¼š</strong></p><ul><li><strong>å¯»æ‰¾ä¸€ä¸ªç‚¹ï¼Œå¸¸è€ƒç‚¹æ·±å…¥å­¦ä¹ ï¼Œè¶Šæ·±è¶Šå¥½ï¼Œå½“æˆæ€æ‰‹é”ï¼Œåªè¦æåˆ°è¿™ä¸ªç‚¹å°±å¯ä»¥****èŠçš„å¾ˆæ·±</strong>ï¼Œ<strong>ç¡¬æ§é¢è¯•å®˜</strong>ï¼ˆå¾ˆæ·±å…¥å¾ˆé€å½»ï¼‰</li><li><strong>ğŸ¤¨æ€è€ƒå…¶ä»–çš„å…«è‚¡æ–‡æ€ä¹ˆ****æ¶‰åŠ</strong>åˆ°è¿™ä¸ªç‚¹ï¼Œå°†é¢è¯•å®˜å¼•å¯¼åˆ°è¿™ä¸ªç‚¹æ¥ï¼Œå‘æŒ¥ä½ çš„ä¼˜åŠ¿</li></ul></li></ul><h2 id="æ¡ˆä¾‹ï¼šå¹¶å‘å’Œé”ğŸ”’"><a href="#æ¡ˆä¾‹ï¼šå¹¶å‘å’Œé”ğŸ”’" class="headerlink" title="æ¡ˆä¾‹ï¼šå¹¶å‘å’Œé”ğŸ”’"></a>æ¡ˆä¾‹ï¼šå¹¶å‘å’Œé”ğŸ”’</h2><h3 id="åˆ†å¸ƒé”çš„å„ç§å®ç°åŸç†ï¼š"><a href="#åˆ†å¸ƒé”çš„å„ç§å®ç°åŸç†ï¼š" class="headerlink" title="åˆ†å¸ƒé”çš„å„ç§å®ç°åŸç†ï¼š"></a>åˆ†å¸ƒé”çš„å„ç§å®ç°åŸç†ï¼š</h3><ul><li><code>setx</code> çœ‹é—¨ç‹—æœºåˆ¶</li><li><strong>å¯é‡å…¥é”å®ç°æ–¹å¼</strong><ul><li><code>hsetx</code> å®ç°å¯é‡å…¥</li><li><strong>ä¸€è‡´æ€§</strong><code>hash</code> é…åˆ <code>RPC</code>æœåŠ¡å®ç°å¯é‡å…¥</li><li><strong>é”é˜»å¡å¯é‡è¯•çš„å‡ ç§å®ç°æ–¹å¼</strong></li></ul></li><li><strong>ä¸»ä»æ¶æ„é”ä¸¢å¤±é—®é¢˜</strong></li><li><strong>è”é”æœºåˆ¶</strong><ul><li><strong>ç¼ºé™·</strong></li></ul></li><li><strong>çº¢é”æœºåˆ¶</strong><ul><li><strong>ç¼ºé™·</strong></li><li><strong>ä¸ºä»€ä¹ˆä¸æ¨èçº¢é”</strong></li></ul></li></ul><h2 id="å¸¸ç”¨çš„é¢è¯•è€ƒç‚¹"><a href="#å¸¸ç”¨çš„é¢è¯•è€ƒç‚¹" class="headerlink" title="å¸¸ç”¨çš„é¢è¯•è€ƒç‚¹"></a>å¸¸ç”¨çš„é¢è¯•è€ƒç‚¹</h2><h3 id="å°å‚å‡†å¤‡ï¼š"><a href="#å°å‚å‡†å¤‡ï¼š" class="headerlink" title="å°å‚å‡†å¤‡ï¼š"></a>å°å‚å‡†å¤‡ï¼š</h3><ul><li><strong>Java åŸºç¡€ï¼š</strong><ul><li><code>HashMap</code> åŸç†</li><li><code>ArrayList</code> åŸç†</li><li><code>String</code> ç‰¹æ€§</li><li><strong>å¤šçº¿ç¨‹</strong></li></ul></li><li><code>MySQL</code><ul><li><strong>äº‹åŠ¡</strong></li><li><strong>ç´¢å¼•</strong></li></ul></li><li><code>Redis</code><ul><li><strong>æ•°æ®ç»“æ„</strong></li><li><strong>ç¼“å­˜</strong></li><li><strong>æŒä¹…åŒ–ç­–ç•¥</strong></li><li><strong>æ·˜æ±°æœºåˆ¶</strong></li></ul></li><li><code>JUC</code>ï¼ˆæœ‰èƒ½åŠ›ä¹Ÿæ˜¯é‡ç‚¹ï¼‰<ul><li><strong>é”</strong></li><li><strong>çº¿ç¨‹æ± </strong></li><li><strong>threadLoad</strong></li><li><strong>concurrentHashMap</strong></li><li><strong>ç­‰ç­‰</strong></li></ul></li><li><code>MQ</code><ul><li><strong>åŸºæœ¬æ¦‚å¿µ</strong></li><li><strong>æ¶ˆæ¯å¯é æ€§</strong></li><li><strong>æ­»ä¿¡é˜Ÿåˆ—</strong></li><li><strong>å»¶è¿Ÿé˜Ÿåˆ—</strong></li><li><strong>ç­‰ç­‰</strong></li></ul></li><li><strong>è®¾è®¡æ¨¡å¼ï¼ˆä¸æ˜¯é‡ç‚¹ã€åŠ åˆ†é¡¹ï¼‰</strong><ul><li><strong>å•ä¾‹æ¨¡å¼</strong></li></ul></li><li><strong>æ•°æ®ç»“æ„</strong><ul><li><strong>æ ˆ</strong></li><li><strong>é˜Ÿåˆ—</strong></li><li><strong>å“ˆå¸Œè¡¨</strong></li></ul></li><li><code>Spring</code>ï¼ˆä¸æ˜¯é¢è¯•é‡ç‚¹ï¼‰<ul><li><code>IOC</code></li><li><code>AOP</code></li><li><strong>è‡ªåŠ¨è£…é…</strong></li><li><code>bean</code>çš„ç”Ÿå‘½å‘¨æœŸ</li></ul></li><li><code>JVM</code>ï¼ˆæœ‰èƒ½åŠ›ä¹Ÿæ˜¯é‡ç‚¹ï¼‰<ul><li><strong>é‡ç‚¹æ”¾åœ¨ä¸­å¤§å‚</strong></li></ul></li></ul><h2 id="ä¸­å¤§å‚å‡†å¤‡ï¼š"><a href="#ä¸­å¤§å‚å‡†å¤‡ï¼š" class="headerlink" title="ä¸­å¤§å‚å‡†å¤‡ï¼š"></a>ä¸­å¤§å‚å‡†å¤‡ï¼š</h2><ul><li><strong>âœ¨</strong><code>MySQL</code><ul><li><strong>é”</strong></li><li><code>MVCC</code></li><li><strong>æ—¥å¿—</strong></li><li><strong>å­˜å‚¨å¼•æ“</strong></li><li><code>SQL</code>ä¼˜åŒ–</li></ul></li><li><strong>âœ¨</strong><code>Redis</code><ul><li><strong>å„ç§æ•°æ®çš„åº•å±‚åŸç†</strong></li><li><strong>ç¼“å­˜</strong></li><li><strong>æŒä¹…åŒ–æœºåˆ¶</strong></li><li><strong>æ·˜æ±°ç­–ç•¥</strong></li><li><strong>åˆ†å¸ƒå¼é”</strong></li><li><strong>åˆ†å¸ƒå¼ä¼šè¯</strong></li></ul></li><li><strong>âœ¨</strong><code>Redis</code> é«˜å¯ç”¨<ul><li><strong>ä¸»ä»</strong></li><li><strong>é›†ç¾¤</strong></li><li><strong>å“¨å…µ</strong></li></ul></li><li><strong>åˆ†å¸ƒå¼ç†è®º</strong><ul><li><code>cap</code>ç†è®º</li><li><code>base</code>ç†è®º</li><li><strong>raftç®—æ³•</strong></li><li><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong></li><li><strong>ç­‰</strong></li></ul></li><li><strong>âœ¨</strong><code>MQ</code><ul><li><strong>æ¶ˆæ¯å¯é æ€§</strong></li><li><strong>æ­»ä¿¡é˜Ÿåˆ—</strong></li><li><strong>å»¶è¿Ÿé˜Ÿåˆ—</strong></li><li><strong>æ¶ˆæ¯å †ç§¯é—®é¢˜</strong></li><li><strong>æ¶ˆæ¯å¹‚ç­‰æ€§</strong></li><li><strong>æ¶ˆæ¯é¡ºåºæ€§æ¶ˆè´¹</strong></li><li><strong>ç­‰ç­‰</strong></li></ul></li><li><strong>âœ¨</strong><code>JUC</code><ul><li><code>JMM</code> ï¼ˆ Java å†…å­˜æ¨¡å‹ï¼ˆJava Memory Modelï¼‰ï¼‰</li><li><strong>é”</strong></li><li><strong>çº¿ç¨‹æ± </strong></li><li><code>threadLocal</code></li><li><code>cas</code></li><li><code>aqs</code></li><li><code>volatile</code></li><li><strong>ä¸€å †å¹¶å‘çš„å·¥å…·ç±»</strong></li></ul></li><li><code>âœ¨JVM</code><ul><li><strong>å†…å­˜ç»“æ„</strong></li><li><strong>åƒåœ¾å›æ”¶</strong></li><li><strong>ç±»åŠ è½½</strong></li><li><strong>ä¸€ä¸‹æœ‰èƒ½åŠ›ï¼ˆè°ƒä¼˜ï¼‰</strong><ul><li><strong>æ€§èƒ½ä¼˜åŒ–</strong></li><li><strong>é—®é¢˜æ’æŸ¥</strong><ul><li><code>arthas</code>ï¼ˆæ’æŸ¥å·¥å…·ï¼‰</li><li><code>mat</code>ï¼ˆæ’æŸ¥å·¥å…·ï¼‰</li></ul></li></ul></li></ul></li><li><strong>æ•°æ®ç»“æ„</strong><ul><li><strong>æ ˆ</strong></li><li><strong>é˜Ÿåˆ—</strong></li><li><strong>å“ˆå¸Œè¡¨</strong></li><li><strong>æ ‘</strong></li><li><strong>å †</strong></li><li><strong>æ·±æœ</strong></li><li><strong>å¹¿æœ</strong></li></ul></li><li><strong>æ“ä½œç³»ç»Ÿ</strong><ul><li><strong>ç”¨æˆ·æ€</strong></li><li><strong>å†…æ ¸æ€</strong></li><li><strong>è¿›ç¨‹</strong></li><li><strong>çº¿ç¨‹</strong></li><li><strong>æ­»é”</strong></li><li><strong>å†…å­˜åˆ†é…</strong></li><li><strong>è™šæ‹Ÿå†…å­˜</strong></li></ul></li><li><strong>è®¡ç®—æœºç½‘ç»œ</strong><ul><li><code>TCP/IP</code>åè®®æ ˆ</li><li><strong>ç½‘ç»œåˆ†å±‚æ¨¡å‹</strong></li><li><strong>ARPåè®®</strong></li><li><code>IP</code></li><li><code>TCP</code></li><li><code>UDP</code></li><li><code>DNS</code></li><li><code>HTTPS</code></li><li><strong>..</strong></li></ul></li><li><strong>å¾®æœåŠ¡ï¼ˆäº†è§£æ¦‚å¿µï¼‰</strong><ul><li><strong>æœåŠ¡æ³¨å†Œ</strong></li><li><strong>ç½‘å…³</strong></li><li><strong>é™æµ</strong></li></ul></li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…«è‚¡æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ¯æ—¥æ—©æŠ¥ã€‘-2025-01-21 - æ˜ŸæœŸäºŒ</title>
      <link href="/posts/27119.html"/>
      <url>/posts/27119.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>æ¯æ—¥æ—©æŠ¥</title></head><body>    <div style="text-align: center;"> <a href="https://file.alapi.cn/60s/202501211737398702.png" title="æ¯æ—¥æ—©æŠ¥" class="gallery-item"><img src="https://file.alapi.cn/60s/202501211737398702.png"            alt="æ¯æ—¥æ—©æŠ¥" width="100%"></a> </div></body></html></more></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¯æ—¥æ—©æŠ¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥æ—©æŠ¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§„åˆ™å¼•æ“ Drools 8+ å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/19819.html"/>
      <url>/posts/19819.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="è§„åˆ™å¼•æ“-Drools-8-å¿«é€Ÿå…¥é—¨"><a href="#è§„åˆ™å¼•æ“-Drools-8-å¿«é€Ÿå…¥é—¨" class="headerlink" title="è§„åˆ™å¼•æ“ Drools 8+å¿«é€Ÿå…¥é—¨"></a>è§„åˆ™å¼•æ“ Drools 8+å¿«é€Ÿå…¥é—¨</h2><blockquote><p>å®˜ç½‘ï¼š<a href="https://drools.org/">https://drools.org/</a><br>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://docs.drools.org/8.44.0.Final/drools-docs/drools/introduction/index.html">https://docs.drools.org/8.44.0.Final/drools-docs/drools/introduction/index.html</a><br>é¡¹ç›®æºç ï¼š<a href="https://github.com/kiegroup/drools">https://github.com/kiegroup/drools</a><br>æœ€æ–°ç‰ˆæœ¬ï¼š<code>8.44.0.Final</code><br>ç‰ˆæœ¬å‚è€ƒï¼š<code>Drools 8.41.0.Final</code>ã€<code>JDK 17</code> ã€<code>Maven 3.6.3</code>ã€<code>SpringBoot 3.3.4</code><br>æ¡ˆä¾‹æºç ï¼š<a href="http://github.com/lingzhexi/drools_demo">æ¡ˆä¾‹æºç </a></p></blockquote><h3 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h3><p><a href="https://www.drools.org/">Drools</a>æ˜¯ä¸€æ¬¾ç”±<code>JBoss</code>ç»„ç»‡æä¾›çš„åŸºäº<code>Java</code>è¯­è¨€å¼€å‘çš„å¼€æºè§„åˆ™å¼•æ“ï¼Œå¯ä»¥å°†å¤æ‚ä¸”å¤šå˜çš„ä¸šåŠ¡è§„åˆ™ä»ç¡¬ç¼–ç ä¸­è§£æ”¾å‡ºæ¥ï¼Œä»¥<strong>è§„åˆ™è„šæœ¬</strong>çš„å½¢å¼å­˜æ”¾åœ¨æ–‡ä»¶æˆ–ç‰¹å®šçš„å­˜å‚¨ä»‹è´¨ä¸­ï¼ˆä¾‹å¦‚å­˜æ”¾åœ¨æ•°æ®åº“ä¸­ï¼‰ï¼Œä½¿å¾—ä¸šåŠ¡è§„åˆ™çš„å˜æ›´ä¸éœ€è¦ä¿®æ”¹é¡¹ç›®ä»£ç ã€é‡å¯æœåŠ¡å™¨å°±å¯ä»¥åœ¨çº¿ä¸Šç¯å¢ƒç«‹å³ç”Ÿæ•ˆã€‚</p><p><a href="https://s2.loli.net/2024/12/24/3fpThEiVN5CWYbx.png" title="drools" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/3fpThEiVN5CWYbx.png" alt="drools"></a></p><h3 id="2ã€åœºæ™¯"><a href="#2ã€åœºæ™¯" class="headerlink" title="2ã€åœºæ™¯"></a>2ã€åœºæ™¯</h3><h4 id="2-1ã€éœ€æ±‚"><a href="#2-1ã€éœ€æ±‚" class="headerlink" title="2.1ã€éœ€æ±‚"></a>2.1ã€éœ€æ±‚</h4><p>æŸç”µå•†å¹³å°çš„ä¿ƒé”€æ´»åŠ¨ï¼Œæ´»åŠ¨è§„åˆ™æ˜¯æ ¹æ®â½¤æˆ·è´­ä¹°è®¢å•çš„â¾¦é¢ç»™â½¤æˆ·é€ç›¸åº”çš„ç§¯åˆ†ï¼Œè´­ä¹°çš„è¶Šå¤šé€çš„ç§¯åˆ†è¶Šå¤šç”¨æˆ·è´­ä¹°çš„é‡‘é¢å’Œå¯¹åº”é€å¤šå°‘ç§¯åˆ†çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><table><thead><tr><th>è§„åˆ™ç¼–å·</th><th>è®¢å•é‡‘é¢</th><th>å¥–åŠ±ç§¯åˆ†</th></tr></thead><tbody><tr><td>1</td><td>100å…ƒä»¥ä¸‹</td><td>ä¸åŠ åˆ†</td></tr><tr><td>2</td><td>100å…ƒ - 500å…ƒ</td><td>åŠ 100åˆ†</td></tr><tr><td>3</td><td>500å…ƒ - 1000å…ƒ</td><td>åŠ 500åˆ†</td></tr><tr><td>4</td><td>1000å…ƒä»¥ä¸Š</td><td>åŠ 1000åˆ†</td></tr><tr><td>5</td><td>â€¦</td><td>â€¦</td></tr></tbody></table><h4 id="2-2ã€ä¼ ç»Ÿæ–¹å¼-ifâ€¦else"><a href="#2-2ã€ä¼ ç»Ÿæ–¹å¼-ifâ€¦else" class="headerlink" title="2.2ã€ä¼ ç»Ÿæ–¹å¼ ifâ€¦else"></a>2.2ã€ä¼ ç»Ÿæ–¹å¼ ifâ€¦else</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderPoint</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">500</span> <span class="token operator">&amp;&amp;</span> order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­˜åœ¨ç¡¬ç¼–ç é—®é¢˜ï¼š</p><p>1ã€ç¡¬ç¼–ç å®ç°ä¸šåŠ¡è§„åˆ™éš¾ä»¥ç»´æŠ¤</p><p>2ã€ç¡¬ç¼–ç å®ç°ä¸šåŠ¡è§„åˆ™éš¾ä»¥åº”å¯¹å˜åŒ–</p><p>3ã€ä¸šåŠ¡è§„åˆ™å‘ç”Ÿå˜åŒ–éœ€è¦ä¿®æ”¹ä»£ç ï¼Œé‡å¯æœåŠ¡åæ‰èƒ½ç”Ÿæ•ˆ</p><h4 id="2-3ã€ç­–ç•¥æ¨¡å¼-Strategy"><a href="#2-3ã€ç­–ç•¥æ¨¡å¼-Strategy" class="headerlink" title="2.3ã€ç­–ç•¥æ¨¡å¼ Strategy"></a>2.3ã€ç­–ç•¥æ¨¡å¼ Strategy</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Strategy</span> <span class="token punctuation">&#123;</span>    <span class="token function">addScore</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span><span class="token keyword">int</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Strategy1</span> <span class="token punctuation">&#123;</span>    <span class="token function">addScore</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">interface</span> <span class="token class-name">StrategyN</span> <span class="token punctuation">&#123;</span>    <span class="token function">addScore</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Environment</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Strategy</span> strategy<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Environment</span><span class="token punctuation">(</span><span class="token class-name">Strategy</span> strategy<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">addScore</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> strategy<span class="token punctuation">.</span><span class="token function">addScore</span><span class="token punctuation">(</span>num1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœéœ€æ±‚æ”¹å˜ï¼Œç§¯åˆ†å±‚æ¬¡å¢åŠ ï¼Œæ¯”ä¾‹è°ƒæ•´ï¼Ÿå¦‚ä½•åˆ†ç¦»ä¸šåŠ¡è§„åˆ™ï¼Œä¸ä¿®æ”¹æºç çš„åŸºç¡€ä¸ŠåŠ¨æ€å®ç°è°ƒæ•´ï¼Ÿ</p><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦å¼•å…¥<strong>è§„åˆ™å¼•æ“</strong>æ¥å¸®åŠ©æˆ‘ä»¬å°†è§„åˆ™ä»ä»£ç ä¸­åˆ†ç¦»å‡ºå»ï¼Œè®©å¼€å‘äººå‘˜ä»è§„åˆ™çš„ä»£ç é€»è¾‘ä¸­è§£æ”¾å‡ºæ¥ï¼ŒæŠŠè§„åˆ™çš„ç»´æŠ¤å’Œè®¾ç½®äº¤ç”±ä¸šåŠ¡äººå‘˜å»ç®¡ç†ã€‚</p><h3 id="3ã€è§„åˆ™å¼•æ“æ¦‚è¿°"><a href="#3ã€è§„åˆ™å¼•æ“æ¦‚è¿°" class="headerlink" title="3ã€è§„åˆ™å¼•æ“æ¦‚è¿°"></a>3ã€è§„åˆ™å¼•æ“æ¦‚è¿°</h3><h4 id="3-1ã€æ˜¯ä»€ä¹ˆ"><a href="#3-1ã€æ˜¯ä»€ä¹ˆ" class="headerlink" title="3.1ã€æ˜¯ä»€ä¹ˆ"></a>3.1ã€æ˜¯ä»€ä¹ˆ</h4><p><strong>è§„åˆ™å¼•æ“</strong>ï¼Œå…¨ç§°ä¸º<strong>ä¸šåŠ¡è§„åˆ™ç®¡ç†ç³»ç»Ÿ</strong>ï¼Œè‹±æ–‡åä¸º<code>BRMS</code>(å³<code>Business Rule Management System</code>)ã€‚è§„åˆ™å¼•æ“çš„ä¸»è¦æ€æƒ³æ˜¯å°†åº”ç”¨ç¨‹åºä¸­çš„<strong>ä¸šåŠ¡å†³ç­–éƒ¨åˆ†åˆ†ç¦»</strong>å‡ºæ¥ï¼Œå¹¶ä½¿ç”¨é¢„å®šä¹‰çš„è¯­ä¹‰æ¨¡å—ç¼–å†™ä¸šåŠ¡å†³ç­–ï¼ˆ<strong>ä¸šåŠ¡è§„åˆ™</strong>ï¼‰ï¼Œç”±ç”¨æˆ·æˆ–å¼€å‘è€…åœ¨éœ€è¦æ—¶è¿›è¡Œé…ç½®ã€ç®¡ç†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è§„åˆ™å¼•æ“å¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯æ¡†æ¶ï¼Œè€Œæ˜¯æŒ‡çš„ä¸€ç±»ç³»ç»Ÿï¼Œå³ä¸šåŠ¡è§„åˆ™ç®¡ç†ç³»ç»Ÿã€‚ç›®å‰å¸‚é¢ä¸Šå…·ä½“çš„è§„åˆ™å¼•æ“äº§å“æœ‰ï¼š<code>droolsã€VisualRulesã€iLog</code>ç­‰ã€‚</p><p>è§„åˆ™å¼•æ“å®ç°äº†å°†ä¸šåŠ¡å†³ç­–ä»åº”ç”¨ç¨‹åºä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œæ¥æ”¶æ•°æ®è¾“å…¥ï¼Œè§£é‡Šä¸šåŠ¡è§„åˆ™ï¼Œå¹¶æ ¹æ®ä¸šåŠ¡è§„åˆ™åšå‡ºä¸šåŠ¡å†³ç­–ã€‚è§„åˆ™å¼•æ“å…¶å®å°±æ˜¯ä¸€ä¸ªè¾“å…¥è¾“å‡ºå¹³å°ã€‚</p><p>ç³»ç»Ÿä¸­å¼•å…¥è§„åˆ™å¼•æ“åï¼Œä¸šåŠ¡è§„åˆ™ä¸å†ä»¥ç¨‹åºä»£ç çš„å½¢å¼é©»ç•™åœ¨ç³»ç»Ÿä¸­ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å¤„ç†è§„åˆ™çš„<strong>è§„åˆ™å¼•æ“</strong>ï¼Œä¸šåŠ¡è§„åˆ™å­˜å‚¨åœ¨<strong>è§„åˆ™åº“</strong>ä¸­ï¼Œå®Œå…¨ç‹¬ç«‹äºç¨‹åºã€‚ä¸šåŠ¡äººå‘˜å¯ä»¥åƒç®¡ç†æ•°æ®ä¸€æ ·å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚æŸ¥è¯¢ã€æ·»åŠ ã€æ›´æ–°ã€ç»Ÿè®¡ã€æäº¤ä¸šåŠ¡è§„åˆ™ç­‰ã€‚ä¸šåŠ¡è§„åˆ™è¢«åŠ è½½åˆ°è§„åˆ™å¼•æ“ä¸­ä¾›åº”ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><h4 id="3-2ã€ä¼˜åŠ¿"><a href="#3-2ã€ä¼˜åŠ¿" class="headerlink" title="3.2ã€ä¼˜åŠ¿"></a>3.2ã€ä¼˜åŠ¿</h4><p>ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p><p>1ã€ä¸šåŠ¡è§„åˆ™ä¸ç³»ç»Ÿä»£ç åˆ†ç¦»ï¼Œå®ç°ä¸šåŠ¡è§„åˆ™çš„é›†ä¸­ç®¡ç†</p><p>2ã€åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹å¯éšæ—¶å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œæ‰©å±•å’Œç»´æŠ¤</p><p>3ã€å¯ä»¥åŠ¨æ€ä¿®æ”¹ä¸šåŠ¡è§„åˆ™ï¼Œä»è€Œå¿«é€Ÿå“åº”éœ€æ±‚å˜æ›´</p><p>4ã€è§„åˆ™å¼•æ“æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œåªå…³å¿ƒä¸šåŠ¡è§„åˆ™ï¼Œä½¿å¾—ä¸šåŠ¡åˆ†æäººå‘˜ä¹Ÿå¯ä»¥å‚ä¸ç¼–è¾‘ã€ç»´æŠ¤ç³»ç»Ÿçš„ä¸šåŠ¡è§„åˆ™</p><p>5ã€å‡å°‘äº†ç¡¬ç¼–ç ä¸šåŠ¡è§„åˆ™çš„æˆæœ¬å’Œé£é™©</p><p>6ã€ä½¿ç”¨è§„åˆ™å¼•æ“æä¾›çš„è§„åˆ™ç¼–è¾‘å·¥å…·ï¼Œä½¿å¤æ‚çš„ä¸šåŠ¡è§„åˆ™å®ç°å˜å¾—çš„ç®€å•</p><h4 id="3-3ã€åº”ç”¨åœºæ™¯"><a href="#3-3ã€åº”ç”¨åœºæ™¯" class="headerlink" title="3.3ã€åº”ç”¨åœºæ™¯"></a>3.3ã€åº”ç”¨åœºæ™¯</h4><p>å¯¹äºä¸€äº›å­˜åœ¨æ¯”è¾ƒå¤æ‚çš„ä¸šåŠ¡è§„åˆ™å¹¶ä¸”ä¸šåŠ¡è§„åˆ™ä¼šé¢‘ç¹å˜åŠ¨çš„ç³»ç»Ÿæ¯”è¾ƒé€‚åˆä½¿ç”¨è§„åˆ™å¼•æ“ï¼Œå¦‚ä¸‹ï¼š</p><p>1ã€é£é™©æ§åˆ¶ç³»ç»Ÿâ€”-é£é™©è´·æ¬¾ã€é£é™©è¯„ä¼°</p><p>2ã€åæ¬ºè¯ˆé¡¹ç›®â€”-é“¶è¡Œè´·æ¬¾ã€å¾ä¿¡éªŒè¯</p><p>3ã€å†³ç­–å¹³å°ç³»ç»Ÿâ€”-è´¢åŠ¡è®¡ç®—</p><p>4ã€ä¿ƒé”€å¹³å°ç³»ç»Ÿâ€”-æ»¡å‡ã€æ‰“æŠ˜ã€åŠ ä»·è´­</p><h3 id="4ã€Droolså…¥é—¨æ¡ˆä¾‹"><a href="#4ã€Droolså…¥é—¨æ¡ˆä¾‹" class="headerlink" title="4ã€Droolså…¥é—¨æ¡ˆä¾‹"></a>4ã€Droolså…¥é—¨æ¡ˆä¾‹</h3><h4 id="4-1ã€åˆ›å»ºspringbooté¡¹ç›®"><a href="#4-1ã€åˆ›å»ºspringbooté¡¹ç›®" class="headerlink" title="4.1ã€åˆ›å»ºspringbooté¡¹ç›®"></a>4.1ã€åˆ›å»ºspringbooté¡¹ç›®</h4><pre class="line-numbers language-none"><code class="language-none">drools_demo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>GroupIdï¼šcom.stormling</code><br><a href="https://s2.loli.net/2024/12/24/emR2vgKh6QHFUSo.png" title="åˆ›å»ºé¡¹ç›®" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/emR2vgKh6QHFUSo.png" alt="åˆ›å»ºé¡¹ç›®"></a></p><h4 id="4-2ã€SpringBootç‰ˆæœ¬"><a href="#4-2ã€SpringBootç‰ˆæœ¬" class="headerlink" title="4.2ã€SpringBootç‰ˆæœ¬"></a>4.2ã€<code>SpringBoot</code>ç‰ˆæœ¬</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4-3ã€å¼•å…¥ä¾èµ–"><a href="#4-3ã€å¼•å…¥ä¾èµ–" class="headerlink" title="4.3ã€å¼•å…¥ä¾èµ–"></a>4.3ã€å¼•å…¥ä¾èµ–</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>drools.version</span><span class="token punctuation">></span></span>8.41.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>drools.version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--test--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--drools è§„åˆ™å¼•æ“--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-decisiontables<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-mvel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--lombokç”¨æ¥ç®€åŒ–å®ä½“ç±»--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-4ã€Ideaä¸­å®‰è£…Droolsæ’ä»¶"><a href="#4-4ã€Ideaä¸­å®‰è£…Droolsæ’ä»¶" class="headerlink" title="4.4ã€Ideaä¸­å®‰è£…Droolsæ’ä»¶"></a>4.4ã€Ideaä¸­å®‰è£…Droolsæ’ä»¶</h4><p><a href="https://s2.loli.net/2024/12/24/45wytksZNTrl9ja.png" title="Droolsæ’ä»¶" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/45wytksZNTrl9ja.png" alt="Droolsæ’ä»¶"></a></p><h3 id="5ã€ç¼–å†™ä»£ç "><a href="#5ã€ç¼–å†™ä»£ç " class="headerlink" title="5ã€ç¼–å†™ä»£ç "></a>5ã€ç¼–å†™ä»£ç </h3><h4 id="5-1ã€æ·»åŠ Droolsé…ç½®ç±»"><a href="#5-1ã€æ·»åŠ Droolsé…ç½®ç±»" class="headerlink" title="5.1ã€æ·»åŠ Droolsé…ç½®ç±»"></a>5.1ã€æ·»åŠ Droolsé…ç½®ç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieServices</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieContainer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ResourceFactory</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span><span class="token comment">/** * è§„åˆ™å¼•æ“é…ç½®ç±» */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆ¶å®šè§„åˆ™æ–‡ä»¶çš„è·¯å¾„</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">RULES_CUSTOMER_RULES_DRL</span> <span class="token operator">=</span> <span class="token string">"rules/order.drl"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">KieContainer</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//è·å¾—Kieå®¹å™¨å¯¹è±¡</span>        <span class="token class-name">KieFileSystem</span> kieFileSystem <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieFileSystem<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">ResourceFactory</span><span class="token punctuation">.</span><span class="token function">newClassPathResource</span><span class="token punctuation">(</span><span class="token constant">RULES_CUSTOMER_RULES_DRL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieBuilder</span> kieBuilder <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieBuilder</span><span class="token punctuation">(</span>kieFileSystem<span class="token punctuation">)</span><span class="token punctuation">;</span>        kieBuilder<span class="token punctuation">.</span><span class="token function">buildAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieModule</span> kieModule <span class="token operator">=</span> kieBuilder<span class="token punctuation">.</span><span class="token function">getKieModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieContainer</span> kieContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieContainer</span><span class="token punctuation">(</span>kieModule<span class="token punctuation">.</span><span class="token function">getReleaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> kieContainer<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>å®šä¹‰äº†ä¸€ä¸ª <code>KieContainer</code>çš„<code>Spring Bean</code> ï¼Œ<code>KieContainer</code>ç”¨äºé€šè¿‡åŠ è½½åº”ç”¨ç¨‹åºçš„<code>/resources</code>æ–‡ä»¶å¤¹ä¸‹çš„è§„åˆ™æ–‡ä»¶æ¥æ„å»ºè§„åˆ™å¼•æ“ã€‚</li><li>åˆ›å»º<code>KieFileSystem</code>å®ä¾‹å¹¶é…ç½®è§„åˆ™å¼•æ“å¹¶ä»åº”ç”¨ç¨‹åºçš„èµ„æºç›®å½•åŠ è½½è§„åˆ™çš„ <code>DRL</code> æ–‡ä»¶ã€‚</li><li>ä½¿ç”¨<code>KieBuilder</code>å®ä¾‹æ¥æ„å»º <code>drools</code> æ¨¡å—ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨KieSeriveå•ä¾‹å®ä¾‹æ¥åˆ›å»º <code>KieBuilder</code> å®ä¾‹ã€‚</li><li>æœ€åï¼Œä½¿ç”¨ <code>KieService</code> åˆ›å»ºä¸€ä¸ª <code>KieContainer</code> å¹¶å°†å…¶é…ç½®ä¸º <code>spring bean</code></li></ul><h4 id="5-2ã€åˆ›å»ºå®ä½“ç±»Order"><a href="#5-2ã€åˆ›å»ºå®ä½“ç±»Order" class="headerlink" title="5.2ã€åˆ›å»ºå®ä½“ç±»Order"></a>5.2ã€åˆ›å»ºå®ä½“ç±»Order</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>model</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> amount<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> score<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-3ã€order-drl"><a href="#5-3ã€order-drl" class="headerlink" title="5.3ã€order.drl"></a>5.3ã€order.drl</h4><p>åˆ›å»ºè§„åˆ™æ–‡ä»¶<code>resources/rules/order.drl</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¢å•ç§¯åˆ†è§„åˆ™</span><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>order</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†</span>rule <span class="token string">"order_rule_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> amount <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™ä¸‰ï¼š500å…ƒ - 1000å…ƒ åŠ 500åˆ†</span>rule <span class="token string">"order_rule_3"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">500</span> <span class="token operator">&amp;&amp;</span> amount <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸‰ï¼š500å…ƒ - 1000å…ƒ åŠ 500åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™å››ï¼š1000å…ƒä»¥ä¸Š åŠ 1000åˆ†</span>rule <span class="token string">"order_rule_4"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">1000</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™å››ï¼š1000å…ƒä»¥ä¸Š åŠ 1000åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-4ã€ç¼–å†™æµ‹è¯•ç±»"><a href="#5-4ã€ç¼–å†™æµ‹è¯•ç±»" class="headerlink" title="5.4ã€ç¼–å†™æµ‹è¯•ç±»"></a>5.4ã€ç¼–å†™æµ‹è¯•ç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieContainer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">class</span> <span class="token class-name">DroolsDemosApplicationTests</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">KieContainer</span> kieContainer<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ä»Kieå®¹å™¨å¯¹è±¡ä¸­è·å–ä¼šè¯å¯¹è±¡</span>        <span class="token class-name">KieSession</span> session <span class="token operator">=</span> kieContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Factå¯¹è±¡ï¼Œäº‹å®å¯¹è±¡</span>        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        order<span class="token punctuation">.</span><span class="token function">setamount</span><span class="token punctuation">(</span><span class="token number">1300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†Orderå¯¹è±¡æ’å…¥åˆ°å·¥ä½œå†…å­˜ä¸­</span>        session<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¿€æ´»è§„åˆ™ï¼Œç”±Droolsæ¡†æ¶è‡ªåŠ¨è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸï¼Œåˆ™æ‰§è¡Œå½“å‰è§„åˆ™</span>        session<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å…³é—­ä¼šè¯</span>        session<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è®¢å•é‡‘é¢ï¼š"</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>                <span class="token string">"ï¼Œæ·»åŠ ç§¯åˆ†ï¼š"</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">åŒ¹é…è§„åˆ™4ï¼š1000è®¢å•é‡‘é¢ï¼š1300.0ç§¯åˆ†ï¼š1000.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šé¢çš„å…¥é—¨æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½¿ç”¨<code>drools</code>è§„åˆ™å¼•æ“ä¸»è¦å·¥ä½œå°±æ˜¯ç¼–å†™è§„åˆ™æ–‡ä»¶ï¼Œåœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰è·Ÿä¸šåŠ¡ç›¸å…³çš„ä¸šåŠ¡è§„åˆ™ã€‚è§„åˆ™å®šä¹‰å¥½åå°±éœ€è¦è°ƒç”¨<code>drools</code>æä¾›çš„<code>API</code>å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“è¿›è¡Œè§„åˆ™æ¨¡å¼åŒ¹é…ï¼Œè§„åˆ™å¼•æ“ä¼šæ‰§è¡ŒåŒ¹é…æˆåŠŸçš„è§„åˆ™å¹¶å°†è®¡ç®—çš„ç»“æœè¿”å›ç»™æˆ‘ä»¬ã€‚</p><p>å¯èƒ½å¤§å®¶ä¼šæœ‰ç–‘é—®ï¼Œå°±æ˜¯æˆ‘ä»¬è™½ç„¶æ²¡æœ‰åœ¨ä»£ç ä¸­ç¼–å†™è§„åˆ™çš„åˆ¤æ–­é€»è¾‘ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯åœ¨è§„åˆ™æ–‡ä»¶ä¸­ç¼–å†™äº†ä¸šåŠ¡è§„åˆ™ï¼Œè¿™è·Ÿåœ¨ä»£ç ä¸­ç¼–å†™è§„åˆ™æœ‰ä»€ä¹ˆæœ¬è´¨çš„åŒºåˆ«å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‰é¢å…¶å®å·²ç»æåˆ°ï¼Œä½¿ç”¨è§„åˆ™å¼•æ“æ—¶ä¸šåŠ¡è§„åˆ™å¯ä»¥åšåˆ°<strong>åŠ¨æ€ç®¡ç†</strong>ã€‚ä¸šåŠ¡äººå‘˜å¯ä»¥åƒç®¡ç†æ•°æ®ä¸€æ ·å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚æŸ¥è¯¢ã€æ·»åŠ ã€æ›´æ–°ã€ç»Ÿè®¡ã€æäº¤ä¸šåŠ¡è§„åˆ™ç­‰ã€‚è¿™æ ·å°±å¯ä»¥åšåˆ°åœ¨<strong>ä¸é‡å¯æœåŠ¡</strong>çš„æƒ…å†µä¸‹<strong>è°ƒæ•´ä¸šåŠ¡è§„åˆ™</strong>ã€‚</p><h3 id="6ã€å°ç»“"><a href="#6ã€å°ç»“" class="headerlink" title="6ã€å°ç»“"></a>6ã€å°ç»“</h3><h4 id="6-1ã€è§„åˆ™å¼•æ“æ„æˆ"><a href="#6-1ã€è§„åˆ™å¼•æ“æ„æˆ" class="headerlink" title="6.1ã€è§„åˆ™å¼•æ“æ„æˆ"></a>6.1ã€è§„åˆ™å¼•æ“æ„æˆ</h4><p><code>drools</code>è§„åˆ™å¼•æ“ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†æ„æˆï¼š</p><ul><li>Working Memoryï¼ˆå·¥ä½œå†…å­˜ï¼‰</li><li>Rule Baseï¼ˆè§„åˆ™åº“ï¼‰</li><li>Inference Engineï¼ˆæ¨ç†å¼•æ“ï¼‰<ul><li>Pattern Matcherï¼ˆåŒ¹é…å™¨ï¼‰ å…·ä½“åŒ¹é…å“ªä¸€ä¸ªè§„åˆ™ï¼Œç”±è¿™ä¸ªå®Œæˆ</li><li>Agenda(è®®ç¨‹)</li><li>Execution Engineï¼ˆæ‰§è¡Œå¼•æ“ï¼‰</li></ul></li></ul><p><a href="https://s2.loli.net/2024/12/24/JRLKoSUflkhIZ9Y.jpg" title="Droolsæ„æˆ" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/JRLKoSUflkhIZ9Y.jpg" alt="Droolsæ„æˆ"></a></p><h4 id="6-2ã€ç›¸å…³æ¦‚å¿µè¯´æ˜"><a href="#6-2ã€ç›¸å…³æ¦‚å¿µè¯´æ˜" class="headerlink" title="6.2ã€ç›¸å…³æ¦‚å¿µè¯´æ˜"></a>6.2ã€ç›¸å…³æ¦‚å¿µè¯´æ˜</h4><p><strong>Working Memory</strong>ï¼šå·¥ä½œå†…å­˜ï¼Œ<code>drools</code>è§„åˆ™å¼•æ“ä¼šä»<code>Working Memoryä¸­</code>è·å–æ•°æ®å¹¶å’Œè§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„è§„åˆ™è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å‘çš„åº”ç”¨ç¨‹åºåªéœ€è¦å°†æˆ‘ä»¬çš„<strong>æ•°æ®æ’å…¥</strong>åˆ°<code>Working Memory</code>ä¸­å³å¯ï¼Œä¾‹å¦‚æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬è°ƒç”¨<code>kieSession.insert(order)</code>å°±æ˜¯å°†<code>order</code>å¯¹è±¡æ’å…¥åˆ°äº†<strong>å·¥ä½œå†…å­˜</strong>ä¸­ã€‚</p><p><strong>Fact</strong>ï¼šäº‹å®ï¼Œæ˜¯æŒ‡åœ¨<code>drools</code> è§„åˆ™åº”ç”¨å½“ä¸­ï¼Œå°†ä¸€ä¸ª<strong>æ™®é€šçš„<code>JavaBean</code>æ’å…¥åˆ°<code>Working Memoryå</code>çš„å¯¹è±¡</strong>å°±æ˜¯<strong>Factå¯¹è±¡</strong>ï¼Œä¾‹å¦‚æœ¬æ¡ˆä¾‹ä¸­çš„<code>Order</code>å¯¹è±¡å°±å±äº<code>Fact</code>å¯¹è±¡ã€‚<code>Fact</code>å¯¹è±¡æ˜¯æˆ‘ä»¬çš„åº”ç”¨å’Œè§„åˆ™å¼•æ“è¿›è¡Œ<strong>æ•°æ®äº¤äº’</strong>çš„æ¡¥æ¢æˆ–é€šé“ã€‚</p><p><strong>Rule Base</strong>ï¼šè§„åˆ™åº“ï¼Œæˆ‘ä»¬åœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„è§„åˆ™éƒ½ä¼šè¢«åŠ è½½åˆ°è§„åˆ™åº“ä¸­ã€‚</p><p><strong>Pattern Matcher</strong>ï¼šåŒ¹é…å™¨ï¼Œå°†<code>Rule Base</code>ä¸­çš„æ‰€æœ‰è§„åˆ™ä¸<code>Working Memory</code>ä¸­çš„<code>Fact</code>å¯¹è±¡è¿›è¡Œ<strong>æ¨¡å¼åŒ¹é…</strong>ï¼ŒåŒ¹é…æˆåŠŸçš„è§„åˆ™å°†è¢«<strong>æ¿€æ´»</strong>å¹¶æ”¾å…¥<code>Agenda</code>ï¼ˆè®®ç¨‹ï¼‰ä¸­ã€‚</p><p><strong>Agenda</strong>ï¼šè®®ç¨‹ï¼Œç”¨äºå­˜æ”¾é€šè¿‡åŒ¹é…å™¨è¿›è¡Œæ¨¡å¼åŒ¹é…åè¢«æ¿€æ´»çš„è§„åˆ™ã€‚</p><p><strong>Execution Engine</strong>ï¼šæ‰§è¡Œå¼•æ“ï¼Œæ‰§è¡Œ<code>Agenda</code>ä¸­è¢«æ¿€æ´»çš„è§„åˆ™ã€‚<br><a href="https://i-blog.csdnimg.cn/direct/95588868b5c94f048eb01475714c08e7.png#pic_center" title="æ¡ˆä¾‹" class="gallery-item"><img src="https://i-blog.csdnimg.cn/direct/95588868b5c94f048eb01475714c08e7.png#pic_center" alt="æ¡ˆä¾‹"></a></p><h4 id="6-3ã€è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹"><a href="#6-3ã€è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="6.3ã€è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹"></a>6.3ã€è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹</h4><p><a href="https://s2.loli.net/2024/12/24/osJML3OFG9XkuWU.png" title="æ‰§è¡Œæµç¨‹" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/osJML3OFG9XkuWU.png" alt="æ‰§è¡Œæµç¨‹"></a></p><h4 id="6-4ã€KIEä»‹ç»"><a href="#6-4ã€KIEä»‹ç»" class="headerlink" title="6.4ã€KIEä»‹ç»"></a>6.4ã€KIEä»‹ç»</h4><p>æˆ‘ä»¬åœ¨æ“ä½œ<code>Drools</code>æ—¶ç»å¸¸ä½¿ç”¨çš„<code>API</code>ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š<br><a href="https://s2.loli.net/2024/12/24/jr7Llc3tOw1dUCo.png" title="æ ¸å¿ƒç±»å…³ç³»" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/jr7Llc3tOw1dUCo.png" alt="æ ¸å¿ƒç±»å…³ç³»"></a></p><p>é€šè¿‡ä¸Šé¢çš„æ ¸å¿ƒ<code>API</code>å¯ä»¥å‘ç°ï¼Œå¤§éƒ¨åˆ†ç±»åéƒ½æ˜¯ä»¥<code>Kie</code>å¼€å¤´ã€‚<strong>Kieå…¨ç§°ä¸ºKnowledge Is Everything</strong>ï¼Œå³â€çŸ¥è¯†å°±æ˜¯ä¸€åˆ‡â€çš„ç¼©å†™ï¼Œæ˜¯<code>Jboss</code>ä¸€ç³»åˆ—é¡¹ç›®çš„æ€»ç§°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<code>Kie</code>çš„ä¸»è¦æ¨¡å—æœ‰<code>OptaPlanner</code>ã€<code>Drools</code>ã€<code>UberFire</code>ã€<code>jBPM</code>ã€‚</p><p><a href="https://s2.loli.net/2024/12/24/2UgIRiof4G9eEVy.png" title="Kie" class="gallery-item"><img src="https://s2.loli.net/2024/12/24/2UgIRiof4G9eEVy.png" alt="Kie"></a></p><p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œ<code>Drools</code>æ˜¯æ•´ä¸ª<code>KIE</code>é¡¹ç›®ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œ<code>Drools</code>ä¸­è¿˜åŒ…æ‹¬ä¸€ä¸ª<code>Drools-WB</code>çš„æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„è§„åˆ™ç¼–è¾‘å™¨ã€‚</p><h3 id="7ã€DroolsåŸºç¡€è¯­æ³•"><a href="#7ã€DroolsåŸºç¡€è¯­æ³•" class="headerlink" title="7ã€DroolsåŸºç¡€è¯­æ³•"></a>7ã€DroolsåŸºç¡€è¯­æ³•</h3><h4 id="7-1ã€è§„åˆ™æ–‡ä»¶æ„æˆ"><a href="#7-1ã€è§„åˆ™æ–‡ä»¶æ„æˆ" class="headerlink" title="7.1ã€è§„åˆ™æ–‡ä»¶æ„æˆ"></a>7.1ã€è§„åˆ™æ–‡ä»¶æ„æˆ</h4><p>åœ¨ä½¿ç”¨<code>Drools</code>æ—¶éå¸¸é‡è¦çš„ä¸€ä¸ªå·¥ä½œå°±æ˜¯ç¼–å†™è§„åˆ™æ–‡ä»¶ï¼Œé€šå¸¸è§„åˆ™æ–‡ä»¶çš„åç¼€ä¸º<code>.drl</code></p><p><strong>drlæ˜¯Drools Rule Languageçš„ç¼©å†™</strong>ã€‚åœ¨è§„åˆ™æ–‡ä»¶ä¸­ç¼–å†™å…·ä½“çš„è§„åˆ™å†…å®¹ã€‚</p><p>ä¸€å¥—å®Œæ•´çš„è§„åˆ™æ–‡ä»¶å†…å®¹æ„æˆå¦‚ä¸‹ï¼š</p><table><thead><tr><th>å…³é”®å­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>package</td><td>åŒ…åï¼Œåªé™äºé€»è¾‘ä¸Šçš„ç®¡ç†ï¼ŒåŒä¸€ä¸ªåŒ…åä¸‹çš„æŸ¥è¯¢æˆ–è€…å‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨</td></tr><tr><td>import</td><td>ç”¨äºå¯¼å…¥ç±»æˆ–è€…é™æ€æ–¹æ³•</td></tr><tr><td>global</td><td>å…¨å±€å˜é‡</td></tr><tr><td>function</td><td>è‡ªå®šä¹‰å‡½æ•°</td></tr><tr><td>query</td><td>æŸ¥è¯¢</td></tr><tr><td>rule end</td><td>è§„åˆ™ä½“</td></tr></tbody></table><p><code>Drools</code>æ”¯æŒçš„è§„åˆ™æ–‡ä»¶ï¼Œé™¤äº†<code>drl</code>å½¢å¼ï¼Œè¿˜æœ‰<code>Excel</code>æ–‡ä»¶ç±»å‹çš„ã€‚</p><h4 id="7-2ã€è§„åˆ™ä½“è¯­æ³•ç»“æ„"><a href="#7-2ã€è§„åˆ™ä½“è¯­æ³•ç»“æ„" class="headerlink" title="7.2ã€è§„åˆ™ä½“è¯­æ³•ç»“æ„"></a>7.2ã€è§„åˆ™ä½“è¯­æ³•ç»“æ„</h4><p>è§„åˆ™ä½“æ˜¯è§„åˆ™æ–‡ä»¶å†…å®¹ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯è¿›è¡Œä¸šåŠ¡è§„åˆ™åˆ¤æ–­ã€å¤„ç†ä¸šåŠ¡ç»“æœçš„éƒ¨åˆ†ã€‚</p><p>è§„åˆ™ä½“è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rule <span class="token string">"ruleName"</span>    attributes    when        <span class="token constant">LHS</span>     then        <span class="token constant">RHS</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>**<code>rule</code>**ï¼šå…³é”®å­—ï¼Œè¡¨ç¤ºè§„åˆ™å¼€å§‹ï¼Œå‚æ•°ä¸ºè§„åˆ™çš„å”¯ä¸€åç§°ã€‚</p><p>**<code>attributes</code>**ï¼šè§„åˆ™å±æ€§ï¼Œæ˜¯<code>rule</code>ä¸<code>when</code>ä¹‹é—´çš„å‚æ•°ï¼Œä¸ºå¯é€‰é¡¹ã€‚</p><p>**<code>when</code>**ï¼šå…³é”®å­—ï¼Œåé¢è·Ÿè§„åˆ™çš„æ¡ä»¶éƒ¨åˆ†ã€‚</p><p><strong><code>LHS</code></strong>(<code>Left Hand Side</code>)ï¼šæ˜¯è§„åˆ™çš„æ¡ä»¶éƒ¨åˆ†çš„é€šç”¨åç§°ã€‚å®ƒç”±é›¶ä¸ªæˆ–å¤šä¸ªæ¡ä»¶å…ƒç´ ç»„æˆã€‚<strong>å¦‚æœ<code>LHS</code>ä¸ºç©ºï¼Œåˆ™å®ƒå°†è¢«è§†ä¸ºå§‹ç»ˆä¸ºtrueçš„æ¡ä»¶å…ƒç´ </strong>ã€‚ ï¼ˆå·¦æ‰‹è¾¹ï¼‰</p><p>**<code>then</code>**ï¼šå…³é”®å­—ï¼Œåé¢è·Ÿè§„åˆ™çš„ç»“æœéƒ¨åˆ†ã€‚</p><p><strong><code>RHS</code></strong>(<code>Right Hand Side</code>)ï¼šæ˜¯è§„åˆ™çš„åæœæˆ–è¡ŒåŠ¨éƒ¨åˆ†çš„é€šç”¨åç§°ã€‚ ï¼ˆå³æ‰‹è¾¹ï¼‰</p><p>**<code>end</code>**ï¼šå…³é”®å­—ï¼Œè¡¨ç¤ºä¸€ä¸ªè§„åˆ™ç»“æŸã€‚</p><h4 id="7-3ã€æ³¨é‡Š"><a href="#7-3ã€æ³¨é‡Š" class="headerlink" title="7.3ã€æ³¨é‡Š"></a>7.3ã€æ³¨é‡Š</h4><p>åœ¨<code>drl</code>å½¢å¼çš„è§„åˆ™æ–‡ä»¶ä¸­ä½¿ç”¨æ³¨é‡Šå’Œ<code>Java</code>ç±»ä¸­ä½¿ç”¨æ³¨é‡Šä¸€è‡´ï¼Œåˆ†ä¸ºå•è¡Œæ³¨é‡Šå’Œå¤šè¡Œæ³¨é‡Šã€‚</p><p>å•è¡Œæ³¨é‡Šç”¨<code>&quot;//&quot;</code>è¿›è¡Œæ ‡è®°ï¼Œå¤šè¡Œæ³¨é‡Šä»¥<code>&quot;/*&quot;</code>å¼€å§‹ï¼Œä»¥â€*/â€œç»“æŸã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™rule1çš„æ³¨é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Š</span>rule <span class="token string">"rule1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"rule1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">/*è§„åˆ™rule2çš„æ³¨é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šè¡Œæ³¨é‡Š*/</span>rule <span class="token string">"rule2"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"rule2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-4ã€Patternæ¨¡å¼åŒ¹é…"><a href="#7-4ã€Patternæ¨¡å¼åŒ¹é…" class="headerlink" title="7.4ã€Patternæ¨¡å¼åŒ¹é…"></a>7.4ã€Patternæ¨¡å¼åŒ¹é…</h4><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†<code>Drools</code>ä¸­çš„åŒ¹é…å™¨å¯ä»¥å°†<code>Rule Base</code>ä¸­çš„æ‰€æœ‰è§„åˆ™ä¸<code>Working Memory</code>ä¸­çš„<code>Fact</code>å¯¹è±¡è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨è§„åˆ™ä½“çš„<code>LHS</code>éƒ¨åˆ†å®šä¹‰è§„åˆ™å¹¶è¿›è¡Œæ¨¡å¼åŒ¹é…ã€‚<code>LHS</code>éƒ¨åˆ†ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¡ä»¶ç»„æˆï¼Œæ¡ä»¶åˆç§°ä¸º<code>pattern</code>ã€‚</p><p><strong>patternçš„è¯­æ³•ç»“æ„ä¸ºï¼šç»‘å®šå˜é‡å:Object(Fieldçº¦æŸ)</strong></p><p>å…¶ä¸­ç»‘å®šå˜é‡åå¯ä»¥çœç•¥ï¼Œé€šå¸¸ç»‘å®šå˜é‡åçš„å‘½åä¸€èˆ¬å»ºè®®ä»¥<code>$</code>å¼€å§‹ã€‚å¦‚æœå®šä¹‰äº†ç»‘å®šå˜é‡åï¼Œå°±å¯ä»¥åœ¨è§„åˆ™ä½“çš„<code>RHS</code>éƒ¨åˆ†ä½¿ç”¨æ­¤ç»‘å®šå˜é‡åæ¥æ“ä½œç›¸åº”çš„<code>Fact</code>å¯¹è±¡ã€‚<code>Field</code>çº¦æŸéƒ¨åˆ†æ˜¯éœ€è¦è¿”å›<code>true</code>æˆ–è€…<code>false</code>çš„0ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬çš„å…¥é—¨æ¡ˆä¾‹ä¸­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†</span>rule <span class="token string">"order_rule_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> amount <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒåŒ¹é…çš„æ¡ä»¶ä¸ºï¼š</p><p>1ã€å·¥ä½œå†…å­˜ä¸­å¿…é¡»å­˜åœ¨<code>Order</code>è¿™ç§ç±»å‹çš„<code>Fact</code>å¯¹è±¡â€”â€“ç±»å‹çº¦æŸ</p><p>2ã€<code>Fact</code>å¯¹è±¡çš„<code>amount</code>å±æ€§å€¼å¿…é¡»å¤§äºç­‰äº100â€”â€”å±æ€§çº¦æŸ</p><p>3ã€<code>Fact</code>å¯¹è±¡çš„<code>amount</code>å±æ€§å€¼å¿…é¡»å°äº500â€”â€”å±æ€§çº¦æŸ</p><p>ä»¥ä¸Šæ¡ä»¶å¿…é¡»åŒæ—¶æ»¡è¶³å½“å‰è§„åˆ™æ‰æœ‰å¯èƒ½è¢«æ¿€æ´»ã€‚</p><h4 id="7-5ã€æ¯”è¾ƒæ“ä½œç¬¦"><a href="#7-5ã€æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="7.5ã€æ¯”è¾ƒæ“ä½œç¬¦"></a>7.5ã€æ¯”è¾ƒæ“ä½œç¬¦</h4><p><code>Drools</code>æä¾›çš„æ¯”è¾ƒæ“ä½œç¬¦ï¼Œå¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>ç¬¦å·</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>&lt;</code></td><td>å°äº</td></tr><tr><td><code>&gt;</code></td><td>å¤§äº</td></tr><tr><td><code>&gt;=</code></td><td>å¤§äºç­‰äº</td></tr><tr><td><code>&lt;=</code></td><td>å°äºç­‰äº</td></tr><tr><td><code>==</code></td><td>ç­‰äº</td></tr><tr><td><code>!=</code></td><td>ä¸ç­‰äº</td></tr><tr><td><code>contains</code></td><td>æ£€æŸ¥ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼æ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡å€¼</td></tr><tr><td><code>not contains</code></td><td>æ£€æŸ¥ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼æ˜¯å¦ä¸åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡å€¼</td></tr><tr><td><code>memberOf</code></td><td>åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§æ˜¯å¦åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªé›†åˆä¸­</td></tr><tr><td><code>not memberOf</code></td><td>åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§æ˜¯å¦ä¸åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªé›†åˆä¸­</td></tr><tr><td><code>matches</code></td><td>åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸æä¾›çš„æ ‡å‡†çš„Javaæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…</td></tr><tr><td><code>not matches</code></td><td>åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸ä¸æä¾›çš„æ ‡å‡†çš„Javaæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…</td></tr></tbody></table><p>å‰6ä¸ªæ¯”è¾ƒæ“ä½œç¬¦å’ŒJavaä¸­çš„å®Œå…¨ç›¸åŒã€‚</p><h4 id="7-6ã€Droolså†…ç½®æ–¹æ³•"><a href="#7-6ã€Droolså†…ç½®æ–¹æ³•" class="headerlink" title="7.6ã€Droolså†…ç½®æ–¹æ³•"></a>7.6ã€Droolså†…ç½®æ–¹æ³•</h4><p>è§„åˆ™æ–‡ä»¶çš„<code>RHS</code>éƒ¨åˆ†çš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡<strong>æ’å…¥ï¼Œåˆ é™¤æˆ–ä¿®æ”¹å·¥ä½œå†…å­˜ä¸­çš„Factæ•°æ®</strong>ï¼Œæ¥è¾¾åˆ°æ§åˆ¶è§„åˆ™å¼•æ“æ‰§è¡Œçš„ç›®çš„ã€‚<code>Drools</code>æä¾›äº†ä¸€äº›æ–¹æ³•å¯ä»¥ç”¨æ¥æ“ä½œå·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œ<strong>æ“ä½œå®Œæˆåè§„åˆ™å¼•æ“ä¼šé‡æ–°è¿›è¡Œç›¸å…³è§„åˆ™çš„åŒ¹é…ï¼Œ</strong>åŸæ¥æ²¡æœ‰åŒ¹é…æˆåŠŸçš„è§„åˆ™åœ¨æˆ‘ä»¬ä¿®æ”¹æ•°æ®å®Œæˆåæœ‰å¯èƒ½å°±ä¼šåŒ¹é…æˆåŠŸäº†ã€‚</p><h5 id="7-6-1ã€updateæ–¹æ³•"><a href="#7-6-1ã€updateæ–¹æ³•" class="headerlink" title="7.6.1ã€updateæ–¹æ³•"></a>7.6.1ã€updateæ–¹æ³•</h5><p><strong>updateæ–¹æ³•çš„ä½œç”¨æ˜¯æ›´æ–°å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</strong> ï¼ˆè¦é¿å…æ­»å¾ªç¯ï¼‰</p><p>å‚æ•°ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//Factå¯¹è±¡ï¼Œäº‹å®å¯¹è±¡</span><span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>order<span class="token punctuation">.</span><span class="token function">setamount</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§„åˆ™ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setamount</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$order<span class="token punctuation">)</span> <span class="token comment">//updateæ–¹æ³•ç”¨äºæ›´æ–°Factå¯¹è±¡ï¼Œä¼šå¯¼è‡´ç›¸å…³è§„åˆ™é‡æ–°åŒ¹é…</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†</span>rule <span class="token string">"order_rule_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> amount <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åœ¨æ›´æ–°æ•°æ®æ—¶éœ€è¦æ³¨æ„é˜²æ­¢å‘ç”Ÿæ­»å¾ªç¯ã€‚</strong></p><h5 id="7-6-2ã€insertæ–¹æ³•"><a href="#7-6-2ã€insertæ–¹æ³•" class="headerlink" title="7.6.2ã€insertæ–¹æ³•"></a>7.6.2ã€insertæ–¹æ³•</h5><p><strong>insert</strong>æ–¹æ³•çš„ä½œç”¨æ˜¯å‘å·¥ä½œå†…å­˜ä¸­æ’å…¥æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        order<span class="token punctuation">.</span><span class="token function">setamount</span><span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">insert</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//insertæ–¹æ³•çš„ä½œç”¨æ˜¯å‘å·¥ä½œå†…å­˜ä¸­æ’å…¥Factå¯¹è±¡ï¼Œä¼šå¯¼è‡´ç›¸å…³è§„åˆ™é‡æ–°åŒ¹é…</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†</span>rule <span class="token string">"order_rule_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">>=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> amount <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span>    then         $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼š100å…ƒ - 500å…ƒ åŠ 100åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="7-6-3ã€retractæ–¹æ³•"><a href="#7-6-3ã€retractæ–¹æ³•" class="headerlink" title="7.6.3ã€retractæ–¹æ³•"></a>7.6.3ã€retractæ–¹æ³•</h5><p><strong>retractæ–¹æ³•çš„ä½œç”¨æ˜¯åˆ é™¤å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        <span class="token function">retract</span><span class="token punctuation">(</span>$order<span class="token punctuation">)</span>      <span class="token comment">//retractæ–¹æ³•çš„ä½œç”¨æ˜¯åˆ é™¤å·¥ä½œå†…å­˜ä¸­çš„Factå¯¹è±¡ï¼Œä¼šå¯¼è‡´ç›¸å…³è§„åˆ™é‡æ–°åŒ¹é…</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8ã€è§„åˆ™å±æ€§-attributes"><a href="#8ã€è§„åˆ™å±æ€§-attributes" class="headerlink" title="8ã€è§„åˆ™å±æ€§ attributes"></a>8ã€è§„åˆ™å±æ€§ attributes</h3><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†è§„åˆ™ä½“çš„æ„æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rule <span class="token string">"ruleName"</span>    attributes    when        <span class="token constant">LHS</span>    then        <span class="token constant">RHS</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬ç« èŠ‚å°±æ˜¯é’ˆå¯¹è§„åˆ™ä½“çš„<strong>attributes</strong>å±æ€§éƒ¨åˆ†è¿›è¡Œè®²è§£ã€‚Droolsä¸­æä¾›çš„å±æ€§å¦‚ä¸‹è¡¨(éƒ¨åˆ†å±æ€§)ï¼š</p><table><thead><tr><th>å±æ€§å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>salience</td><td>æŒ‡å®šè§„åˆ™æ‰§è¡Œä¼˜å…ˆçº§</td></tr><tr><td>dialect</td><td>æŒ‡å®šè§„åˆ™ä½¿ç”¨çš„è¯­è¨€ç±»å‹ï¼Œå–å€¼ä¸ºjavaå’Œmvel</td></tr><tr><td>enabled</td><td>æŒ‡å®šè§„åˆ™æ˜¯å¦å¯ç”¨</td></tr><tr><td>date-effective</td><td>æŒ‡å®šè§„åˆ™ç”Ÿæ•ˆæ—¶é—´</td></tr><tr><td>date-expires</td><td>æŒ‡å®šè§„åˆ™å¤±æ•ˆæ—¶é—´</td></tr><tr><td>activation-group</td><td>æ¿€æ´»åˆ†ç»„ï¼Œå…·æœ‰ç›¸åŒåˆ†ç»„åç§°çš„è§„åˆ™åªèƒ½æœ‰ä¸€ä¸ªè§„åˆ™è§¦å‘</td></tr><tr><td>agenda-group</td><td>è®®ç¨‹åˆ†ç»„ï¼Œåªæœ‰è·å–ç„¦ç‚¹çš„ç»„ä¸­çš„è§„åˆ™æ‰æœ‰å¯èƒ½è§¦å‘</td></tr><tr><td>timer</td><td>å®šæ—¶å™¨ï¼ŒæŒ‡å®šè§„åˆ™è§¦å‘çš„æ—¶é—´</td></tr><tr><td>auto-focus</td><td>è‡ªåŠ¨è·å–ç„¦ç‚¹ï¼Œä¸€èˆ¬ç»“åˆagenda-groupä¸€èµ·ä½¿ç”¨</td></tr><tr><td>no-loop</td><td>é˜²æ­¢æ­»å¾ªç¯</td></tr></tbody></table><p>é‡ç‚¹è¯´ä¸€ä¸‹æˆ‘ä»¬é¡¹ç›®éœ€è¦ä½¿ç”¨çš„å±æ€§</p><h4 id="8-1ã€salienceå±æ€§"><a href="#8-1ã€salienceå±æ€§" class="headerlink" title="8.1ã€salienceå±æ€§"></a>8.1ã€salienceå±æ€§</h4><p>salienceå±æ€§ç”¨äºæŒ‡å®šè§„åˆ™çš„æ‰§è¡Œä¼˜å…ˆçº§ï¼Œ<strong>å–å€¼ç±»å‹ä¸ºInteger</strong>ã€‚<strong>æ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ‰§è¡Œ</strong>ã€‚æ¯ä¸ªè§„åˆ™éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„æ‰§è¡Œé¡ºåºï¼Œå¦‚æœä¸è®¾ç½®salienceå±æ€§ï¼Œè§„åˆ™ä½“çš„æ‰§è¡Œé¡ºåºä¸ºç”±ä¸Šåˆ°ä¸‹ã€‚</p><p>å¯ä»¥é€šè¿‡åˆ›å»ºè§„åˆ™æ–‡ä»¶salience.drlæ¥æµ‹è¯•salienceå±æ€§ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>order</span>rule <span class="token string">"rule_1"</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end    rule <span class="token string">"rule_2"</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_3"</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_3è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œç”±äºä»¥ä¸Šä¸‰ä¸ªè§„åˆ™æ²¡æœ‰è®¾ç½®salienceå±æ€§ï¼Œæ‰€ä»¥æ‰§è¡Œçš„é¡ºåºæ˜¯æŒ‰ç…§è§„åˆ™æ–‡ä»¶ä¸­è§„åˆ™çš„é¡ºåºç”±ä¸Šåˆ°ä¸‹æ‰§è¡Œçš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>order</span>rule <span class="token string">"rule_1"</span>    salience <span class="token number">9</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_2"</span>    salience <span class="token number">10</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_3"</span>    salience <span class="token number">8</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_3è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œè§„åˆ™æ–‡ä»¶æ‰§è¡Œçš„é¡ºåºæ˜¯æŒ‰ç…§æˆ‘ä»¬è®¾ç½®çš„salienceå€¼ç”±å¤§åˆ°å°é¡ºåºæ‰§è¡Œçš„ã€‚</p><p>å»ºè®®åœ¨ç¼–å†™è§„åˆ™æ—¶ä½¿ç”¨salienceå±æ€§æ˜ç¡®æŒ‡å®šæ‰§è¡Œä¼˜å…ˆçº§ã€‚</p><h4 id="8-2ã€no-loopå±æ€§"><a href="#8-2ã€no-loopå±æ€§" class="headerlink" title="8.2ã€no-loopå±æ€§"></a>8.2ã€no-loopå±æ€§</h4><p><strong>no-loop</strong>å±æ€§ç”¨äºé˜²æ­¢æ­»å¾ªç¯ï¼Œå½“è§„åˆ™é€šè¿‡<code>update</code>ä¹‹ç±»çš„å‡½æ•°ä¿®æ”¹äº†<code>Fact</code>å¯¹è±¡æ—¶ï¼Œå¯èƒ½ä½¿å½“å‰è§„åˆ™å†æ¬¡è¢«æ¿€æ´»ä»è€Œå¯¼è‡´æ­»å¾ªç¯ã€‚å–å€¼ç±»å‹ä¸º<code>Boolean</code>ï¼Œé»˜è®¤å€¼ä¸º<code>false</code>ï¼Œæµ‹è¯•æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ç¼–å†™è§„åˆ™æ–‡ä»¶<code>/resources/rules/activationgroup.drl</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¢å•ç§¯åˆ†è§„åˆ™</span><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>order</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>         <span class="token comment">//é˜²æ­¢é™·å…¥æ­»å¾ªç¯</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$order<span class="token punctuation">)</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®<code>no-loop</code>å±æ€§çš„å€¼ï¼Œæ‰€ä»¥å‘ç”Ÿäº†æ­»å¾ªç¯ã€‚æ¥ä¸‹æ¥è®¾ç½®<code>no-loop</code>çš„å€¼ä¸º<code>true</code>å†æ¬¡æµ‹è¯•åˆ™ä¸ä¼šå‘ç”Ÿæ­»å¾ªç¯ã€‚</p><h3 id="9ã€Droolsé«˜çº§è¯­æ³•"><a href="#9ã€Droolsé«˜çº§è¯­æ³•" class="headerlink" title="9ã€Droolsé«˜çº§è¯­æ³•"></a>9ã€Droolsé«˜çº§è¯­æ³•</h3><p>å‰é¢ç« èŠ‚æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€å¥—å®Œæ•´çš„è§„åˆ™æ–‡ä»¶å†…å®¹æ„æˆå¦‚ä¸‹ï¼š</p><table><thead><tr><th>å…³é”®å­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>package</td><td>åŒ…åï¼Œåªé™äºé€»è¾‘ä¸Šçš„ç®¡ç†ï¼ŒåŒä¸€ä¸ªåŒ…åä¸‹çš„æŸ¥è¯¢æˆ–è€…å‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨</td></tr><tr><td>import</td><td>ç”¨äºå¯¼å…¥ç±»æˆ–è€…é™æ€æ–¹æ³•</td></tr><tr><td>global</td><td>å…¨å±€å˜é‡</td></tr><tr><td>function</td><td>è‡ªå®šä¹‰å‡½æ•°</td></tr><tr><td>query</td><td>æŸ¥è¯¢</td></tr><tr><td>rule end</td><td>è§„åˆ™ä½“</td></tr></tbody></table><h4 id="9-1ã€globalå…¨å±€å˜é‡"><a href="#9-1ã€globalå…¨å±€å˜é‡" class="headerlink" title="9.1ã€globalå…¨å±€å˜é‡"></a>9.1ã€globalå…¨å±€å˜é‡</h4><p><code>global</code>å…³é”®å­—ç”¨äºåœ¨è§„åˆ™æ–‡ä»¶ä¸­<strong>å®šä¹‰å…¨å±€å˜é‡</strong>ï¼Œå®ƒå¯ä»¥è®©åº”ç”¨ç¨‹åºçš„å¯¹è±¡åœ¨è§„åˆ™æ–‡ä»¶ä¸­èƒ½å¤Ÿè¢«è®¿é—®ã€‚å¯ä»¥ç”¨æ¥ä¸ºè§„åˆ™æ–‡ä»¶æä¾›æ•°æ®æˆ–æœåŠ¡ã€‚</p><p>è¯­æ³•ç»“æ„ä¸ºï¼š<strong>global å¯¹è±¡ç±»å‹ å¯¹è±¡åç§°</strong></p><p>åœ¨ä½¿ç”¨<code>global</code>å®šä¹‰çš„å…¨å±€å˜é‡æ—¶æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p><p>1ã€å¦‚æœå¯¹è±¡ç±»å‹ä¸º<strong>åŒ…è£…ç±»å‹</strong>æ—¶ï¼Œåœ¨ä¸€ä¸ªè§„åˆ™ä¸­æ”¹å˜äº†<code>global</code>çš„å€¼ï¼Œé‚£ä¹ˆ<strong>åªé’ˆå¯¹å½“å‰è§„åˆ™æœ‰æ•ˆ</strong>ï¼Œå¯¹å…¶ä»–è§„åˆ™ä¸­çš„<code>global</code>ä¸ä¼šæœ‰å½±å“ã€‚å¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯å½“å‰è§„åˆ™ä»£ç ä¸­çš„globalå‰¯æœ¬ï¼Œè§„åˆ™å†…éƒ¨ä¿®æ”¹ä¸ä¼šå½±å“å…¨å±€çš„ä½¿ç”¨ã€‚</p><p>2ã€å¦‚æœå¯¹è±¡ç±»å‹ä¸º**é›†åˆç±»å‹æˆ–<code>JavaBean</code>**æ—¶ï¼Œåœ¨ä¸€ä¸ªè§„åˆ™ä¸­æ”¹å˜äº†<code>global</code>çš„å€¼ï¼Œå¯¹<code>java</code>ä»£ç å’Œæ‰€æœ‰è§„åˆ™éƒ½æœ‰æ•ˆã€‚</p><p>è®¢å•<code>Order</code>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> amount<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç§¯åˆ†<code>Integral</code>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Integral</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token keyword">double</span> score<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§„åˆ™æ–‡ä»¶ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¢å•ç§¯åˆ†è§„åˆ™</span><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>order</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Order</span>global <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span>Integral</span> integral<span class="token punctuation">;</span><span class="token comment">//è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†</span>rule <span class="token string">"order_rule_1"</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>         <span class="token comment">//é˜²æ­¢é™·å…¥æ­»å¾ªç¯</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        integral<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$order<span class="token punctuation">)</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼š100å…ƒä»¥ä¸‹ ä¸åŠ åˆ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ä»Kieå®¹å™¨å¯¹è±¡ä¸­è·å–ä¼šè¯å¯¹è±¡</span>    <span class="token class-name">KieSession</span> session <span class="token operator">=</span> kieContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//Factå¯¹è±¡ï¼Œäº‹å®å¯¹è±¡</span>    <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    order<span class="token punctuation">.</span><span class="token function">setamount</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å…¨å±€å˜é‡</span>    <span class="token class-name">Integral</span> integral <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integral</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">setGlobal</span><span class="token punctuation">(</span><span class="token string">"integral"</span><span class="token punctuation">,</span> integral<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†Orderå¯¹è±¡æ’å…¥åˆ°å·¥ä½œå†…å­˜ä¸­</span>    session<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ¿€æ´»è§„åˆ™ï¼Œç”±Droolsæ¡†æ¶è‡ªåŠ¨è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸï¼Œåˆ™æ‰§è¡Œå½“å‰è§„åˆ™</span>    session<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å…³é—­ä¼šè¯</span>    session<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è®¢å•é‡‘é¢ï¼š"</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getamount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ·»åŠ ç§¯åˆ†ï¼š"</span> <span class="token operator">+</span> integral<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> è§„åˆ™å¼•æ“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§„åˆ™å¼•æ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“ç³»åˆ—ï¼ˆäºŒï¼‰ | Mybatis Plus 3.0+å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/60908.html"/>
      <url>/posts/60908.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Mybatis-Plus-3-0-å¿«é€Ÿå…¥é—¨"><a href="#Mybatis-Plus-3-0-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Mybatis Plus 3.0+å¿«é€Ÿå…¥é—¨"></a>Mybatis Plus 3.0+å¿«é€Ÿå…¥é—¨</h1><blockquote><p>å®˜ç½‘ï¼š<a href="https://baomidou.com/">https://baomidou.com/</a></p><p>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://baomidou.com/getting-started/">å¿«é€Ÿå¼€å§‹</a></p><p>æœ€æ–°ç‰ˆæœ¬ï¼š<a href="https://baomidou.com/getting-started/#spring-boot3">3.5.7</a> </p><p>å¯¹åº”ç‰ˆæœ¬å‚è€ƒï¼šJDK 8+ ã€Maven or Gradle</p></blockquote><h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><p><a href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus</a> ï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª <a href="https://www.mybatis.org/mybatis-3/">MyBatis</a> çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927101721314.png" title="Mybatis æœ€å¥½çš„æ­æ¡£" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927101721314.png" alt="Mybatis æœ€å¥½çš„æ­æ¡£"></a> </p><h2 id="2ã€åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°æ®åº“"><a href="#2ã€åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="2ã€åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°æ®åº“"></a>2ã€åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°æ®åº“</h2><h3 id="2-1ã€åˆ›å»ºæ•°æ®åº“"><a href="#2-1ã€åˆ›å»ºæ•°æ®åº“" class="headerlink" title="2.1ã€åˆ›å»ºæ•°æ®åº“"></a>2.1ã€åˆ›å»ºæ•°æ®åº“</h3><p><code>mybatis_plus</code></p><h3 id="2-2ã€åˆ›å»º-User-è¡¨"><a href="#2-2ã€åˆ›å»º-User-è¡¨" class="headerlink" title="2.2ã€åˆ›å»º User è¡¨"></a>2.2ã€åˆ›å»º <code>User</code> è¡¨</h3><p>å…¶è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p><table><thead><tr><th>id</th><th>name</th><th>age</th><th>email</th></tr></thead><tbody><tr><td>1</td><td>Jone</td><td>18</td><td><a href="mailto:&#x74;&#101;&#115;&#x74;&#49;&#64;&#x62;&#97;&#111;&#109;&#105;&#x64;&#111;&#x75;&#x2e;&#99;&#111;&#109;">&#x74;&#101;&#115;&#x74;&#49;&#64;&#x62;&#97;&#111;&#109;&#105;&#x64;&#111;&#x75;&#x2e;&#99;&#111;&#109;</a></td></tr><tr><td>2</td><td>Jack</td><td>20</td><td><a href="mailto:&#116;&#101;&#x73;&#116;&#50;&#64;&#x62;&#x61;&#111;&#109;&#105;&#x64;&#111;&#x75;&#x2e;&#99;&#x6f;&#109;">&#116;&#101;&#x73;&#116;&#50;&#64;&#x62;&#x61;&#111;&#109;&#105;&#x64;&#111;&#x75;&#x2e;&#99;&#x6f;&#109;</a></td></tr><tr><td>3</td><td>Tom</td><td>28</td><td><a href="mailto:&#116;&#x65;&#x73;&#x74;&#51;&#64;&#x62;&#97;&#x6f;&#109;&#105;&#100;&#x6f;&#117;&#x2e;&#x63;&#111;&#109;">&#116;&#x65;&#x73;&#x74;&#51;&#64;&#x62;&#97;&#x6f;&#109;&#105;&#100;&#x6f;&#117;&#x2e;&#x63;&#111;&#109;</a></td></tr><tr><td>4</td><td>Sandy</td><td>21</td><td><a href="mailto:&#x74;&#101;&#x73;&#116;&#x34;&#64;&#x62;&#97;&#x6f;&#109;&#x69;&#100;&#x6f;&#117;&#46;&#x63;&#111;&#x6d;">&#x74;&#101;&#x73;&#116;&#x34;&#64;&#x62;&#97;&#x6f;&#109;&#x69;&#100;&#x6f;&#117;&#46;&#x63;&#111;&#x6d;</a></td></tr><tr><td>5</td><td>Billie</td><td>24</td><td><a href="mailto:&#x74;&#x65;&#x73;&#116;&#x35;&#x40;&#98;&#x61;&#111;&#x6d;&#x69;&#x64;&#111;&#117;&#46;&#x63;&#111;&#109;">&#x74;&#x65;&#x73;&#116;&#x35;&#x40;&#98;&#x61;&#111;&#x6d;&#x69;&#x64;&#111;&#117;&#46;&#x63;&#111;&#109;</a></td></tr></tbody></table><p>å…¶å¯¹åº”çš„æ•°æ®åº“ Schema è„šæœ¬å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">user</span><span class="token punctuation">;</span><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span><span class="token punctuation">(</span>    id <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ä¸»é”®ID'</span><span class="token punctuation">,</span>    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'å§“å'</span><span class="token punctuation">,</span>    age <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'å¹´é¾„'</span><span class="token punctuation">,</span>    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'é‚®ç®±'</span><span class="token punctuation">,</span>    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å¯¹åº”çš„æ•°æ®åº“ Data è„šæœ¬å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Jone'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'test1@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'test2@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">'test3@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Sandy'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">'test4@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'Billie'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'test5@baomidou.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3ã€åˆ›å»ºé¡¹ç›®"><a href="#3ã€åˆ›å»ºé¡¹ç›®" class="headerlink" title="3ã€åˆ›å»ºé¡¹ç›®"></a>3ã€åˆ›å»ºé¡¹ç›®</h2><h3 id="3-1ã€åˆ›å»ºmavené¡¹ç›®"><a href="#3-1ã€åˆ›å»ºmavené¡¹ç›®" class="headerlink" title="3.1ã€åˆ›å»ºmavené¡¹ç›®"></a>3.1ã€åˆ›å»ºmavené¡¹ç›®</h3><p><code>mybatis_plus_demo</code></p><p><code>GroupIdï¼šcom.stormling</code></p><p><a href="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927102444438.png" title="åˆ›å»ºMybatis-Plusé¡¹ç›®" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927102444438.png" alt="åˆ›å»ºMybatis-Plusé¡¹ç›®"></a> </p><h3 id="3-2ã€SpringBootç‰ˆæœ¬"><a href="#3-2ã€SpringBootç‰ˆæœ¬" class="headerlink" title="3.2ã€SpringBootç‰ˆæœ¬"></a>3.2ã€SpringBootç‰ˆæœ¬</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-3ã€æ·»åŠ ä¾èµ–"><a href="#3-3ã€æ·»åŠ ä¾èµ–" class="headerlink" title="3.3ã€æ·»åŠ ä¾èµ–"></a>3.3ã€æ·»åŠ ä¾èµ–</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">></span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">></span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--mybatis-plus--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--mysql--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>8.0.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--lombokç”¨æ¥ç®€åŒ–å®ä½“ç±»--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-4ã€Ideaä¸­å®‰è£…lombokæ’ä»¶"><a href="#3-4ã€Ideaä¸­å®‰è£…lombokæ’ä»¶" class="headerlink" title="3.4ã€Ideaä¸­å®‰è£…lombokæ’ä»¶"></a>3.4ã€Ideaä¸­å®‰è£…lombokæ’ä»¶</h3><p>ä½¿ç”¨çš„æ˜¯Idea 23.3.4ï¼Œä½¿ç”¨ lombok æ˜¯ä¸ºäº†ç®€åŒ–å®ä½“ç±»çš„ä»£ç ç¼–ç¨‹ï¼Œä¸äº†è§£çš„åŒå­¦å¯ä»¥å‡ºé—¨å·¦è½¬çœ‹ä¸‹<a href="https://projectlombok.org/features/">lombokç‰¹æ€§</a>ï¼Œåç»­ä¼šä¸“é—¨å†™ä¸€ç¯‡lombokç›¸å…³ä½¿ç”¨ï¼ˆæŒ–ä¸€ä¸ªå‘ï¼‰</p><p><a href="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927102655255.png" title="å®‰è£…lombokæ’ä»¶" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927102655255.png" alt="å®‰è£…lombokæ’ä»¶"></a></p><h2 id="4ã€ç¼–å†™ä»£ç "><a href="#4ã€ç¼–å†™ä»£ç " class="headerlink" title="4ã€ç¼–å†™ä»£ç "></a>4ã€ç¼–å†™ä»£ç </h2><h3 id="4-1ã€é…ç½®æ–‡ä»¶"><a href="#4-1ã€é…ç½®æ–‡ä»¶" class="headerlink" title="4.1ã€é…ç½®æ–‡ä»¶"></a>4.1ã€é…ç½®æ–‡ä»¶</h3><p> <code>application.properties</code> é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#mysqlæ•°æ®åº“è¿æ¥</span><span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span><span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/mybatis_plus?serverTimezone=GMT%2B8&amp;useSSL=false</span><span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span><span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span><span class="token comment">#mybatisæ—¥å¿—</span><span class="token key attr-name">mybatis-plus.configuration.log-impl</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.ibatis.logging.stdout.StdOutImpl</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2ã€å®ä½“ç±»"><a href="#4-2ã€å®ä½“ç±»" class="headerlink" title="4.2ã€å®ä½“ç±»"></a>4.2ã€å®ä½“ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>mp<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-3ã€mapper"><a href="#4-3ã€mapper" class="headerlink" title="4.3ã€mapper"></a>4.3ã€mapper</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>mp<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Mapper</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5ã€å¼€å§‹ä½¿ç”¨"><a href="#5ã€å¼€å§‹ä½¿ç”¨" class="headerlink" title="5ã€å¼€å§‹ä½¿ç”¨"></a>5ã€å¼€å§‹ä½¿ç”¨</h2><p>æ·»åŠ æµ‹è¯•ç±»ï¼Œè¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>mp</span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CRUDTests</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">UserMapper</span> userMapper<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSelectList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        userList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é€šè¿‡ä»¥ä¸Šå‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å®ç°äº† User è¡¨çš„ CRUD åŠŸèƒ½ï¼Œç”šè‡³è¿ XML æ–‡ä»¶éƒ½ä¸ç”¨ç¼–å†™ï¼</strong></p><h2 id="6ã€ä¸»é”®ç­–ç•¥"><a href="#6ã€ä¸»é”®ç­–ç•¥" class="headerlink" title="6ã€ä¸»é”®ç­–ç•¥"></a>6ã€ä¸»é”®ç­–ç•¥</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Stormling"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    user<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"501344802@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> result <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å½±å“çš„è¡Œæ•°</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//idè‡ªåŠ¨å›å¡«</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong>æ•°æ®åº“æ’å…¥idå€¼é»˜è®¤ä¸ºï¼šå…¨å±€å”¯ä¸€id</p><p><a href="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927110351744.png" title="æ–°å¢ä¸€æ¡æ•°æ®" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/image-20240927110351744.png" alt="æ–°å¢ä¸€æ¡æ•°æ®"></a> </p><h3 id="6-1ã€ASSIGN-ID-å…¨å±€å”¯ä¸€IDï¼ˆé»˜è®¤ï¼‰"><a href="#6-1ã€ASSIGN-ID-å…¨å±€å”¯ä¸€IDï¼ˆé»˜è®¤ï¼‰" class="headerlink" title="6.1ã€ASSIGN_ID å…¨å±€å”¯ä¸€IDï¼ˆé»˜è®¤ï¼‰"></a>6.1ã€<code>ASSIGN_ID</code> å…¨å±€å”¯ä¸€<code>ID</code>ï¼ˆé»˜è®¤ï¼‰</h3><blockquote><p>ä¸äº†è§£é›ªèŠ±ç®—æ³•çš„ç«¥é‹ï¼Œåç»­æ›´æ–°ä¸€ç¯‡æ‰‹å†™ä¸€ä¸ªé›ªèŠ±ç®—æ³•ï¼ˆ<strong>æŒ–å‘</strong>ï¼‰</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">ASSIGN_ID</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>é›ªèŠ±ç®—æ³•</strong>æ˜¯ç”± <code>Twitter</code> å…¬å¸ƒçš„åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆç®—æ³•ï¼Œå®ƒèƒ½å¤Ÿä¿è¯ä¸åŒè¿›ç¨‹ä¸»é”®çš„<strong>ä¸é‡å¤æ€§</strong>ï¼Œä»¥åŠç›¸åŒè¿›ç¨‹ä¸»é”®çš„<strong>æœ‰åºæ€§</strong>ã€‚</p><p><strong>å®ç°åŸç†</strong></p><p>åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå®ƒé¦–å…ˆæ˜¯é€šè¿‡<strong>æ—¶é—´ä½ä¿è¯ä¸é‡å¤</strong>ï¼Œå¦‚æœæ—¶é—´ç›¸åŒåˆ™æ˜¯é€šè¿‡<strong>åºåˆ—ä½ä¿è¯</strong>ã€‚ åŒæ—¶ç”±äºæ—¶é—´ä½æ˜¯<strong>å•è°ƒé€’å¢</strong>çš„ï¼Œä¸”å„ä¸ªæœåŠ¡å™¨å¦‚æœå¤§ä½“åšäº†æ—¶é—´åŒæ­¥ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ä¸»é”®åœ¨åˆ†å¸ƒå¼ç¯å¢ƒå¯ä»¥è®¤ä¸ºæ˜¯<strong>æ€»ä½“æœ‰åº</strong>çš„ï¼Œè¿™å°±ä¿è¯äº†å¯¹<strong>ç´¢å¼•å­—æ®µçš„æ’å…¥çš„é«˜æ•ˆæ€§</strong>ã€‚ ä¾‹å¦‚ <code>MySQL</code> çš„ <code>Innodb</code> å­˜å‚¨å¼•æ“çš„ä¸»é”®ã€‚</p><p>ä½¿ç”¨é›ªèŠ±ç®—æ³•ç”Ÿæˆçš„ä¸»é”®ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼åŒ…å« <code>4</code> éƒ¨åˆ†ï¼Œä»é«˜ä½åˆ°ä½ä½åˆ†è¡¨ä¸ºï¼š<code>1bit</code> <strong>ç¬¦å·ä½</strong>ã€<code>41bit</code> <strong>æ—¶é—´æˆ³ä½</strong>ã€<code>10bit</code> <strong>å·¥ä½œè¿›ç¨‹ä½</strong>ä»¥åŠ <code>12bit</code> <strong>åºåˆ—å·ä½</strong>ã€‚</p><ul><li>ç¬¦å·ä½ï¼ˆ<code>1bit</code>ï¼‰</li></ul><p>é¢„ç•™çš„ç¬¦å·ä½ï¼Œæ’ä¸ºé›¶ã€‚</p><ul><li>æ—¶é—´æˆ³ä½ï¼ˆ<code>41bit</code>ï¼‰</li></ul><p><code>41</code> ä½çš„æ—¶é—´æˆ³å¯ä»¥å®¹çº³çš„æ¯«ç§’æ•°æ˜¯ <code>2</code> çš„ <code>41</code> æ¬¡å¹‚ï¼Œä¸€å¹´æ‰€ä½¿ç”¨çš„æ¯«ç§’æ•°æ˜¯ï¼š<code>365 * 24 * 60 * 60 * 1000</code>ã€‚ é€šè¿‡è®¡ç®—å¯çŸ¥ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">365</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç»“æœçº¦ç­‰äº <code>69.73</code> å¹´ï¼Œç›¸ä¿¡èƒ½æ»¡è¶³ç»å¤§éƒ¨åˆ†ç³»ç»Ÿçš„è¦æ±‚ã€‚</p><ul><li>å·¥ä½œè¿›ç¨‹ä½ï¼ˆ<code>10bit</code>ï¼‰</li></ul><p>è¯¥æ ‡å¿—åœ¨ <code>Java</code> è¿›ç¨‹å†…æ˜¯å”¯ä¸€çš„ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼åº”ç”¨éƒ¨ç½²åº”ä¿è¯æ¯ä¸ªå·¥ä½œè¿›ç¨‹çš„ <code>id</code> æ˜¯ä¸åŒçš„ã€‚ è¯¥å€¼é»˜è®¤ä¸º 0ï¼Œå¯é€šè¿‡å±æ€§è®¾ç½®ã€‚å¯ä»¥æ”¯æŒ <code>1024</code>(2 çš„ 10 æ¬¡å¹‚)ä¸ªå·¥ä½œè¿›ç¨‹</p><ul><li>åºåˆ—å·ä½ï¼ˆ<code>12bit</code>ï¼‰</li></ul><p>è¯¥åºåˆ—æ˜¯ç”¨æ¥åœ¨åŒä¸€ä¸ªæ¯«ç§’å†…ç”Ÿæˆä¸åŒçš„ <code>ID</code>ã€‚å¦‚æœåœ¨è¿™ä¸ªæ¯«ç§’å†…ç”Ÿæˆçš„æ•°é‡è¶…è¿‡ <code>4096</code> (2 çš„ 12 æ¬¡å¹‚)ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨ä¼šç­‰å¾…åˆ°ä¸‹ä¸ªæ¯«ç§’ç»§ç»­ç”Ÿæˆã€‚</p><p>é›ªèŠ±ç®—æ³•ä¸»é”®çš„è¯¦ç»†ç»“æ„è§ä¸‹å›¾ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/202409240943887.png" title="é›ªèŠ±ç®—æ³•" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/lingzhexi/blogImage/post/202409240943887.png" alt="é›ªèŠ±ç®—æ³•"></a></p><h3 id="6-2ã€ASSIGN-UUID"><a href="#6-2ã€ASSIGN-UUID" class="headerlink" title="6.2ã€ASSIGN_UUID"></a>6.2ã€<code>ASSIGN_UUID</code></h3><ul><li>ç”Ÿæˆå”¯ä¸€çš„å€¼ï¼ŒåŒ…å«æ•°å­—å’Œå­—æ¯ï¼Œè¡¨å¯¹åº”å­—æ®µç±»å‹<code>varchar</code>ç±»å‹</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span><span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="6-3ã€AUTO-è‡ªå¢ç­–ç•¥"><a href="#6-3ã€AUTO-è‡ªå¢ç­–ç•¥" class="headerlink" title="6.3ã€AUTO è‡ªå¢ç­–ç•¥"></a>6.3ã€<code>AUTO</code> è‡ªå¢ç­–ç•¥</h3><ul><li><p>è¦æƒ³ä¸»é”®è‡ªå¢éœ€è¦é…ç½®å¦‚ä¸‹ä¸»é”®ç­–ç•¥</p><ul><li><p>éœ€è¦åœ¨åˆ›å»ºæ•°æ®è¡¨çš„æ—¶å€™è®¾ç½®ä¸»é”®è‡ªå¢</p></li><li><p>å®ä½“å­—æ®µä¸­é…ç½® <code>@TableId(type = IdType.AUTO)</code></p></li></ul></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span><span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="6-4ã€INPUT-æ‰‹åŠ¨è®¾ç½®"><a href="#6-4ã€INPUT-æ‰‹åŠ¨è®¾ç½®" class="headerlink" title="6.4ã€INPUT æ‰‹åŠ¨è®¾ç½®"></a>6.4ã€<code>INPUT</code> æ‰‹åŠ¨è®¾ç½®</h3><ul><li>éœ€è¦æ‰‹åŠ¨è®¾ç½®<code>id</code>å€¼</li></ul><h2 id="7ã€åˆ†é¡µæ’ä»¶"><a href="#7ã€åˆ†é¡µæ’ä»¶" class="headerlink" title="7ã€åˆ†é¡µæ’ä»¶"></a>7ã€åˆ†é¡µæ’ä»¶</h2><blockquote><p>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://baomidou.com/plugins/pagination/">åˆ†é¡µæ’ä»¶</a></p></blockquote><p><code>MyBatis Plus</code>è‡ªå¸¦åˆ†é¡µæ’ä»¶ï¼Œåªè¦ç®€å•çš„é…ç½®å³å¯å®ç°åˆ†é¡µåŠŸèƒ½</p><h3 id="7-1ã€é…ç½®åˆ†é¡µæ’ä»¶"><a href="#7-1ã€é…ç½®åˆ†é¡µæ’ä»¶" class="headerlink" title="7.1ã€é…ç½®åˆ†é¡µæ’ä»¶"></a>7.1ã€é…ç½®åˆ†é¡µæ’ä»¶</h3><p>åˆ›å»º<code>MybatisPlusConfig</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stormling<span class="token punctuation">.</span>mp<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisPlusConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * åˆ†é¡µæ’ä»¶     */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">MybatisPlusInterceptor</span> <span class="token function">optimisticLockerInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">MybatisPlusInterceptor</span> interceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MybatisPlusInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å‘Mybatisè¿‡æ»¤å™¨é“¾ä¸­æ·»åŠ åˆ†é¡µæ‹¦æˆªå™¨</span>        interceptor<span class="token punctuation">.</span><span class="token function">addInnerInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PaginationInnerInterceptor</span><span class="token punctuation">(</span><span class="token class-name">DbType</span><span class="token punctuation">.</span><span class="token constant">MYSQL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> interceptor<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å±æ€§ä»‹ç»</p><p><code>PaginationInnerInterceptor</code> æä¾›äº†ä»¥ä¸‹å±æ€§æ¥å®šåˆ¶åˆ†é¡µè¡Œä¸ºï¼š</p><table><thead><tr><th align="center">å±æ€§å</th><th align="center">ç±»å‹</th><th align="center">é»˜è®¤å€¼</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">overflow</td><td align="center">boolean</td><td align="center">false</td><td align="center">æº¢å‡ºæ€»é¡µæ•°åæ˜¯å¦è¿›è¡Œå¤„ç†</td></tr><tr><td align="center">maxLimit</td><td align="center">Long</td><td align="center"></td><td align="center">å•é¡µåˆ†é¡µæ¡æ•°é™åˆ¶</td></tr><tr><td align="center">dbType</td><td align="center">DbType</td><td align="center"></td><td align="center">æ•°æ®åº“ç±»å‹</td></tr><tr><td align="center">dialect</td><td align="center">IDialect</td><td align="center"></td><td align="center">æ–¹è¨€å®ç°ç±»</td></tr></tbody></table><blockquote><p>å»ºè®®å•ä¸€æ•°æ®åº“ç±»å‹çš„å‡è®¾ç½® dbType</p></blockquote><p> <code>Page</code> ç±»</p><p><code>Page</code> ç±»ç»§æ‰¿äº† <code>IPage</code> ç±»ï¼Œå®ç°äº†ç®€å•åˆ†é¡µæ¨¡å‹ã€‚å¦‚æœä½ éœ€è¦å®ç°è‡ªå·±çš„åˆ†é¡µæ¨¡å‹ï¼Œå¯ä»¥ç»§æ‰¿ <code>Page</code> ç±»æˆ–å®ç° <code>IPage</code> ç±»ã€‚</p><table><thead><tr><th align="center">å±æ€§å</th><th align="center">ç±»å‹</th><th align="center">é»˜è®¤å€¼</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">records</td><td align="center">List<T></td><td align="center">emptyList</td><td align="center">æŸ¥è¯¢æ•°æ®åˆ—è¡¨</td></tr><tr><td align="center">total</td><td align="center">Long</td><td align="center">0</td><td align="center">æŸ¥è¯¢åˆ—è¡¨æ€»è®°å½•æ•°</td></tr><tr><td align="center">size</td><td align="center">Long</td><td align="center">10</td><td align="center">æ¯é¡µæ˜¾ç¤ºæ¡æ•°ï¼Œé»˜è®¤ 10</td></tr><tr><td align="center">current</td><td align="center">Long</td><td align="center">1</td><td align="center">å½“å‰é¡µ</td></tr><tr><td align="center">orders</td><td align="center">List<OrderItem></td><td align="center">emptyList</td><td align="center">æ’åºå­—æ®µä¿¡æ¯</td></tr><tr><td align="center">optimizeCountSql</td><td align="center">boolean</td><td align="center">true</td><td align="center">è‡ªåŠ¨ä¼˜åŒ– COUNT SQL</td></tr><tr><td align="center">optimizeJoinOfCountSql</td><td align="center">boolean</td><td align="center">true</td><td align="center">è‡ªåŠ¨ä¼˜åŒ– COUNT SQL æ˜¯å¦æŠŠ join æŸ¥è¯¢éƒ¨åˆ†ç§»é™¤</td></tr><tr><td align="center">searchCount</td><td align="center">boolean</td><td align="center">true</td><td align="center">æ˜¯å¦è¿›è¡Œ count æŸ¥è¯¢</td></tr><tr><td align="center">maxLimit</td><td align="center">Long</td><td align="center"></td><td align="center">å•é¡µåˆ†é¡µæ¡æ•°é™åˆ¶</td></tr><tr><td align="center">countId</td><td align="center">String</td><td align="center"></td><td align="center">XML è‡ªå®šä¹‰ count æŸ¥è¯¢çš„ statementId</td></tr></tbody></table><p>é€šè¿‡è¿™äº›é…ç½®å’Œä½¿ç”¨æ–¹æ³•ï¼Œä½ å¯ä»¥è½»æ¾åœ°åœ¨ MyBatis-Plus ä¸­å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œæé«˜åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h3 id="7-2ã€æµ‹è¯•selectPageåˆ†é¡µ"><a href="#7-2ã€æµ‹è¯•selectPageåˆ†é¡µ" class="headerlink" title="7.2ã€æµ‹è¯•selectPageåˆ†é¡µ"></a>7.2ã€æµ‹è¯•selectPageåˆ†é¡µ</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSelectPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> page <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    userMapper<span class="token punctuation">.</span><span class="token function">selectPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    page<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰é¡µ</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æŸ¥è¯¢åˆ—è¡¨åˆ†é¡µæ•°</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æŸ¥è¯¢åˆ—è¡¨æ€»è®°å½•æ•°</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">hasPrevious</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ˜¯å¦æœ‰ä¸Šä¸€é¡µ</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> è¾“å‡ºç»“æœ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&#x3D;&#x3D;&gt;  Preparing: SELECT COUNT(*) AS total FROM user&#x3D;&#x3D;&gt; Parameters: &lt;&#x3D;&#x3D;    Columns: total&lt;&#x3D;&#x3D;        Row: 6&lt;&#x3D;&#x3D;      Total: 1&#x3D;&#x3D;&gt;  Preparing: SELECT id,name,age,email FROM user LIMIT ?&#x3D;&#x3D;&gt; Parameters: 5(Long)&lt;&#x3D;&#x3D;    Columns: id, name, age, email&lt;&#x3D;&#x3D;        Row: 1, Jone, 18, test1@baomidou.com&lt;&#x3D;&#x3D;        Row: 2, Jack, 20, test2@baomidou.com&lt;&#x3D;&#x3D;        Row: 3, Tom, 28, test3@baomidou.com&lt;&#x3D;&#x3D;        Row: 4, Sandy, 21, test4@baomidou.com&lt;&#x3D;&#x3D;        Row: 5, Billie, 24, test5@baomidou.com&lt;&#x3D;&#x3D;      Total: 5Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9e30f9a]User(id&#x3D;1, name&#x3D;Jone, age&#x3D;18, email&#x3D;test1@baomidou.com)User(id&#x3D;2, name&#x3D;Jack, age&#x3D;20, email&#x3D;test2@baomidou.com)User(id&#x3D;3, name&#x3D;Tom, age&#x3D;28, email&#x3D;test3@baomidou.com)User(id&#x3D;4, name&#x3D;Sandy, age&#x3D;21, email&#x3D;test4@baomidou.com)User(id&#x3D;5, name&#x3D;Billie, age&#x3D;24, email&#x3D;test5@baomidou.com)1256truefalse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8ã€é€»è¾‘åˆ é™¤"><a href="#8ã€é€»è¾‘åˆ é™¤" class="headerlink" title="8ã€é€»è¾‘åˆ é™¤"></a>8ã€é€»è¾‘åˆ é™¤</h2><ul><li>ç‰©ç†åˆ é™¤ï¼šçœŸå®åˆ é™¤ï¼Œå°†å¯¹åº”æ•°æ®ä»æ•°æ®åº“ä¸­åˆ é™¤ï¼Œä¹‹åæŸ¥è¯¢ä¸åˆ°æ­¤æ¡è¢«åˆ é™¤æ•°æ®</li><li>é€»è¾‘åˆ é™¤ï¼šå‡åˆ é™¤ï¼Œå°†å¯¹åº”æ•°æ®ä¸­ä»£è¡¨æ˜¯å¦è¢«åˆ é™¤çš„å­—æ®µçŠ¶æ€ä¿®æ”¹ä¸ºâ€œ<code>è¢«åˆ é™¤çŠ¶æ€</code>â€ï¼Œä¹‹ååœ¨æ•°æ®åº“ä¸­ä»æ—§èƒ½çœ‹åˆ°æ­¤æ¡æ•°æ®è®°å½•</li></ul><h3 id="8-1ã€æ•°æ®åº“ä¸­æ·»åŠ -deletedå­—æ®µ"><a href="#8-1ã€æ•°æ®åº“ä¸­æ·»åŠ -deletedå­—æ®µ" class="headerlink" title="8.1ã€æ•°æ®åº“ä¸­æ·»åŠ  deletedå­—æ®µ"></a>8.1ã€æ•°æ®åº“ä¸­æ·»åŠ  deletedå­—æ®µ</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> <span class="token identifier"><span class="token punctuation">`</span>deleted<span class="token punctuation">`</span></span> <span class="token keyword">BOOLEAN</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span> <span class="token keyword">COMMENT</span> <span class="token string">'é€»è¾‘åˆ é™¤å­—æ®µ'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="8-2ã€å®ä½“ç±»æ·»åŠ deleted-å­—æ®µ"><a href="#8-2ã€å®ä½“ç±»æ·»åŠ deleted-å­—æ®µ" class="headerlink" title="8.2ã€å®ä½“ç±»æ·»åŠ deleted å­—æ®µ"></a>8.2ã€å®ä½“ç±»æ·»åŠ deleted å­—æ®µ</h2><p>å¹¶åŠ ä¸Š <code>@TableLogic</code> æ³¨è§£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@TableLogic</span><span class="token keyword">private</span> <span class="token class-name">Integer</span> deleted<span class="token punctuation">;</span><span class="token comment">//private Boolean deleted;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="8-3ã€application-properties-é…ç½®"><a href="#8-3ã€application-properties-é…ç½®" class="headerlink" title="8.3ã€application.properties é…ç½®"></a>8.3ã€application.properties é…ç½®</h3><p>æ­¤ä¸ºé»˜è®¤å€¼ï¼Œå¦‚æœä½ çš„é»˜è®¤å€¼å’Œmpé»˜è®¤çš„ä¸€æ ·ï¼Œåˆ™ä¸éœ€è¦è¯¥é…ç½®</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#é»˜è®¤é…ç½®</span><span class="token key attr-name">mybatis-plus.global-config.db-config.logic-delete-value</span><span class="token punctuation">=</span><span class="token value attr-value">1</span><span class="token key attr-name">mybatis-plus.global-config.db-config.logic-not-delete-value</span><span class="token punctuation">=</span><span class="token value attr-value">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä½¿ç”¨äº†@TableLogicæ³¨è§£ï¼Œåˆ™ä¸éœ€è¦è¯¥é…ç½®</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">mybatis-plus.global-config.db-config.logic-delete-field</span><span class="token punctuation">=</span><span class="token value attr-value">deleted</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="8-4ã€æµ‹è¯•é€»è¾‘åˆ é™¤"><a href="#8-4ã€æµ‹è¯•é€»è¾‘åˆ é™¤" class="headerlink" title="8.4ã€æµ‹è¯•é€»è¾‘åˆ é™¤"></a>8.4ã€æµ‹è¯•é€»è¾‘åˆ é™¤</h3><ul><li>æµ‹è¯•åå‘ç°ï¼Œæ•°æ®å¹¶æ²¡æœ‰è¢«åˆ é™¤ï¼Œdeletedå­—æ®µçš„å€¼ç”±0å˜æˆäº†1</li><li>æµ‹è¯•ååˆ†ææ‰“å°çš„sqlè¯­å¥ï¼Œæ˜¯ä¸€æ¡update</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * æµ‹è¯• é€»è¾‘åˆ é™¤ */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLogicDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> result <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&#x3D;&#x3D;&gt;  Preparing: UPDATE user SET deleted&#x3D;1 WHERE id&#x3D;? AND deleted&#x3D;0&#x3D;&#x3D;&gt;  Parameters: 1(Long)&lt;&#x3D;&#x3D;    Updates: 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="8-5ã€æµ‹è¯•é€»è¾‘åˆ é™¤åçš„æŸ¥è¯¢"><a href="#8-5ã€æµ‹è¯•é€»è¾‘åˆ é™¤åçš„æŸ¥è¯¢" class="headerlink" title="8.5ã€æµ‹è¯•é€»è¾‘åˆ é™¤åçš„æŸ¥è¯¢"></a>8.5ã€æµ‹è¯•é€»è¾‘åˆ é™¤åçš„æŸ¥è¯¢</h3><p>MyBatis Plusä¸­æŸ¥è¯¢æ“ä½œä¹Ÿä¼šè‡ªåŠ¨æ·»åŠ é€»è¾‘åˆ é™¤å­—æ®µçš„åˆ¤æ–­<code>ï¼ˆdeleted = 0ï¼‰</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * æµ‹è¯• æŸ¥è¯¢æ“ä½œ */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> users <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&#x3D;&#x3D;&gt;  Preparing: SELECT id,name,age,email,deleted FROM user WHERE deleted&#x3D;0&#x3D;&#x3D;&gt;  Parameters: &lt;&#x3D;&#x3D;    Columns: id, name, age, email, deleted&lt;&#x3D;&#x3D;        Row: 2, Jack, 20, test2@baomidou.com, 0&lt;&#x3D;&#x3D;        Row: 3, Tom, 28, test3@baomidou.com, 0&lt;&#x3D;&#x3D;        Row: 4, Sandy, 21, test4@baomidou.com, 0&lt;&#x3D;&#x3D;        Row: 5, Billie, 24, test5@baomidou.com, 0&lt;&#x3D;&#x3D;        Row: 1839500916857540609, Stormling, 28, 501344802@qq.com, 0&lt;&#x3D;&#x3D;        Row: 1844981342959046657, Stormling, 28, 501344802@qq.com, 0&lt;&#x3D;&#x3D;      Total: 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Mybatis Plus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> Mybatis Plus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼ç³»åˆ—ï¼ˆäºŒï¼‰ | Redissonåˆ†å¸ƒå¼é”</title>
      <link href="/posts/50356.html"/>
      <url>/posts/50356.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="åˆ†å¸ƒå¼é”"><a href="#åˆ†å¸ƒå¼é”" class="headerlink" title="åˆ†å¸ƒå¼é”"></a>åˆ†å¸ƒå¼é”</h1><h2 id="1ã€æ¦‚è¿°"><a href="#1ã€æ¦‚è¿°" class="headerlink" title="1ã€æ¦‚è¿°"></a>1ã€æ¦‚è¿°</h2><ul><li><strong>Redisson <strong>æ˜¯ä¸€ä¸ªåœ¨Redisçš„åŸºç¡€ä¸Šå®ç°çš„<code>Java</code>é©»å†…å­˜æ•°æ®ç½‘æ ¼</strong>ï¼ˆIn-Memory Data Gridï¼‰</strong>ã€‚å®ƒä¸ä»…æä¾›äº†ä¸€ç³»åˆ—çš„åˆ†å¸ƒå¼çš„<strong>Java</strong>å¸¸ç”¨å¯¹è±¡ï¼Œè¿˜æä¾›äº†è®¸å¤šåˆ†å¸ƒå¼æœåŠ¡ã€‚</li><li><strong>Redisson</strong> çš„å®—æ—¨æ˜¯ï¼šä¿ƒè¿›ä½¿ç”¨è€…å¯¹<code>Redis</code>çš„å…³æ³¨åˆ†ç¦»<strong>ï¼ˆSeparation of Concernï¼‰</strong>ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</li></ul><h2 id="2ã€å››ä¸ªæ¡ä»¶"><a href="#2ã€å››ä¸ªæ¡ä»¶" class="headerlink" title="2ã€å››ä¸ªæ¡ä»¶"></a>2ã€å››ä¸ªæ¡ä»¶</h2><p>ä¸ºäº†ç¡®ä¿åˆ†å¸ƒå¼é”å¯ç”¨ï¼Œæˆ‘ä»¬è‡³å°‘è¦ç¡®ä¿é”çš„å®ç°åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªï¼šäº’æ–¥æ€§ï¼Œåœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æŒæœ‰é”ã€‚</li><li>ç¬¬äºŒä¸ªï¼šä¸ä¼šå‘ç”Ÿæ­»é”ï¼Œå³ä½¿æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯åœ¨è·å–é”æ“ä½œæ—¶å€™å´©æºƒäº†ï¼Œä¹Ÿèƒ½ä¿è¯å…¶ä»–å®¢æˆ·ç«¯èƒ½è·å–åˆ°é”ã€‚</li><li>ç¬¬ä¸‰ä¸ªï¼šè§£é“ƒè¿˜é¡»ç³»é“ƒäººï¼Œè§£é”åŠ é”å¿…é¡»åŒä¸€ä¸ªå®¢æˆ·ç«¯æ“ä½œã€‚</li><li>ç¬¬å››ä¸ªï¼šåŠ é”å’Œè§£é”å¿…é¡»å…·å¤‡<strong>åŸå­æ€§</strong></li></ul><h2 id="3ã€å¼•å…¥ä¾èµ–"><a href="#3ã€å¼•å…¥ä¾èµ–" class="headerlink" title="3ã€å¼•å…¥ä¾èµ–"></a>3ã€å¼•å…¥ä¾èµ–</h2><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4ã€é…ç½®ç±»åˆ«"><a href="#4ã€é…ç½®ç±»åˆ«" class="headerlink" title="4ã€é…ç½®ç±»åˆ«"></a>4ã€é…ç½®ç±»åˆ«</h2><h5 id="åˆ›å»ºRedissonConfig-é…ç½®ç±»"><a href="#åˆ›å»ºRedissonConfig-é…ç½®ç±»" class="headerlink" title="åˆ›å»ºRedissonConfig é…ç½®ç±»"></a>åˆ›å»º<code>RedissonConfig</code> é…ç½®ç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.data.redis"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedissonConfig</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> host<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> port<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> timeout <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ADDRESS_PREFIX</span> <span class="token operator">=</span> <span class="token string">"redis://"</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è‡ªåŠ¨è£…é…     *     */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token class-name">RedissonClient</span> <span class="token function">redissonSingle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"host is  empty"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">SingleServerConfig</span> serverConfig <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token constant">ADDRESS_PREFIX</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>host <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> port<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            serverConfig<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é…ç½® application.yml</strong></p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>    <span class="token key atrule">data</span><span class="token punctuation">:</span>        <span class="token key atrule">redis</span><span class="token punctuation">:</span>          <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.2.5          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>          <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>          <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">1800000</span>          <span class="token key atrule">password</span><span class="token punctuation">:</span>          <span class="token key atrule">jedis</span><span class="token punctuation">:</span>            <span class="token key atrule">pool</span><span class="token punctuation">:</span>              <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">20</span> <span class="token comment">#æœ€å¤§è¿æ¥æ•°</span>              <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">-1</span>    <span class="token comment">#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)</span>              <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">5</span>    <span class="token comment">#æœ€å¤§ç©ºé—²</span>              <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">0</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5ã€ä»£ç å®ç°"><a href="#5ã€ä»£ç å®ç°" class="headerlink" title="5ã€ä»£ç å®ç°"></a>5ã€ä»£ç å®ç°</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLockRedisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token comment">// 1.è·å–é” å¯é‡å…¥é”</span>       <span class="token class-name">RLock</span> lock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"lock1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 2.åŠ é”</span>       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           <span class="token comment">// é˜»å¡ é»˜è®¤è¿‡æœŸ30s  çœ‹é—¨ç‹—ï¼šè‡ªåŠ¨ç»­æœŸ</span>           lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// è®¾ç½®è¿‡æœŸ 10s</span>           <span class="token comment">//lock.lock(10, TimeUnit.SECONDS);</span>           <span class="token comment">// ç­‰å¾…æ—¶é—´ ã€ è®¾ç½®è¿‡æœŸæ—¶é—´</span>           <span class="token comment">// lock.tryLock(30, 10, TimeUnit.SECONDS);</span>           <span class="token comment">// 3.ä¸šåŠ¡ä»£ç </span>           <span class="token class-name">String</span> value <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>           redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>           <span class="token comment">//4.é‡Šæ”¾é”</span>           lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6ã€Redisson-çœ‹é—¨ç‹—"><a href="#6ã€Redisson-çœ‹é—¨ç‹—" class="headerlink" title="6ã€Redisson çœ‹é—¨ç‹—"></a>6ã€Redisson çœ‹é—¨ç‹—</h2><pre><code>åŸºäº**`Redis`**çš„**`Redisson`**åˆ†å¸ƒå¼å¯é‡å…¥é”**`RLock` `Java`**å¯¹è±¡å®ç°äº†**`java.util.concurrent.locks.Lock`**æ¥å£ã€‚å¦‚æœè´Ÿè´£å‚¨å­˜è¿™ä¸ªåˆ†å¸ƒå¼é”çš„**`Redisson`**èŠ‚ç‚¹å®•æœºä»¥åï¼Œè€Œä¸”è¿™ä¸ªé”æ­£å¥½å¤„äºé”ä½çš„çŠ¶æ€æ—¶ï¼Œè¿™ä¸ªé”ä¼šå‡ºç°**é”æ­»**çš„çŠ¶æ€ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œ**`Redisson`**å†…éƒ¨æä¾›äº†ä¸€ä¸ª**ç›‘æ§é”çš„çœ‹é—¨ç‹—**ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨**`Redisson`**å®ä¾‹è¢«å…³é—­å‰ï¼Œä¸æ–­çš„å»¶é•¿é”çš„æœ‰æ•ˆæœŸã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œçœ‹é—¨ç‹—çš„æ£€æŸ¥é”çš„è¶…æ—¶æ—¶é—´æ˜¯30ç§’é’Ÿï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹**`Config.lockWatchdogTimeoutæ¥`**å¦è¡ŒæŒ‡å®šã€‚</code></pre><p>å¦å¤–**<code>Redisson</code><strong>è¿˜é€šè¿‡åŠ é”çš„æ–¹æ³•æä¾›äº†</strong><code>leaseTime</code>**çš„å‚æ•°æ¥æŒ‡å®šåŠ é”çš„æ—¶é—´ã€‚è¶…è¿‡è¿™ä¸ªæ—¶é—´åé”ä¾¿è‡ªåŠ¨è§£å¼€äº†ã€‚</p><p>çœ‹é—¨ç‹—åŸç†ï¼š</p><pre><code>åªè¦çº¿ç¨‹ä¸€åŠ é”æˆåŠŸï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ª**`watch dog`**çœ‹é—¨ç‹—ï¼Œå®ƒæ˜¯ä¸€ä¸ª**åå°çº¿ç¨‹**ï¼Œä¼šæ¯éš”**10ç§’æ£€æŸ¥**ä¸€ä¸‹ï¼Œå¦‚æœçº¿ç¨‹è¿˜æŒæœ‰é”ï¼Œé‚£ä¹ˆå°±ä¼š**ä¸æ–­çš„å»¶é•¿é”key**çš„ç”Ÿå­˜æ—¶é—´ã€‚å› æ­¤ï¼Œ**`Redisson`**å°±æ˜¯ä½¿ç”¨**`watch dog`**è§£å†³äº†`é”è¿‡æœŸé‡Šæ”¾ï¼Œä¸šåŠ¡æ²¡æ‰§è¡Œå®Œé—®é¢˜`ã€‚</code></pre><ul><li>å¦‚æœæˆ‘ä»¬æŒ‡å®šäº†é”çš„è¶…æ—¶æ—¶é—´ï¼Œå°±å‘é€ç»™**<code>Redis</code>**æ‰§è¡Œè„šæœ¬ï¼Œè¿›è¡Œå é”ï¼Œé»˜è®¤è¶…æ—¶å°±æ˜¯æˆ‘ä»¬åˆ¶å®šçš„æ—¶é—´ï¼Œä¸ä¼šè‡ªåŠ¨ç»­æœŸï¼›</li><li>å¦‚æœæˆ‘ä»¬æœªæŒ‡å®šé”çš„è¶…æ—¶æ—¶é—´ï¼Œå°±ä½¿ç”¨ <code>lockwatchdogTimeout= 30 * 1000</code>ã€çœ‹é—¨ç‹—é»˜è®¤æ—¶é—´ã€‘</li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Redisson </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
            <tag> Redisson </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼ç³»åˆ—ï¼ˆä¸€ï¼‰ | Redisåˆ†å¸ƒå¼é”</title>
      <link href="/posts/28724.html"/>
      <url>/posts/28724.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="Rediså®ç°åˆ†å¸ƒå¼é”"><a href="#Rediså®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="Rediså®ç°åˆ†å¸ƒå¼é”"></a>Rediså®ç°åˆ†å¸ƒå¼é”</h2><blockquote><p>ä¹å°šä»£é©¾å­¦ä¹ ç¬”è®°-Rediså¸æœºæŠ¢å•åˆ†å¸ƒå¼é”</p></blockquote><h3 id="1ã€setnx-è¿‡æœŸæ—¶é—´å®ç°"><a href="#1ã€setnx-è¿‡æœŸæ—¶é—´å®ç°" class="headerlink" title="1ã€setnx+è¿‡æœŸæ—¶é—´å®ç°"></a>1ã€setnx+è¿‡æœŸæ—¶é—´å®ç°</h3><p><a href="https://i-blog.csdnimg.cn/direct/d407440f16f144bcbe2b36c69c1d372f.png#pic_center" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" class="gallery-item"><img src="https://i-blog.csdnimg.cn/direct/d407440f16f144bcbe2b36c69c1d372f.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></a></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//ä»redisé‡Œé¢è·å–æ•°æ®</span>   <span class="token comment">//1 è·å–å½“å‰é”  setnx</span>    <span class="token class-name">Boolean</span> ifAbsent <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">,</span> <span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//2 å¦‚æœè·å–åˆ°é”ï¼Œä»redisè·å–æ•°æ® æ•°æ®+1 æ”¾å›redisé‡Œé¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>ifAbsent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//è·å–é”æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡ä»£ç </span>        <span class="token comment">//1.å…ˆä»redisä¸­é€šè¿‡key numè·å–å€¼  keyæå‰æ‰‹åŠ¨è®¾ç½® num åˆå§‹å€¼ï¼š0</span>        <span class="token class-name">String</span> value <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//2.å¦‚æœå€¼ä¸ºç©ºåˆ™éæ³•ç›´æ¥è¿”å›å³å¯</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//3.å¯¹numå€¼è¿›è¡Œè‡ªå¢åŠ ä¸€</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//3 é‡Šæ”¾é”</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-1ã€é—®é¢˜ï¼š"><a href="#1-1ã€é—®é¢˜ï¼š" class="headerlink" title="1.1ã€é—®é¢˜ï¼š"></a>1.1ã€<strong>é—®é¢˜ï¼š</strong></h4><ul><li>å¦‚æœä¸šåŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¿ƒå‡ºç°å¼‚å¸¸ï¼Œå¯¼è‡´é”æ— æ³•é‡Šæ”¾</li></ul><h4 id="1-2ã€è§£å†³æ–¹æ¡ˆï¼š"><a href="#1-2ã€è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="1.2ã€è§£å†³æ–¹æ¡ˆï¼š"></a>1.2ã€<strong>è§£å†³æ–¹æ¡ˆï¼š</strong></h4><ul><li>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ°æ—¶é—´ä¹‹åè‡ªåŠ¨é‡Šæ”¾é”</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//1 è·å–å½“å‰é”  setnx  + è®¾ç½®è¿‡æœŸæ—¶é—´</span><span class="token comment">//        Boolean ifAbsent = redisTemplate.opsForValue().setIfAbsent("lock", "lock");</span> <span class="token class-name">Boolean</span> ifAbsent <span class="token operator">=</span>          redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">,</span> <span class="token string">"lock"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€UUIDé˜²æ­¢è¯¯åˆ "><a href="#2ã€UUIDé˜²æ­¢è¯¯åˆ " class="headerlink" title="2ã€UUIDé˜²æ­¢è¯¯åˆ "></a>2ã€UUIDé˜²æ­¢è¯¯åˆ </h3><ul><li>ä½¿ç”¨setnx+è¿‡æœŸæ—¶é—´å®ç°åˆ†å¸ƒå¼é”ï¼Œå­˜åœ¨é—®é¢˜ï¼šåˆ é™¤ä¸æ˜¯è‡ªå·±çš„é”ï¼Œé”è¯¯åˆ </li></ul><p><strong>åœºæ™¯ï¼šå¦‚æœä¸šåŠ¡é€»è¾‘çš„æ‰§è¡Œæ—¶é—´æ˜¯7sã€‚æ‰§è¡Œæµç¨‹å¦‚ä¸‹</strong></p><ol><li><p>index1ä¸šåŠ¡é€»è¾‘æ²¡æ‰§è¡Œå®Œï¼Œ3ç§’åé”è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚</p></li><li><p>index2è·å–åˆ°é”ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œ3ç§’åé”è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚</p></li><li><p>index3è·å–åˆ°é”ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘</p><p>index1ä¸šåŠ¡é€»è¾‘æ‰§è¡Œå®Œæˆï¼Œå¼€å§‹è°ƒç”¨delé‡Šæ”¾é”ï¼Œè¿™æ—¶é‡Šæ”¾çš„æ˜¯index3çš„é”ï¼Œ å¯¼è‡´index3çš„ä¸šåŠ¡åªæ‰§è¡Œ1så°±è¢«åˆ«äººé‡Šæ”¾ã€‚</p></li></ol><p>æœ€ç»ˆç­‰äºæ²¡é”çš„æƒ…å†µ</p><p><a href="https://s2.loli.net/2024/12/22/Fv4hzfNTaPAudRK.png" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" class="gallery-item"><img src="https://s2.loli.net/2024/12/22/Fv4hzfNTaPAudRK.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></a></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//uuidé˜²æ­¢è¯¯åˆ </span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//ä»redisé‡Œé¢è·å–æ•°æ®</span>    <span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//1 è·å–å½“å‰é”  setnx  + è®¾ç½®è¿‡æœŸæ—¶é—´</span>    <span class="token comment">//        Boolean ifAbsent = redisTemplate.opsForValue().setIfAbsent("lock", "lock");</span>    <span class="token class-name">Boolean</span> ifAbsent <span class="token operator">=</span>            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">,</span> uuid<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//2 å¦‚æœè·å–åˆ°é”ï¼Œä»redisè·å–æ•°æ® æ•°æ®+1 æ”¾å›redisé‡Œé¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>ifAbsent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//è·å–é”æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡ä»£ç </span>        <span class="token comment">//1.å…ˆä»redisä¸­é€šè¿‡key numè·å–å€¼  keyæå‰æ‰‹åŠ¨è®¾ç½® num åˆå§‹å€¼ï¼š0</span>        <span class="token class-name">String</span> value <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//2.å¦‚æœå€¼ä¸ºç©ºåˆ™éæ³•ç›´æ¥è¿”å›å³å¯</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//3.å¯¹numå€¼è¿›è¡Œè‡ªå¢åŠ ä¸€</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å‡ºç°å¼‚å¸¸</span>        <span class="token comment">//3 é‡Šæ”¾é”</span>        <span class="token class-name">String</span> redisUuid <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>redisUuid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3ã€LUAè„šæœ¬ä¿è¯åŸå­æ€§"><a href="#3ã€LUAè„šæœ¬ä¿è¯åŸå­æ€§" class="headerlink" title="3ã€LUAè„šæœ¬ä¿è¯åŸå­æ€§"></a>3ã€LUAè„šæœ¬ä¿è¯åŸå­æ€§</h3><ul><li><strong>é€šè¿‡uuidé˜²æ­¢è¯¯åˆ ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨é—®é¢˜ï¼Œä¸å…·å¤‡åŸå­æ€§çš„</strong><br><a href="https://s2.loli.net/2024/12/22/NxteOgsJ5dfzDWm.png" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" class="gallery-item"><img src="https://s2.loli.net/2024/12/22/NxteOgsJ5dfzDWm.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></a></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//luaè„šæœ¬ä¿è¯åŸå­æ€§</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//ä»redisé‡Œé¢è·å–æ•°æ®</span>    <span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//1 è·å–å½“å‰é”  setnx  + è®¾ç½®è¿‡æœŸæ—¶é—´</span>    <span class="token comment">//        Boolean ifAbsent = redisTemplate.opsForValue().setIfAbsent("lock", "lock");</span>    <span class="token class-name">Boolean</span> ifAbsent <span class="token operator">=</span>            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">,</span> uuid<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//2 å¦‚æœè·å–åˆ°é”ï¼Œä»redisè·å–æ•°æ® æ•°æ®+1 æ”¾å›redisé‡Œé¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>ifAbsent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//è·å–é”æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡ä»£ç </span>        <span class="token comment">//1.å…ˆä»redisä¸­é€šè¿‡key numè·å–å€¼  keyæå‰æ‰‹åŠ¨è®¾ç½® num åˆå§‹å€¼ï¼š0</span>        <span class="token class-name">String</span> value <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//2.å¦‚æœå€¼ä¸ºç©ºåˆ™éæ³•ç›´æ¥è¿”å›å³å¯</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//3.å¯¹numå€¼è¿›è¡Œè‡ªå¢åŠ ä¸€</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å‡ºç°å¼‚å¸¸</span>        <span class="token comment">//3 é‡Šæ”¾é” luaè„šæœ¬å®ç°</span>        <span class="token class-name">DefaultRedisScript</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">></span></span> redisScript <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultRedisScript</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//luaè„šæœ¬</span>        <span class="token class-name">String</span> script <span class="token operator">=</span> <span class="token string">"if redis.call(\"get\",KEYS[1]) == ARGV[1]\n"</span> <span class="token operator">+</span>                <span class="token string">"then\n"</span> <span class="token operator">+</span>                <span class="token string">"    return redis.call(\"del\",KEYS[1])\n"</span> <span class="token operator">+</span>                <span class="token string">"else\n"</span> <span class="token operator">+</span>                <span class="token string">"    return 0\n"</span> <span class="token operator">+</span>                <span class="token string">"end"</span><span class="token punctuation">;</span>        redisScript<span class="token punctuation">.</span><span class="token function">setScriptText</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®è¿”å›ç»“æœ</span>        redisScript<span class="token punctuation">.</span><span class="token function">setResultType</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>redisScript<span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4 æ€»ç»“"></a>4 æ€»ç»“</h3><h4 id="4-1ã€åŠ é”"><a href="#4-1ã€åŠ é”" class="headerlink" title="4.1ã€åŠ é”"></a>4.1ã€åŠ é”</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 1. ä»Redisä¸­è·å–é”,set k1 v1 px 20000 nx</span><span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Boolean</span> lock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">,</span> uuid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-2ã€ä½¿ç”¨luaé‡Šæ”¾é”"><a href="#4-2ã€ä½¿ç”¨luaé‡Šæ”¾é”" class="headerlink" title="4.2ã€ä½¿ç”¨luaé‡Šæ”¾é”"></a>4.2ã€ä½¿ç”¨luaé‡Šæ”¾é”</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 2. é‡Šæ”¾é” del</span><span class="token class-name">String</span> script <span class="token operator">=</span> <span class="token string">"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end"</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®luaè„šæœ¬è¿”å›çš„æ•°æ®ç±»å‹</span><span class="token class-name">DefaultRedisScript</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">></span></span> redisScript <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultRedisScript</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®luaè„šæœ¬è¿”å›ç±»å‹ä¸ºLong</span>redisScript<span class="token punctuation">.</span><span class="token function">setResultType</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>redisScript<span class="token punctuation">.</span><span class="token function">setScriptText</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>redisTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>redisScript<span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"lock"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-3ã€é‡è¯•"><a href="#4-3ã€é‡è¯•" class="headerlink" title="4.3ã€é‡è¯•"></a>4.3ã€é‡è¯•</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">testLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸ºäº†ç¡®ä¿åˆ†å¸ƒå¼é”å¯ç”¨ï¼Œæˆ‘ä»¬è‡³å°‘è¦ç¡®ä¿é”çš„å®ç°åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š</p><p><strong>ç¬¬ä¸€ä¸ªï¼šäº’æ–¥æ€§</strong>ï¼Œåœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æŒæœ‰é”ã€‚</p><p><strong>ç¬¬äºŒä¸ªï¼šä¸ä¼šå‘ç”Ÿæ­»é”</strong>ï¼Œå³ä½¿æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯åœ¨è·å–é”æ“ä½œæ—¶å€™å´©æºƒäº†ï¼Œä¹Ÿèƒ½ä¿è¯å…¶ä»–å®¢æˆ·ç«¯èƒ½è·å–åˆ°é”ã€‚</p><p><strong>ç¬¬ä¸‰ä¸ªï¼šè§£é“ƒè¿˜é¡»ç³»é“ƒäºº</strong>ï¼Œè§£é”åŠ é”å¿…é¡»åŒä¸€ä¸ªå®¢æˆ·ç«¯æ“ä½œã€‚</p><p><strong>ç¬¬å››ä¸ªï¼šåŠ é”å’Œè§£é”å¿…é¡»å…·å¤‡åŸå­æ€§</strong></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
          <category> åˆ†å¸ƒå¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“ç³»åˆ—(ä¸€) | MongoDB 7.0+ å¿«é€Ÿå…¥é—¨&amp;æ•´åˆSpringBoot</title>
      <link href="/posts/56299.html"/>
      <url>/posts/56299.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="MongoDB7-0-å¿«é€Ÿå…¥é—¨"><a href="#MongoDB7-0-å¿«é€Ÿå…¥é—¨" class="headerlink" title="MongoDB7.0+ å¿«é€Ÿå…¥é—¨"></a>MongoDB7.0+ å¿«é€Ÿå…¥é—¨</h2><h3 id="1ã€MongoDB"><a href="#1ã€MongoDB" class="headerlink" title="1ã€MongoDB"></a>1ã€MongoDB</h3><h4 id="1-1ã€MongoDB-æ¦‚å¿µ"><a href="#1-1ã€MongoDB-æ¦‚å¿µ" class="headerlink" title="1.1ã€MongoDB æ¦‚å¿µ"></a>1.1ã€MongoDB æ¦‚å¿µ</h4><h5 id="1-1-1ã€ä»€ä¹ˆæ˜¯MongoDB"><a href="#1-1-1ã€ä»€ä¹ˆæ˜¯MongoDB" class="headerlink" title="1.1.1ã€ä»€ä¹ˆæ˜¯MongoDB"></a>1.1.1ã€ä»€ä¹ˆæ˜¯MongoDB</h5><p><code>MongoDB</code> æ˜¯åœ¨<code>2007</code>å¹´ç”±<code>DoubleClick</code>å…¬å¸çš„å‡ ä½æ ¸å¿ƒæˆå‘˜å¼€å‘å‡ºçš„ä¸€æ¬¾åˆ†å¸ƒå¼æ–‡æ¡£æ•°æ®åº“ï¼Œç”±<code>C++</code>è¯­è¨€ç¼–å†™ã€‚</p><p>ç›®çš„æ˜¯ä¸ºäº†è§£å†³æ•°æ®å¤§é‡å¢é•¿çš„æ—¶å€™ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œæ•æ·æ€§ã€‚<code>MongoDB</code>è¦æ¯”ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ç®€å•å¾ˆå¤šã€‚</p><p>åœ¨<code>MongoDB</code>ä¸­æ•°æ®ä¸»è¦çš„ç»„ç»‡ç»“æ„å°±æ˜¯<code>æ•°æ®åº“ã€é›†åˆå’Œæ–‡æ¡£</code>ï¼Œæ–‡æ¡£å­˜å‚¨åœ¨é›†åˆå½“ä¸­ï¼Œé›†åˆå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚</p><p><code>MongoDB</code>ä¸­æ¯ä¸€æ¡æ•°æ®è®°å½•å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œ<code>æ•°æ®ç»“æ„ç”±é”®å€¼(key=&gt;value)å¯¹ç»„æˆ</code>ã€‚</p><p>æ–‡æ¡£ç±»ä¼¼äº <code>JSON</code> å¯¹è±¡ï¼Œå®ƒçš„æ•°æ®ç»“æ„è¢«å«åš<code>BSON</code>ï¼ˆ<code>Binary JSON</code>ï¼‰ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131956865.png" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131956865.png" alt="img"></a></p><p>ä¸‹è¡¨å°†å¸®åŠ©æ‚¨æ›´å®¹æ˜“ç†è§£<code>MongoDB</code>ä¸­çš„ä¸€äº›æ¦‚å¿µï¼š</p><table><thead><tr><th>RDBMS</th><th>MongoDB</th></tr></thead><tbody><tr><td>æ•°æ®åº“</td><td>æ•°æ®åº“</td></tr><tr><td>è¡¨æ ¼</td><td>é›†åˆ</td></tr><tr><td>è¡Œ</td><td>æ–‡æ¡£</td></tr><tr><td>åˆ—</td><td>å­—æ®µ</td></tr><tr><td>è¡¨è”åˆ</td><td>åµŒå…¥æ–‡æ¡£</td></tr><tr><td>ä¸»é”®</td><td>_id</td></tr></tbody></table><h5 id="1-1-2ã€MongoDBé€‚ç”¨åœºæ™¯"><a href="#1-1-2ã€MongoDBé€‚ç”¨åœºæ™¯" class="headerlink" title="1.1.2ã€MongoDBé€‚ç”¨åœºæ™¯"></a>1.1.2ã€MongoDBé€‚ç”¨åœºæ™¯</h5><p><code>MongoDB</code>ä¸éœ€è¦å»æ˜ç¡®æŒ‡å®šä¸€å¼ è¡¨çš„å…·ä½“ç»“æ„ï¼Œå¯¹å­—æ®µçš„ç®¡ç†éå¸¸çµæ´»ï¼Œæœ‰å¾ˆå¼ºçš„å¯æ‰©å±•æ€§ã€‚</p><p>æ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨ã€é«˜å¯æ‰©å±•æ€§ï¼Œè‡ªå¸¦æ•°æ®å‹ç¼©åŠŸèƒ½ï¼Œæ”¯æŒæµ·é‡æ•°æ®çš„é«˜æ•ˆå­˜å‚¨å’Œè®¿é—®ã€‚</p><p>æ”¯æŒåŸºæœ¬çš„<code>CRUD</code>ã€æ•°æ®èšåˆã€æ–‡æœ¬æœç´¢å’Œåœ°ç†ç©ºé—´æŸ¥è¯¢åŠŸèƒ½ã€‚</p><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ç½‘ç«™æ•°æ®ï¼š<code>Mongo</code>éå¸¸é€‚åˆå®æ—¶çš„æ’å…¥ï¼Œæ›´æ–°ä¸æŸ¥è¯¢ï¼Œå¹¶å…·å¤‡ç½‘ç«™å®æ—¶æ•°æ®å­˜å‚¨æ‰€éœ€çš„å¤åˆ¶åŠé«˜åº¦ä¼¸ç¼©æ€§ã€‚</li><li>é«˜ä¼¸ç¼©æ€§çš„åœºæ™¯ï¼š<code>Mongo</code>éå¸¸é€‚åˆç”±æ•°åæˆ–æ•°ç™¾å°æœåŠ¡å™¨ç»„æˆçš„æ•°æ®åº“ã€‚</li><li>å¤§å°ºå¯¸ï¼Œä½ä»·å€¼çš„æ•°æ®ï¼šä½¿ç”¨ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å­˜å‚¨ä¸€äº›æ•°æ®æ—¶å¯èƒ½ä¼šæ¯”è¾ƒæ˜‚è´µï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå¾ˆå¤šæ—¶å€™ç¨‹åºå‘˜å¾€å¾€ä¼šé€‰æ‹©ä¼ ç»Ÿçš„æ–‡ä»¶è¿›è¡Œå­˜å‚¨ã€‚</li><li>ç¼“å­˜ï¼šç”±äºæ€§èƒ½å¾ˆé«˜ï¼Œ<code>Mongo</code>ä¹Ÿé€‚åˆä½œä¸ºä¿¡æ¯åŸºç¡€è®¾æ–½çš„ç¼“å­˜å±‚ã€‚åœ¨ç³»ç»Ÿé‡å¯ä¹‹åï¼Œç”±<code>Mongo</code>æ­å»ºçš„æŒä¹…åŒ–ç¼“å­˜å±‚å¯ä»¥é¿å…ä¸‹å±‚çš„æ•°æ®æºè¿‡è½½ã€‚</li></ul><p><strong>ä¾‹å¦‚ï¼š</strong></p><p>å¼¹å¹•ã€ç›´æ’­é—´äº’åŠ¨ä¿¡æ¯ã€æœ‹å‹åœˆä¿¡æ¯ã€ç‰©æµåœºæ™¯ç­‰</p><p><strong>ä¸é€‚ç”¨åœºåˆï¼š</strong></p><ul><li>é«˜åº¦äº‹åŠ¡æ€§ç³»ç»Ÿï¼šä¾‹å¦‚é“¶è¡Œç³»ç»Ÿã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ç›®å‰è¿˜æ˜¯æ›´é€‚ç”¨äºéœ€è¦å¤§é‡åŸå­æ€§å¤æ‚äº‹åŠ¡çš„åº”ç”¨ç¨‹åºã€‚</li><li>ä¼ ç»Ÿçš„å•†ä¸šæ™ºèƒ½åº”ç”¨ï¼šé’ˆå¯¹ç‰¹å®šé—®é¢˜çš„<code>BI</code>æ•°æ®åº“ä¼šå¯¹äº§ç”Ÿé«˜åº¦ä¼˜åŒ–çš„æŸ¥è¯¢æ–¹å¼ã€‚å¯¹äºæ­¤ç±»åº”ç”¨ï¼Œæ•°æ®ä»“åº“å¯èƒ½æ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚</li></ul><h4 id="1-2ã€å®‰è£…å’Œå¯åŠ¨ï¼ˆdockeræ–¹å¼ï¼‰"><a href="#1-2ã€å®‰è£…å’Œå¯åŠ¨ï¼ˆdockeræ–¹å¼ï¼‰" class="headerlink" title="1.2ã€å®‰è£…å’Œå¯åŠ¨ï¼ˆdockeræ–¹å¼ï¼‰"></a>1.2ã€å®‰è£…å’Œå¯åŠ¨ï¼ˆdockeræ–¹å¼ï¼‰</h4><h5 id="1-2-1ã€æ‹‰å–é•œåƒ"><a href="#1-2-1ã€æ‹‰å–é•œåƒ" class="headerlink" title="1.2.1ã€æ‹‰å–é•œåƒ"></a>1.2.1ã€æ‹‰å–é•œåƒ</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker pull mongo:7.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-2-2ã€åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨"><a href="#1-2-2ã€åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨" class="headerlink" title="1.2.2ã€åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨"></a>1.2.2ã€åˆ›å»ºå’Œå¯åŠ¨å®¹å™¨</h5><p>éœ€è¦åœ¨å®¿ä¸»æœºå»ºç«‹æ–‡ä»¶å¤¹</p><blockquote><p>rm -rf /opt/mongo</p><p>mkdir -p /opt/mongo/data/db</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run -d --restart&#x3D;always -p 27017:27017 --name mongo -v &#x2F;opt&#x2F;mongo&#x2F;data&#x2F;db:&#x2F;data&#x2F;db mongo:7.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-2-3ã€è¿›å…¥å®¹å™¨"><a href="#1-2-3ã€è¿›å…¥å®¹å™¨" class="headerlink" title="1.2.3ã€è¿›å…¥å®¹å™¨"></a>1.2.3ã€è¿›å…¥å®¹å™¨</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker exec -it mongo mongosh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-2-4ã€åŸºæœ¬å‘½ä»¤"><a href="#1-2-4ã€åŸºæœ¬å‘½ä»¤" class="headerlink" title="1.2.4ã€åŸºæœ¬å‘½ä»¤"></a>1.2.4ã€åŸºæœ¬å‘½ä»¤</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">show dbsdb.version() #å½“å‰dbç‰ˆæœ¬db.getMongo() #æŸ¥çœ‹å½“å‰dbçš„é“¾æ¥æœºå™¨åœ°å€db.help() #å¸®åŠ©quit() #é€€å‡ºå‘½ä»¤è¡Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-4ã€æ•°æ®åº“æ“ä½œ"><a href="#1-4ã€æ•°æ®åº“æ“ä½œ" class="headerlink" title="1.4ã€æ•°æ®åº“æ“ä½œ"></a>1.4ã€æ•°æ®åº“æ“ä½œ</h4><h5 id="1-4-1ã€åˆ›å»ºæ•°æ®åº“"><a href="#1-4-1ã€åˆ›å»ºæ•°æ®åº“" class="headerlink" title="1.4.1ã€åˆ›å»ºæ•°æ®åº“"></a>1.4.1ã€åˆ›å»ºæ•°æ®åº“</h5><p>å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ•°æ®åº“ï¼Œå¦åˆ™åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“ã€‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">use tingshu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-4-2ã€æŸ¥çœ‹å½“å‰æ•°æ®åº“"><a href="#1-4-2ã€æŸ¥çœ‹å½“å‰æ•°æ®åº“" class="headerlink" title="1.4.2ã€æŸ¥çœ‹å½“å‰æ•°æ®åº“"></a>1.4.2ã€æŸ¥çœ‹å½“å‰æ•°æ®åº“</h5><pre class="line-numbers language-none"><code class="language-none">db.getName()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-4-3ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“çŠ¶æ€"><a href="#1-4-3ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“çŠ¶æ€" class="headerlink" title="1.4.3ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“çŠ¶æ€"></a>1.4.3ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“çŠ¶æ€</h5><pre class="line-numbers language-none"><code class="language-none">db.stats()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-4-4ã€åˆ é™¤å½“å‰æ•°æ®åº“"><a href="#1-4-4ã€åˆ é™¤å½“å‰æ•°æ®åº“" class="headerlink" title="1.4.4ã€åˆ é™¤å½“å‰æ•°æ®åº“"></a>1.4.4ã€åˆ é™¤å½“å‰æ•°æ®åº“</h5><pre class="line-numbers language-none"><code class="language-none">db.dropDatabase()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="1-5ã€é›†åˆæ“ä½œ"><a href="#1-5ã€é›†åˆæ“ä½œ" class="headerlink" title="1.5ã€é›†åˆæ“ä½œ"></a>1.5ã€é›†åˆæ“ä½œ</h4><h5 id="1-5-1ã€åˆ›å»ºé›†åˆ"><a href="#1-5-1ã€åˆ›å»ºé›†åˆ" class="headerlink" title="1.5.1ã€åˆ›å»ºé›†åˆ"></a>1.5.1ã€åˆ›å»ºé›†åˆ</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.createCollection(&quot;User&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-5-2ã€åˆ é™¤é›†åˆ"><a href="#1-5-2ã€åˆ é™¤é›†åˆ" class="headerlink" title="1.5.2ã€åˆ é™¤é›†åˆ"></a>1.5.2ã€åˆ é™¤é›†åˆ</h5><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.drop()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="1-6ã€æ–‡æ¡£æ“ä½œ"><a href="#1-6ã€æ–‡æ¡£æ“ä½œ" class="headerlink" title="1.6ã€æ–‡æ¡£æ“ä½œ"></a>1.6ã€æ–‡æ¡£æ“ä½œ</h4><p>æ–‡æ¡£æ˜¯ä¸€ç»„é”®å€¼<code>(key-value)</code>å¯¹ã€‚<code>MongoDB</code> çš„æ–‡æ¡£ä¸éœ€è¦è®¾ç½®ç›¸åŒçš„å­—æ®µï¼Œå¹¶ä¸”ç›¸åŒçš„å­—æ®µä¸éœ€è¦ç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œè¿™ä¸å…³ç³»å‹æ•°æ®åº“æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä¹Ÿæ˜¯ <code>MongoDB</code> éå¸¸çªå‡ºçš„ç‰¹ç‚¹ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p><p>1ã€<code>MongoDB</code>åŒºåˆ†ç±»å‹å’Œå¤§å°å†™ã€‚</p><p>2ã€<code>MongoDB</code>çš„æ–‡æ¡£ä¸èƒ½æœ‰é‡å¤çš„é”®ã€‚</p><h5 id="1-6-1ã€insert"><a href="#1-6-1ã€insert" class="headerlink" title="1.6.1ã€insert"></a>1.6.1ã€insert</h5><p>å‘Useré›†åˆæ’å…¥ä¸€æ¡è®°å½•ã€‚å¯ä»¥é¢„å…ˆä½¿ç”¨<code>createCollection</code>æ–¹æ³•åˆ›å»ºé›†åˆï¼Œä¹Ÿå¯ä»¥ä¸åˆ›å»ºé›†åˆï¼Œç›´æ¥æ’å…¥æ•°æ®ï¼Œé‚£ä¹ˆé›†åˆä¼šè¢«è‡ªåŠ¨åˆ›å»º</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.insert(&#123;name:&#39;zhangsan&#39;,age:21,sex:true&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-6-2ã€query"><a href="#1-6-2ã€query" class="headerlink" title="1.6.2ã€query"></a>1.6.2ã€query</h5><p>æŸ¥è¯¢å½“å‰Useré›†åˆä¸­æ‰€æœ‰çš„è®°å½•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.find()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥è¯¢å½“å‰Useré›†åˆä¸­nameæ˜¯zhangsançš„è®°å½•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.find(&#123;name:&quot;zhangsan&quot;&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-6-3ã€update"><a href="#1-6-3ã€update" class="headerlink" title="1.6.3ã€update"></a>1.6.3ã€update</h5><p>åªæ›´æ–°åŒ¹é…åˆ°çš„ç¬¬ä¸€æ¡è®°å½•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.update(&#123;age:20&#125;, &#123;$set:&#123;name:100&#125;&#125;) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ›´æ–°åŒ¹é…åˆ°çš„æ‰€æœ‰è®°å½•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.update(&#123;age:21&#125;, &#123;$set:&#123;age:99&#125;&#125;, &#123;multi: true&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="1-6-4ã€remove"><a href="#1-6-4ã€remove" class="headerlink" title="1.6.4ã€remove"></a>1.6.4ã€remove</h5><p>ç§»é™¤ä¸€ä¸ªæ–‡æ¡£</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.remove(id)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç§»é™¤æ‰€æœ‰æ–‡æ¡£</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">db.User.remove(&#123;&#125;) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ›´å¤šå‘½ä»¤å‚è€ƒï¼š</strong><a href="https://www.runoob.com/mongodb/mongodb-tutorial.html">https://www.runoob.com/mongodb/mongodb-tutorial.html</a></p><h3 id="2ã€SpringBooté›†æˆMongoDB"><a href="#2ã€SpringBooté›†æˆMongoDB" class="headerlink" title="2ã€SpringBooté›†æˆMongoDB"></a>2ã€SpringBooté›†æˆMongoDB</h3><p><code>spring-data-mongodb</code>æä¾›äº†<code>MongoTemplate</code>ä¸<code>MongoRepository</code>ä¸¤ç§æ–¹å¼è®¿é—®<code>mongodb</code>ï¼Œ<code>MongoRepository</code>æ“ä½œç®€å•ï¼Œ<code>MongoTemplate</code>æ“ä½œçµæ´»ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¯ä»¥çµæ´»ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼æ“ä½œ<code>mongodb</code>ã€‚</p><h4 id="2-1ã€é›†æˆspring-data-mongodb"><a href="#2-1ã€é›†æˆspring-data-mongodb" class="headerlink" title="2.1ã€é›†æˆspring-data-mongodb"></a>2.1ã€é›†æˆspring-data-mongodb</h4><h5 id="2-1-1ã€æ­å»ºé¡¹ç›®"><a href="#2-1-1ã€æ­å»ºé¡¹ç›®" class="headerlink" title="2.1.1ã€æ­å»ºé¡¹ç›®"></a>2.1.1ã€æ­å»ºé¡¹ç›®</h5><p>1ã€åˆ›å»ºé¡¹ç›®ï¼š<code>mongo_demo</code></p><p>2ã€å¯¼å…¥<code>pom.xmlï¼š</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.atguigu<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mongo_demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--mongodb--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-mongodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3ã€æ·»åŠ é…ç½®æ–‡ä»¶</p><p><code>application.yml</code></p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">data</span><span class="token punctuation">:</span>    <span class="token key atrule">mongodb</span><span class="token punctuation">:</span>      <span class="token key atrule">database</span><span class="token punctuation">:</span> daijia      <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.100.101      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27017</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-1-2ã€æ·»åŠ å®ä½“"><a href="#2-1-2ã€æ·»åŠ å®ä½“" class="headerlink" title="2.1.2ã€æ·»åŠ å®ä½“"></a>2.1.2ã€æ·»åŠ å®ä½“</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>model</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token comment">//æŒ‡å®šmongodbä¸­çš„é›†åˆåå­—</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Id</span>    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> createDate<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2ã€MongoRepository"><a href="#2-2ã€MongoRepository" class="headerlink" title="2.2ã€MongoRepository"></a>2.2ã€MongoRepository</h4><h5 id="2-2-1ã€æ·»åŠ Repositoryç±»"><a href="#2-2-1ã€æ·»åŠ Repositoryç±»" class="headerlink" title="2.2.1ã€æ·»åŠ Repositoryç±»"></a>2.2.1ã€æ·»åŠ Repositoryç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>repository</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">MongoRepository</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">MongoRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">ObjectId</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-2-2ã€åˆ›å»ºæµ‹è¯•ç±»"><a href="#2-2-2ã€åˆ›å»ºæµ‹è¯•ç±»" class="headerlink" title="2.2.2ã€åˆ›å»ºæµ‹è¯•ç±»"></a>2.2.2ã€åˆ›å»ºæµ‹è¯•ç±»</h5><p>testç›®å½•åˆ›å»ºæµ‹è¯•ç±»ï¼š<code>MongoRepositoryTest</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">UserRepository</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Example</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Page</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">PageRequest</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Sort</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Optional</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MongoRepositoryTest</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>    <span class="token comment">//æ’å…¥</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å°è°·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setCreateDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æŸ¥è¯¢æ‰€æœ‰</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ ¹æ®idæŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token string">"64eee9dff317c823c62b4faf"</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> present <span class="token operator">=</span> optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>present<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">User</span> user <span class="token operator">=</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ¡ä»¶æŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindAllExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> example <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ’åºæŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindAllSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Sort</span> sort <span class="token operator">=</span> <span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Direction</span><span class="token punctuation">.</span><span class="token constant">DESC</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>sort<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindAllPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> page <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> totalPages <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">getTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>totalPages<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ›´æ–°</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpdateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ³¨æ„ï¼šå…ˆæŸ¥è¯¢ï¼Œå†æ›´æ–°</span>        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token string">"64eee9dff317c823c62b4faf"</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">User</span> user <span class="token operator">=</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//userä¸­åŒ…å«idï¼Œå°±ä¼šæ‰§è¡Œæ›´æ–°</span>            userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åˆ é™¤</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDeleteUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        userRepository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token string">"64eee9dff317c823c62b4faf"</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-3ã€MongoTemplate"><a href="#2-3ã€MongoTemplate" class="headerlink" title="2.3ã€MongoTemplate"></a>2.3ã€MongoTemplate</h4><p>testç›®å½•åˆ›å»ºæµ‹è¯•ç±»ï¼šMongoTemplateTest</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>mongo_demo<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>client<span class="token punctuation">.</span>result<span class="token punctuation">.</span></span><span class="token class-name">DeleteResult</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>client<span class="token punctuation">.</span>result<span class="token punctuation">.</span></span><span class="token class-name">UpdateResult</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">MongoTemplate</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Criteria</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Query</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Update</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span></span><span class="token class-name">Pattern</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MongoTemplateTest</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MongoTemplate</span> mongoTemplate<span class="token punctuation">;</span>    <span class="token comment">//æ·»åŠ </span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        user<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token string">"test@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mongoTemplate<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æŸ¥è¯¢æ‰€æœ‰</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ ¹æ®idæŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindUserById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"64eeeae31711344f35635788"</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åˆ é™¤</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRemove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"_id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">"64eeeae31711344f35635788"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">DeleteResult</span> result <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> count <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getDeletedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ¡ä»¶æŸ¥è¯¢ and</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findUsersPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å…ˆæŸ¥è¯¢æ€»è®°å½•æ•°</span>        <span class="token keyword">long</span> count <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åæŸ¥è¯¢åˆ†é¡µåˆ—è¡¨</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userList<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment">//ä¿®æ”¹</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpdateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"_id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">"64eeeae31711344f35635788"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Update</span> update <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        update<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        update<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">UpdateResult</span> result <span class="token operator">=</span> mongoTemplate<span class="token punctuation">.</span><span class="token function">upsert</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¹ä¸€æ¡</span>        <span class="token comment">//UpdateResult result = mongoTemplate.updateMulti(query, update, User.class);//æ”¹å¤šæ¡</span>        <span class="token keyword">long</span> count <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getModifiedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> MonogDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> MonogDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆä¸ƒï¼‰| RocketMQ ä¸ºä»€ä¹ˆæ€§èƒ½ä¸å¦‚Kafka?</title>
      <link href="/posts/56299.html"/>
      <url>/posts/56299.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="RocketMQ-ä¸ºä»€ä¹ˆæ€§èƒ½ä¸å¦‚-Kafkaï¼Ÿ"><a href="#RocketMQ-ä¸ºä»€ä¹ˆæ€§èƒ½ä¸å¦‚-Kafkaï¼Ÿ" class="headerlink" title="RocketMQ ä¸ºä»€ä¹ˆæ€§èƒ½ä¸å¦‚ Kafkaï¼Ÿ"></a>RocketMQ ä¸ºä»€ä¹ˆæ€§èƒ½ä¸å¦‚ Kafkaï¼Ÿ</h1><blockquote><p><strong>RocketMQ ä½¿ç”¨çš„æ˜¯ mmap é›¶æ‹·è´æŠ€æœ¯ï¼Œè€Œ kafka ä½¿ç”¨çš„æ˜¯ sendfile</strong> (ç¡¬ä»¶è®¾å¤‡æŠ€æœ¯ <strong>SG-DMA</strong>ï¼Œä¸å½±å“ï¼ˆä¸å ç”¨ï¼‰CPUå·¥ä½œ)</p><p>mmap   å†…æ ¸ç¼“å†²åŒº-&gt;æ˜ å°„ç”¨æˆ·ç¼“å†²åŒº-&gt;å†…æ ¸ç¼“å†²åŒº-&gt;ç½‘å¡<br>sendfile å†…æ ¸ç¼“å†²åŒº-&gt; SG-DMA -&gt; ç½‘å¡</p></blockquote><p>åœ¨ä¸Šç¯‡æ–‡ç« ã€Š<a href="https://www.cnblogs.com/stormling2022/p/18605383">rocketmq æ˜¯ä»€ä¹ˆ</a>ã€‹ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ° <code>RocketMQ</code> çš„æ¶æ„å…¶å®å‚è€ƒäº† <code>kafka</code> çš„è®¾è®¡æ€æƒ³ï¼ŒåŒæ—¶åˆåœ¨ <code>kafka</code> çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›è°ƒæ•´ã€‚<br>çœ‹èµ·æ¥ï¼Œ<code>RocketMQ</code> å¥½åƒå„æ–¹é¢éƒ½æ¯” <code>kafka</code> æ›´èƒ½æ‰“ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171407187.jpeg" title="Kafkaä¸RocketMQå¯¹æ¯”" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171407187.jpeg" alt="Kafkaä¸RocketMQå¯¹æ¯”"></a></p><p>ä½† <code>kafka</code> å´ä¸€ç›´æ²¡è¢«æ·˜æ±°ï¼Œè¯´æ˜ <code>RocketMQ</code> å¿…ç„¶æ˜¯æœ‰ç€ä¸å¦‚ <code>kafka</code> çš„åœ°æ–¹ã€‚<br>æ˜¯å•¥å‘¢ï¼Ÿ<br><strong>æ€§èƒ½</strong>ï¼Œä¸¥æ ¼æ¥è¯´æ˜¯<strong>ååé‡</strong>ã€‚é˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå¯¹å®ƒä»¬åšè¿‡å‹æµ‹ï¼ŒåŒæ ·æ¡ä»¶ä¸‹ï¼Œ<code>kafka</code> æ¯” <code>RocketMQ</code> å¿« **50%**å·¦å³ã€‚ä½†å³ä½¿è¿™æ ·ï¼Œ<code>RocketMQ</code> ä¾ç„¶èƒ½æ¯ç§’å¤„ç† <code>10w</code> é‡çº§çš„æ•°æ®ï¼Œä¾æ—§éå¸¸èƒ½æ‰“ã€‚<br>ä½ ä¸èƒ½è¯´ <code>RocketMQ</code> å¼±ï¼Œåªèƒ½è¯´ <code>Kafka</code> æ€§èƒ½å¤ªå¼ºäº†ã€‚</p><p>ä¸è¿‡è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œ<strong>ä¸ºä»€ä¹ˆ RocketMQ å‚è€ƒäº† kafka çš„æ¶æ„ï¼Œå´ä¸èƒ½è·Ÿ kafka ä¿æŒä¸€æ ·çš„æ€§èƒ½å‘¢</strong>ï¼Ÿ<br>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥èŠä¸‹ä»€ä¹ˆæ˜¯<strong>é›¶æ‹·è´</strong>ã€‚</p><h2 id="é›¶æ‹·è´æ˜¯ä»€ä¹ˆ"><a href="#é›¶æ‹·è´æ˜¯ä»€ä¹ˆ" class="headerlink" title="é›¶æ‹·è´æ˜¯ä»€ä¹ˆ"></a>é›¶æ‹·è´æ˜¯ä»€ä¹ˆ</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯ä¸ºäº†é˜²æ­¢è¿›ç¨‹å´©æºƒåä¸¢å¤±ï¼Œä¸€èˆ¬ä¸ä¼šæ”¾å†…å­˜é‡Œï¼Œè€Œæ˜¯æ”¾ç£ç›˜ä¸Šã€‚<br>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œæ¶ˆæ¯ä»æ¶ˆæ¯é˜Ÿåˆ—çš„ç£ç›˜ï¼Œå‘é€åˆ°æ¶ˆè´¹è€…ï¼Œè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><h3 id="æ¶ˆæ¯çš„å‘é€è¿‡ç¨‹"><a href="#æ¶ˆæ¯çš„å‘é€è¿‡ç¨‹" class="headerlink" title="æ¶ˆæ¯çš„å‘é€è¿‡ç¨‹"></a>æ¶ˆæ¯çš„å‘é€è¿‡ç¨‹</h3><p>æ“ä½œç³»ç»Ÿåˆ†ä¸º<strong>ç”¨æˆ·ç©ºé—´</strong>å’Œ<strong>å†…æ ¸ç©ºé—´</strong>ã€‚<br>ç¨‹åºå¤„äºç”¨æˆ·ç©ºé—´ï¼Œè€Œç£ç›˜å±äºç¡¬ä»¶ï¼Œæ“ä½œç³»ç»Ÿæœ¬è´¨ä¸Šæ˜¯ç¨‹åºå’Œç¡¬ä»¶è®¾å¤‡çš„ä¸€ä¸ª<strong>ä¸­é—´å±‚</strong>ã€‚ç¨‹åºéœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿå»è°ƒç”¨ç¡¬ä»¶èƒ½åŠ›ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417675.jpeg" title="æ“ä½œç³»ç»Ÿæ˜¯ç¨‹åºå’Œç¡¬ä»¶çš„ä¸­é—´å±‚" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417675.jpeg" alt="æ“ä½œç³»ç»Ÿæ˜¯ç¨‹åºå’Œç¡¬ä»¶çš„ä¸­é—´å±‚"></a><br>å¦‚æœç”¨æˆ·æƒ³è¦å°†æ•°æ®ä»ç£ç›˜å‘é€åˆ°ç½‘ç»œã€‚é‚£ä¹ˆå°±ä¼šå‘ç”Ÿä¸‹é¢è¿™å‡ ä»¶äº‹ï¼š<br>ç¨‹åºä¼šå‘èµ·<strong>ç³»ç»Ÿè°ƒç”¨</strong><code>read()</code>ï¼Œå°è¯•è¯»å–ç£ç›˜æ•°æ®ï¼Œ</p><ul><li>ç£ç›˜æ•°æ®ä»è®¾å¤‡<strong>æ‹·è´</strong>åˆ°å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºã€‚</li><li>å†ä»å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒº<strong>æ‹·è´</strong>åˆ°ç”¨æˆ·ç©ºé—´ã€‚</li></ul><p>ç¨‹åºå†å‘èµ·<strong>ç³»ç»Ÿè°ƒç”¨</strong><code>write()</code>ï¼Œå°†è¯»åˆ°çš„æ•°æ®å‘åˆ°ç½‘ç»œï¼š</p><ul><li>æ•°æ®ä»ç”¨æˆ·ç©ºé—´<strong>æ‹·è´</strong>åˆ° <code>socket</code> å‘é€ç¼“å†²åŒº</li><li>å†ä» <code>socket</code> å‘é€ç¼“å†²åŒº<strong>æ‹·è´</strong>åˆ°ç½‘å¡ã€‚</li></ul><p>æœ€ç»ˆæ•°æ®å°±ä¼šç»è¿‡ç½‘ç»œåˆ°è¾¾æ¶ˆè´¹è€…ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171419834.jpeg" title="åŸå§‹å‘é€æµç¨‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171419834.jpeg" alt="åŸå§‹å‘é€æµç¨‹"></a></p><p>æ•´ä¸ªè¿‡ç¨‹ï¼Œæœ¬æœºå†…å‘ç”Ÿäº† <code>2</code> æ¬¡<strong>ç³»ç»Ÿè°ƒç”¨</strong>ï¼Œå¯¹åº” <code>4</code> æ¬¡ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„<strong>åˆ‡æ¢</strong>ï¼Œä»¥åŠ <code>4</code> æ¬¡æ•°æ®<strong>æ‹·è´</strong>ã€‚<br><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417261.jpeg" title="4æ¬¡åˆ‡æ¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417261.jpeg" alt="4æ¬¡åˆ‡æ¢"></a><br>ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œç»“æœå°±æ˜¯åŒæ ·ä¸€ä»½æ•°æ®æ¥å›æ‹·è´ã€‚<br>æœ‰æ²¡æœ‰åŠæ³•ä¼˜åŒ–å‘¢ï¼Ÿ<br>æœ‰ï¼Œå®ƒå°±æ˜¯é›¶æ‹·è´æŠ€æœ¯ï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ <code>mmap</code> å’Œ <code>sendfile</code>ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒä»¬æ˜¯ä»€ä¹ˆã€‚</p><h3 id="mmap-æ˜¯ä»€ä¹ˆ"><a href="#mmap-æ˜¯ä»€ä¹ˆ" class="headerlink" title="mmap æ˜¯ä»€ä¹ˆ"></a>mmap æ˜¯ä»€ä¹ˆ</h3><p><code>mmap</code> æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å°†å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒº<strong>æ˜ å°„</strong>åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417734.jpeg" title="mmapæ˜ å°„å†…å­˜" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417734.jpeg" alt="mmapæ˜ å°„å†…å­˜"></a></p><p>ç”¨äº†å®ƒï¼Œæ•´ä¸ªå‘é€æµç¨‹å°±æœ‰äº†ä¸€äº›å˜åŒ–ã€‚<br>ç¨‹åºå‘èµ·<strong>ç³»ç»Ÿè°ƒç”¨</strong><code>mmap()</code>ï¼Œå°è¯•è¯»å–ç£ç›˜æ•°æ®ï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š</p><ul><li>ç£ç›˜æ•°æ®ä»è®¾å¤‡<strong>æ‹·è´</strong>åˆ°å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºã€‚</li><li>å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒº<strong>æ˜ å°„</strong>åˆ°ç”¨æˆ·ç©ºé—´ï¼Œè¿™é‡Œ<strong>ä¸éœ€è¦</strong>æ‹·è´ã€‚</li></ul><p>ç¨‹åºå†å‘èµ·<strong>ç³»ç»Ÿè°ƒç”¨</strong><code>write()</code>ï¼Œå°†è¯»åˆ°çš„æ•°æ®å‘åˆ°ç½‘ç»œï¼š</p><ul><li>æ•°æ®ä»å†…æ ¸ç©ºé—´ç¼“å†²åŒº<strong>æ‹·è´</strong>åˆ° socket å‘é€ç¼“å†²åŒºã€‚</li><li>å†ä» socket å‘é€ç¼“å†²åŒº<strong>æ‹·è´</strong>åˆ°ç½‘å¡ã€‚</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417402.jpeg" title="åŸºäºmmapçš„å‘é€æµç¨‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171417402.jpeg" alt="åŸºäºmmapçš„å‘é€æµç¨‹"></a></p><p>æ•´ä¸ªè¿‡ç¨‹ï¼Œå‘ç”Ÿäº† <code>2</code> æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹åº” <code>4</code> æ¬¡ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åˆ‡æ¢ï¼Œä»¥åŠ <code>3</code> æ¬¡æ•°æ®æ‹·è´ï¼Œå¯¹æ¯”ä¹‹å‰ï¼Œçœä¸‹<strong>ä¸€æ¬¡</strong>å†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´çš„æ‹·è´ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426344.jpeg" title="4æ¬¡åˆ‡æ¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426344.jpeg" alt="4æ¬¡åˆ‡æ¢"></a><br>çœ‹åˆ°è¿™é‡Œå¤§å®¶ä¼°è®¡ä¹Ÿè’™äº†ï¼Œä¸æ˜¯è¯´é›¶æ‹·è´å—ï¼Ÿæ€ä¹ˆè¿˜æœ‰ 3 æ¬¡æ‹·è´ã€‚<br><code>mmap</code> ä½œä¸ºä¸€ç§é›¶æ‹·è´æŠ€æœ¯ï¼ŒæŒ‡çš„æ˜¯<strong>ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦æ‹·è´</strong>ï¼Œè€Œä¸æ˜¯æŒ‡æ•°æ®ä»ç£ç›˜åˆ°å‘é€åˆ°ç½‘å¡è¿™ä¸ªè¿‡ç¨‹é›¶æ‹·è´ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426553.jpeg" title="è¿™è¯¥æ´—çš„æ–‡å­—æ¸¸æˆ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426553.jpeg" alt="è¿™è¯¥æ´—çš„æ–‡å­—æ¸¸æˆ"></a><br><strong>ç¡®å®çœäº†ä¸€ç‚¹ï¼Œä½†ä¸å¤š</strong>ã€‚æœ‰æ²¡æœ‰æ›´å½»åº•çš„é›¶æ‹·è´ï¼Ÿ<br>æœ‰ï¼Œç”¨ <code>sendfile</code>.</p><h3 id="sendfile-æ˜¯ä»€ä¹ˆ"><a href="#sendfile-æ˜¯ä»€ä¹ˆ" class="headerlink" title="sendfile æ˜¯ä»€ä¹ˆ"></a>sendfile æ˜¯ä»€ä¹ˆ</h3><p><code>sendfile</code>ï¼Œä¹Ÿæ˜¯å†…æ ¸æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä»åå­—å¯ä»¥çœ‹å‡ºï¼Œå°±æ˜¯ç”¨æ¥<strong>å‘é€æ–‡ä»¶æ•°æ®</strong>çš„ã€‚<br>ç¨‹åºå‘èµ·<strong>ç³»ç»Ÿè°ƒç”¨</strong><code>sendfile()</code>ï¼Œå†…æ ¸ä¼šå°è¯•è¯»å–ç£ç›˜æ•°æ®ç„¶åå‘é€ï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š</p><ul><li>ç£ç›˜æ•°æ®ä»è®¾å¤‡<strong>æ‹·è´</strong>åˆ°å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºã€‚</li><li>å†…æ ¸ç©ºé—´ç¼“å†²åŒºé‡Œçš„æ•°æ®<strong>å¯ä»¥</strong>ç›´æ¥<strong>æ‹·è´</strong>åˆ°ç½‘å¡ã€‚</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426494.jpeg" title="åŸºäºsendfileçš„å‘é€æµç¨‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426494.jpeg" alt="åŸºäºsendfileçš„å‘é€æµç¨‹"></a></p><p>æ•´ä¸ªè¿‡ç¨‹ï¼Œå‘ç”Ÿäº† <code>1</code> æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹åº” <code>2</code> æ¬¡ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åˆ‡æ¢ï¼Œä»¥åŠ <code>2</code> æ¬¡æ•°æ®æ‹·è´ã€‚<br>è¿™æ—¶å€™é—®é¢˜å¾ˆå¤šçš„å°æ˜å°±æœ‰æ„è§äº†ï¼Œè¯´å¥½çš„<strong>é›¶</strong>æ‹·è´æ€ä¹ˆè¿˜æœ‰ <code>2</code> æ¬¡æ‹·è´ï¼Ÿ</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426101.jpeg" title="2æ¬¡åˆ‡æ¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426101.jpeg" alt="2æ¬¡åˆ‡æ¢"></a><br>å…¶å®ï¼Œè¿™é‡Œçš„é›¶æ‹·è´æŒ‡çš„æ˜¯<strong>é›¶ CPU</strong>æ‹·è´ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ <code>sendfile</code> åœºæ™¯ä¸‹ï¼Œéœ€è¦çš„ä¸¤æ¬¡æ‹·è´ï¼Œéƒ½<strong>ä¸æ˜¯ CPU ç›´æ¥å‚ä¸çš„æ‹·è´</strong>ï¼Œè€Œæ˜¯å…¶ä»–<strong>ç¡¬ä»¶è®¾å¤‡æŠ€æœ¯</strong>åšçš„æ‹·è´ï¼Œä¸è€½è¯¯æˆ‘ä»¬ CPU è·‘ç¨‹åºã€‚</p><h3 id="kafka-ä¸ºä»€ä¹ˆæ€§èƒ½æ¯”-RocketMQ-å¥½"><a href="#kafka-ä¸ºä»€ä¹ˆæ€§èƒ½æ¯”-RocketMQ-å¥½" class="headerlink" title="kafka ä¸ºä»€ä¹ˆæ€§èƒ½æ¯” RocketMQ å¥½"></a>kafka ä¸ºä»€ä¹ˆæ€§èƒ½æ¯” RocketMQ å¥½</h3><p>èŠå®Œä¸¤ç§é›¶æ‹·è´æŠ€æœ¯ï¼Œæˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹ä¸‹ <code>kafka</code> ä¸ºä»€ä¹ˆæ€§èƒ½æ¯” <code>RocketMQ</code> å¥½ã€‚<br>è¿™æ˜¯å› ä¸º <strong>RocketMQ ä½¿ç”¨çš„æ˜¯ mmap é›¶æ‹·è´æŠ€æœ¯ï¼Œè€Œ kafka ä½¿ç”¨çš„æ˜¯ sendfile</strong>ã€‚<code>kafka</code> ä»¥æ›´å°‘çš„æ‹·è´æ¬¡æ•°ä»¥åŠç³»ç»Ÿå†…æ ¸åˆ‡æ¢æ¬¡æ•°ï¼Œè·å¾—äº†æ›´é«˜çš„æ€§èƒ½ã€‚<br>ä½†é—®é¢˜åˆæ¥äº†ï¼Œä¸ºä»€ä¹ˆ <code>RocketMQ</code> ä¸ä½¿ç”¨ <code>sendfile</code>ï¼Ÿå‚è€ƒ <code>kafka</code> æŠ„ä¸ªä½œä¸šä¹Ÿä¸éš¾å•Šï¼Ÿ<br>æˆ‘ä»¬æ¥çœ‹ä¸‹ <code>sendfile</code> å‡½æ•°é•¿å•¥æ ·ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">ssize_t</span> <span class="token function">sendfile</span><span class="token punctuation">(</span><span class="token keyword">int</span> out_fd<span class="token punctuation">,</span> <span class="token keyword">int</span> in_fd<span class="token punctuation">,</span> <span class="token class-name">off_t</span><span class="token operator">*</span> offset<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// num = sendfile(xxx);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å†æ¥çœ‹ä¸‹ <code>mmap</code> å‡½æ•°é•¿å•¥æ ·ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">mmap</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>addr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">,</span> <span class="token keyword">int</span> prot<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token class-name">off_t</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// buf = mmap(xxx)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ³¨é‡Šé‡Œå†™çš„æ˜¯ä¸¤ä¸ªå‡½æ•°çš„ç”¨æ³•ï¼Œ<code>mmap</code> è¿”å›çš„æ˜¯æ•°æ®çš„<strong>å…·ä½“å†…å®¹</strong>ï¼Œåº”ç”¨å±‚èƒ½è·å–åˆ°æ¶ˆæ¯å†…å®¹å¹¶è¿›è¡Œä¸€äº›é€»è¾‘å¤„ç†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426131.jpeg" title="mmapèƒ½è·å–åˆ°å…·ä½“å†…å®¹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426131.jpeg" alt="mmapèƒ½è·å–åˆ°å…·ä½“å†…å®¹"></a>è€Œ <code>sendfile</code> è¿”å›çš„åˆ™æ˜¯å‘é€æˆåŠŸäº†å‡ ä¸ª<strong>å­—èŠ‚æ•°</strong>ï¼Œ<strong>å…·ä½“å‘äº†ä»€ä¹ˆå†…å®¹ï¼Œåº”ç”¨å±‚æ ¹æœ¬ä¸çŸ¥é“</strong>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426996.jpeg" title="sendfileåªè¿”å›num" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426996.jpeg" alt="sendfileåªè¿”å›num"></a><br>è€Œ <code>RocketMQ</code> çš„ä¸€äº›åŠŸèƒ½ï¼Œå´<strong>éœ€è¦äº†è§£å…·ä½“è¿™ä¸ªæ¶ˆæ¯å†…å®¹</strong>ï¼Œ<strong>æ–¹ä¾¿äºŒæ¬¡æŠ•é€’</strong>ç­‰ï¼Œæ¯”å¦‚å°†æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯é‡æ–°<strong>æŠ•é€’åˆ°æ­»ä¿¡é˜Ÿåˆ—</strong>ä¸­ï¼Œå¦‚æœ <code>RocketMQ</code> ä½¿ç”¨ <code>sendfile</code>ï¼Œé‚£æ ¹æœ¬æ²¡æœºä¼šè·å–åˆ°æ¶ˆæ¯å†…å®¹é•¿ä»€ä¹ˆæ ·å­ï¼Œä¹Ÿå°±æ²¡åŠæ³•å®ç°ä¸€äº›å¥½ç”¨çš„åŠŸèƒ½äº†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426725.jpeg" title="rocketMQæœ‰äºŒæ¬¡æŠ•é€’ç­‰åŠŸèƒ½" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171426725.jpeg" alt="rocketMQæœ‰äºŒæ¬¡æŠ•é€’ç­‰åŠŸèƒ½"></a><br>è€Œ <code>kafka</code> å´æ²¡æœ‰è¿™äº›åŠŸèƒ½ç‰¹æ€§ï¼Œè¿½æ±‚æè‡´æ€§èƒ½ï¼Œæ­£å¥½å¯ä»¥ä½¿ç”¨ <code>sendfile</code>ã€‚</p><p>é™¤äº†é›¶æ‹·è´ä»¥å¤–ï¼Œ<code>kafka</code> é«˜æ€§èƒ½çš„åŸå› è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä»€ä¹ˆæ‰¹å¤„ç†ï¼Œæ•°æ®å‹ç¼©å•¥çš„ï¼Œä½†é‚£äº›ä¼˜åŒ–æ‰‹æ®µ <code>rocketMQ</code> ä¹Ÿéƒ½èƒ½å€Ÿé‰´ä¸€æ³¢ï¼Œå”¯ç‹¬è¿™ä¸ªé›¶æ‹·è´ï¼Œé‚£æ˜¯æ¯«æ— åŠæ³•ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171427354.jpeg" title="Kafkaçš„ä¼˜åŒ–æ‰‹æ®µ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171427354.jpeg" alt="Kafkaçš„ä¼˜åŒ–æ‰‹æ®µ"></a><br>æ‰€ä»¥è¿˜æ˜¯é‚£å¥è¯ï¼Œæ²¡æœ‰ä¸€ç§æ¶æ„æ˜¯å®Œç¾çš„ï¼Œä¸€ç§æ¶æ„å¾€å¾€ç”¨äºé€‚é…æŸäº›åœºæ™¯ï¼Œä½ å¾ˆéš¾åšåˆ°æ—¢è¦åˆè¦è¿˜è¦ã€‚<br>å½“åœºæ™¯ä¸åŒï¼Œæˆ‘ä»¬å°±éœ€è¦åšä¸€äº›å®šåˆ¶åŒ–æ”¹é€ ï¼Œé€šè¿‡ç‰ºç‰²ä¸€éƒ¨åˆ†èƒ½åŠ›å»æ¢å–å¦ä¸€éƒ¨åˆ†èƒ½åŠ›ã€‚<br>åšæ¶æ„ï¼Œåšåˆ°æœ€åéƒ½æ˜¯åœ¨åšæŠ˜ä¸­ã€‚<br>æ˜¯ä¸æ˜¯æ„Ÿè§‰å‡åäº†ã€‚</p><h3 id="kafka-å’Œ-RocketMQ-æ€ä¹ˆé€‰ï¼Ÿ"><a href="#kafka-å’Œ-RocketMQ-æ€ä¹ˆé€‰ï¼Ÿ" class="headerlink" title="kafka å’Œ RocketMQ æ€ä¹ˆé€‰ï¼Ÿ"></a>kafka å’Œ RocketMQ æ€ä¹ˆé€‰ï¼Ÿ</h3><p>è¿™æ—¶å€™å¤§å®¶ä¼°è®¡è¿˜æ˜¯æƒ³çŸ¥é“ <code>kafka</code> å’Œ <code>RocketMQ</code> åˆ°åº•è¯¥æ€ä¹ˆé€‰ï¼Œç”¨å“ªä¸ªã€‚<br>å®˜æ–¹ç‚¹çš„å›ç­”æ˜¯â€è¿™ä¸ªè¦çœ‹åœºæ™¯çš„â€ã€‚è¯´äº†ç­‰äºæ²¡è¯´ã€‚<br>è¿™ä¸æ˜¯æˆ‘çš„é£æ ¼ã€‚<br>æˆ‘çš„æ ‡å‡†åªæœ‰ä¸€ä¸ªï¼Œå¦‚æœæ˜¯å¤§æ•°æ®åœºæ™¯ï¼Œæ¯”å¦‚ä½ èƒ½é¢‘ç¹å¬åˆ° <code>spark</code>ï¼Œ<code>flink</code> è¿™äº›å…³é”®è¯çš„æ—¶å€™ï¼Œé‚£å°±ç”¨ kafkaã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœå…¬å¸ç»„ä»¶æ”¯æŒï¼Œå°½é‡ç”¨ <code>RocketMQ</code>ã€‚</p><p>ç°åœ¨å¤§å®¶é€šäº†å—ï¼Ÿ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><code>RocketMQ</code> å’Œ <code>kafka</code> ç›¸æ¯”ï¼Œåœ¨æ¶æ„ä¸Šåšäº†å‡æ³•ï¼Œåœ¨åŠŸèƒ½ä¸Šåšäº†åŠ æ³•</li><li>è·Ÿ <code>kafka</code> çš„æ¶æ„ç›¸æ¯”ï¼Œ<code>RocketMQ</code> ç®€åŒ–äº†åè°ƒèŠ‚ç‚¹å’Œåˆ†åŒºä»¥åŠå¤‡ä»½æ¨¡å‹ã€‚åŒæ—¶<strong>å¢å¼ºäº†æ¶ˆæ¯è¿‡æ»¤</strong>ã€æ¶ˆæ¯å›æº¯å’Œ<strong>äº‹åŠ¡èƒ½åŠ›</strong>ï¼ŒåŠ å…¥äº†<strong>å»¶è¿Ÿé˜Ÿåˆ—</strong>ï¼Œ<strong>æ­»ä¿¡é˜Ÿåˆ—</strong>ç­‰æ–°ç‰¹æ€§ã€‚</li><li>å‡¡äº‹çš†æœ‰ä»£ä»·ï¼Œ<code>RocketMQ</code> ç‰ºç‰²äº†ä¸€éƒ¨åˆ†æ€§èƒ½ï¼Œæ¢å–äº†æ¯” <code>kafka</code> æ›´å¼ºå¤§çš„åŠŸèƒ½ç‰¹æ€§ã€‚</li></ul><h2 id=""><a href="#" class="headerlink" title=""></a></h2></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆå…­ï¼‰| RocketMQ å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/15036.html"/>
      <url>/posts/15036.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="RocketMQ-å¿«é€Ÿå…¥é—¨"><a href="#RocketMQ-å¿«é€Ÿå…¥é—¨" class="headerlink" title="RocketMQ å¿«é€Ÿå…¥é—¨"></a>RocketMQ å¿«é€Ÿå…¥é—¨</h1><hr><blockquote><p>æœ¬å‚è€ƒé“¾æ¥ï¼š<a href="https://golangguide.top/%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9/RocketMQ%E6%98%AF%E4%BB%80%E4%B9%88.html#%E5%9C%A8%E6%9E%B6%E6%9E%84%E4%B8%8A%E5%81%9A%E5%87%8F%E6%B3%95"><code>RocketMQ</code> æ˜¯ä»€ä¹ˆï¼Ÿ</a><br>åŸä½œè€…ï¼š<a href="https://golangguide.top/" title="å°ç™½debug">å°ç™½debug</a></p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p> ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œå‡è®¾ä½ æœ‰ Aã€B ä¸¤ä¸ªæœåŠ¡ï¼ŒA æœåŠ¡å‘å‡ºæ¶ˆæ¯åï¼Œä¸æƒ³è®© B æœåŠ¡<strong>ç«‹é©¬</strong>å¤„ç†åˆ°ã€‚è€Œæ˜¯è¦<strong>è¿‡åŠå°æ—¶</strong>æ‰è®© B æœåŠ¡å¤„ç†åˆ°ï¼Œè¯¥æ€ä¹ˆå®ç°ï¼Ÿ<br> è¿™ç±»å»¶è¿Ÿå¤„ç†æ¶ˆæ¯çš„åœºæ™¯éå¸¸å¸¸è§ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘æ¯å¤©æ—©ä¸Šåˆ°å…¬å¸åéƒ½ä¼šç‚¹ä¸ªå¤–å–ï¼Œæˆ‘å¸Œæœ›å¤–å–èƒ½åœ¨ä¸­åˆé€è¿‡æ¥ï¼Œè€Œä¸æ˜¯ç«‹é©¬é€è¿‡æ¥ï¼Œè¿™å°±éœ€è¦å°†å¤–å–æ¶ˆæ¯ç»è¿‡å»¶æ—¶åï¼Œå†æŠ•é€’åˆ°å•†å®¶ä¾§ã€‚</p></blockquote><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202428.jpeg" title="å»¶æ—¶æ¶ˆæ¯åœºæ™¯" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202428.jpeg" alt="å»¶æ—¶æ¶ˆæ¯åœºæ™¯"></a></p><h2 id="å»¶æ—¶æ¶ˆæ¯åœºæ™¯"><a href="#å»¶æ—¶æ¶ˆæ¯åœºæ™¯" class="headerlink" title="å»¶æ—¶æ¶ˆæ¯åœºæ™¯"></a>å»¶æ—¶æ¶ˆæ¯åœºæ™¯</h2><p>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œæœ‰æ²¡æœ‰ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Ÿ<br>å½“ç„¶æœ‰ï¼Œ<strong>æ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€å±‚ä¸­é—´å±‚ä¸èƒ½è§£å†³çš„ï¼Œå¦‚æœæœ‰ï¼Œé‚£å°±å†åŠ ä¸€å±‚</strong>ã€‚<br>è¿™æ¬¡æˆ‘ä»¬è¦åŠ çš„ä¸­é—´å±‚æ˜¯æ¶ˆæ¯é˜Ÿåˆ— **<code>RocketMQ</code>**ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202896.jpeg" title="RocketMQ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202896.jpeg" alt="RocketMQ"></a></p><h3 id="RocketMQ-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#RocketMQ-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="RocketMQ æ˜¯ä»€ä¹ˆï¼Ÿ"></a><code>RocketMQ</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>RocketMQ</code> æ˜¯é˜¿é‡Œè‡ªç ”çš„å›½äº§<strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼Œç›®å‰å·²ç»æ˜¯ <code>Apache</code> çš„é¡¶çº§é¡¹ç›®ã€‚å’Œå…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—ä¸€æ ·ï¼Œå®ƒæ¥å—æ¥è‡ª<strong>ç”Ÿäº§è€…</strong>çš„æ¶ˆæ¯ï¼Œå°†æ¶ˆæ¯åˆ†ç±»ï¼Œæ¯ä¸€ç±»æ˜¯ä¸€ä¸ª <strong>topic</strong>ï¼Œ<strong>æ¶ˆè´¹è€…</strong>æ ¹æ®éœ€è¦è®¢é˜… <code>topic</code>ï¼Œè·å–é‡Œé¢çš„æ¶ˆæ¯ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202844.jpeg" title="æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202844.jpeg" alt="æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹"></a></p><p>æ˜¯ä¸æ˜¯å¾ˆåƒæˆ‘ä»¬ä¸Šç¯‡æ–‡ç« é‡Œæåˆ°çš„æ¶ˆæ¯é˜Ÿ <code>Kafka</code>ï¼Œé‚£ä¹ˆé—®é¢˜å¾ˆè‡ªç„¶å°±æ¥äº†ï¼Œ<strong>æ—¢ç„¶éƒ½æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé‚£å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢</strong>ï¼Ÿ</p><h3 id="RocketMQ-å’Œ-Kafka-åŒºåˆ«"><a href="#RocketMQ-å’Œ-Kafka-åŒºåˆ«" class="headerlink" title="RocketMQ å’Œ Kafka åŒºåˆ«"></a><code>RocketMQ</code> å’Œ <code>Kafka</code> åŒºåˆ«</h3><p><code>RocketMQ</code> çš„æ¶æ„å…¶å®å‚è€ƒäº† <code>Kafka</code> çš„è®¾è®¡æ€æƒ³ï¼ŒåŒæ—¶åˆåœ¨ <code>Kafka</code> çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›è°ƒæ•´ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202547.jpeg" title="RocketMQå‚è€ƒKafkaæ¶æ„" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202547.jpeg" alt="RocketMQå‚è€ƒKafkaæ¶æ„"></a></p><p>è¿™äº›è°ƒæ•´ï¼Œç”¨ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼Œâ€<strong>å’Œ Kafka ç›¸æ¯”ï¼ŒRocketMQ åœ¨æ¶æ„ä¸Šåšäº†å‡æ³•ï¼Œåœ¨åŠŸèƒ½ä¸Šåšäº†åŠ æ³•</strong>â€œã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™å¥è¯çš„å«ä¹‰ã€‚</p><h2 id="åœ¨æ¶æ„ä¸Šåšå‡æ³•"><a href="#åœ¨æ¶æ„ä¸Šåšå‡æ³•" class="headerlink" title="åœ¨æ¶æ„ä¸Šåšå‡æ³•"></a>åœ¨æ¶æ„ä¸Šåšå‡æ³•</h2><p>æˆ‘ä»¬æ¥ç®€å•å›é¡¾ä¸‹æ¶ˆæ¯é˜Ÿåˆ— Kafka çš„æ¶æ„ã€‚<br><code>kakfa</code> ä¹Ÿæ˜¯é€šè¿‡å¤šä¸ª <code>topic</code> å¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202917.jpeg" title="topicåˆ†ç±»" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202917.jpeg" alt="topicåˆ†ç±»"></a></p><ul><li>ä¸ºäº†æå‡å•ä¸ª topic çš„å¹¶å‘<strong>æ€§èƒ½</strong>ï¼Œå°†<strong>å•ä¸ª topic</strong> æ‹†ä¸ºå¤šä¸ª <code>partition</code>ã€‚</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202262.jpeg" title="partition" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202262.jpeg" alt="partition"></a></p><ul><li>ä¸ºäº†æå‡ç³»ç»Ÿ<strong>æ‰©å±•æ€§</strong>ï¼Œå°†å¤šä¸ª partition åˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒ <code>broker</code> ä¸Šã€‚</li><li>ä¸ºäº†æå‡ç³»ç»Ÿçš„<strong>å¯ç”¨æ€§</strong>ï¼Œä¸º partition åŠ äº†å¤šä¸ªå‰¯æœ¬ã€‚</li><li>ä¸ºäº†åè°ƒå’Œç®¡ç† Kafka é›†ç¾¤çš„æ•°æ®ä¿¡æ¯ï¼Œå¼•å…¥<code>Zookeeper</code>ä½œä¸ºåè°ƒèŠ‚ç‚¹ã€‚</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202698.jpeg" title="kakfaæ¶æ„" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202698.jpeg" alt="kakfaæ¶æ„"></a></p><p>å¦‚æœä½ å¯¹è¿™äº›ä¾æ—§å¾ˆé™Œç”Ÿï¼Œå¯ä»¥çœ‹çœ‹ä¸Šç¯‡æ–‡ç« ã€Š**<a href="https://www.cnblogs.com/stormling2022/p/18605254">MQç³»åˆ—ï¼ˆäº”ï¼‰|Kafka å¿«é€Ÿå…¥é—¨</a>**ã€‹ã€‚<br>Kafka å·²ç»æ˜¯éå¸¸å¼ºçš„æ¶ˆæ¯é˜Ÿåˆ—äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ <code>RocketMQ</code> åœ¨ Kafka æ¶æ„çš„åŸºç¡€ä¸Šï¼Œè¿˜èƒ½ç©å‡ºä»€ä¹ˆèŠ±æ ·æ¥ã€‚</p><h3 id="ç®€åŒ–åè°ƒèŠ‚ç‚¹"><a href="#ç®€åŒ–åè°ƒèŠ‚ç‚¹" class="headerlink" title="ç®€åŒ–åè°ƒèŠ‚ç‚¹"></a>ç®€åŒ–åè°ƒèŠ‚ç‚¹</h3><blockquote><p>zookeeper å¤ªé‡ ï¼Œnameserver æ›¿ä»£ zookeeper</p></blockquote><p><code>Zookeeper</code> åœ¨ Kafka æ¶æ„ä¸­ä¼šå’Œ broker é€šä¿¡ï¼Œç»´æŠ¤ Kafka é›†ç¾¤ä¿¡æ¯ã€‚ä¸€ä¸ªæ–°çš„ <code>broker</code> è¿ä¸Š <code>Zookeeper</code> åï¼Œå…¶ä»– <code>broker</code> å°±èƒ½ç«‹é©¬æ„ŸçŸ¥åˆ°å®ƒçš„åŠ å…¥ï¼Œåƒè¿™ç§èƒ½åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œè®©å¤šä¸ªå®ä¾‹åŒæ—¶è·å–åˆ°åŒä¸€ä»½ä¿¡æ¯çš„æœåŠ¡ï¼Œå°±æ˜¯æ‰€è°“çš„<strong>åˆ†å¸ƒå¼åè°ƒæœåŠ¡</strong>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202011.jpeg" title="Zookeeperçš„ä½œç”¨" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202011.jpeg" alt="Zookeeperçš„ä½œç”¨"></a><code>Zookeeper</code>çš„ä½œç”¨</p><p>ä½† <code>Zookeeper</code> ä½œä¸ºä¸€ä¸ª<strong>é€šç”¨çš„</strong>åˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼Œå®ƒä¸ä»…å¯ä»¥ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œè¿˜å¯ä»¥ç”¨äºåˆ†å¸ƒå¼é”ã€é…ç½®ç®¡ç†ç­‰åœºæ™¯ã€‚ Kafka å…¶å®åªç”¨åˆ°äº†å®ƒçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå¤šå°‘æœ‰ç‚¹<strong>æ€é¸¡ç”¨ç‰›åˆ€</strong>çš„å‘³é“ã€‚<strong>å¤ªé‡äº†</strong>ã€‚</p><p>æ‰€ä»¥ <code>RocketMQ</code> ç›´æ¥å°† <code>Zookeeper</code> å»æ‰ï¼Œæ¢æˆäº† <strong>nameserver</strong>ï¼Œç”¨ä¸€ç§æ›´è½»é‡çš„æ–¹å¼ï¼Œç®¡ç†æ¶ˆæ¯é˜Ÿåˆ—çš„é›†ç¾¤ä¿¡æ¯ã€‚ç”Ÿäº§è€…é€šè¿‡ nameserver è·å–åˆ° topic å’Œ broker çš„è·¯ç”±ä¿¡æ¯ï¼Œç„¶åå†ä¸ broker é€šä¿¡ï¼Œå®ç°<strong>æœåŠ¡å‘ç°</strong>å’Œ<strong>è´Ÿè½½å‡è¡¡</strong>çš„æ•ˆæœã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171338641.jpeg" title="nameserveræ˜¯ä»€ä¹ˆ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171338641.jpeg" alt="nameserveræ˜¯ä»€ä¹ˆ"></a></p><p>å½“ç„¶ï¼Œå¼€å‘ <code>Kafka</code> çš„å¤§ä½¬ä»¬åæ¥ä¹Ÿæ„è¯†åˆ°äº† <code>Zookeeper</code> è¿‡é‡çš„é—®é¢˜ï¼Œæ‰€ä»¥ä» 2.8.0 ç‰ˆæœ¬å°±æ”¯æŒå°† <code>Zookeeper</code> ç§»é™¤ï¼Œé€šè¿‡ åœ¨ <code>broker</code> ä¹‹é—´åŠ å…¥ä¸€è‡´æ€§ç®—æ³• <code>raft</code> å®ç°åŒæ ·çš„æ•ˆæœï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ <strong><code>KRaft</code></strong> æˆ– <strong><code>Quorum</code></strong> æ¨¡å¼ã€‚</p><blockquote><p>raft ç®—æ³•å¯ä»¥çœ‹ä¸‹è¿™é‡Œï¼š<a href="https://javaguide.cn/distributed-system/protocol/raft-algorithm.html">Raft ç®—æ³•è¯¦è§£ | JavaGuide</a></p></blockquote><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202973.jpeg" title="KRaftæ¨¡å¼" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202973.jpeg" alt="KRaftæ¨¡å¼"></a></p><h3 id="ç®€åŒ–åˆ†åŒº"><a href="#ç®€åŒ–åˆ†åŒº" class="headerlink" title="ç®€åŒ–åˆ†åŒº"></a>ç®€åŒ–åˆ†åŒº</h3><blockquote><p>Queue æ›¿æ¢ partitionï¼Œå¢åŠ ä¸€ä¸ª <code>commitLog</code> ï¼ŒQueueæ”¾æ¶ˆæ¯çš„ç®€è¦ä¿¡æ¯ï¼ˆåŒ…å«æ¶ˆæ¯åç§»é‡ï¼‰ï¼Œ<code>commitLog</code> æ”¾å…·ä½“çš„æ¶ˆæ¯</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>Kafka</code> ä¼šå°† <code>topic</code> æ‹†åˆ†ä¸ºå¤šä¸ª <code>partition</code>ï¼Œç”¨æ¥æå‡<strong>å¹¶å‘æ€§èƒ½</strong>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202431.jpeg" title="partitionæ˜¯ä»€ä¹ˆ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171202431.jpeg" alt="partitionæ˜¯ä»€ä¹ˆ"></a></p><p>åœ¨ <code>RocketMQ</code> é‡Œä¹Ÿä¸€æ ·ï¼Œå°† <code>topic</code> æ‹†åˆ†æˆäº†å¤šä¸ªåˆ†åŒºï¼Œä½†æ¢äº†ä¸ªåå­—ï¼Œå« <strong>Queue</strong>,ä¹Ÿå°±æ˜¯â€<strong>é˜Ÿåˆ—</strong>â€œã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203970.jpeg" title="RocketMQä¸­çš„é˜Ÿåˆ—" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203970.jpeg" alt="RocketMQä¸­çš„é˜Ÿåˆ—"></a></p><p><code>Kafka</code> ä¸­çš„ <code>partition</code> ä¼šå­˜å‚¨<strong>å®Œæ•´</strong>çš„æ¶ˆæ¯ä½“ï¼Œè€Œ <code>RocketMQ</code> çš„ <code>Queue</code> ä¸Šå´åªå­˜ä¸€äº›<strong>ç®€è¦</strong>ä¿¡æ¯ï¼Œæ¯”å¦‚æ¶ˆæ¯åç§» <code>offset</code>ï¼Œè€Œæ¶ˆæ¯çš„å®Œæ•´æ•°æ®åˆ™æ”¾åˆ°â€ä¸€ä¸ªâ€å« <code>commitlog</code> çš„æ–‡ä»¶ä¸Šï¼Œé€šè¿‡ <code>offset</code> æˆ‘ä»¬å¯ä»¥å®šä½åˆ° <code>commitlog</code> ä¸Šçš„æŸæ¡æ¶ˆæ¯ã€‚<br><code>Kafka</code> æ¶ˆè´¹æ¶ˆæ¯ï¼Œ<code>broker</code> åªéœ€è¦ç›´æ¥ä» <code>partition</code> è¯»å–æ¶ˆæ¯è¿”å›å°±å¥½ï¼Œä¹Ÿå°±æ˜¯è¯»ç¬¬<strong>ä¸€æ¬¡</strong>å°±å¤Ÿäº†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203298.jpeg" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203298.jpeg" alt="img"></a></p><p>è€Œåœ¨ <code>RocketMQ</code> ä¸­ï¼Œ<code>broker</code> åˆ™éœ€è¦å…ˆä» <code>Queue</code> ä¸Šè¯»å–åˆ° offset çš„å€¼ï¼Œå†è·‘åˆ° <code>commitlog</code> ä¸Šå°†å®Œæ•´æ•°æ®è¯»å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è¯»<strong>ä¸¤æ¬¡</strong>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203460.jpeg" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171203460.jpeg" alt="img"></a></p><p>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œçœ‹èµ·æ¥ <code>Kafka</code> çš„è®¾è®¡æ›´é«˜æ•ˆï¼Ÿä¸ºä»€ä¹ˆ <code>RocketMQ</code> ä¸é‡‡ç”¨ <code>Kafka</code> çš„è®¾è®¡ï¼Ÿ<br>è¿™å°±ä¸å¾—è¯´ä¸€ä¸‹ Kafka çš„<strong>åº•å±‚å­˜å‚¨</strong>äº†ã€‚</p><h2 id="Kafka-çš„åº•å±‚å­˜å‚¨"><a href="#Kafka-çš„åº•å±‚å­˜å‚¨" class="headerlink" title="Kafka çš„åº•å±‚å­˜å‚¨"></a>Kafka çš„åº•å±‚å­˜å‚¨</h2><blockquote><p>segment å°æ–‡ä»¶</p></blockquote><p><code>Kafka</code> çš„ <code>partition</code> åˆ†åŒºï¼Œå…¶å®åœ¨åº•å±‚ç”±å¾ˆå¤š<strong>æ®µ</strong>ï¼ˆ**<code>segment</code><strong>ï¼‰ç»„æˆï¼Œæ¯ä¸ª <code>segment</code> å¯ä»¥è®¤ä¸ºå°±æ˜¯ä¸ª</strong>å°æ–‡ä»¶**ã€‚å°†æ¶ˆæ¯æ•°æ®å†™å…¥åˆ° <code>partition</code> åˆ†åŒºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å°†æ•°æ®å†™å…¥åˆ°æŸä¸ª <code>segment</code> æ–‡ä»¶ä¸‹ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353496.jpeg" title="segmentæ˜¯ä»€ä¹ˆ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353496.jpeg" alt="segmentæ˜¯ä»€ä¹ˆ"></a></p><h3 id="segmentæ˜¯ä»€ä¹ˆ"><a href="#segmentæ˜¯ä»€ä¹ˆ" class="headerlink" title="segmentæ˜¯ä»€ä¹ˆ"></a>segmentæ˜¯ä»€ä¹ˆ</h3><blockquote><p>å¤šä¸ªsegment æ–‡ä»¶ä¸‹é¡ºåºåˆ—åŠ£åŒ–æˆéšæœºå†™ï¼Œæ€§èƒ½ä¸‹é™æŒ‡æ ‡ï¼š8ä¸ªåˆ†åŒº 64ä¸ª <code>topic</code></p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ“ä½œç³»ç»Ÿçš„æœºæ¢°ç£ç›˜ï¼Œ<strong>é¡ºåºå†™</strong>çš„æ€§èƒ½ä¼šæ¯”<strong>éšæœºå†™</strong>å¿«å¾ˆå¤šï¼Œå·®è·é«˜è¾¾å‡ åå€ã€‚ä¸ºäº†æå‡æ€§èƒ½ï¼Œ<code>Kafka</code> å¯¹æ¯ä¸ªå°æ–‡ä»¶éƒ½æ˜¯é¡ºåºå†™ã€‚<br>å¦‚æœåªæœ‰<strong>ä¸€ä¸ª</strong> <code>segment</code> æ–‡ä»¶ï¼Œé‚£å†™æ–‡ä»¶çš„æ€§èƒ½ä¼šå¾ˆå¥½ã€‚<br>ä½†å½“ <code>topic</code> å˜å¤šä¹‹åï¼Œ<code>topic</code> åº•ä¸‹çš„ <code>partition</code> åˆ†åŒºä¹Ÿä¼šå˜å¤šï¼Œå¯¹åº”çš„ <code>partition</code> åº•ä¸‹çš„ <code>segment</code> æ–‡ä»¶ä¹Ÿä¼šå˜å¤šã€‚åŒæ—¶å†™<strong>å¤šä¸ª</strong> <code>topic</code> åº•ä¸‹çš„ <code>partition</code>ï¼Œå°±æ˜¯åŒæ—¶<strong>å†™å¤šä¸ªæ–‡ä»¶</strong>ï¼Œè™½ç„¶æ¯ä¸ªæ–‡ä»¶å†…éƒ¨éƒ½æ˜¯é¡ºåºå†™ï¼Œä½†å¤šä¸ªæ–‡ä»¶å­˜æ”¾åœ¨ç£ç›˜çš„ä¸åŒåœ°æ–¹ï¼ŒåŸæœ¬<strong>é¡ºåºå†™ç£ç›˜å°±å¯èƒ½åŠ£åŒ–å˜æˆäº†éšæœºå†™</strong>ã€‚äºæ˜¯å†™æ€§èƒ½å°±é™ä½äº†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353184.jpeg" title="é¡ºåºå†™åŠ£åŒ–ä¸ºéšæœºå†™" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353184.jpeg" alt="é¡ºåºå†™åŠ£åŒ–ä¸ºéšæœºå†™"></a></p><p>é‚£é—®é¢˜åˆåˆæ¥äº†ï¼Œç©¶ç«Ÿå¤šå°‘ topic æ‰ç®—å¤šï¼Ÿè¿™ä¸ªçœ‹å®é™…æƒ…å†µï¼Œä½†æ‰“å¤ªæä»æ¥ä¸æ˜¯æˆ‘çš„é£æ ¼ã€‚<br>æˆ‘ç»™ä¸€ä¸ªç»éªŒå€¼<strong>ä»…ä¾›å‚è€ƒ</strong>ï¼Œ8 ä¸ªåˆ†åŒºçš„æƒ…å†µä¸‹ï¼Œè¶…è¿‡ 64 topic, Kafka æ€§èƒ½å°±ä¼šå¼€å§‹ä¸‹é™ã€‚</p><h2 id="RocketMQ-çš„åº•å±‚å­˜å‚¨"><a href="#RocketMQ-çš„åº•å±‚å­˜å‚¨" class="headerlink" title="RocketMQ çš„åº•å±‚å­˜å‚¨"></a><code>RocketMQ</code> çš„åº•å±‚å­˜å‚¨</h2><p>ä¸ºäº†ç¼“è§£åŒæ—¶å†™å¤šä¸ªæ–‡ä»¶å¸¦æ¥çš„éšæœºå†™é—®é¢˜ï¼Œ<code>RocketMQ</code> ç´¢æ€§å°†å•ä¸ª broker åº•ä¸‹çš„å¤šä¸ª topic æ•°æ®ï¼Œå…¨éƒ½å†™åˆ°â€<strong>ä¸€ä¸ª</strong>â€œé€»è¾‘æ–‡ä»¶ <code>CommitLog</code> ä¸Šï¼Œè¿™å°±æ¶ˆé™¤äº†éšæœºå†™å¤šæ–‡ä»¶çš„é—®é¢˜ï¼Œå°†æ‰€æœ‰å†™æ“ä½œéƒ½å˜æˆäº†é¡ºåºå†™ã€‚å¤§å¤§æå‡äº† <code>RocketMQ</code> åœ¨å¤š topic åœºæ™¯ä¸‹çš„å†™æ€§èƒ½ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353601.jpeg" title="CommitLogçš„ä½œç”¨" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353601.jpeg" alt="CommitLogçš„ä½œç”¨"></a><code>CommitLog</code>çš„ä½œç”¨</p><blockquote><p>æ³¨æ„ä¸Šé¢æåˆ°çš„â€<strong>ä¸€ä¸ª</strong>â€œæ˜¯å¸¦å¼•å·çš„ï¼Œè™½ç„¶é€»è¾‘ä¸Šå®ƒæ˜¯ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œä½†å®é™…ä¸Šè¿™ä¸ª <code>CommitLog</code> ç”±å¤šä¸ªå°æ–‡ä»¶ç»„æˆã€‚æ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶è¢«å†™æ»¡åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æ¥ç»§ç»­å­˜å‚¨æ–°çš„æ¶ˆæ¯ã€‚è¿™ç§æ–¹å¼å¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†å’Œæ¸…ç†æ—§çš„æ¶ˆæ¯ã€‚</p></blockquote><h3 id="ç®€åŒ–å¤‡ä»½æ¨¡å‹"><a href="#ç®€åŒ–å¤‡ä»½æ¨¡å‹" class="headerlink" title="ç®€åŒ–å¤‡ä»½æ¨¡å‹"></a>ç®€åŒ–å¤‡ä»½æ¨¡å‹</h3><blockquote><p><code>kafka</code> å°†ä¸»<code>broker</code> ä¸­ <code>partition</code> <strong>åŒæ­¥</strong> <code>segment</code> æ–‡ä»¶æ•°æ®åˆ°åˆ° ä» <code>broker</code>çš„å‰¯æœ¬ <code>partition</code>ä¸‹ <code>segement</code>æ–‡ä»¶</p><p><code>rocketMQ</code> ç›´æ¥åŒæ­¥ä¸» <code>broker</code>ä¸­çš„ <code>commitLog</code> æ–‡ä»¶åˆ° ä» <code>broker</code> ä¸­</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>Kafka</code> ä¼šå°† <code>partition</code> åˆ†æ•£åˆ°å¤šä¸ª <code>broker</code> ä¸­ï¼Œå¹¶ä¸º <code>partition</code> é…ç½®å‰¯æœ¬ï¼Œå°† <code>partition</code> åˆ†ä¸º <code>leader</code>å’Œ <code>follower</code>ï¼Œä¹Ÿå°±æ˜¯<strong>ä¸»å’Œä»</strong>ã€‚<code>broker</code> ä¸­æ—¢å¯èƒ½æœ‰ <strong>A</strong> <code>topic</code> çš„ä¸» <code>partition</code>ï¼Œä¹Ÿå¯èƒ½æœ‰ <strong>B</strong> <code>topic</code> çš„ä» <code>partition</code>ã€‚<br>ä¸»ä» <code>partition</code> ä¹‹é—´ä¼šå»ºç«‹æ•°æ®åŒæ­¥ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åŒæ­¥ <code>partition</code> åº•ä¸‹çš„ <code>segment</code> æ–‡ä»¶æ•°æ®</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353101.jpeg" title="Kafkaä¸»ä»parttionåŒæ­¥æ•°æ®" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353101.jpeg" alt="Kafkaä¸»ä»parttionåŒæ­¥æ•°æ®"></a></p><p><code>RocketMQ</code> å°† <code>broker</code> ä¸Šçš„æ‰€æœ‰ <code>topic</code> æ•°æ®åˆ°å†™åˆ° <code>CommitLog</code> ä¸Šã€‚å¦‚æœè¿˜åƒ <code>Kafka</code> é‚£æ ·ç»™æ¯ä¸ªåˆ†åŒºå•ç‹¬å»ºç«‹åŒæ­¥é€šä¿¡ï¼Œå°±è¿˜å¾—å°† <code>CommitLog</code> é‡Œçš„å†…å®¹<strong>æ‹†å¼€</strong>ï¼Œè¿™å°±è¿˜æ˜¯é€€åŒ–ä¸º<strong>éšæœºè¯»</strong>äº†ã€‚<br>äºæ˜¯ <code>RocketMQ</code> ç´¢æ€§<strong>ä»¥ broker ä¸ºå•ä½åŒºåˆ†ä¸»ä»</strong>ï¼Œä¸»ä»ä¹‹é—´åŒæ­¥ <code>CommitLog</code> æ–‡ä»¶ï¼Œä¿æŒé«˜å¯ç”¨çš„åŒæ—¶ï¼Œä¹Ÿå¤§å¤§ç®€åŒ–äº†å¤‡ä»½æ¨¡å‹ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353848.jpeg" title="RocketMQä¸»ä»brokeråŒæ­¥" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353848.jpeg" alt="RocketMQä¸»ä»brokeråŒæ­¥"></a></p><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ç†Ÿæ‚‰çš„ <code>Kafka</code> æ¶æ„ï¼Œå°±æˆäº† <code>RocketMQ</code> çš„æ¶æ„ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353845.jpeg" title="Kafkaæ¶æ„" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353845.jpeg" alt="Kafkaæ¶æ„"></a></p><p>æ˜¯ä¸æ˜¯è·Ÿ <code>Kafka</code> çš„å¾ˆåƒä½†åˆç®€åŒ–äº†ä¸å°‘ï¼Ÿ</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353940.jpeg" title="RocketMQæ¶æ„" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171353940.jpeg" alt="RocketMQæ¶æ„"></a></p><h2 id="åœ¨åŠŸèƒ½ä¸ŠåšåŠ æ³•"><a href="#åœ¨åŠŸèƒ½ä¸ŠåšåŠ æ³•" class="headerlink" title="åœ¨åŠŸèƒ½ä¸ŠåšåŠ æ³•"></a>åœ¨åŠŸèƒ½ä¸ŠåšåŠ æ³•</h2><p>è™½ç„¶ <code>RocketMQ</code> çš„æ¶æ„æ¯” Kafka çš„ç®€å•ï¼Œä½†åŠŸèƒ½å´æ¯” <code>Kafka</code> è¦æ›´ä¸°å¯Œï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ã€‚</p><h3 id="æ¶ˆæ¯è¿‡æ»¤"><a href="#æ¶ˆæ¯è¿‡æ»¤" class="headerlink" title="æ¶ˆæ¯è¿‡æ»¤"></a>æ¶ˆæ¯è¿‡æ»¤</h3><blockquote><p><code>RocketMQ</code> æ”¯æŒå¯¹æ¶ˆæ¯æ‰“æ ‡ï¼Œæ¶ˆè´¹è€…æ ¹æ® tag è¿‡æ»¤éœ€è¦çš„æ•°æ®ï¼Œæ”¯æŒäºŒçº§åˆ†ç±»</p><p><code>kafka</code> éœ€è¦è·å–å…¨éƒ¨æ¶ˆæ¯ï¼Œå†è¿‡æ»¤å‡ºéœ€è¦çš„æ¶ˆæ¯</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>Kafka</code> æ”¯æŒé€šè¿‡ <code>topic</code> å°†æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚è®¢å•æ•°æ®å’Œç”¨æˆ·æ•°æ®æ˜¯ä¸¤ä¸ªä¸åŒçš„ <code>topic</code>ï¼Œä½†å¦‚æœæˆ‘è¿˜æƒ³<strong>å†è¿›ä¸€æ­¥åˆ†ç±»</strong>å‘¢ï¼Ÿæ¯”å¦‚åŒæ ·æ˜¯ç”¨æˆ·æ•°æ®ï¼Œè¿˜èƒ½æ ¹æ® <code>vip</code> ç­‰çº§è¿›ä¸€æ­¥åˆ†ç±»ã€‚å‡è®¾æˆ‘ä»¬åªéœ€è¦è·å– <code>vip6</code> çš„ç”¨æˆ·æ•°æ®ï¼Œåœ¨ <code>Kafka</code> é‡Œï¼Œæ¶ˆè´¹è€…éœ€è¦æ¶ˆè´¹ <code>topic</code> ä¸ºç”¨æˆ·æ•°æ®çš„<strong>æ‰€æœ‰æ¶ˆæ¯</strong>ï¼Œå†å°† <code>vip6</code> çš„ç”¨æˆ·è¿‡æ»¤å‡ºæ¥ã€‚</p><p>è€Œ <code>RocketMQ</code> æ”¯æŒå¯¹æ¶ˆæ¯æ‰“ä¸Š<strong>æ ‡è®°</strong>ï¼Œä¹Ÿå°±æ˜¯æ‰“ <strong>tag</strong>ï¼Œæ¶ˆè´¹è€…èƒ½æ ¹æ® tag è¿‡æ»¤æ‰€éœ€è¦çš„æ•°æ®ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åœ¨éƒ¨åˆ†æ¶ˆæ¯ä¸Šæ ‡è®° tag=vip6ï¼Œè¿™æ ·æ¶ˆè´¹è€…å°±èƒ½<strong>åªè·å–</strong>è¿™éƒ¨åˆ†æ•°æ®ï¼Œçœä¸‹äº†æ¶ˆè´¹è€…è¿‡æ»¤æ•°æ®æ—¶çš„èµ„æºæ¶ˆè€—ã€‚</p><blockquote><p>ç›¸å½“äº <code>RocketMQ</code> é™¤äº†æ”¯æŒé€šè¿‡ <code>topic</code> è¿›è¡Œä¸€çº§åˆ†ç±»ï¼Œè¿˜æ”¯æŒé€šè¿‡ <code>tag</code> è¿›è¡ŒäºŒçº§åˆ†ç±»ã€‚</p></blockquote><p><a href="https://cdn.xiaobaidebug.top/1716039636534.jpeg" title="tagäºŒçº§è¿‡æ»¤" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1716039636534.jpeg" alt="tagäºŒçº§è¿‡æ»¤"></a></p><h3 id="æ”¯æŒäº‹åŠ¡"><a href="#æ”¯æŒäº‹åŠ¡" class="headerlink" title="æ”¯æŒäº‹åŠ¡"></a>æ”¯æŒäº‹åŠ¡</h3><p>æˆ‘ä»¬çŸ¥é“ <code>Kafka</code> æ”¯æŒäº‹åŠ¡ï¼Œæ¯”å¦‚ç”Ÿäº§è€…å‘ä¸‰æ¡æ¶ˆæ¯ <code>ABC</code>ï¼Œè¿™ä¸‰æ¡æ¶ˆæ¯è¦ä¹ˆåŒæ—¶å‘é€æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å‘é€å¤±è´¥ã€‚</p><p><a href="https://cdn.xiaobaidebug.top/1716039652367.jpeg" title="Kafkaçš„äº‹åŠ¡" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1716039652367.jpeg" alt="Kafkaçš„äº‹åŠ¡"></a><br>æ˜¯ï¼Œè¿™ç¡®å®ä¹Ÿå«äº‹åŠ¡ï¼Œä½†<strong>è·Ÿæˆ‘ä»¬è¦çš„ä¸å¤ªä¸€æ ·</strong>ã€‚</p><p>å†™ä¸šåŠ¡ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´æƒ³è¦çš„äº‹åŠ¡æ˜¯ï¼Œâ€<strong>æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰é€»è¾‘</strong>â€œå’Œâ€<strong>ç”Ÿäº§è€…å‘æ¶ˆæ¯</strong>â€œè¿™ä¸¤ä»¶äº‹ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</p><p>è€Œè¿™æ­£æ˜¯ <code>RocketMQ</code> æ”¯æŒçš„äº‹åŠ¡èƒ½åŠ›ã€‚</p><p><a href="https://cdn.xiaobaidebug.top/1716039663099.jpeg" title="RocketMQçš„äº‹åŠ¡" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1716039663099.jpeg" alt="RocketMQçš„äº‹åŠ¡"></a></p><h3 id="åŠ å…¥å»¶æ—¶é˜Ÿåˆ—"><a href="#åŠ å…¥å»¶æ—¶é˜Ÿåˆ—" class="headerlink" title="åŠ å…¥å»¶æ—¶é˜Ÿåˆ—"></a>åŠ å…¥å»¶æ—¶é˜Ÿåˆ—</h3><blockquote><p><code>kafka</code> å®ç°è´¹åŠ²</p></blockquote><p>å¦‚æœæˆ‘ä»¬å¸Œæœ›æ¶ˆæ¯æŠ•é€’å‡ºå»ä¹‹åï¼Œæ¶ˆè´¹è€…ä¸èƒ½ç«‹é©¬æ¶ˆè´¹åˆ°ï¼Œè€Œæ˜¯è¿‡ä¸ªä¸€å®šæ—¶é—´åæ‰æ¶ˆè´¹ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„<strong>å»¶æ—¶æ¶ˆæ¯</strong>ï¼Œå°±åƒæ–‡ç« å¼€å¤´çš„å®šæ—¶å¤–å–é‚£æ ·ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Kafkaï¼Œ è¦å®ç°ç±»ä¼¼çš„åŠŸèƒ½çš„è¯ï¼Œå°±ä¼šå¾ˆè´¹åŠ²ã€‚<br>ä½† <code>RocketMQ</code> å¤©ç„¶æ”¯æŒ<strong>å»¶æ—¶é˜Ÿåˆ—</strong>ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿å®ç°è¿™ä¸€åŠŸèƒ½ã€‚</p><h3 id="åŠ å…¥æ­»ä¿¡é˜Ÿåˆ—"><a href="#åŠ å…¥æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="åŠ å…¥æ­»ä¿¡é˜Ÿåˆ—"></a>åŠ å…¥æ­»ä¿¡é˜Ÿåˆ—</h3><blockquote><p><code>kafka</code> åŸç”Ÿä¸æ”¯æŒ</p></blockquote><p>æ¶ˆè´¹æ¶ˆæ¯æ˜¯æœ‰å¯èƒ½å¤±è´¥çš„ï¼Œå¤±è´¥åä¸€èˆ¬å¯ä»¥è®¾ç½®<strong>é‡è¯•</strong>ã€‚å¦‚æœå¤šæ¬¡é‡è¯•å¤±è´¥ï¼Œ<code>RocketMQ</code> ä¼šå°†æ¶ˆæ¯æ”¾åˆ°ä¸€ä¸ªä¸“é—¨çš„é˜Ÿåˆ—ï¼Œæ–¹ä¾¿æˆ‘ä»¬<strong>åé¢å•ç‹¬å¤„ç†</strong>ã€‚è¿™ç§ä¸“é—¨å­˜æ”¾å¤±è´¥æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼Œå°±æ˜¯<strong>æ­»ä¿¡é˜Ÿåˆ—</strong>ã€‚<br>Kafka åŸç”Ÿä¸æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°ã€‚</p><h3 id="æ¶ˆæ¯å›æº¯"><a href="#æ¶ˆæ¯å›æº¯" class="headerlink" title="æ¶ˆæ¯å›æº¯"></a>æ¶ˆæ¯å›æº¯</h3><blockquote><p><code>kafka</code> è°ƒæ•´<code>offset</code></p><p><code>rocketMQ</code> è¿˜å¯ä»¥è°ƒæ•´æ—¶é—´</p></blockquote><p>Kafka æ”¯æŒé€šè¿‡<strong>è°ƒæ•´ offset</strong> æ¥è®©æ¶ˆè´¹è€…ä»æŸä¸ªåœ°æ–¹å¼€å§‹æ¶ˆè´¹ï¼Œè€Œ <code>RocketMQ</code>ï¼Œé™¤äº†å¯ä»¥è°ƒæ•´ offset, è¿˜æ”¯æŒ<strong>è°ƒæ•´æ—¶é—´</strong>ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><code>RocketMQ</code> å’Œ <code>Kafka</code> ç›¸æ¯”ï¼Œåœ¨æ¶æ„ä¸Šåšäº†å‡æ³•ï¼Œåœ¨åŠŸèƒ½ä¸Šåšäº†åŠ æ³•</li><li>è·Ÿ Kafka çš„æ¶æ„ç›¸æ¯”ï¼Œ<code>RocketMQ</code> ç®€åŒ–äº†åè°ƒèŠ‚ç‚¹å’Œåˆ†åŒºä»¥åŠå¤‡ä»½æ¨¡å‹ã€‚åŒæ—¶å¢å¼ºäº†æ¶ˆæ¯è¿‡æ»¤ã€æ¶ˆæ¯å›æº¯å’Œäº‹åŠ¡èƒ½åŠ›ï¼ŒåŠ å…¥äº†å»¶è¿Ÿé˜Ÿåˆ—ï¼Œæ­»ä¿¡é˜Ÿåˆ—ç­‰æ–°ç‰¹æ€§</li></ul><h2 id="å»¶ä¼¸"><a href="#å»¶ä¼¸" class="headerlink" title="å»¶ä¼¸"></a>å»¶ä¼¸</h2><p>æœ€åé—ç•™ä¸€ä¸ªé—®é¢˜ã€‚<br>ç°åœ¨çœ‹èµ·æ¥ï¼Œ<code>RocketMQ</code> å¥½åƒå„æ–¹é¢éƒ½æ¯” <code>Kafka</code> æ›´èƒ½æ‰“ã€‚<br>ä½† <code>Kafka</code> å´ä¸€ç›´æ²¡è¢«æ·˜æ±°ï¼Œè¯´æ˜ <code>RocketMQ</code> å¿…ç„¶æ˜¯æœ‰ç€ä¸å¦‚ <code>Kafka</code> çš„åœ°æ–¹ã€‚<br>æ˜¯å•¥å‘¢ï¼Ÿ<br><strong>æ€§èƒ½</strong>ï¼Œä¸¥æ ¼æ¥è¯´æ˜¯<strong>ååé‡</strong>ã€‚<br>è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œ**ä¸ºä»€ä¹ˆ <code>RocketMQ</code> å‚è€ƒäº† Kafka çš„æ¶æ„ï¼Œæ€§èƒ½å´è¿˜ä¸å¦‚ <code>Kafka</code>**ï¼Ÿ</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆäº”ï¼‰| Kafka å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/24869.html"/>
      <url>/posts/24869.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Kafka-å¿«é€Ÿå…¥é—¨ä»‹ç»"><a href="#Kafka-å¿«é€Ÿå…¥é—¨ä»‹ç»" class="headerlink" title="Kafka å¿«é€Ÿå…¥é—¨ä»‹ç»"></a>Kafka å¿«é€Ÿå…¥é—¨ä»‹ç»</h1><blockquote><p>å‚è€ƒï¼š<a href="https://golangguide.top/%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9/kafka%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E6%9E%B6%E6%9E%84%E6%98%AF%E6%80%8E%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F.html#%E6%80%BB%E7%BB%93">Kafka æ˜¯ä»€ä¹ˆï¼Ÿ</a></p></blockquote><h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><p>ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œé«˜æ‰©å±•æ€§ï¼Œé«˜å¯ç”¨ï¼Œæ”¯æŒæŒä¹…åŒ–çš„è¶…å¼ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ¶ˆæ¯é˜Ÿåˆ— <strong>Kafka</strong><br><code>Zookeeper</code> åè°ƒç®¡ç†å¤šä¸ª broker ç»„æˆï¼Œå†…éƒ¨æœ‰å¤šä¸ª <code>topic</code> åˆ†ç±»ï¼Œæ¯ä¸ª <code>topic</code> åˆåˆ†æˆå¤šä¸ª <code>partition</code> ï¼Œæ¯ä¸ª <code>partition</code> æœ‰å¤šä¸ªå‰¯æœ¬ repliaï¼Œä¸åŒçš„<code>partition</code> ä¼šåˆ†å¸ƒåœ¨ä¸åŒ <code>broker</code> ä¸Šï¼Œæå‡æ€§èƒ½åŒæ—¶ï¼Œè¿˜å¢åŠ äº†ç³»ç»Ÿå¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§</p><p><a href="https://cdn.xiaobaidebug.top/1713672461143.jpeg" title="Kafkaæ˜¯ä»€ä¹ˆ" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672461143.jpeg" alt="Kafkaæ˜¯ä»€ä¹ˆ"></a></p><h2 id="é«˜æ€§èƒ½"><a href="#é«˜æ€§èƒ½" class="headerlink" title="é«˜æ€§èƒ½"></a>é«˜æ€§èƒ½</h2><p><a href="https://cdn.xiaobaidebug.top/1713672053390.jpeg" title="å¢åŠ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672053390.jpeg" alt="å¢åŠ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…"></a></p><p>å¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ï¼Œæ¯ä¸ªç±»æ˜¯ä¸€ä¸ª topic</p><p><a href="https://cdn.xiaobaidebug.top/1713672075754.jpeg" title="å¤šä¸ªtopic" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672075754.jpeg" alt="å¤šä¸ªtopic"></a></p><p>å•ä¸ª <code>topic</code> çš„æ¶ˆæ¯å¯èƒ½è¿‡å¤šï¼Œå¯å°†å•ä¸ªé˜Ÿåˆ—æ‹†åˆ†æˆå¤šä¸ªæ®µï¼Œæ¯æ®µå°±æ˜¯ä¸€ä¸ª<strong>åˆ†åŒº partition</strong> ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£ä¸€ä¸ª <code>partition</code></p><p><a href="https://cdn.xiaobaidebug.top/1713672107754.jpeg" title="partition" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672107754.jpeg" alt="partition"></a></p><h2 id="é«˜æ‰©å±•æ€§"><a href="#é«˜æ‰©å±•æ€§" class="headerlink" title="é«˜æ‰©å±•æ€§"></a>é«˜æ‰©å±•æ€§</h2><p>å¯å°† <code>partition</code> åˆ†éƒ¨åœ¨å¤šå°è®¾å¤‡ï¼Œæ¯å°è®¾å¤‡ä»£è¡¨ä¸€ä¸ª <code>broker</code></p><p><a href="https://cdn.xiaobaidebug.top/1713672180019.jpeg" title="broker" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672180019.jpeg" alt="broker"></a></p><h2 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h2><p>å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ª<code>partition</code>æ‰€åœ¨çš„ <code>broker</code> æŒ‚äº†ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†çš„æ¶ˆæ¯ä¸ä¹…ä¸¢å¤±äº†å—ï¼Ÿ</p><p>å¯ä»¥ç»™<code>partition</code> å¤šåŠ å‡ ä¸ªå‰¯æœ¬ <code>replica</code>ï¼Œä»ä¸­åˆ†ä¸º <code>Leader</code> å’Œ <code>Follower</code>ï¼Œ<code>Leader</code> è´Ÿè´£ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„è¯»å†™ï¼Œ<code>Follower</code> è´Ÿè´£åŒæ­¥æ•°æ®</p><p><a href="https://cdn.xiaobaidebug.top/1713672211341.jpeg" title="replicas" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672211341.jpeg" alt="replicas"></a></p><p>å°†<code>Leader</code> å’Œ <code>Follower</code> åˆ†æ•£åœ¨ä¸åŒçš„ <code>broker</code> ä¸Šï¼Œè¿™æ ·å¦‚æœ <code>Leader</code>æ‰€åœ¨çš„<code>broker</code> æŒ‚äº†ï¼Œä¹Ÿä¸å½±å“ <code>Follower</code>æ‰€åœ¨çš„<code>broker</code>ï¼Œè¿˜èƒ½ä» <code>Followe</code> é€‰ä¸¾æ–°çš„<code>Leader partition</code> é¡¶ä¸Š</p><p><a href="https://cdn.xiaobaidebug.top/1713672217821.jpeg" title="é«˜å¯ç”¨" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672217821.jpeg" alt="é«˜å¯ç”¨"></a></p><h2 id="æŒä¹…åŒ–è¿‡æœŸç­–ç•¥"><a href="#æŒä¹…åŒ–è¿‡æœŸç­–ç•¥" class="headerlink" title="æŒä¹…åŒ–è¿‡æœŸç­–ç•¥"></a>æŒä¹…åŒ–è¿‡æœŸç­–ç•¥</h2><p>å‡è®¾æ‰€æœ‰ <code>broker</code> éƒ½æŒ‚äº†ï¼Œé‚£å²‚ä¸æ˜¯æ•°æ®å…¨ä¸¢äº†ï¼Ÿ<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸èƒ½å…‰æŠŠæ•°æ®æ”¾å†…å­˜é‡Œï¼Œè¿˜è¦<strong>æŒä¹…åŒ–</strong>åˆ°ç£ç›˜ä¸­ï¼Œè¿™æ ·å“ªæ€•å…¨éƒ¨ <code>broker</code> éƒ½æŒ‚äº†ï¼Œæ•°æ®ä¹Ÿä¸ä¼šå…¨ä¸¢ï¼Œé‡å¯æœåŠ¡åï¼Œä¹Ÿèƒ½ä»<strong>ç£ç›˜é‡Œè¯»å‡ºæ•°æ®</strong>ï¼Œç»§ç»­å·¥ä½œã€‚</p><p><a href="https://cdn.xiaobaidebug.top/1713672282194.jpeg" title="æŒä¹…åŒ–" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672282194.jpeg" alt="æŒä¹…åŒ–"></a></p><p>ç£ç›˜æ€»æ˜¯æœ‰é™çš„ï¼Œæä¾›ä¿ç•™ç­–ç•¥ <code>retention policy</code>ï¼Œæ•°æ®è¶…è¿‡å¤§å°æˆ–è€…æ—¶é—´æ¸…ç†æ‰</p><h2 id="æ¶ˆè´¹è€…ç»„-Comsumer-Group"><a href="#æ¶ˆè´¹è€…ç»„-Comsumer-Group" class="headerlink" title="æ¶ˆè´¹è€…ç»„ Comsumer Group"></a>æ¶ˆè´¹è€…ç»„ Comsumer Group</h2><ul><li>æ¯æ¬¡æ–°å¢çš„æ¶ˆè´¹è€…åªèƒ½è·Ÿç€<strong>æœ€æ–°çš„</strong>æ¶ˆè´¹ Offset æ¥ç€æ¶ˆè´¹</li><li>å“ªæ€• B æœåŠ¡æœ‰å¤šä¸ªå®ä¾‹ï¼Œä½†æœ¬è´¨ä¸Šï¼Œå®ƒåªæœ‰ä¸€ä¸ªæ¶ˆè´¹ä¸šåŠ¡æ–¹ï¼Œæ–°å¢å®ä¾‹ä¸€èˆ¬ä¹Ÿæ˜¯æ¥ç€ä¹‹å‰çš„ <code>offset</code> ç»§ç»­æ¶ˆè´¹</li><li>å‡è®¾ç°åœ¨æ¥äº†ä¸ªæ–°çš„ä¸šåŠ¡æ–¹ï¼ŒC æœåŠ¡ï¼Œå®ƒæƒ³ä»å¤´å¼€å§‹æ¶ˆè´¹æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ•°æ®ï¼Œè¿™æ—¶å€™å°±ä¸èƒ½è·Ÿåœ¨ B æœåŠ¡çš„ <code>offset</code> åè¾¹ç»§ç»­æ¶ˆè´¹äº†</li></ul><p>æ¶ˆæ¯é˜Ÿåˆ—åŠ å…¥æ¶ˆè´¹è€…ç»„ï¼ˆ<code>consumer group</code>ï¼‰çš„æ¦‚å¿µï¼ŒB å’Œ C æœåŠ¡å„è‡ªæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆè´¹è€…ç»„ï¼Œä¸åŒæ¶ˆè´¹è€…ç»„ç»´æŠ¤è‡ªå·±çš„æ¶ˆè´¹è¿›åº¦ï¼Œäº’ä¸æ‰“æ…</p><p><a href="https://cdn.xiaobaidebug.top/1713672430656.jpeg" title="æ¶ˆè´¹è€…ç»„äº’ç›¸ç‹¬ç«‹" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672430656.jpeg" alt="æ¶ˆè´¹è€…ç»„äº’ç›¸ç‹¬ç«‹"></a></p><h2 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h2><p> <strong>ZooKeeper</strong> ç»„ä»¶ã€‚å®ƒä¼šå®šæœŸå’Œ broker é€šä¿¡ï¼Œè·å– æ•´ä¸ª kafka é›†ç¾¤çš„çŠ¶æ€ï¼Œä»¥æ­¤åˆ¤æ–­ æŸäº› broker æ˜¯ä¸æ˜¯è·ªäº†ï¼ŒæŸäº›æ¶ˆè´¹ç»„æ¶ˆè´¹åˆ°å“ªäº†ã€‚</p><p><a href="https://cdn.xiaobaidebug.top/1713672523963.jpeg" title="åŠ å…¥ZooKeeper" class="gallery-item"><img src="https://cdn.xiaobaidebug.top/1713672523963.jpeg" alt="åŠ å…¥ZooKeeper"></a></p><h2 id="kafka-çš„åº”ç”¨åœºæ™¯"><a href="#kafka-çš„åº”ç”¨åœºæ™¯" class="headerlink" title="kafka çš„åº”ç”¨åœºæ™¯"></a><code>kafka</code> çš„åº”ç”¨åœºæ™¯</h2><p>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶æ„ä¸­æœ€å¸¸è§çš„ä¸­é—´ä»¶ä¹‹ä¸€ï¼Œä½¿ç”¨åœºæ™¯ä¹‹å¤šï¼Œå ªç§°ä¸‡é‡‘æ²¹ï¼</p><ul><li><strong>å‰Šå³°å¡«è°·ï¼š</strong>ä¸Šæ¸¸æµé‡å¿½é«˜å¿½ä½ï¼Œæƒ³è¦æå‡ <code>cpu/gpu</code> åˆ©ç”¨ç‡</li><li><strong>é™ä½ç³»ç»Ÿè€¦åˆï¼š</strong> ç³»ç»Ÿè¿‡å¤§ï¼Œæ¶ˆæ¯æµå‘ç›˜æ ¹é”™èŠ‚ï¼Œæƒ³è¦æ‹†è§£ç»„ä»¶</li><li><strong>ä¿æŠ¤æœåŠ¡ï¼š</strong>å†æ¯”å¦‚ç§’æ€æ´»åŠ¨ï¼Œè¯·æ±‚æ¿€å¢ï¼Œä¿æŠ¤æœåŠ¡å°½é‡ä¸å½±å“ç”¨æˆ·</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><code>kafka</code> æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåƒæ¶ˆæ¯é˜Ÿåˆ—æŠ•é€’æ¶ˆæ¯çš„æ˜¯ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹æ¶ˆæ¯çš„æ˜¯æ¶ˆè´¹è€…ã€‚å¢åŠ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å®ä¾‹ä¸ªæ•°å¯ä»¥æå‡ç³»ç»Ÿååã€‚å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥ç»„æˆä¸€ä¸ªæ¶ˆè´¹è€…ç»„ï¼Œä¸åŒæ¶ˆè´¹è€…ç»„ç»´æŠ¤è‡ªå·±çš„æ¶ˆè´¹è¿›åº¦ï¼Œäº’ä¸æ‰“æ…ã€‚</li><li><code>kafka</code> å°†æ¶ˆæ¯åˆ†ä¸ºå¤šä¸ª <code>topic</code>ï¼Œæ¯ä¸ª <code>topic</code> å†…éƒ¨æ‹†åˆ†ä¸ºå¤šä¸ª <code>partition</code>ï¼Œæ¯ä¸ª <code>partition</code> åˆæœ‰è‡ªå·±çš„å‰¯æœ¬ï¼Œä¸åŒçš„ <code>partition</code> ä¼šåˆ†å¸ƒåœ¨ä¸åŒçš„ <code>broker</code> ä¸Šï¼Œæå‡æ€§èƒ½çš„åŒæ—¶ï¼Œè¿˜å¢åŠ äº†ç³»ç»Ÿå¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚</li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆå››ï¼‰| RabbitMQ æ­»ä¿¡é˜Ÿåˆ—å’Œå»¶è¿Ÿé˜Ÿåˆ—</title>
      <link href="/posts/40901.html"/>
      <url>/posts/40901.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a>æ­»ä¿¡é˜Ÿåˆ—</h1><h2 id="æ­»ä¿¡æ˜¯ä»€ä¹ˆ"><a href="#æ­»ä¿¡æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ­»ä¿¡æ˜¯ä»€ä¹ˆ"></a>æ­»ä¿¡æ˜¯ä»€ä¹ˆ</h2><p>æ­»ä¿¡ï¼šæ— æ³•è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚ç”±äºç‰¹å®šçš„åŸå› å¯¼è‡´é˜Ÿåˆ—ä¸­çš„æŸäº›æ¶ˆæ¯æ— æ³•è¢«æ¶ˆè´¹ï¼Œè¿™äº›æ¶ˆæ¯æ²¡æœ‰åç»­çš„å¤„ç†ï¼Œå°±ä¼šå˜æˆæ­»ä¿¡ã€‚å½“æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹æ—¶ï¼Œä¼šè¢«å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚</p><h2 id="æ­»ä¿¡æ¥æº"><a href="#æ­»ä¿¡æ¥æº" class="headerlink" title="æ­»ä¿¡æ¥æº"></a>æ­»ä¿¡æ¥æº</h2><p>æ¶ˆæ¯ TTL<br>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦<br>æ¶ˆæ¯æ‹’ç­¾(<code>basicNack</code> æˆ– <code>basicReject</code>)ä¸”é‡å…¥é˜Ÿåˆ—ä¸º<code>false</code>(<code>requeue=false)</code></p><h2 id="æ­»ä¿¡æ¶æ„"><a href="#æ­»ä¿¡æ¶æ„" class="headerlink" title="æ­»ä¿¡æ¶æ„"></a>æ­»ä¿¡æ¶æ„</h2><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840091.png" title="image-20241211220211008" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840091.png" alt="image-20241211220211008"></a> </p><h3 id="æ¶ˆæ¯TTL"><a href="#æ¶ˆæ¯TTL" class="headerlink" title="æ¶ˆæ¯TTL"></a>æ¶ˆæ¯TTL</h3><table><thead><tr><th>åç§°</th><th>äº¤æ¢æœº</th><th>è·¯ç”±é”®</th><th>ç±»å‹</th><th>ç‰¹å¾</th><th>å‚æ•°</th></tr></thead><tbody><tr><td>æ™®é€šäº¤æ¢æœº</td><td>normal_exchange</td><td><code>zhangsan</code></td><td>direct</td><td>/</td><td>/</td></tr><tr><td>æ™®é€šé˜Ÿåˆ—</td><td>normal_queue</td><td><code>zhangsan</code></td><td>/</td><td>TTL DLX DLK</td><td><code>x-dead-letter-exchange</code>ï¼š<code>dead_exchange</code><br /><code>x-dead-letter-routing-key</code>ï¼š<code>lisi</code><br /><code>x-message-ttl</code>: <code>10 * 1000</code></td></tr><tr><td>æ­»ä¿¡äº¤æ¢æœº</td><td>dead_exchange</td><td><code>lisi</code></td><td>direct</td><td>/</td><td>/</td></tr><tr><td>æ­»ä¿¡é˜Ÿåˆ—</td><td>dead_queue</td><td><code>lisi</code></td><td>/</td><td>/</td><td>/</td></tr></tbody></table><p>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯10æ¡æ¶ˆæ¯åˆ°é˜Ÿåˆ— <code>normal-queue</code>ï¼Œæ¶ˆè´¹è€…C1å…³é—­ä¸å»æ¶ˆè´¹ï¼Œæ¶ˆæ¯å­˜æ´»æ—¶é—´10såˆ°åï¼Œ10æ¡æ¶ˆæ¯è¿›å»æ­»ä¿¡é˜Ÿåˆ— <code>dead-queue</code>ï¼Œ</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840525.png" title="image-20241211220303413" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840525.png" alt="image-20241211220303413"></a> </p><p>æ¶ˆè´¹ç«¯<code>C2</code>å¼€å¯ï¼Œå¼€å§‹æ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840940.png" title="image-20241211222528449" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141840940.png" alt="image-20241211222528449"></a> </p><h3 id="æ¶ˆæ¯è¢«æ‹’"><a href="#æ¶ˆæ¯è¢«æ‹’" class="headerlink" title="æ¶ˆæ¯è¢«æ‹’"></a>æ¶ˆæ¯è¢«æ‹’</h3><p>æ ¸å¿ƒä»£ç ï¼šåœ¨æ¥æ”¶æ¶ˆæ¯çš„åœ°æ–¹  </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æ¶ˆæ¯æ‹’ç­¾ requeue è®¾ç½® false è¡¨ç¤ºä¸é‡å…¥é˜Ÿ</span>channel<span class="token punctuation">.</span><span class="token function">basicReject</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">//æ¶ˆæ¯ä¸ç¡®è®¤ï¼Œmultiple=false ä¸æ‰¹é‡ requeue=false ä¸é‡å…¥é˜Ÿ</span><span class="token comment">//channel.basicNack(deliveryTag,false,false)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å‘é€10æ¡æ¶ˆæ¯åˆ°é˜Ÿåˆ—</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841649.png" title="image-20241211225554204" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841649.png" alt="image-20241211225554204"></a> </p><p> æ¶ˆè´¹ç«¯C2æ‹’ç»ä¸€æ¡æ¶ˆæ¯</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841516.png" title="image-20241211230004126" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841516.png" alt="image-20241211230004126"></a> </p><h3 id="é˜Ÿåˆ—å¤§å°æœ€å¤§é•¿åº¦"><a href="#é˜Ÿåˆ—å¤§å°æœ€å¤§é•¿åº¦" class="headerlink" title="é˜Ÿåˆ—å¤§å°æœ€å¤§é•¿åº¦"></a>é˜Ÿåˆ—å¤§å°æœ€å¤§é•¿åº¦</h3><p>å°† <code>x-message-ttl</code> å±æ€§æ”¹æˆ <code>x-max-length : 6</code>ï¼Œé‡æ–°å¯åŠ¨ï¼Œå‘é€10ä¸ªæ¶ˆæ¯ï¼Œæ­»ä¿¡é˜Ÿåˆ—æ¥æ”¶åˆ°4ä¸ªæ¶ˆæ¯</p><table><thead><tr><th>åç§°</th><th>äº¤æ¢æœº</th><th>è·¯ç”±é”®</th><th>ç±»å‹</th><th>ç‰¹å¾</th><th>å‚æ•°</th></tr></thead><tbody><tr><td>æ™®é€šé˜Ÿåˆ—</td><td>normal_queue</td><td><code>zhangsan</code></td><td>/</td><td>TTL DLX DLK</td><td><code>x-dead-letter-exchange</code>ï¼š<code>dead_exchange</code><br /><code>x-dead-letter-routing-key</code>ï¼š<code>lisi</code><br /><code>x-max-length</code>: <code>6</code></td></tr></tbody></table><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841306.png" title="image-20241211223706816" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841306.png" alt="image-20241211223706816"></a> </p><h1 id="å»¶è¿Ÿé˜Ÿåˆ—"><a href="#å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—"></a>å»¶è¿Ÿé˜Ÿåˆ—</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><pre><code>å»¶è¿Ÿé˜Ÿåˆ—,é˜Ÿåˆ—**å†…éƒ¨æ˜¯æœ‰åº**çš„ï¼Œæœ€é‡è¦çš„ç‰¹æ€§å°±ä½“ç°åœ¨å®ƒçš„å»¶æ—¶å±æ€§ä¸Šï¼Œå»¶æ—¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯å¸Œæœ› åœ¨æŒ‡å®šæ—¶é—´åˆ°äº†**ä»¥åæˆ–ä¹‹å‰å–å‡ºå’Œå¤„**ç†ï¼Œç®€å•æ¥è¯´ï¼Œå»¶æ—¶é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥å­˜æ”¾éœ€è¦**åœ¨æŒ‡å®šæ—¶é—´è¢«å¤„ç†**çš„å…ƒç´ çš„é˜Ÿåˆ—ã€‚</code></pre><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><ol><li>è®¢å•åœ¨ååˆ†é’Ÿä¹‹å†…æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆ  </li><li>æ–°åˆ›å»ºçš„åº—é“ºï¼Œå¦‚æœåœ¨åå¤©å†…éƒ½æ²¡æœ‰ä¸Šä¼ è¿‡å•†å“ï¼Œåˆ™è‡ªåŠ¨å‘é€æ¶ˆæ¯æé†’ã€‚  </li><li>ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰ç™»é™†åˆ™è¿›è¡ŒçŸ­ä¿¡æé†’ã€‚  </li><li>ç”¨æˆ·å‘èµ·é€€æ¬¾ï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰å¾—åˆ°å¤„ç†åˆ™é€šçŸ¥ç›¸å…³è¿è¥äººå‘˜ã€‚ </li><li>é¢„å®šä¼šè®®åï¼Œéœ€è¦åœ¨é¢„å®šçš„æ—¶é—´ç‚¹å‰ååˆ†é’Ÿé€šçŸ¥å„ä¸ªä¸ä¼šäººå‘˜å‚åŠ ä¼šè®®</li></ol><h3 id="åˆ†æåœºæ™¯ç‰¹ç‚¹ï¼šX-äº‹ä»¶å‘ç”Ÿä¹‹åä¹‹å‰-X-æ—¶é—´å®Œæˆ-X-ä»»åŠ¡"><a href="#åˆ†æåœºæ™¯ç‰¹ç‚¹ï¼šX-äº‹ä»¶å‘ç”Ÿä¹‹åä¹‹å‰-X-æ—¶é—´å®Œæˆ-X-ä»»åŠ¡" class="headerlink" title="åˆ†æåœºæ™¯ç‰¹ç‚¹ï¼šX äº‹ä»¶å‘ç”Ÿä¹‹åä¹‹å‰ X æ—¶é—´å®Œæˆ X ä»»åŠ¡"></a>åˆ†æåœºæ™¯ç‰¹ç‚¹ï¼šX äº‹ä»¶å‘ç”Ÿä¹‹åä¹‹å‰ X æ—¶é—´å®Œæˆ X ä»»åŠ¡</h3><p>å®šæ—¶è½®è¯¢ï¼šå¯èƒ½å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†å¦‚æœçŸ­æœŸæ•°æ®é‡å¾ˆå¤šï¼Œæ´»åŠ¨æœŸé—´ç”šè‡³ç™¾ä¸‡åƒä¸‡çš„æ•°æ®ï¼Œè½®è¯¢å°±ä¸èƒ½è§£å†³äº†    </p><ul><li><p>â˜‘ï¸è´¦å•ä¸€å‘¨è´¦å•æœªç»“ç®—çš„è‡ªåŠ¨ç»“ç®— </p></li><li><p>âŒè®¢å•ååˆ†é’Ÿå†…æœªæ”¯ä»˜åˆ™å…³é—­</p></li></ul><h2 id="RabbitMQ-TTL"><a href="#RabbitMQ-TTL" class="headerlink" title="RabbitMQ TTL"></a>RabbitMQ TTL</h2><pre><code>æœ€å¤§å­˜æ´»æ—¶é—´ `TTLï¼š Time to Live`ï¼Œ`RabbitMQ` ä¸­**æ¶ˆæ¯**æˆ–**é˜Ÿåˆ—**çš„å±æ€§ï¼Œè¡¨é¢æ¶ˆæ¯æˆ–é˜Ÿåˆ—çš„**æœ€å¤§å­˜æ´»æ—¶é—´**å¦‚æœä¸€æ¡æ¶ˆæ¯è®¾ç½®äº† `TTL` å±æ€§æˆ–è€…è¿›å…¥äº†è®¾ç½®`TTL` å±æ€§çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™ æ¡æ¶ˆæ¯å¦‚æœåœ¨`TTL` è®¾ç½®çš„æ—¶é—´å†…æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™ä¼šæˆä¸º&quot;æ­»ä¿¡&quot;ã€‚å¦‚æœåŒæ—¶é…ç½®äº†é˜Ÿåˆ—çš„TTL å’Œæ¶ˆæ¯çš„ `TTL`ï¼Œé‚£ä¹ˆè¾ƒå°çš„é‚£ä¸ªå€¼å°†ä¼šè¢«ä½¿ç”¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼è®¾ç½® `TTL`ã€‚</code></pre><h3 id="æ¶ˆæ¯-TTL"><a href="#æ¶ˆæ¯-TTL" class="headerlink" title="æ¶ˆæ¯ TTL"></a>æ¶ˆæ¯ TTL</h3><p>å¦ä¸€ç§æ–¹å¼ä¾¿æ˜¯é’ˆå¯¹æ¯æ¡æ¶ˆæ¯è®¾ç½®TTL</p><p> <a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841893.png" title="image-20241212115827412" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841893.png" alt="image-20241212115827412"></a></p><h3 id="é˜Ÿåˆ—-TTL"><a href="#é˜Ÿåˆ—-TTL" class="headerlink" title="é˜Ÿåˆ— TTL"></a>é˜Ÿåˆ— TTL</h3><p>ç¬¬ä¸€ç§æ˜¯åœ¨åˆ›å»ºé˜Ÿåˆ—çš„æ—¶å€™è®¾ç½®é˜Ÿåˆ—çš„ ã€<code>x-message-ttl</code>ã€‘å±æ€§ </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841078.png" title="image-20241211231446238" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841078.png" alt="image-20241211231446238"></a> </p><h2 id="æ•´åˆSpringBoot"><a href="#æ•´åˆSpringBoot" class="headerlink" title="æ•´åˆSpringBoot"></a>æ•´åˆ<code>SpringBoot</code></h2><h3 id="æ¶æ„ï¼šé˜Ÿåˆ—TTL"><a href="#æ¶æ„ï¼šé˜Ÿåˆ—TTL" class="headerlink" title="æ¶æ„ï¼šé˜Ÿåˆ—TTL"></a>æ¶æ„ï¼šé˜Ÿåˆ—TTL</h3><p>åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ— QA å’Œ QBï¼Œä¸¤è€…é˜Ÿåˆ— TTL åˆ†åˆ«è®¾ç½®ä¸º 10S å’Œ 40Sï¼Œç„¶ååœ¨åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº X å’Œæ­»ä¿¡äº¤ æ¢æœº Yï¼Œå®ƒä»¬çš„ç±»å‹éƒ½æ˜¯directï¼Œåˆ›å»ºä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ— QDï¼Œå®ƒä»¬çš„ç»‘å®šå…³ç³»</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841879.png" title="image-20241211233441601" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841879.png" alt="image-20241211233441601"></a>  </p><h4 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.rabbitmq.host</span><span class="token punctuation">=</span><span class="token value attr-value">localhost</span><span class="token key attr-name">spring.rabbitmq.port</span><span class="token punctuation">=</span><span class="token value attr-value">5672 </span><span class="token key attr-name">spring.rabbitmq.username</span><span class="token punctuation">=</span><span class="token value attr-value">guest </span><span class="token key attr-name">spring.rabbitmq.password</span><span class="token punctuation">=</span><span class="token value attr-value">guest</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é…ç½®ç±»ï¼šTtlQueueConfig"><a href="#é…ç½®ç±»ï¼šTtlQueueConfig" class="headerlink" title="é…ç½®ç±»ï¼šTtlQueueConfig"></a>é…ç½®ç±»ï¼š<code>TtlQueueConfig</code></h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TtlQueueConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æ™®é€šäº¤æ¢æœºå’Œé˜Ÿåˆ—</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">X_EXCHANGE</span> <span class="token operator">=</span> <span class="token string">"X"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">QUEUE_A</span> <span class="token operator">=</span> <span class="token string">"QA"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">QUEUE_B</span> <span class="token operator">=</span> <span class="token string">"QB"</span><span class="token punctuation">;</span>    <span class="token comment">//æ™®é€šè·¯ç”±é”®</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">XA_ROUTING_KEY</span> <span class="token operator">=</span> <span class="token string">"XA"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">XB_ROUTING_KEY</span> <span class="token operator">=</span> <span class="token string">"XB"</span><span class="token punctuation">;</span>    <span class="token comment">//æ­»ä¿¡äº¤æ¢æœºå’Œé˜Ÿåˆ—</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">Y_DEAD_LETTER_EXCHANGE</span> <span class="token operator">=</span> <span class="token string">"Y"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEAD_LETTER_QUEUE</span> <span class="token operator">=</span> <span class="token string">"QD"</span><span class="token punctuation">;</span>    <span class="token comment">//æ­»ä¿¡è·¯ç”±é”®</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">Y_DEAD_LETTER_ROUTING_KEY</span> <span class="token operator">=</span> <span class="token string">"YD"</span><span class="token punctuation">;</span>    <span class="token comment">//å£°æ˜æ™®é€šäº¤æ¢æœº X</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"xExchange"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">DirectExchange</span> <span class="token function">xExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token constant">X_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ­»ä¿¡äº¤æ¢æœº Y</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"yExchange"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">DirectExchange</span> <span class="token function">yExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token constant">Y_DEAD_LETTER_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ™®é€šé˜Ÿåˆ— A ç»‘å®šåˆ°å¯¹åº”æ­»ä¿¡äº¤æ¢æœº Y ä¸Š</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"queueA"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-exchange"</span><span class="token punctuation">,</span> <span class="token constant">Y_DEAD_LETTER_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-routing-key"</span><span class="token punctuation">,</span> <span class="token constant">Y_DEAD_LETTER_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-message-ttl"</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">QueueBuilder</span><span class="token punctuation">.</span><span class="token function">durable</span><span class="token punctuation">(</span><span class="token constant">QUEUE_A</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ™®é€šé˜Ÿåˆ— B ttl 40s å¹¶ç»‘å®šåˆ°å¯¹åº”æ­»ä¿¡äº¤æ¢æœºY</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"queueB"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-exchange"</span><span class="token punctuation">,</span> <span class="token constant">Y_DEAD_LETTER_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-routing-key"</span><span class="token punctuation">,</span> <span class="token constant">Y_DEAD_LETTER_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-message-ttl"</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">QueueBuilder</span><span class="token punctuation">.</span><span class="token function">durable</span><span class="token punctuation">(</span><span class="token constant">QUEUE_B</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—QD</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"queueD"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueD</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">QueueBuilder</span><span class="token punctuation">.</span><span class="token function">durable</span><span class="token punctuation">(</span><span class="token constant">DEAD_LETTER_QUEUE</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ™®é€šé˜Ÿåˆ— A ç»‘å®šåˆ° æ™®é€šäº¤æ¢æœº X</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">queueBindingX</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"queueA"</span><span class="token punctuation">)</span> <span class="token class-name">Queue</span> queueA<span class="token punctuation">,</span>                                 <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"xExchange"</span><span class="token punctuation">)</span> <span class="token class-name">DirectExchange</span> xExchange<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueA<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>xExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">XA_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å£°æ˜æ™®é€šé˜Ÿåˆ— B ç»‘å®šåˆ° æ™®é€šäº¤æ¢æœº X</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">queueBBindingX</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"queueB"</span><span class="token punctuation">)</span> <span class="token class-name">Queue</span> queueB<span class="token punctuation">,</span>                                  <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"xExchange"</span><span class="token punctuation">)</span> <span class="token class-name">DirectExchange</span> xExchange<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueB<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>xExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">XB_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">deadLetterBindingY</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"queueD"</span><span class="token punctuation">)</span> <span class="token class-name">Queue</span> queueD<span class="token punctuation">,</span>                                  <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"yExchange"</span><span class="token punctuation">)</span> <span class="token class-name">DirectExchange</span> yExchange<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueD<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>yExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">Y_DEAD_LETTER_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ç”Ÿäº§è€…ï¼šSendMsgController"><a href="#ç”Ÿäº§è€…ï¼šSendMsgController" class="headerlink" title="ç”Ÿäº§è€…ï¼šSendMsgController"></a>ç”Ÿäº§è€…ï¼š<code>SendMsgController</code></h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/ttl"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SendMsgController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"sendMsg/&#123;msg&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡æ¶ˆæ¯ç»™ä¸¤ä¸ªTTLé˜Ÿåˆ—ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"XA"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"XB"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¶ˆè´¹è€…ï¼šDeadLetterQueueConsumer"><a href="#æ¶ˆè´¹è€…ï¼šDeadLetterQueueConsumer" class="headerlink" title="æ¶ˆè´¹è€…ï¼šDeadLetterQueueConsumer"></a>æ¶ˆè´¹è€…ï¼š<code>DeadLetterQueueConsumer</code></h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeadLetterQueueConsumer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"QD"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveD</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´ï¼š&#123;&#125;,æ”¶åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘èµ·ä¸€ä¸ªè¯·æ±‚ <a href="http://localhost:8080/ttl/sendMsg/%E5%98%BB%E5%98%BB%E5%98%BB">http://localhost:8080/ttl/sendMsg/å˜»å˜»å˜»</a></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841495.png" title="image-20241212111944595" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841495.png" alt="image-20241212111944595"></a> </p><p>ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨ 10S åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œç„¶åè¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ‰ï¼Œç¬¬äºŒæ¡æ¶ˆæ¯åœ¨ 40S ä¹‹åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œ  ç„¶åè¢«æ¶ˆè´¹æ‰ï¼Œè¿™æ ·ä¸€ä¸ªå»¶æ—¶é˜Ÿåˆ—å°±æ‰“é€ å®Œæˆäº†ã€‚</p><h3 id="ä¼˜åŒ–ï¼šåŠ¨æ€è®¾ç½®Ttlçš„é˜Ÿåˆ—"><a href="#ä¼˜åŒ–ï¼šåŠ¨æ€è®¾ç½®Ttlçš„é˜Ÿåˆ—" class="headerlink" title="ä¼˜åŒ–ï¼šåŠ¨æ€è®¾ç½®Ttlçš„é˜Ÿåˆ—"></a>ä¼˜åŒ–ï¼šåŠ¨æ€è®¾ç½®<code>Ttl</code>çš„é˜Ÿåˆ—</h3><p>åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— QC,ç»‘å®šå…³ç³»å¦‚ä¸‹,è¯¥é˜Ÿåˆ—ä¸è®¾ç½®TTL æ—¶é—´</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841653.png" title="image-20241212112115951" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841653.png" alt="image-20241212112115951"></a></p><h4 id="é…ç½®ç±»-MsgTtlQueueConfig"><a href="#é…ç½®ç±»-MsgTtlQueueConfig" class="headerlink" title="é…ç½®ç±» MsgTtlQueueConfig"></a>é…ç½®ç±» <code>MsgTtlQueueConfig</code></h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgTtlQueueConfig</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">Y_DEAD_LETTER_EXCHANGE</span> <span class="token operator">=</span> <span class="token string">"Y"</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">QUEUE_C</span> <span class="token operator">=</span> <span class="token string">"QC"</span><span class="token punctuation">;</span>      <span class="token comment">//å£°æ˜é˜Ÿåˆ— C æ­»ä¿¡äº¤æ¢æœº </span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"queueC"</span><span class="token punctuation">)</span>     <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº </span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-exchange"</span><span class="token punctuation">,</span> <span class="token constant">Y_DEAD_LETTER_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key </span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-routing-key"</span><span class="token punctuation">,</span> <span class="token string">"YD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//æ²¡æœ‰å£°æ˜ TTL å±æ€§ </span>        <span class="token keyword">return</span> <span class="token class-name">QueueBuilder</span><span class="token punctuation">.</span><span class="token function">durable</span><span class="token punctuation">(</span><span class="token constant">QUEUE_C</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token comment">//å£°æ˜é˜Ÿåˆ— B ç»‘å®š X äº¤æ¢æœº </span>    <span class="token annotation punctuation">@Bean</span>     <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">queuecBindingX</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"queueC"</span><span class="token punctuation">)</span> <span class="token class-name">Queue</span> queueC<span class="token punctuation">,</span>       <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"xExchange"</span><span class="token punctuation">)</span> <span class="token class-name">DirectExchange</span> xExchange<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueC<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>xExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token string">"XC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ç”Ÿäº§è€…å‘é€æ¶ˆæ¯"><a href="#ç”Ÿäº§è€…å‘é€æ¶ˆæ¯" class="headerlink" title="ç”Ÿäº§è€…å‘é€æ¶ˆæ¯"></a>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯</h4><p>æ ¸å¿ƒä»£ç ï¼š <code>correlationData.getMessageProperties().setExpiration(ttlTime);</code> </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"sendExpirationMsg/&#123;message&#125;/&#123;ttlTime&#125;"</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> message<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> ttlTime<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"XC"</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> correlationData<span class="token operator">-></span><span class="token punctuation">&#123;</span>         correlationData<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span>ttlTime<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> correlationData<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡æ—¶é•¿&#123;&#125;æ¯«ç§’ TTL ä¿¡æ¯ç»™é˜Ÿåˆ— C:&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ttlTime<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># å‘èµ·è¯·æ±‚ http:&#x2F;&#x2F;localhost:8080&#x2F;ttl&#x2F;sendExpirationMsg&#x2F;ä½ å¥½ 1&#x2F;20000 http:&#x2F;&#x2F;localhost:8080&#x2F;ttl&#x2F;sendExpirationMsg&#x2F;ä½ å¥½ 2&#x2F;2000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841093.png" title="image-20241212112615811" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841093.png" alt="image-20241212112615811"></a> </p><p><strong>åˆ†æ</strong>ï¼š<strong>RabbitMQ åªä¼šæ£€æŸ¥ç¬¬ä¸€ä¸ªæ¶ˆæ¯æ˜¯å¦è¿‡æœŸ</strong>ï¼Œå¦‚æœæ¶ˆæ¯è¿‡æœŸåˆ™ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œ  å¦‚æœç¬¬ä¸€ä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆé•¿ï¼Œè€Œç¬¬äºŒä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆçŸ­ï¼Œç¬¬äºŒä¸ªæ¶ˆæ¯å¹¶ä¸ä¼šä¼˜å…ˆå¾—åˆ°æ‰§è¡Œ</p><h3 id="å®‰è£…å»¶æ—¶æ’ä»¶"><a href="#å®‰è£…å»¶æ—¶æ’ä»¶" class="headerlink" title="å®‰è£…å»¶æ—¶æ’ä»¶"></a>å®‰è£…å»¶æ—¶æ’ä»¶</h3><ol><li><p>åœ¨å®˜ç½‘ä¸Šä¸‹è½½ <a href="https://www.rabbitmq.com/community-plugins.html%EF%BC%8C%E4%B8%8B%E8%BD%BD">https://www.rabbitmq.com/community-plugins.htmlï¼Œä¸‹è½½</a> <code>rabbitmq_delayed_message_exchange</code></p></li><li><p>å°†æ’ä»¶å¤åˆ¶åˆ°RabbitMQ å®¹å™¨çš„ /plugins è·¯å¾„ï¼Œ</p><pre class="line-numbers language-none"><code class="language-none"># å¤åˆ¶æ’ä»¶åˆ°å®¹å™¨ï¼ˆrabbitmqï¼‰çš„è·¯å¾„(&#x2F;plugins)docker cp D:&#x2F;rabbitmq_delayed_message_exchange-4.0.2.ez rabbitmq:&#x2F;plugins<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>æ‰§è¡Œå‘½ä»¤</p><pre class="line-numbers language-none"><code class="language-none">rabbitmq-plugins enable rabbitmq_delayed_message_exchange<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841999.png" title="image-20241212113757789" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841999.png" alt="image-20241212113757789"></a> </p></li><li><p>æ’ä»¶ç”Ÿæ•ˆ</p></li></ol><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841191.png" title="image-20241212113809910" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841191.png" alt="image-20241212113809910"></a></p><h3 id="ä¼˜åŒ–ï¼šå»¶æ—¶é˜Ÿåˆ—æ’ä»¶-delayed"><a href="#ä¼˜åŒ–ï¼šå»¶æ—¶é˜Ÿåˆ—æ’ä»¶-delayed" class="headerlink" title="ä¼˜åŒ–ï¼šå»¶æ—¶é˜Ÿåˆ—æ’ä»¶ delayed"></a>ä¼˜åŒ–ï¼šå»¶æ—¶é˜Ÿåˆ—æ’ä»¶ <code>delayed</code></h3><p>åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ—<code>delayed.queue</code>,ä¸€ä¸ªè‡ªå®šä¹‰äº¤æ¢æœº <code>delayed.exchange</code>ï¼Œç»‘å®šå…³ç³»å¦‚ä¸‹:</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841798.png" title="image-20241212113930549" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841798.png" alt="image-20241212113930549"></a></p><h4 id="é…ç½®ç±»-DelayedQueueConfig"><a href="#é…ç½®ç±»-DelayedQueueConfig" class="headerlink" title="é…ç½®ç±» DelayedQueueConfig"></a>é…ç½®ç±» <code>DelayedQueueConfig</code></h4><p>åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„äº¤æ¢æœºä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„äº¤æ¢ç±»å‹ï¼Œè¯¥ç±»å‹<strong>æ¶ˆæ¯</strong>æ”¯<strong>æŒå»¶è¿ŸæŠ•é€’</strong>æœºåˆ¶ æ¶ˆæ¯ä¼ é€’åå¹¶ä¸ä¼šç«‹å³æŠ•é€’åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨ ã€**<code>mnesia</code><strong>ã€‘(<strong>ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿ</strong>)è¡¨ä¸­ï¼Œå½“</strong>è¾¾åˆ°æŠ•é€’æ—¶é—´<strong>æ—¶ï¼Œ</strong>æ‰æŠ•é€’**åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DelayedQueueConfig</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DELAYED_EXCHANGE_NAME</span> <span class="token operator">=</span> <span class="token string">"delayed.exchange"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DELAYED_QUEUE_NAME</span> <span class="token operator">=</span> <span class="token string">"delayed.queue"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DELAYED_ROUTING_KEY</span> <span class="token operator">=</span> <span class="token string">"delayed.routingkey"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">delayedQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token constant">DELAYED_QUEUE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// è‡ªå®šä¹‰å»¶è¿Ÿäº¤æ¢æœº</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">CustomExchange</span> <span class="token function">delayedExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è‡ªå®šä¹‰äº¤æ¢æœºçš„ç±»å‹</span>        args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-delayed-type"</span><span class="token punctuation">,</span> <span class="token string">"direct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CustomExchange</span><span class="token punctuation">(</span><span class="token constant">DELAYED_EXCHANGE_NAME</span><span class="token punctuation">,</span> <span class="token string">"x-delayed-message"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ç»‘å®šå»¶è¿Ÿé˜Ÿåˆ— åˆ° å»¶è¿Ÿäº¤æ¢æœº</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">bindingDelayedQueue</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"delayedQueue"</span><span class="token punctuation">)</span><span class="token class-name">Queue</span> delayedQueue<span class="token punctuation">,</span>                                       <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"delayedExchange"</span><span class="token punctuation">)</span> <span class="token class-name">CustomExchange</span> delayedExchange  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>delayedQueue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>delayedExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">DELAYED_ROUTING_KEY</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noargs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "><a href="#æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç " class="headerlink" title="æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "></a>æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç </h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DELAYED_EXCHANGE_NAME</span> <span class="token operator">=</span> <span class="token string">"delayed.exchange"</span><span class="token punctuation">;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DELAYED_ROUTING_KEY</span> <span class="token operator">=</span> <span class="token string">"delayed.routingkey"</span><span class="token punctuation">;</span>  <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"sendDelayMsg/&#123;msg&#125;/&#123;delayTime&#125;"</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> msg<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> delayTime<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"delayed.exchange"</span><span class="token punctuation">,</span> <span class="token string">"delayed.routingkey"</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> correlationData <span class="token operator">-></span> <span class="token punctuation">&#123;</span> correlationData<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDelay</span><span class="token punctuation">(</span>delayTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> correlationData<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡å»¶è¿Ÿ&#123;&#125;æ¯«ç§’ä¿¡æ¯ç»™é˜Ÿåˆ—delayed.queue:&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> delayTime<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç ï¼šDeadLetterQueueConsumer-æ·»åŠ æ¶ˆè´¹"><a href="#æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç ï¼šDeadLetterQueueConsumer-æ·»åŠ æ¶ˆè´¹" class="headerlink" title="æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç ï¼šDeadLetterQueueConsumer æ·»åŠ æ¶ˆè´¹"></a>æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç ï¼š<code>DeadLetterQueueConsumer</code> æ·»åŠ æ¶ˆè´¹</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"delayed.queue"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveDelayedQueue</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ—¶é—´ï¼š&#123;&#125;,æ”¶åˆ°å»¶æ—¶é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># å‘èµ·è¯·æ±‚ï¼š http:&#x2F;&#x2F;localhost:8080&#x2F;ttl&#x2F;sendDelayMsg&#x2F;come on baby1&#x2F;20000 http:&#x2F;&#x2F;localhost:8080&#x2F;ttl&#x2F;sendDelayMsg&#x2F;come on baby2&#x2F;2000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841505.png" title="image-20241212114815590" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141841505.png" alt="image-20241212114815590"></a> </p><p> ç¬¬äºŒä¸ªæ¶ˆæ¯è¢«å…ˆæ¶ˆè´¹æ‰äº†ï¼Œç¬¦åˆé¢„æœŸ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><pre><code>å»¶æ—¶é˜Ÿåˆ—åœ¨éœ€è¦å»¶æ—¶å¤„ç†çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œä½¿ç”¨ `RabbitMQ` æ¥å®ç°å»¶æ—¶é˜Ÿåˆ—å¯ä»¥å¾ˆå¥½çš„åˆ©ç”¨ `RabbitMQ` çš„ç‰¹æ€§ï¼Œå¦‚ï¼šæ¶ˆæ¯å¯é å‘é€ã€æ¶ˆæ¯å¯é æŠ•é€’ã€æ­»ä¿¡é˜Ÿåˆ—æ¥ä¿éšœæ¶ˆæ¯è‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡ä»¥åŠæœªè¢«æ­£ ç¡®å¤„ç†çš„æ¶ˆæ¯ä¸ä¼šè¢«ä¸¢å¼ƒã€‚å¦å¤–ï¼Œé€šè¿‡ `RabbitMQ` é›†ç¾¤çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½çš„è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä¸ä¼šå› ä¸º å•ä¸ªèŠ‚ç‚¹æŒ‚æ‰å¯¼è‡´å»¶æ—¶é˜Ÿåˆ—ä¸å¯ç”¨æˆ–è€…æ¶ˆæ¯ä¸¢å¤±ã€‚ </code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆä¸‰ï¼‰| RabbitMQ æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</title>
      <link href="/posts/38624.html"/>
      <url>/posts/38624.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="RabbitMQ-æ¶ˆæ¯ç¡®è®¤æœºåˆ¶"><a href="#RabbitMQ-æ¶ˆæ¯ç¡®è®¤æœºåˆ¶" class="headerlink" title="RabbitMQ æ¶ˆæ¯ç¡®è®¤æœºåˆ¶"></a>RabbitMQ æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</h2><blockquote><p>:heavy_exclamation_mark::heavy_exclamation_mark::heavy_exclamation_mark:æ¸©é¦¨æç¤ºï¼šåŸºäº<code>JDK17</code>ã€<code>SpringBoot 2.1.8.RELEASE</code> ç‰ˆæœ¬ï¼Œç”±äº<code>RabbitMQ</code> åœ¨ <code>SpringBoot3+</code> çš„é…ç½®é¡¹æœ‰æ‰€ä¸åŒï¼Œ æ‰€ä»¥è¯·ä¸¥æ ¼æŒ‰ç…§è¯¥æœ¬ç‰ˆæ¥ä½¿ç”¨ï¼ŒæŒ–ä¸€å‘ï¼šã€åç»­ä¼šå‡ºä¸€ä¸ª<code>SpringBoot3+</code>ç‰ˆæœ¬çš„é…ç½®ç›¸å…³æ•™ç¨‹ã€‘</p></blockquote><h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528538.svg" title="RabbitMQ æ¶ˆæ¯ç¡®è®¤æœºåˆ¶-å¯é æŠµè¾¾.drawio" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528538.svg" alt="RabbitMQ æ¶ˆæ¯ç¡®è®¤æœºåˆ¶-å¯é æŠµè¾¾.drawio"></a> </p><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œå¯é æŠµè¾¾ï¼Œå¯ä»¥ä½¿ç”¨äº‹åŠ¡æ¶ˆæ¯ï¼Œæ€§èƒ½ä¸‹é™250å€ ä¸ºæ­¤å¼•å…¥<strong>ç¡®è®¤æœºåˆ¶</strong></p><ul><li>ç”Ÿäº§è€…ç¡®è®¤å›è°ƒï¼š<code>publisher</code> <code>confirmCallback</code></li><li>ç”Ÿäº§è€…é€€å›å›è°ƒï¼š<code>publisher</code> <code>returnCallback</code>æœªæŠ•é€’åˆ°<code>queue</code>é€€å›æ¨¡å¼</li><li>æ¶ˆè´¹è€…ç¡®è®¤ï¼š<code>consumer</code> <code>ack</code>ç¡®è®¤æœºåˆ¶</li></ul><h3 id="ComfirmCallbackã€ç”Ÿäº§è€…ç¡®è®¤å›è°ƒã€‘"><a href="#ComfirmCallbackã€ç”Ÿäº§è€…ç¡®è®¤å›è°ƒã€‘" class="headerlink" title="ComfirmCallbackã€ç”Ÿäº§è€…ç¡®è®¤å›è°ƒã€‘"></a><code>ComfirmCallback</code>ã€ç”Ÿäº§è€…ç¡®è®¤å›è°ƒã€‘</h3><ul><li><strong>æ¦‚å¿µï¼š</strong><code>ComfirmCallback</code>æ˜¯ç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚å½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ° <code>RabbitMQ</code> çš„äº¤æ¢å™¨ï¼ˆ<code>Exchange</code>ï¼‰åï¼Œ<code>RabbitMQ</code> ä¼šè¿”å›ä¸€ä¸ªç¡®è®¤æ¶ˆæ¯ç»™ç”Ÿäº§è€…ï¼Œè¿™ä¸ªç¡®è®¤è¿‡ç¨‹å¯ä»¥é€šè¿‡ <code>ConfirmCallback</code> æ¥å¤„ç†ã€‚</li><li><strong>åŸç†ï¼š</strong>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šä¸ºæ¯æ¡æ¶ˆæ¯å…³è”ä¸€ä¸ª <code>CorrelationData</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…å«ä¸€äº›è‡ªå®šä¹‰çš„ä¿¡æ¯ï¼Œç”¨äºè·Ÿè¸ªæ¶ˆæ¯ã€‚å½“æ¶ˆæ¯æˆåŠŸå‘é€åˆ°äº¤æ¢å™¨åï¼Œ<code>RabbitMQ</code> ä¼šè§¦å‘ <code>ConfirmCallback</code> æ¥å£ä¸­çš„ã€ <code>confirm</code>ã€‘ æ–¹æ³•ã€‚</li></ul><h3 id="ReturnCallbackã€ç”Ÿäº§è€…é€€å›å›è°ƒã€‘"><a href="#ReturnCallbackã€ç”Ÿäº§è€…é€€å›å›è°ƒã€‘" class="headerlink" title="ReturnCallbackã€ç”Ÿäº§è€…é€€å›å›è°ƒã€‘"></a><code>ReturnCallback</code>ã€ç”Ÿäº§è€…é€€å›å›è°ƒã€‘</h3><ul><li><strong>æ¦‚å¿µï¼š</strong><code>ReturnCallback</code> ç”¨äºå¤„ç†æ¶ˆæ¯<strong>æ— æ³•è¢«æ­£ç¡®è·¯ç”±</strong>åˆ°é˜Ÿåˆ—çš„æƒ…å†µã€‚å½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°äº¤æ¢å™¨åï¼Œå¦‚æœäº¤æ¢å™¨æ— æ³•å°†æ¶ˆæ¯è·¯ç”±åˆ°ä»»ä½•é˜Ÿåˆ—ï¼ˆä¾‹å¦‚ï¼Œæ²¡æœ‰åŒ¹é…çš„ç»‘å®šè§„åˆ™æˆ–è€…é˜Ÿåˆ—ä¸å­˜åœ¨ï¼‰ï¼Œæ¶ˆæ¯ä¼šè¢«é€€å›ç»™ç”Ÿäº§è€…ï¼Œè¿™ä¸ªé€€å›è¿‡ç¨‹å¯ä»¥é€šè¿‡ <code>ReturnCallback</code> æ¥å¤„ç†ã€‚</li><li><strong>åŸç†ï¼š</strong>ç”Ÿäº§è€…éœ€è¦é…ç½®æ¶ˆæ¯é€€å›æœºåˆ¶ï¼Œå¹¶ä¸”å®ç° <code>ReturnCallback</code> æ¥å£ã€‚å½“æ¶ˆæ¯è¢«é€€å›æ—¶ï¼Œ<code>ReturnCallback</code> æ¥å£ä¸­çš„ ã€<code>returnedMessage</code>ã€‘ æ–¹æ³•ä¼šè¢«è§¦å‘ã€‚</li></ul><h3 id="BasicAckã€æ¶ˆè´¹è€…ç¡®è®¤ã€‘"><a href="#BasicAckã€æ¶ˆè´¹è€…ç¡®è®¤ã€‘" class="headerlink" title="BasicAckã€æ¶ˆè´¹è€…ç¡®è®¤ã€‘"></a><code>BasicAck</code>ã€æ¶ˆè´¹è€…ç¡®è®¤ã€‘</h3><ul><li><strong>æ¦‚å¿µï¼š</strong> <code>BasicAck</code>æ˜¯æ¶ˆè´¹è€…ç¡®è®¤æ¶ˆæ¯çš„ä¸€ç§æ–¹å¼ã€‚åœ¨ <code>RabbitMQ</code> ä¸­ï¼Œæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œéœ€è¦å‘ <code>RabbitMQ</code> æœåŠ¡å™¨ç¡®è®¤æ¶ˆæ¯å·²ç»è¢«æ­£ç¡®å¤„ç†ï¼Œè¿™æ · <code>RabbitMQ</code> æ‰ä¼šä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯ã€‚<code>BasicAck</code> æ˜¯æ‰‹åŠ¨ç¡®è®¤æ¨¡å¼ä¸‹ç”¨äºç¡®è®¤æ¶ˆæ¯çš„æ–¹æ³•ä¹‹ä¸€ã€‚</li><li><strong>åŸç†ï¼š</strong>æ¶ˆè´¹è€…åœ¨æ‰‹åŠ¨ç¡®è®¤æ¨¡å¼ä¸‹ï¼Œä»é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ã€‚å½“å¤„ç†å®Œæˆä¸”æ²¡æœ‰å‡ºç°é—®é¢˜æ—¶ï¼Œæ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨ Channel å¯¹è±¡çš„<code>basicAck</code>æ–¹æ³•æ¥ç¡®è®¤æ¶ˆæ¯ã€‚<code>basicAck</code>æ–¹æ³•éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š<code>deliveryTag</code>å’Œ<code>multiple</code>ã€‚<code>deliveryTag</code>æ˜¯æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼Œç”± RabbitMQ æœåŠ¡å™¨åˆ†é…ï¼›<code>multiple</code>æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºè¡¨ç¤ºæ˜¯å¦ç¡®è®¤å¤šæ¡æ¶ˆæ¯ã€‚</li></ul><h2 id="ç”Ÿäº§è€…ç¡®è®¤å›è°ƒ-ConfirmCallback"><a href="#ç”Ÿäº§è€…ç¡®è®¤å›è°ƒ-ConfirmCallback" class="headerlink" title="ç”Ÿäº§è€…ç¡®è®¤å›è°ƒ ConfirmCallback"></a>ç”Ÿäº§è€…ç¡®è®¤å›è°ƒ <code>ConfirmCallback</code></h2><h3 id="æ·»åŠ é…ç½®"><a href="#æ·»åŠ é…ç½®" class="headerlink" title="æ·»åŠ é…ç½®"></a>æ·»åŠ é…ç½®</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># å¼€å¯ç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</span><span class="token key attr-name">spring.rabbitmq.publisher-confirms</span><span class="token punctuation">=</span><span class="token value attr-value">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ·»åŠ -RabbitMQConfig"><a href="#æ·»åŠ -RabbitMQConfig" class="headerlink" title="æ·»åŠ  RabbitMQConfig"></a>æ·»åŠ  <code>RabbitMQConfig</code></h3><p><strong>è‡ªå®šä¹‰ <code>confirmCallback#confirm</code></strong> </p><ul><li><code>CorrelationData</code>ï¼šå½“å‰æ¶ˆæ¯å”¯ä¸€å…³è”æ•°æ®ã€æ¶ˆæ¯çš„å”¯ä¸€Idã€‘</li><li><code>ack</code>ï¼šæ˜¯å¦æˆåŠŸæ”¶åˆ°çŠ¶æ€</li><li><code>cause</code>ï¼šå¤±è´¥åŸå› </li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQConfig</span> <span class="token punctuation">&#123;</span>     <span class="token annotation punctuation">@Autowired</span>     <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>         <span class="token annotation punctuation">@PostConstruct</span> <span class="token comment">//åˆ›å»ºRabbitMQConfigå¯¹è±¡åï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•</span>     <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initRabbitTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//è®¾ç½®ç¡®è®¤å›è°ƒ</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setConfirmCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RabbitTemplate<span class="token punctuation">.</span>ConfirmCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/**         * @param correlationData å½“å‰æ¶ˆæ¯çš„å”¯ä¸€å…³è”æ•°æ®ï¼ˆè¿™ä¸ªæ¶ˆæ¯çš„å”¯ä¸€idï¼‰         * @param ack æ¶ˆæ¯æ˜¯å¦æˆåŠŸæ”¶åˆ°         * @param cause  å¤±è´¥çš„åŸå›         */</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token class-name">CorrelationData</span> correlationData<span class="token punctuation">,</span> <span class="token keyword">boolean</span> ack<span class="token punctuation">,</span> <span class="token class-name">String</span> cause<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"confirm=>correlationDataã€&#123;&#125;ã€‘=>ackã€&#123;&#125;ã€‘=>causeã€&#123;&#125;ã€‘ "</span><span class="token punctuation">,</span> correlationData<span class="token punctuation">,</span> ack<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•ï¼šç”Ÿäº§è€…ç¡®è®¤"><a href="#æµ‹è¯•ï¼šç”Ÿäº§è€…ç¡®è®¤" class="headerlink" title="æµ‹è¯•ï¼šç”Ÿäº§è€…ç¡®è®¤"></a>æµ‹è¯•ï¼šç”Ÿäº§è€…ç¡®è®¤</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProducerController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token comment">/**     * å‘é€æ¶ˆæ¯     *     * @param num     */</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/send"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"num"</span><span class="token punctuation">)</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">OrderReturnReasonEntity</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderReturnReasonEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                data<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•-"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>                rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello-java"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">OrderEntity</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                data<span class="token punctuation">.</span><span class="token function">setOrderSn</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello-java"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å‘é€æ¶ˆæ¯: &#123;&#125;æ¡å®Œæˆ"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¶ˆæ¯å‘é€æˆåŠŸï¼Œç”Ÿäº§è€…ç¡®è®¤å›è°ƒç”Ÿæ•ˆï¼Œ<strong>æ³¨æ„ä¸‹è¿™é‡Œçš„<code>correlationData</code>çš„æ•°æ®ä¸º<code>null</code></strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528539.png" title="image-20241209143121904" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528539.png" alt="image-20241209143121904"></a> </p><h3 id="ä¿®æ”¹ä¸‹å‘é€ä¿¡æ¯"><a href="#ä¿®æ”¹ä¸‹å‘é€ä¿¡æ¯" class="headerlink" title="ä¿®æ”¹ä¸‹å‘é€ä¿¡æ¯"></a>ä¿®æ”¹ä¸‹å‘é€ä¿¡æ¯</h3><p><code>ProducerController</code>#<code>sendMessage</code>ä¸­æ·»åŠ å½“å‰æ¶ˆæ¯çš„å”¯ä¸€<code>id</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello-java"</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">CorralationData</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è¿™é‡Œ<code>correlationData.getId()</code>ï¼ˆä¹Ÿå°±æ˜¯<code>UUID</code>ï¼‰å¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨å¤šä¸ªæ¶ˆæ¯å‘é€åœºæ™¯ä¸­ï¼Œå”¯ä¸€åœ°æ ‡è¯†æ¯æ¡æ¶ˆæ¯ï¼Œä»è€Œå‡†ç¡®åœ°è·Ÿè¸ªæŸä¸€æ¡ç‰¹å®šæ¶ˆæ¯çš„å‘é€çŠ¶æ€ï¼Œæ˜¯å‘é€æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚</li></ul><h3 id="æµ‹è¯•2ï¼šæ¶ˆæ¯å”¯ä¸€Id"><a href="#æµ‹è¯•2ï¼šæ¶ˆæ¯å”¯ä¸€Id" class="headerlink" title="æµ‹è¯•2ï¼šæ¶ˆæ¯å”¯ä¸€Id"></a>æµ‹è¯•2ï¼šæ¶ˆæ¯å”¯ä¸€Id</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528540.png" title="image-20241209143421885" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528540.png" alt="image-20241209143421885"></a></p><h2 id="ç”Ÿäº§è€…å›é€€å›è°ƒ-ReturnCallback"><a href="#ç”Ÿäº§è€…å›é€€å›è°ƒ-ReturnCallback" class="headerlink" title="ç”Ÿäº§è€…å›é€€å›è°ƒ ReturnCallback"></a>ç”Ÿäº§è€…å›é€€å›è°ƒ <code>ReturnCallback</code></h2><p><code>confirm</code> æ¨¡å¼åªèƒ½ä¿è¯æ¶ˆæ¯åˆ°è¾¾ <code>broker</code>ï¼Œä¸èƒ½ä¿è¯æ¶ˆæ¯å‡†ç¡®æŠ•é€’åˆ°ç›®æ ‡ <code>queue</code> é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æ¶ˆæ¯ä¸€å®šè¦æŠ•é€’åˆ°ç›®æ ‡ <code>queue</code> é‡Œï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ°<br><code>return</code> é€€å›æ¨¡å¼ã€‚</p><h3 id="æ·»åŠ é…ç½®-1"><a href="#æ·»åŠ é…ç½®-1" class="headerlink" title="æ·»åŠ é…ç½®"></a>æ·»åŠ é…ç½®</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.rabbitmq.publisher-returns</span><span class="token punctuation">=</span><span class="token value attr-value">true # å¼€å¯ç”Ÿäº§è€…æ¶ˆæ¯æŠµè¾¾é˜Ÿåˆ—çš„ç¡®è®¤</span><span class="token key attr-name">spring.rabbitmq.template.mandatory</span><span class="token punctuation">=</span><span class="token value attr-value">true # åªè¦æŠµè¾¾é˜Ÿåˆ—ï¼Œä»¥å¼‚æ­¥å‘é€ä¼˜å…ˆå›è°ƒ return confirm,ã€å‘é€ç«¯ç¡®è®¤ï¼Œé»˜è®¤falseã€‘ï¼Œå½“äº¤æ¢æœºæ— æ³•æ‰¾åˆ°é˜Ÿåˆ—æ—¶ï¼Œfalseã€ç›´æ¥ä¸¢å¼ƒæ•°æ®ã€‘ï¼Œtrueã€ä¼šå°†æ¶ˆæ¯è¿”å›ç»™ç”Ÿäº§è€…ã€‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="RabbitMQConfig-é…ç½®ç±»æ·»åŠ "><a href="#RabbitMQConfig-é…ç½®ç±»æ·»åŠ " class="headerlink" title="RabbitMQConfig é…ç½®ç±»æ·»åŠ "></a><code>RabbitMQConfig</code> é…ç½®ç±»æ·»åŠ </h3><pre><code>åªæœ‰å½“å‰æ¶ˆæ¯ä¸èƒ½æŠµè¾¾é˜Ÿåˆ—æ‰ä¼šè§¦å‘è¿™ä¸ªå›è°ƒ</code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¾ç½®æ¶ˆæ¯æŠµè¾¾é˜Ÿåˆ—çš„ç¡®è®¤å›è°ƒ</span>    rabbitTemplate<span class="token punctuation">.</span><span class="token function">setReturnCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RabbitTemplate<span class="token punctuation">.</span>ReturnCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/**          * åªè¦æ¶ˆæ¯æ²¡æœ‰æŠ•é€’ç»™æŒ‡å®šçš„é˜Ÿåˆ—ï¼Œå°±è§¦å‘è¿™ä¸ªå¤±è´¥å›è°ƒ          * @param message  æŠ•é€’å¤±è´¥çš„æ¶ˆæ¯è¯¦ç»†ä¿¡æ¯          * @param replyCode  å›å¤çš„çŠ¶æ€ç           * @param replyText  å›å¤çš„æ–‡æœ¬å†…å®¹          * @param exchange  å½“æ—¶è¿™ä¸ªæ¶ˆæ¯å‘ç»™å“ªä¸ªäº¤æ¢æœº          * @param routingKey  å½“æ—¶è¿™ä¸ªæ¶ˆæ¯ç”¨å“ªä¸ªè·¯ç”±é”®        */</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">returnedMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token keyword">int</span> replyCode<span class="token punctuation">,</span> <span class="token class-name">String</span> replyText<span class="token punctuation">,</span> <span class="token class-name">String</span> exchange<span class="token punctuation">,</span> <span class="token class-name">String</span> routingKey<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œæ¶ˆæ¯ï¼š&#123;&#125;ï¼Œå¤±è´¥ç ï¼š&#123;&#125;ï¼Œå¤±è´¥åŸå› ï¼š&#123;&#125;ï¼Œå‘é€çš„äº¤æ¢æœºï¼š&#123;&#125;,è·¯ç”±é”®ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> replyCode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹å‘é€æ¶ˆæ¯çš„è·¯ç”±é”®"><a href="#ä¿®æ”¹å‘é€æ¶ˆæ¯çš„è·¯ç”±é”®" class="headerlink" title="ä¿®æ”¹å‘é€æ¶ˆæ¯çš„è·¯ç”±é”®"></a>ä¿®æ”¹å‘é€æ¶ˆæ¯çš„è·¯ç”±é”®</h3><pre><code>`ProducerController`#`sendMessage`å‘é€æ¶ˆæ¯æ ¸å¿ƒä»£ç ä¿®æ”¹ï¼Œå°†å…¶ä¸­ä¸€ä¸ªè·¯ç”±é”®ä¿®æ”¹æˆ  `hello2-java`ï¼ˆæˆ–è€…ä¿®æ”¹æˆæ²¡æœ‰å¯ç»‘å®šçš„é˜Ÿåˆ—å³å¯ï¼‰</code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java">rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello2-java"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¿®æ”¹è¿™ä¸ªè·¯ç”±é”®ä¸º hello2-java</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æµ‹è¯•ï¼šç”Ÿäº§è€…é€€å›å›è°ƒ"><a href="#æµ‹è¯•ï¼šç”Ÿäº§è€…é€€å›å›è°ƒ" class="headerlink" title="æµ‹è¯•ï¼šç”Ÿäº§è€…é€€å›å›è°ƒ"></a>æµ‹è¯•ï¼šç”Ÿäº§è€…é€€å›å›è°ƒ</h3><p>æ‰§è¡Œå‘é€æ¶ˆæ¯ï¼Œç»“æœå¦‚ä¸‹</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528541.png" title="image-20241209143647892" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528541.png" alt="image-20241209143647892"></a></p><ul><li>æ¶ˆæ¯æˆåŠŸåˆ°è¾¾ <code>Broker</code> æœåŠ¡å™¨ï¼Œæ¶ˆæ¯ç¡®è®¤æœºåˆ¶ç”Ÿæ•ˆï¼Œæ‰“å° <code>confirm</code> ç›¸å…³ä¿¡æ¯</li><li>æ¶ˆæ¯æ¥æ”¶å¤±è´¥ï¼Œç”Ÿäº§è€…å›é€€æ¨¡å¼ç”Ÿæ•ˆï¼Œå…¶ä¸­ <strong>å¤±è´¥åŸå› </strong>ï¼šã€<code>NO_ROUTE</code>ã€‘æ²¡æœ‰è·¯ç”±åˆ°é˜Ÿåˆ—ï¼Œå…¶ä¸­<strong>è·¯ç”±é”®</strong>ï¼šã€<code>hello2-java</code>ã€‘ï¼Œäº¤æ¢æœºå’Œå¤±è´¥ç ç­‰ä¿¡æ¯éƒ½æ‰“å°å‡ºæ¥</li></ul><h2 id="æ¶ˆè´¹è€…ç¡®è®¤ï¼šAck"><a href="#æ¶ˆè´¹è€…ç¡®è®¤ï¼šAck" class="headerlink" title="æ¶ˆè´¹è€…ç¡®è®¤ï¼šAck"></a>æ¶ˆè´¹è€…ç¡®è®¤ï¼šAck</h2><pre><code>æ¶ˆè´¹è€…æ”¶åˆ°æ¶ˆæ¯ï¼ŒæˆåŠŸå¤„ç†å‘é€ `Ack` ç»™ `Broker`    æ¶ˆè´¹è€…æ”¶åˆ°æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤ï¼Œä½†æ˜¯æ— æ³•ç¡®è®¤æ¶ˆæ¯æ˜¯å¦è¢«å¤„ç†å®Œæˆæˆ–è€…æˆåŠŸå¤„ç†ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯`ack`</code></pre><h3 id="æµ‹è¯•ï¼šé»˜è®¤è‡ªåŠ¨-ack"><a href="#æµ‹è¯•ï¼šé»˜è®¤è‡ªåŠ¨-ack" class="headerlink" title="æµ‹è¯•ï¼šé»˜è®¤è‡ªåŠ¨ ack"></a>æµ‹è¯•ï¼šé»˜è®¤è‡ªåŠ¨ ack</h3><p><code>ProducerController</code> æ·»åŠ ä¸€ä¸ªå‘é€æ¶ˆæ¯æ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"sendMQ/&#123;num&#125;"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMQ</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">OrderReturnReasonEntity</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderReturnReasonEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        data<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello-java"</span><span class="token punctuation">,</span>                                       data<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">CorrelationData</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å‘é€æ¶ˆæ¯: &#123;&#125;æ¡å®Œæˆ"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘é€10æ¡æ¶ˆæ¯</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528542.png" title="image-20241209162941438" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528542.png" alt="image-20241209162941438"></a>  </p><p>å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¼€å§‹å¤„ç†ï¼Œå¤„ç†ä¸€æ¡æ¶ˆæ¯å®Œæˆåï¼Œæ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯å®•æœº </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528543.png" title="image-20241209160547226" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528543.png" alt="image-20241209160547226"></a> </p><p>æ”¶åˆ°æ¶ˆæ¯å¤„ç†ä¸€æ¡å®Œæˆï¼Œé˜Ÿåˆ—å‰©ä¸‹9æ¡æ¶ˆæ¯</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528544.png" title="image-20241209161006108" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528544.png" alt="image-20241209161006108"></a></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528546.png" title="image-20241209163428598" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528546.png" alt="image-20241209163428598"></a>  </p><p>æ­¤æ—¶ç›´æ¥ç»“æŸæœåŠ¡ï¼Œä»£è¡¨å®•æœºï¼Œé˜Ÿåˆ—ä¸­çš„<strong>æœªç¡®è®¤</strong>çš„æ¶ˆæ¯è‡ªåŠ¨è¢«ç¡®è®¤</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528547.png" title="image-20241209163452903" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528547.png" alt="image-20241209163452903"></a> </p><h3 id="æ‰‹åŠ¨ack-ï¼šæ·»åŠ é…ç½®"><a href="#æ‰‹åŠ¨ack-ï¼šæ·»åŠ é…ç½®" class="headerlink" title="æ‰‹åŠ¨ack ï¼šæ·»åŠ é…ç½®"></a>æ‰‹åŠ¨ack ï¼šæ·»åŠ é…ç½®</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.rabbitmq.listener.simple.acknowleage-mode</span><span class="token punctuation">=</span><span class="token value attr-value">maunal # æ‰‹åŠ¨ackæ¶ˆæ¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘é€10æ¡æ¶ˆæ¯ï¼Œæ”¶åˆ°åæ¨¡æ‹Ÿå®•æœºï¼Œå‘ç°æ¶ˆæ¯ä¸ä¼šè‡ªåŠ¨ç¡®è®¤</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528548.png" title="image-20241209164445649" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528548.png" alt="image-20241209164445649"></a> </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528549.png" title="image-20241209164430742" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528549.png" alt="image-20241209164430742"></a> </p><p>å®•æœºåï¼Œæ¶ˆæ¯å›åˆ°å‡†å¤‡çŠ¶æ€ï¼Œæ²¡æœ‰ç¡®è®¤ </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141529496.png" title="image-20241209164704294" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141529496.png" alt="image-20241209164704294"></a>  </p><h3 id="ä¿®æ”¹æ¥æ”¶æ¶ˆæ¯ä»£ç "><a href="#ä¿®æ”¹æ¥æ”¶æ¶ˆæ¯ä»£ç " class="headerlink" title="ä¿®æ”¹æ¥æ”¶æ¶ˆæ¯ä»£ç "></a>ä¿®æ”¹æ¥æ”¶æ¶ˆæ¯ä»£ç </h3><p>æ·»åŠ æ¶ˆè´¹è€…æ¶ˆæ¯ç¡®è®¤<code>ack</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RabbitHandler</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveOrderReturnReason</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">OrderReturnReasonEntity</span> content<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ¥æ”¶åˆ°æ¶ˆæ¯ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ¶ˆæ¯ä½“</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ¶ˆæ¯å¤´é…ç½®</span>    <span class="token class-name">MessageProperties</span> messageProperties <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯å¤„ç†å®Œæˆï¼šæ¶ˆæ¯ä½“å†…å®¹ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> content<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//channelå†…æŒ‰é¡ºåºè‡ªå¢</span>    <span class="token keyword">long</span> deliveryTag <span class="token operator">=</span> messageProperties<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"deliveryTag:&#123;&#125;"</span><span class="token punctuation">,</span> deliveryTag<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ç­¾æ”¶è·å–ï¼Œéæ‰¹é‡æ¨¡å¼</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>deliveryTag <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ç­¾æ”¶è´§ç‰©ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> deliveryTag<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token comment">// æ‹’ç­¾ requeue=falseä¸¢å¼ƒ requeue=true å‘å›æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é‡æ–°å…¥é˜Ÿ</span>           <span class="token comment">// long deliveryTag, boolean multiple, boolean requeue</span>           channel<span class="token punctuation">.</span><span class="token function">basicNack</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// long deliveryTag, boolean requeue</span>           <span class="token comment">// channel.basicReject(deliveryTag, false);</span>           log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ‹’ç»ç­¾æ”¶è´§ç‰©ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> deliveryTag<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//ç½‘ç»œä¸­æ–­</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ¶ˆæ¯ç¡®è®¤ackï¼Œä»æ¶ˆæ¯å¤´ä¸­è·å– <code>deliveryTag</code></li><li><code>deliveryTag</code>ï¼šæ˜¯æ¶ˆæ¯ä¼ é€’æ ‡ç­¾ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ä¸€æ¡æ¶ˆæ¯çš„æŠ•é€’ã€‚è¿™ä¸ªæ ‡ç­¾ä¸»è¦ç”¨äºæ¶ˆæ¯ç¡®è®¤æœºåˆ¶ã€‚<ul><li>æ¶ˆæ¯æŠ•é€’é¡ºåºï¼šåœ¨é€šé“å†…ã€<code>channel</code>ã€‘å†…ï¼Œæ¶ˆæ¯æŒ‰ç…§é¡ºåºè¢«æŠ•é€’ï¼Œå¹¶ä¸”ã€<code>deliveryTag</code> ã€‘å€¼æ˜¯å•è°ƒé€’å¢çš„</li><li>é‡è¯•æœºåˆ¶ï¼šå¯ä»¥æ ¹æ®æœªç¡®è®¤<code>deliveryTag</code>é‡æ–°å°†æ¶ˆæ¯å‘é€ç»™å…¶ä»–æ¶ˆè´¹è€…æˆ–è€…åœ¨ä¸€å®šæ—¶é—´åé‡æ–°å‘é€ç»™åŒä¸€æ¶ˆè´¹è€…ã€‚</li></ul></li><li><code>channel.basicAck(deliveryTag,false)</code> æ‰‹åŠ¨ç¡®è®¤ï¼Œ<code>false</code> éæ‰¹é‡</li><li><code>channel.basicNack(deliveryTag,false,false)</code> æ‹’ç»ç¡®è®¤<ul><li><code>deliveryTag</code>æ ‡è¯†æ¶ˆæ¯çš„æ ‡ç­¾ï¼Œ <code>multiple=false</code> éæ‰¹é‡ï¼Œ<code>requeue=false</code>ä¸¢å¼ƒ( <code>requeue=true</code> <strong>å‘å›æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é‡æ–°å…¥é˜Ÿ</strong>)</li></ul></li><li><code>channel.basicReject(deliverTag,false)</code> æ‹’ç»ç¡®è®¤ï¼Œä¸èƒ½æ‰¹é‡</li></ul><h3 id="æµ‹è¯•ï¼šé‡æ–°å…¥é˜Ÿrequeue-true"><a href="#æµ‹è¯•ï¼šé‡æ–°å…¥é˜Ÿrequeue-true" class="headerlink" title="æµ‹è¯•ï¼šé‡æ–°å…¥é˜Ÿrequeue=true"></a>æµ‹è¯•ï¼šé‡æ–°å…¥é˜Ÿ<code>requeue=true</code></h3><pre><code>å‘é€10æ¡æ¶ˆæ¯ï¼Œ`channel.basicNack(deliveryTag,false,true)` ä¸­ `requeue=true` ï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿï¼Œå†æ¬¡æ¶ˆè´¹</code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528551.png" title="image-20241209203537538" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528551.png" alt="image-20241209203537538"></a> </p><p>æ‰€æœ‰æ¶ˆæ¯æ¶ˆè´¹å®Œæ¯•</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528350.png" title="image-20241209203737712" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528350.png" alt="image-20241209203737712"></a> </p><h3 id="æµ‹è¯•ï¼šä¸¢å¼ƒæ¶ˆæ¯-requeue-false"><a href="#æµ‹è¯•ï¼šä¸¢å¼ƒæ¶ˆæ¯-requeue-false" class="headerlink" title="æµ‹è¯•ï¼šä¸¢å¼ƒæ¶ˆæ¯ requeue=false"></a>æµ‹è¯•ï¼šä¸¢å¼ƒæ¶ˆæ¯ <code>requeue=false</code></h3><p>å‘é€10æ¡æ¶ˆæ¯ï¼Œ<code>channel.basicNack(deliveryTag,false,false)</code> ä¸­ <code>requeue=false</code> ï¼Œæ¶ˆæ¯ç›´æ¥ä¸¢å¼ƒ<a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528299.png" title="image-20241209203750543" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528299.png" alt="image-20241209203750543"></a> </p><p>æ‹’ç»çš„æ¶ˆæ¯ç›´æ¥ä¸¢å¼ƒ</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528604.png" title="image-20241209203831722" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412141528604.png" alt="image-20241209203831722"></a> </p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆäºŒï¼‰| RabbitMQ æ•´åˆ SpringBoot</title>
      <link href="/posts/41545.html"/>
      <url>/posts/41545.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="RabbitMQ-æ•´åˆ-SpringBoot"><a href="#RabbitMQ-æ•´åˆ-SpringBoot" class="headerlink" title="RabbitMQ æ•´åˆ SpringBoot"></a>RabbitMQ æ•´åˆ SpringBoot</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><ol><li><pre><code>å¤§å¤šåº”ç”¨ä¸­ï¼Œå¯é€šè¿‡æ¶ˆæ¯æœåŠ¡ä¸­é—´ä»¶æ¥æå‡ç³»ç»Ÿå¼‚æ­¥é€šä¿¡ã€æ‰©å±•è§£è€¦èƒ½åŠ›ã€æµé‡å‰Šå³°</code></pre></li><li> æ¶ˆæ¯æœåŠ¡ä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼š<pre><code>æ¶ˆæ¯ä»£ç†ï¼ˆ`message broker`ï¼‰å’Œç›®çš„åœ°ï¼ˆ`destination`ï¼‰å½“æ¶ˆæ¯å‘é€è€…å‘é€æ¶ˆæ¯ä»¥åï¼Œå°†ç”±æ¶ˆæ¯ä»£ç†æ¥ç®¡ï¼Œæ¶ˆæ¯ä»£ç†ä¿è¯æ¶ˆæ¯ä¼ é€’åˆ°æŒ‡å®šç›®çš„åœ°ã€‚</code></pre></li><li> æ¶ˆæ¯é˜Ÿåˆ—ä¸»è¦æœ‰ä¸¤ç§å½¢å¼çš„ç›®çš„åœ°<pre><code>1.     é˜Ÿåˆ—ï¼ˆ`queue`ï¼‰ï¼šç‚¹å¯¹ç‚¹æ¶ˆæ¯é€šä¿¡ï¼ˆ`point-to-point`ï¼‰2.     ä¸»é¢˜ï¼ˆ`topic`ï¼‰ï¼šå‘å¸ƒï¼ˆ`publish`ï¼‰/è®¢é˜…ï¼ˆ`subscribe`ï¼‰æ¶ˆæ¯é€šä¿¡</code></pre></li></ol><h2 id="RabbitMQ-æ¶æ„å›¾"><a href="#RabbitMQ-æ¶æ„å›¾" class="headerlink" title="RabbitMQ æ¶æ„å›¾"></a>RabbitMQ æ¶æ„å›¾</h2><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131721524.svg" title="rabbitmqæ¶æ„" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131721524.svg" alt="rabbitmqæ¶æ„"></a></p><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h4 id="ç”Ÿäº§è€…-Producer"><a href="#ç”Ÿäº§è€…-Producer" class="headerlink" title="ç”Ÿäº§è€… Producer"></a>ç”Ÿäº§è€… Producer</h4><pre><code>ç”Ÿäº§è€…æ˜¯æ¶ˆæ¯çš„å‘é€æ–¹ï¼Œå®ƒå°†æ¶ˆæ¯å‘é€åˆ° RabbitMQ çš„äº¤æ¢å™¨ä¸­ã€‚</code></pre><h4 id="âœ¨æ¶ˆæ¯-Message"><a href="#âœ¨æ¶ˆæ¯-Message" class="headerlink" title="âœ¨æ¶ˆæ¯ Message"></a>âœ¨æ¶ˆæ¯ Message</h4><ul><li>æ¶ˆæ¯=æ¶ˆæ¯å¤´+æ¶ˆæ¯ä½“ï¼Œæ ¹æ®routekeyå‘é€åˆ°æŒ‡å®šçš„äº¤æ¢æœº Exchange</li><li>æ¶ˆæ¯å¤´ï¼šå«æœ‰å„ç§å±æ€§ <strong>routing-key</strong>ï¼ˆè·¯ç”±é”®ï¼‰ã€priorityï¼ˆä¼˜å…ˆçº§ï¼‰ã€delivery-modeï¼ˆæŒ‡å‡ºè¯¥æ¶ˆæ¯å¯èƒ½éœ€è¦æŒä¹…æ€§å­˜å‚¨ï¼‰ç­‰ã€‚</li></ul><h4 id="âœ¨æ¶ˆæ¯ä»£ç†-Broker"><a href="#âœ¨æ¶ˆæ¯ä»£ç†-Broker" class="headerlink" title="âœ¨æ¶ˆæ¯ä»£ç† Broker"></a>âœ¨æ¶ˆæ¯ä»£ç† Broker</h4><ul><li>æ¶ˆæ¯ä¼ é€’çš„ä¸­é—´ä»¶æœåŠ¡å™¨ï¼Œè´Ÿè´£æ¥æ”¶ã€å­˜å‚¨å’Œè½¬å‘æ¶ˆæ¯ï¼Œä½œç”¨ç±»ä¼¼é‚®å±€ğŸ£</li><li>æ¶ˆæ¯å­˜å‚¨+æ¶ˆæ¯è·¯ç”±</li><li>Broker = VHost1+Vhost2+Vhost3+â€¦..</li><li>Virtual Host = Exchange + Queue +Binding</li></ul><h4 id="è™šæ‹Ÿä¸»æœº-Virtual-Host"><a href="#è™šæ‹Ÿä¸»æœº-Virtual-Host" class="headerlink" title="è™šæ‹Ÿä¸»æœº Virtual Host"></a>è™šæ‹Ÿä¸»æœº Virtual Host</h4><ul><li><p>é€»è¾‘åˆ†ç»„æœºåˆ¶ï¼Œå°†ä¸åŒçš„ç”¨æˆ·ã€é˜Ÿåˆ—ã€äº¤æ¢å™¨ç­‰èµ„æºéš”ç¦»å¼€æ¥</p></li><li><p>Virtual å³ VHost</p></li><li><p>é»˜è®¤ç›®å½• /</p></li></ul><h4 id="âœ¨äº¤æ¢æœº-Exchange"><a href="#âœ¨äº¤æ¢æœº-Exchange" class="headerlink" title="âœ¨äº¤æ¢æœº Exchange"></a>âœ¨äº¤æ¢æœº Exchange</h4><ul><li>ç»‘å®š routekeyæ¥æ”¶æ¶ˆæ¯å¹¶å‘é€åˆ°ç¬¦åˆroutekey çš„ é˜Ÿåˆ—</li><li>å¸¸ç”¨ä¸‰ç§ç±»å‹<ul><li>âœ¨<strong>dirct</strong>ï¼š<strong>Direct Exchangeï¼ˆç›´è¿äº¤æ¢å™¨ï¼‰</strong> ã€<strong>å•æ’­</strong>ã€‘å®Œå…¨åŒ¹é…<strong>è·¯ç”±é”®</strong>çš„é˜Ÿåˆ—<ul><li><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131719657.png" title="image-20241207003055398" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131719657.png" alt="image-20241207003055398"></a> </li></ul></li><li>âœ¨<strong>fanout</strong>ï¼š<strong>Fanout Exchangeï¼ˆæ‰‡å‡ºäº¤æ¢å™¨ï¼‰</strong>ã€<strong>å¹¿æ’­</strong>ã€‘æ¶ˆæ¯åˆ†å‘æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—ä¸Šï¼Œä¸å¤„ç†è·¯ç”±é”®<ul><li><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131719560.png" title="image-20241207003049286" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131719560.png" alt="image-20241207003049286"></a> </li></ul></li><li>âœ¨<strong>topic</strong>ï¼š<strong>Topic Exchangeï¼ˆä¸»é¢˜äº¤æ¢å™¨ï¼‰</strong>ã€<strong>æ¨¡å¼åŒ¹é…</strong>ã€‘<ul><li><code>#</code>:é…ç½®0ä¸ªæˆ–è€…å¤šä¸ªå•è¯</li><li><code>*</code>ï¼šåŒ¹é…ä¸€ä¸ªå•è¯</li><li><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720772.png" title="image-20241207003038106" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720772.png" alt="image-20241207003038106"></a>ã€€</li></ul></li><li>headersï¼šå¾ˆå°‘ä½¿ç”¨</li><li>systemï¼šå¾ˆå°‘ä½¿ç”¨</li></ul></li></ul><h4 id="âœ¨é˜Ÿåˆ—-Queue"><a href="#âœ¨é˜Ÿåˆ—-Queue" class="headerlink" title="âœ¨é˜Ÿåˆ— Queue"></a>âœ¨é˜Ÿåˆ— Queue</h4><ul><li>å­˜å‚¨æ¶ˆæ¯çš„å®¹å™¨ï¼ŒFIFO</li><li>ç¼“å†²æ¶ˆæ¯+æŒä¹…åŒ–</li></ul><h4 id="ç»‘å®š-Binding"><a href="#ç»‘å®š-Binding" class="headerlink" title="ç»‘å®š Binding"></a>ç»‘å®š Binding</h4><ul><li>ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—å’Œäº¤æ¢å™¨ä¹‹é—´çš„å…³è”ã€‚</li><li>ä¸€ä¸ªç»‘å®šå°±æ˜¯åŸºäºè·¯ç”±é”®å°†äº¤æ¢å™¨å’Œæ¶ˆæ¯é˜Ÿåˆ—è¿æ¥èµ·æ¥çš„è·¯ç”±è§„åˆ™ï¼Œæ‰€ä»¥å¯ä»¥å°†äº¤æ¢å™¨ç†è§£æˆä¸€ä¸ªç”±ç»‘å®šæ„æˆçš„è·¯ç”±è¡¨ã€‚</li><li>Exchange å’ŒQueueçš„ç»‘å®šå¯ä»¥æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</li></ul><h4 id="è¿æ¥-Connection"><a href="#è¿æ¥-Connection" class="headerlink" title="è¿æ¥ Connection"></a>è¿æ¥ Connection</h4><ul><li>ç½‘ç»œè¿æ¥ï¼Œæ¯”å¦‚ä¸€ä¸ªTCPè¿æ¥</li></ul><h4 id="ä¿¡é“-Channel"><a href="#ä¿¡é“-Channel" class="headerlink" title="ä¿¡é“ Channel"></a>ä¿¡é“ Channel</h4><ul><li>ä¿¡é“ï¼Œå¤šè·¯å¤ç”¨è¿æ¥ä¸­çš„ä¸€æ¡<strong>ç‹¬ç«‹çš„åŒå‘æ•°æ®æµé€šé“</strong>ã€‚ä¿¡é“æ˜¯å»ºç«‹åœ¨çœŸå®çš„TCPè¿æ¥å†…çš„è™šæ‹Ÿè¿æ¥ï¼ŒAMQP å‘½ä»¤éƒ½æ˜¯é€šè¿‡ä¿¡é“å‘å‡ºå»çš„ï¼Œä¸ç®¡æ˜¯<strong>å‘å¸ƒæ¶ˆæ¯</strong>ã€<strong>è®¢é˜…é˜Ÿåˆ—</strong>è¿˜æ˜¯<strong>æ¥æ”¶æ¶ˆæ¯</strong>ï¼Œè¿™äº›åŠ¨ä½œéƒ½æ˜¯é€šè¿‡ä¿¡é“å®Œæˆã€‚å› ä¸ºå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´å»ºç«‹å’Œé”€æ¯ TCP éƒ½æ˜¯éå¸¸æ˜‚è´µçš„å¼€é”€ï¼Œæ‰€ä»¥å¼•å…¥äº†ä¿¡é“çš„æ¦‚å¿µï¼Œä»¥å¤ç”¨ä¸€æ¡ TCP è¿æ¥ã€‚</li></ul><h4 id="æ¶ˆè´¹è€…-Consumer"><a href="#æ¶ˆè´¹è€…-Consumer" class="headerlink" title="æ¶ˆè´¹è€… Consumer"></a>æ¶ˆè´¹è€… Consumer</h4><pre><code>æ¶ˆè´¹è€…æ˜¯æ¶ˆæ¯çš„æ¥æ”¶æ–¹ï¼Œå®ƒä» RabbitMQ çš„é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ã€‚</code></pre><h2 id="Docker-å®‰è£…-RMQ"><a href="#Docker-å®‰è£…-RMQ" class="headerlink" title="Docker å®‰è£… RMQ"></a>Docker å®‰è£… RMQ</h2> <pre class="line-numbers language-none"><code class="language-none">docker run -d --restart&#x3D;always --name rabbitmq -p 5671:5671 -p 5672:5672 -p 4369:43699-p25672:25672-p 15671:15671 -p 15672:15672 rabbitmq:management<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="åå°é¡µé¢æ”¶å‘æ¶ˆæ¯"><a href="#åå°é¡µé¢æ”¶å‘æ¶ˆæ¯" class="headerlink" title="åå°é¡µé¢æ”¶å‘æ¶ˆæ¯"></a>åå°é¡µé¢æ”¶å‘æ¶ˆæ¯</h2><p>æ‰“å¼€ <a href="localhost:15672">localhost:15672</a></p><h3 id="ç™»å½•é¡µé¢"><a href="#ç™»å½•é¡µé¢" class="headerlink" title="ç™»å½•é¡µé¢"></a>ç™»å½•é¡µé¢</h3><pre class="line-numbers language-none"><code class="language-none">ç™»å½•çš„ç”¨æˆ·å¯†ç ï¼šguest&#x2F;guest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720654.png" title="ç™»å½•é¡µé¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720654.png" alt="ç™»å½•é¡µé¢"></a> </p><h3 id="ç™»å½•åå°é¦–é¡µ"><a href="#ç™»å½•åå°é¦–é¡µ" class="headerlink" title="ç™»å½•åå°é¦–é¡µ"></a>ç™»å½•åå°é¦–é¡µ</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720356.png" title="é¦–é¡µ" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720356.png" alt="é¦–é¡µ"></a></p><h3 id="äº¤æ¢æœº-Exchangeé¡µé¢"><a href="#äº¤æ¢æœº-Exchangeé¡µé¢" class="headerlink" title="äº¤æ¢æœº Exchangeé¡µé¢"></a>äº¤æ¢æœº Exchangeé¡µé¢</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720609.png" title="äº¤æ¢æœºé¡µé¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720609.png" alt="äº¤æ¢æœºé¡µé¢"></a> </p><p>äº”ç§äº¤æ¢æœºç±»å‹ï¼š<strong>direct</strong>ã€<strong>fanout</strong>ã€headersã€<strong>topic</strong>ã€x-local-random</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720740.png" title="æ–°å¢äº¤æ¢æœº" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720740.png" alt="æ–°å¢äº¤æ¢æœº"></a> </p><h3 id="é˜Ÿåˆ—é¡µé¢"><a href="#é˜Ÿåˆ—é¡µé¢" class="headerlink" title="é˜Ÿåˆ—é¡µé¢"></a>é˜Ÿåˆ—é¡µé¢</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720697.png" title="é˜Ÿåˆ—é¡µé¢" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720697.png" alt="é˜Ÿåˆ—é¡µé¢"></a> </p><h3 id="ç»‘å®šï¼šäº¤æ¢æœºæ ¹æ®è·¯ç”±é”®ç»‘å®šåˆ°å¯¹åº”çš„é˜Ÿåˆ—"><a href="#ç»‘å®šï¼šäº¤æ¢æœºæ ¹æ®è·¯ç”±é”®ç»‘å®šåˆ°å¯¹åº”çš„é˜Ÿåˆ—" class="headerlink" title="ç»‘å®šï¼šäº¤æ¢æœºæ ¹æ®è·¯ç”±é”®ç»‘å®šåˆ°å¯¹åº”çš„é˜Ÿåˆ—"></a>ç»‘å®šï¼šäº¤æ¢æœºæ ¹æ®è·¯ç”±é”®ç»‘å®šåˆ°å¯¹åº”çš„é˜Ÿåˆ—</h3><blockquote><p><strong>Virtual Host</strong>ã€Exchange â€“&gt; binding(<strong>route-key</strong>) ã€‘â€“&gt; Queue(<strong>route-key</strong>)</p><p>é»˜è®¤çš„è™šæ‹Ÿä¸»æœºçš„è·¯å¾„æ˜¯ â€œ/â€œï¼Œå³<strong>æ ¹ç›®å½•</strong></p></blockquote><p><strong>äº¤æ¢æœºå’Œé˜Ÿåˆ—ç»‘å®š</strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720696.png" title="äº¤æ¢æœºç»‘å®šé˜Ÿåˆ—" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720696.png" alt="äº¤æ¢æœºç»‘å®šé˜Ÿåˆ—"></a> </p><p><strong>é˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®šå…³ç³»</strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720966.png" title="é˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®šå…³ç³»" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720966.png" alt="é˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®šå…³ç³»"></a></p><h2 id="SpringBoot-æ•´åˆ"><a href="#SpringBoot-æ•´åˆ" class="headerlink" title="SpringBoot æ•´åˆ"></a>SpringBoot æ•´åˆ</h2><h3 id="é…ç½®pom-æ–‡ä»¶"><a href="#é…ç½®pom-æ–‡ä»¶" class="headerlink" title="é…ç½®pom æ–‡ä»¶"></a>é…ç½®pom æ–‡ä»¶</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--AMQPä¾èµ–ï¼ŒåŒ…å«RabbitMQ--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é…ç½®application-yaml"><a href="#é…ç½®application-yaml" class="headerlink" title="é…ç½®application.yaml"></a>é…ç½®application.yaml</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">application</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">-</span>demo  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest    <span class="token key atrule">virtualHost</span><span class="token punctuation">:</span> /<span class="token comment">#    publisher-confirm-type: CORRELATED</span><span class="token comment">#    publisher-returns: true</span><span class="token comment">#    listener:</span><span class="token comment">#      simple:</span><span class="token comment">#        acknowledge-mode: manual #é»˜è®¤æƒ…å†µä¸‹æ¶ˆæ¯æ¶ˆè´¹è€…æ˜¯è‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯çš„ï¼Œå¦‚æœè¦æ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯åˆ™éœ€è¦ä¿®æ”¹ç¡®è®¤æ¨¡å¼ä¸ºmanual</span><span class="token comment">#        prefetch: 1 # æ¶ˆè´¹è€…æ¯æ¬¡ä»é˜Ÿåˆ—è·å–çš„æ¶ˆæ¯æ•°é‡ã€‚æ­¤å±æ€§å½“ä¸è®¾ç½®æ—¶ä¸ºï¼šè½®è¯¢åˆ†å‘ï¼Œè®¾ç½®ä¸º1ä¸ºï¼šå…¬å¹³åˆ†å‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•ç±»ä¸­-åˆ›å»ºäº¤æ¢æœº"><a href="#æµ‹è¯•ç±»ä¸­-åˆ›å»ºäº¤æ¢æœº" class="headerlink" title="æµ‹è¯•ç±»ä¸­-åˆ›å»ºäº¤æ¢æœº"></a>æµ‹è¯•ç±»ä¸­-åˆ›å»ºäº¤æ¢æœº</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token keyword">class</span> <span class="token class-name">RabbitmqDemoApplicationTests</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token class-name">AmqpAdmin</span> amqpAdmin<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">DirectExchange</span> directExchange <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        amqpAdmin<span class="token punctuation">.</span><span class="token function">declareExchange</span><span class="token punctuation">(</span>directExchange<span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Exchange[hello-java-exchange] åˆ›å»ºå®Œæˆ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æˆåŠŸåˆ›å»º</strong><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720837.png" title="image-20241206170654862" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720837.png" alt="image-20241206170654862"></a></p><h3 id="åˆ›å»ºé˜Ÿåˆ—"><a href="#åˆ›å»ºé˜Ÿåˆ—" class="headerlink" title="åˆ›å»ºé˜Ÿåˆ—"></a>åˆ›å»ºé˜Ÿåˆ—</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Queue</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">"hello-java-queue"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    amqpAdmin<span class="token punctuation">.</span><span class="token function">declareQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Queue[hello-java-queue] åˆ›å»ºå®Œæˆ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡ŒåæˆåŠŸåˆ›å»º</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720822.png" title="image-20241206170811552" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720822.png" alt="image-20241206170811552"></a> </p><h3 id="åˆ›å»ºç»‘å®š"><a href="#åˆ›å»ºç»‘å®š" class="headerlink" title="åˆ›å»ºç»‘å®š"></a>åˆ›å»ºç»‘å®š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Binding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Binding</span> binding <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Binding</span><span class="token punctuation">(</span><span class="token string">"hello-java-queue"</span><span class="token punctuation">,</span>                                  <span class="token class-name">Binding<span class="token punctuation">.</span>DestinationType</span><span class="token punctuation">.</span><span class="token constant">QUEUE</span><span class="token punctuation">,</span>                                  <span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span>                                  <span class="token string">"hello-java"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    amqpAdmin<span class="token punctuation">.</span><span class="token function">declareBinding</span><span class="token punctuation">(</span>binding<span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Binding[hello-java-binding] åˆ›å»ºå®Œæˆ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç›´è¿äº¤æ¢æœº</strong>ã€<code>hello-java-exchang</code>eã€‘å’Œé˜Ÿåˆ—ã€<code>hello-java-queue</code>ã€‘ç”¨ <code>routingkey</code> ã€<code>hello-java</code>ã€‘ç»‘å®š</p><p><strong>é˜Ÿåˆ—ç»‘å®š</strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720396.png" title="image-20241206170917982" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720396.png" alt="image-20241206170917982"></a></p><p><strong>äº¤æ¢æœºç»‘å®š</strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720598.png" title="image-20241206171001858" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720598.png" alt="image-20241206171001858"></a></p><h3 id="å‘é€æ¶ˆæ¯ã€JSONæ¶ˆæ¯è½¬æ¢å™¨ã€‘"><a href="#å‘é€æ¶ˆæ¯ã€JSONæ¶ˆæ¯è½¬æ¢å™¨ã€‘" class="headerlink" title="å‘é€æ¶ˆæ¯ã€JSONæ¶ˆæ¯è½¬æ¢å™¨ã€‘"></a>å‘é€æ¶ˆæ¯ã€JSONæ¶ˆæ¯è½¬æ¢å™¨ã€‘</h3><p>é…ç½® <code>RabbitConfig</code> åºåˆ—åŒ– <code>json</code> </p><blockquote><p>æ ¹æ®æºç  <code>RabbitAutoConfiguration</code>  åˆ›å»º<code>@Bean RabbitTemplate</code> ä¸­çš„æ¶ˆæ¯è½¬æ¢å™¨å±æ€§ <code>MessageConverter messageConverter = new SimpleMessageConverter();</code></p><p>è¯´æ˜äº†<code>RabbitMQ</code> è‡ªåŠ¨é…ç½®è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºå·¥å…·ç±»ã€<code>RabbitTemplate</code>ã€‘ï¼Œå…¶ä¸­é»˜è®¤çš„æ¶ˆæ¯è½¬æ¢å™¨æ˜¯ ã€<code>SimpleMessageConverter</code>ã€‘ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ã€<code>SimpleMessageConverter</code>ã€‘æºç æ˜¯å¦‚ä½•æ”¶å‘æ¶ˆæ¯çš„</p></blockquote><p><strong><code>SimpleMessageConverter</code>åˆ›å»ºæ¶ˆæ¯</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åˆ›å»ºæ¶ˆæ¯,é»˜è®¤ä½¿ç”¨åºåˆ—åŒ– Serializableç±»å‹å‘é€ï¼Œå‘é€çš„æ¶ˆæ¯å®ä½“éœ€è¦å®ç°åºåˆ—åŒ–</span><span class="token keyword">protected</span> <span class="token class-name">Message</span> <span class="token function">createMessage</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span> messageProperties<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessageConversionException</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        messageProperties<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/octet-stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            bytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">(</span><span class="token string">"failed to convert to Message content"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        messageProperties<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/plain"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        messageProperties<span class="token punctuation">.</span><span class="token function">setContentEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token keyword">instanceof</span> <span class="token class-name">Serializable</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            bytes <span class="token operator">=</span> <span class="token class-name">SerializationUtils</span><span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalArgumentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">(</span><span class="token string">"failed to convert to serialized Message content"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        messageProperties<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/x-java-serialized-object"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        messageProperties<span class="token punctuation">.</span><span class="token function">setContentLength</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>bytes<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> messageProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> var10002 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>var10002 <span class="token operator">+</span> <span class="token string">" only supports String, byte[] and Serializable payloads, received: "</span> <span class="token operator">+</span> object<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><code>SimpleMessageConverter</code>æ¶ˆè´¹æ¶ˆæ¯</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">fromMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MessageConversionException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> content <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">MessageProperties</span> properties <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>properties <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> contentType <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> contentType<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">String</span> encoding <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getContentEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>encoding <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    encoding <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>defaultCharset<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> encoding<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">(</span><span class="token string">"failed to convert text-based Message content"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> contentType<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"application/x-java-serialized-object"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    content <span class="token operator">=</span> <span class="token class-name">SerializationUtils</span><span class="token punctuation">.</span><span class="token function">deserialize</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalArgumentException</span> <span class="token operator">|</span> <span class="token class-name">IllegalStateException</span> <span class="token operator">|</span> <span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">(</span><span class="token string">"failed to convert serialized Message content"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            content <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> content<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹è½¬å™¨ <code>MessageConverter</code></strong></p><blockquote><p><code>MessageConverter</code> çš„å±‚æ¬¡ç»“æ„</p></blockquote><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720416.png" title="image-20241207013346381" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720416.png" alt="image-20241207013346381"></a></p><p><strong>è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹è½¬æ¢å™¨</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>support<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">Jackson2JsonMessageConverter</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>support<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">MessageConverter</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">MessageConverter</span> <span class="token function">jsonMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºæ•°æ®ï¼š<strong>è®¢å•é€€å‡ºåŸå› å®ä½“å¯¹è±¡</strong> æ³¨æ„éœ€è¦åºåˆ—åŒ– <code>Serializable</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ToString</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Accessors</span><span class="token punctuation">(</span>chain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">//@TableName("oms_order_return_reason")</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderReturnReasonEntity</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span><span class="token comment">/** * é€€è´§åŸå› å */</span><span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span class="token comment">/** * æ’åº */</span><span class="token keyword">private</span> <span class="token class-name">Integer</span> sort<span class="token punctuation">;</span><span class="token comment">/** * å¯ç”¨çŠ¶æ€ */</span><span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span><span class="token comment">/** * create_time */</span><span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ç±»ä¸­å‘é€æ¶ˆæ¯</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span><span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">OrderReturnReasonEntity</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderReturnReasonEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    data<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"hello-java-exchange"</span><span class="token punctuation">,</span> <span class="token string">"hello-java"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å‘é€æ¶ˆæ¯: &#123;&#125;"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é˜Ÿåˆ—æ”¶åˆ°æ¶ˆæ¯</strong></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720069.png" title="image-20241206192848893" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720069.png" alt="image-20241206192848893"></a> </p><p><strong>æ”¶åˆ°æ¶ˆæ¯å¯¹è±¡</strong> </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720465.png" title="image-20241206193039689" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412131720465.png" alt="image-20241206193039689"></a> </p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"id"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"æµ‹è¯•"</span><span class="token punctuation">,</span><span class="token property">"sort"</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">"status"</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">"createTime"</span><span class="token operator">:</span><span class="token number">1733484472414</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æ¥æ”¶ä¿¡æ¯"><a href="#æ¥æ”¶ä¿¡æ¯" class="headerlink" title="æ¥æ”¶ä¿¡æ¯"></a>æ¥æ”¶ä¿¡æ¯</h3><p>åœ¨<strong>å¯åŠ¨ç±»</strong>ä¸Šæ·»åŠ  <code>@EnableRabbit </code>å¼€å¯ RabbitMQ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableRabbit</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqDemoApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">RabbitmqDemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨éœ€è¦æ¥æ”¶æ¶ˆæ¯çš„åœ°æ–¹æ·»åŠ æ–¹æ³• <code>@RabbitListerner</code> ã€<code>@RabbitHandler</code></p><blockquote><p>@<code>RabbitListerner</code> ï¼šç”¨åœ¨ç±»å’Œæ–¹æ³•ä¸Šå¹¶ç»‘å®šå¯¹åº”çš„é˜Ÿåˆ—</p><p>@<code>RabbitHandler</code>ï¼šç”¨åœ¨æ–¹æ³•ä¸Šï¼Œå¯ä»¥æ¥æ”¶<strong>ä¸åŒçš„ç±»å‹çš„æ•°æ®</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"hello-java-queue"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderMQHandler</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@RabbitHandler</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveOrderReturnReason</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">OrderReturnReasonEntity</span> content<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//æ¶ˆæ¯ä½“</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¶ˆæ¯å¤´é…ç½®</span>        <span class="token class-name">MessageProperties</span> messageProperties <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆæ¯ä½“å†…å®¹ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@RabbitHandler</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiverOrder</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span> content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ¥æ”¶æ¶ˆæ¯=>Orderï¼š&#123;&#125;"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæ”¶åˆ°<code>OrderReturnReasonEntity</code>å¯¹è±¡æ•°æ®</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">2024-12-06T22:46:37.495+08:00  INFO 15808 --- [ntContainer#0-3] c.s.rabbitmqdemo.handler.OrderMQHandler  : æ¶ˆæ¯ä½“å†…å®¹ï¼šOrderReturnReasonEntity(id&#x3D;1, name&#x3D;æµ‹è¯•-0, sort&#x3D;null, status&#x3D;null, createTime&#x3D;Fri Dec 06 22:46:37 CST 2024)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸæ”¶åˆ°<code>OrderEntity</code>å¯¹è±¡æ•°æ®</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">2024-12-06T22:46:37.522+08:00  INFO 15808 --- [ntContainer#0-3] c.s.rabbitmqdemo.handler.OrderMQHandler  : æ¥æ”¶æ¶ˆæ¯&#x3D;&gt;Orderï¼šOrderEntity(id&#x3D;1, memberId&#x3D;null, orderSn&#x3D;null, couponId&#x3D;null, createTime&#x3D;Fri Dec 06 22:46:37 CST 2024, memberUsername&#x3D;æµ‹è¯•-1, totalAmount&#x3D;null, payAmount&#x3D;null, freightAmount&#x3D;null, promotionAmount&#x3D;null, integrationAmount&#x3D;null, couponAmount&#x3D;null, discountAmount&#x3D;null, payType&#x3D;null, sourceType&#x3D;null, status&#x3D;null, deliveryCompany&#x3D;null, deliverySn&#x3D;null, autoConfirmDay&#x3D;null, integration&#x3D;null, growth&#x3D;null, billType&#x3D;null, billHeader&#x3D;null, billContent&#x3D;null, billReceiverPhone&#x3D;null, billReceiverEmail&#x3D;null, receiverName&#x3D;null, receiverPhone&#x3D;null, receiverPostCode&#x3D;null, receiverProvince&#x3D;null, receiverCity&#x3D;null, receiverRegion&#x3D;null, receiverDetailAddress&#x3D;null, note&#x3D;null, confirmStatus&#x3D;null, deleteStatus&#x3D;null, useIntegration&#x3D;null, paymentTime&#x3D;null, deliveryTime&#x3D;null, receiveTime&#x3D;null, commentTime&#x3D;null, modifyTime&#x3D;null)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQç³»åˆ—ï¼ˆä¸€ï¼‰| RabbitMQ å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/46172.html"/>
      <url>/posts/46172.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="RabbitMQ-å¿«é€Ÿå…¥é—¨"><a href="#RabbitMQ-å¿«é€Ÿå…¥é—¨" class="headerlink" title="RabbitMQ å¿«é€Ÿå…¥é—¨"></a>RabbitMQ å¿«é€Ÿå…¥é—¨</h1><blockquote><p>å®˜ç½‘ï¼š<a href="https://www.rabbitmq.com/">https://www.rabbitmq.com/</a></p><p>å…¥é—¨æ•™ç¨‹ï¼š<a href="https://www.rabbitmq.com/tutorials">https://www.rabbitmq.com/tutorials</a></p><p>æœ€æ–°ç‰ˆæœ¬ï¼š<code>4.0.2</code></p><p>ç‰ˆæœ¬å‚è€ƒï¼š<code>JDK17ã€Maven Or Gradle</code></p></blockquote><h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><p>RabbitMQæ˜¯ä¸€ä¸ªå¯é ä¸”æˆç†Ÿçš„æ¶ˆæ¯ä¼ é€’å’Œæµä»£ç†ï¼Œæ˜“äºéƒ¨ç½²åœ¨äº‘ç¯å¢ƒã€æœ¬åœ°å’Œæœ¬åœ°æœºå™¨ä¸Šã€‚å®ƒç›®å‰è¢«å…¨çƒæ•°ç™¾ä¸‡äººä½¿ç”¨ã€‚<br><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/rabbitmq-logo-with-name.svg" title="rabbitmq-logo-with-name" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/rabbitmq-logo-with-name.svg" alt="rabbitmq-logo-with-name"  /></a></p><h2 id="2ã€ä¸ºä»€ä¹ˆä½¿ç”¨"><a href="#2ã€ä¸ºä»€ä¹ˆä½¿ç”¨" class="headerlink" title="2ã€ä¸ºä»€ä¹ˆä½¿ç”¨"></a>2ã€ä¸ºä»€ä¹ˆä½¿ç”¨</h2><p>å…¬å¸ä¸šåŠ¡åœºæ™¯æ ¸å¿ƒï¼šè§£è€¦ã€å¼‚æ­¥ã€å‰Šå³°</p><h3 id="2-1ã€è§£è€¦"><a href="#2-1ã€è§£è€¦" class="headerlink" title="2.1ã€è§£è€¦"></a>2.1ã€è§£è€¦</h3><p><code>A</code>ç³»ç»Ÿå‘æ•°æ®ç»™åˆ°<code>BCD</code>ç³»ç»Ÿï¼Œå¦‚æœ<code>E</code>ç³»ç»Ÿéœ€è¦æ¥å…¥ï¼Ÿ<code>C</code>ç³»ç»Ÿä¸éœ€è¦äº†ï¼ŸAç³»ç»Ÿçš„è´Ÿè´£äººå°±éœ€è¦æ¥å›ä¿®æ”¹æ¥å£å¯¹æ¥å…¶ä»–ç³»ç»Ÿã€‚</p><p> <a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203061747025.png" title="æœªè§£è€¦" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203061747025.png" alt="æœªè§£è€¦"></a></p><p>å¦‚æœä½¿ç”¨<code>MQ</code>ï¼Œ<code>A</code>ç³»ç»Ÿäº§ç”Ÿä¸€æ¡æ•°æ®ï¼Œå‘é€åˆ°<code>MQ</code>ä¸­ï¼Œé‚£ä¸ªç³»ç»Ÿéœ€è¦æ•°æ®è‡ªå·±å»<code>MQ</code>æ¶ˆè´¹ã€‚å¦‚æœæ–°çš„ç³»ç»Ÿéœ€è¦æ•°æ®ï¼Œç›´æ¥ä»<code>MQ</code>ä¸­æ¶ˆè´¹ï¼›æŸä¸ªç³»ç»Ÿä¸éœ€è¦æ•°æ®çš„è¯ï¼Œå–æ¶ˆæ¶ˆè´¹è¿™ä¸ª<code>MQ</code>å³å¯ã€‚è¿™æ ·<code>A</code>ç³»ç»Ÿä¸éœ€è¦è€ƒè™‘è°å‘é€æ•°æ®ç»™è°ï¼Œä¸éœ€è¦è€ƒè™‘æ˜¯å¦è°ƒç”¨æˆåŠŸã€å¤±è´¥è¶…æ—¶ç­‰é—®é¢˜ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062104532.png" title="MQè§£è€¦" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062104532.png" alt="MQè§£è€¦"></a> </p><p><strong>æ€»ç»“</strong>ï¼šé€šè¿‡ä¸€ä¸ª<code>MQ</code>ï¼Œ<code>Pub/Sub</code>å‘å¸ƒè®¢é˜…æ¶ˆæ¯æ¨¡å‹ï¼Œ<code>A</code>ç³»ç»Ÿå°±å’Œå…¶ä»–ç³»ç»Ÿå½»åº•è€¦åˆäº†ã€‚</p><h4 id="2-2-1ã€é¡¹ç›®åº”ç”¨"><a href="#2-2-1ã€é¡¹ç›®åº”ç”¨" class="headerlink" title="2.2.1ã€é¡¹ç›®åº”ç”¨"></a>2.2.1ã€é¡¹ç›®åº”ç”¨</h4><p> è½¦ç«™ç³»ç»Ÿé€šè¿‡æ§åˆ¶å‘½ä»¤ä¸‹å‘ç»™å„ä¸ªè®¾å¤‡ï¼Œå…¶ä¸­è½¦ç«™çš„è®¾å¤‡é€šå¸¸åŒ…å«ï¼š<strong>é—¸æœº</strong>ã€<strong>åŠè‡ªåŠ¨å”®ç¥¨æœº</strong>ã€<strong>è‡ªåŠ¨å”®ç¥¨æœº</strong>ã€<strong>æ‰‹æŒæœºç­‰è®¾å¤‡</strong>ã€‚</p><p>å¦‚æœæŒ‰ç…§å¸¸è§„çš„åŒæ­¥æ–¹å¼æ¥å¯¹æ¥ä¸åŒçš„è®¾å¤‡ï¼Œè¿™å°†ä½¿å¾—ç³»ç»Ÿå†—ä½™çš„ä»£ç å¾ˆå¤šã€‚å½“è½¦ç«™å¢å‡ä¸€ä¸ªè®¾å¤‡å°±å¯èƒ½éœ€è¦é‡æ–°å¯¹æ¥æ¥å£ï¼Œé€ æˆç³»ç»Ÿ<strong>è€¦åˆæ€§å¾ˆé«˜</strong>ï¼Œè¿™æ ·çš„æ•ˆç‡ä¸é«˜ä¸”ä¸ä¼˜é›…ã€‚</p><p>æ‰€ä»¥å½“ç³»ç»Ÿéœ€è¦å‘é€å‘½ä»¤ï¼ˆ<strong>ç”Ÿäº§ä¸€ä¸ªæ•°æ®</strong>ï¼‰ï¼Œå°†æ•°æ®æ”¾åˆ°<code>MQ</code>ä¸­ï¼Œä¸éœ€è¦çŸ¥é“å“ªä¸ªè®¾å¤‡æ¥æ”¶æ¶ˆæ¯æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå…¶ä¸­éœ€è¦æ¶ˆè´¹çš„è®¾å¤‡è‡ªå·±å»è®¢é˜…å¹¶ä¸”è·å–ç›¸åº”çš„æ¶ˆæ¯å³å¯ã€‚è¿™æ ·å°±å¯ä»¥è¾¾åˆ°ç³»ç»Ÿä¸‹å‘è®¾å¤‡æ§åˆ¶å‘½ä»¤ï¼Œä¸åŒè®¾å¤‡å“åº”ã€‚</p><h3 id="2-2ã€å¼‚æ­¥"><a href="#2-2ã€å¼‚æ­¥" class="headerlink" title="2.2ã€å¼‚æ­¥"></a>2.2ã€å¼‚æ­¥</h3><p> <code>A</code>ç³»ç»Ÿæ¥æ”¶è¯·æ±‚ï¼Œéœ€è¦æœ¬åœ°å…¥åº“ï¼Œè¿˜éœ€è¦<code>BCD</code>ä¸‰ä¸ªç³»ç»Ÿå…¥åº“ï¼Œæœ¬åœ°å…¥åº“ï¼ˆ<code>3ms</code>ï¼‰ï¼Œ<code>BCD</code>ï¼ˆ<code>300ms+400ms+500ms</code>ï¼‰ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå·®ç­‰å¾…æ—¶é—´å¤ªé•¿ã€‚ä¸šå†…è¯·æ±‚éœ€è¦åšåˆ° <code>200ms</code> ä»¥å†…ï¼Œå¯¹ç”¨æˆ·å‡ ä¹æ— æ„Ÿã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062204267.png" title="å¼‚æ­¥-1" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062204267.png" alt="å¼‚æ­¥-1"></a> </p><p> ä½¿ç”¨MQï¼ŒAç³»ç»Ÿè¿ç»­å‘é€3æ¡æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‡å¦‚æ¶ˆè€—5msï¼Œè¯·æ±‚èŠ±äº† 5 + 3 = 8ms ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´å°±æ˜¯ç‚¹äº†ä¸€ä¸ªæŒ‰é’®è¿”å›å¾ˆå¿«ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203062210072.png" title="å¼‚æ­¥-2" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203062210072.png" alt="å¼‚æ­¥-2"></a> </p><h3 id="2-3ã€å‰Šå³°"><a href="#2-3ã€å‰Šå³°" class="headerlink" title="2.3ã€å‰Šå³°"></a>2.3ã€å‰Šå³°</h3><p> æ¯å¤©ä¸€æ®µæ—¶é—´ï¼ŒAç³»ç»Ÿé£å¹³æµªé™ï¼Œæ¯ç§’è¯·æ±‚æ•°é‡å°±<code>50</code>ä¸ªã€‚ç»“æœæ¯æ¬¡ä¸€åˆ° <code>12:00~13:00</code>ï¼Œæ¯ç§’å¹¶å‘è¯·æ±‚æ•°é‡çªç„¶æš´å¢åˆ°5k+æ¡ã€‚ä½†æ˜¯ç³»ç»Ÿæ˜¯ç›´æ¥åŸºäº<code>MySQL</code>ï¼Œå¤§é‡è¯·æ±‚æ¶Œå…¥<code>MySQL</code>ï¼Œæ¯ç§’æ‰§è¡Œçº¦<code>5k</code>æ¡<code>SQL</code>ï¼Œ ä¸€èˆ¬æƒ…å†µä¸‹<code>MySQL</code> æ¯ç§’å¯æŠ— <code>2k</code>è¯·æ±‚ï¼Œ<code>5k</code>çš„è¯·æ±‚å¯èƒ½æ‰“æ­»<code>MySQL</code>ï¼Œå¯¼è‡´æ— æ³•ä½¿ç”¨ã€‚ ä¸€æ—¦è¿‡äº†é«˜å³°ï¼Œåˆ°äº†ä¸‹åˆå°±åˆ°äº†ä½å³°æœŸï¼Œæ¯ç§’è¯·æ±‚æ•°é‡ <code>50</code> å·¦å³ï¼Œå¯¹æ•´ä¸ªç³»ç»Ÿæ²¡æœ‰å¤šå°‘å‹åŠ›äº†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062301225.png" title="æœªå‰Šå³°" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062301225.png" alt="æœªå‰Šå³°"></a> </p><p>å¦‚æœä½¿ç”¨MQï¼Œæ¯ç§’ 5k è¯·æ±‚å†™å…¥ MQ , Aç³»ç»Ÿæ¯ç§’æœ€å¤šå¤„ç† 2k ä¸ªè¯·æ±‚ï¼Œå› ä¸º MySQLæ¯ç§’æœ€å¤šè¯·æ±‚ 2k ä¸ªè¯·æ±‚ã€‚Aç³»ç»Ÿä»MQä¸­æ…¢æ…¢æ‹‰å–è¯·æ±‚ï¼Œæ¯ç§’2kä¸ªè¯·æ±‚ï¼Œä¸è¶…è¿‡è‡ªå·±æ¯ç§’æœ€å¤§çš„è¯·æ±‚æ•°é‡å³å¯ã€‚æ‰€ä»¥å†é«˜å³°æœŸï¼ŒAç³»ç»Ÿä¸ä¼šæŒ‚æ‰ã€‚è€ŒMQæ¯ç§’è¿› 5k ï¼Œå‡º 2kï¼Œè¯·æ±‚å°±ä¼šåœ¨é«˜å³°æœŸç§¯å‹å¯èƒ½å¤šå¤§åå‡ ä¸‡ç”šè‡³ç™¾ä¸‡çš„æ¶ˆæ¯å† MQä¸­ã€‚ </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062328446.png" title="MQå‰Šå³°" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202203062328446.png" alt="MQå‰Šå³°"></a> </p><p>æ€»ç»“ï¼šçŸ­æš‚çš„æŒ¤å‹åæ˜¯å¯å…è®¸çš„ï¼Œç­‰åˆ°é«˜å³°æœŸè¿‡åï¼Œæ¯ç§’è¿›å…¥<code>MQ</code>çš„æ¶ˆæ¯é™ä½å¾ˆå¤šï¼Œä½†æ˜¯ç³»ç»Ÿä¾ç„¶æŒ‰ç…§ 2k çš„è¯·æ±‚å–æ¶ˆè´¹ï¼Œ<code>A</code>ç³»ç»Ÿå¾ˆå¿«çš„å°±ä¼šæŠŠæŒ¤å‹è§£å†³æ‰äº†ã€‚</p><h3 id="2-4ã€å¹¶è¡Œ"><a href="#2-4ã€å¹¶è¡Œ" class="headerlink" title="2.4ã€å¹¶è¡Œ"></a>2.4ã€å¹¶è¡Œ</h3><p> <a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215400.jpg" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215400.jpg" alt="img"></a></p><h3 id="2-5ã€æ’é˜Ÿ"><a href="#2-5ã€æ’é˜Ÿ" class="headerlink" title="2.5ã€æ’é˜Ÿ"></a>2.5ã€æ’é˜Ÿ</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215401.jpg" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215401.jpg" alt="img"></a> </p><h2 id="3ã€æ¶ˆæ¯é˜Ÿåˆ—å·¥å…·-RabbitMQ"><a href="#3ã€æ¶ˆæ¯é˜Ÿåˆ—å·¥å…·-RabbitMQ" class="headerlink" title="3ã€æ¶ˆæ¯é˜Ÿåˆ—å·¥å…· RabbitMQ"></a>3ã€æ¶ˆæ¯é˜Ÿåˆ—å·¥å…· RabbitMQ</h2><h3 id="3-1ã€å¸¸è§MQäº§å“"><a href="#3-1ã€å¸¸è§MQäº§å“" class="headerlink" title="3.1ã€å¸¸è§MQäº§å“"></a>3.1ã€å¸¸è§MQäº§å“</h3><ul><li><p>ActiveMQï¼šåŸºäº<code>JMS</code>ï¼ˆ<code>Java Message Service</code>ï¼‰åè®®ï¼Œ<code>java</code>è¯­è¨€ï¼Œ<code>jdk</code></p></li><li><p>RabbitMQï¼šåŸºäº<code>AMQP</code>åè®®ï¼Œ<code>erlang</code>è¯­è¨€å¼€å‘ï¼Œç¨³å®šæ€§å¥½</p></li><li><p>RocketMQï¼šåŸºäº<code>JMS</code>ï¼Œé˜¿é‡Œå·´å·´äº§å“ï¼Œç›®å‰äº¤ç”±<code>Apache</code>åŸºé‡‘ä¼š</p></li><li><p>Kafkaï¼šåˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œé«˜ååé‡</p></li></ul><h3 id="3-2ã€RabbitMQåŸºç¡€æ¦‚å¿µ"><a href="#3-2ã€RabbitMQåŸºç¡€æ¦‚å¿µ" class="headerlink" title="3.2ã€RabbitMQåŸºç¡€æ¦‚å¿µ"></a>3.2ã€RabbitMQåŸºç¡€æ¦‚å¿µ</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/RabbitMQ%E7%BB%84%E4%BB%B6.jpg" title="RabbitMQç»„ä»¶" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/RabbitMQ%E7%BB%84%E4%BB%B6.jpg" alt="RabbitMQç»„ä»¶"></a>        Brokerï¼šç®€å•æ¥è¯´å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“</p><pre><code>Exchangeï¼šæ¶ˆæ¯äº¤æ¢æœºï¼Œå®ƒæŒ‡å®šæ¶ˆæ¯æŒ‰ä»€ä¹ˆè§„åˆ™ï¼Œè·¯ç”±åˆ°å“ªä¸ªé˜Ÿåˆ—Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—è½½ä½“ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«æŠ•å…¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—Bindingï¼šç»‘å®šï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æŠŠ exchangeå’Œ queueæŒ‰ç…§è·¯ç”±è§„åˆ™ç»‘å®šèµ·æ¥Routing Keyï¼šè·¯ç”±å…³é”®å­—ï¼Œ exchangeæ ¹æ®è¿™ä¸ªå…³é”®å­—è¿›è¡Œæ¶ˆæ¯æŠ•é€’vhostï¼šè™šæ‹Ÿä¸»æœºï¼Œä¸€ä¸ª brokeré‡Œå¯ä»¥å¼€è®¾å¤šä¸ª vhostï¼Œç”¨ä½œä¸åŒç”¨æˆ·çš„æƒé™åˆ†ç¦»producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå°±æ˜¯æŠ•é€’æ¶ˆæ¯çš„ç¨‹åºconsumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œå°±æ˜¯æ¥å—æ¶ˆæ¯çš„ç¨‹åºchannelï¼šæ¶ˆæ¯é€šé“ï¼Œåœ¨å®¢æˆ·ç«¯çš„æ¯ä¸ªè¿æ¥é‡Œï¼Œå¯å»ºç«‹å¤šä¸ª channelï¼Œæ¯ä¸ª channelä»£è¡¨ä¸€ä¸ªä¼šè¯ä»»åŠ¡</code></pre><h3 id="3-3ã€äº”ç§æ¶ˆæ¯æ¨¡å‹"><a href="#3-3ã€äº”ç§æ¶ˆæ¯æ¨¡å‹" class="headerlink" title="3.3ã€äº”ç§æ¶ˆæ¯æ¨¡å‹"></a>3.3ã€äº”ç§æ¶ˆæ¯æ¨¡å‹</h3><p>RabbitMQæä¾›äº†6ç§æ¶ˆæ¯æ¨¡å‹ï¼Œä½†æ˜¯ç¬¬6ç§å…¶å®æ˜¯RPCï¼Œå¹¶ä¸æ˜¯MQï¼Œå› æ­¤ä¸äºˆå­¦ä¹ ã€‚é‚£ä¹ˆä¹Ÿå°±å‰©ä¸‹5ç§ã€‚</p><p>ä½†æ˜¯å…¶å®3ã€4ã€5è¿™ä¸‰ç§éƒ½å±äºè®¢é˜…æ¨¡å‹ï¼Œåªä¸è¿‡è¿›è¡Œè·¯ç”±çš„æ–¹å¼ä¸åŒã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215403.jpg" title="img" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/post/202409252215403.jpg" alt="img"></a> </p><ul><li><strong>åŸºæœ¬æ¶ˆæ¯æ¨¡å‹</strong>ï¼šç”Ÿäº§è€…â€“&gt;é˜Ÿåˆ—â€“&gt;æ¶ˆè´¹è€…</li></ul><ul><li><strong><code>work</code>æ¶ˆæ¯æ¨¡å‹</strong>ï¼šç”Ÿäº§è€…â€“&gt;é˜Ÿåˆ—â€“&gt;å¤šä¸ªæ¶ˆè´¹è€…ç«äº‰æ¶ˆè´¹</li></ul><ul><li><strong>è®¢é˜…æ¨¡å‹</strong>-**<code>Fanout</code>**ï¼šå¹¿æ’­æ¨¡å¼ï¼Œå°†æ¶ˆæ¯äº¤ç»™æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½ä¼šæ”¶åˆ°åŒä¸€æ¡æ¶ˆæ¯</li></ul><ul><li>**è®¢é˜…æ¨¡å‹-<code>Direct</code>**ï¼šå®šå‘ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆæŒ‡å®š <strong><code>rotingKey</code></strong> çš„é˜Ÿåˆ—</li></ul><ul><li><strong>è®¢é˜…æ¨¡å‹-<code>Topic</code> ä¸»é¢˜æ¨¡å¼</strong>ï¼šé€šé…ç¬¦ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆ**<code>routing pattern</code>ï¼ˆ**è·¯ç”±æ¨¡å¼ï¼‰ çš„é˜Ÿåˆ—</li></ul><h2 id="4ã€æ¶ˆæ¯ä¸ä¸¢å¤±"><a href="#4ã€æ¶ˆæ¯ä¸ä¸¢å¤±" class="headerlink" title="4ã€æ¶ˆæ¯ä¸ä¸¢å¤±"></a>4ã€æ¶ˆæ¯ä¸ä¸¢å¤±</h2><h3 id="4-1ã€MQè§’åº¦"><a href="#4-1ã€MQè§’åº¦" class="headerlink" title="4.1ã€MQè§’åº¦"></a>4.1ã€<code>MQ</code>è§’åº¦</h3><ol><li><p>ç”Ÿäº§è€…ä¸ä¸¢æ•°æ®</p></li><li><p>MQæœåŠ¡å™¨ä¸ä¸¢æ•°æ®</p></li><li><p>æ¶ˆè´¹è€…ä¸ä¸¢æ•°æ®</p></li></ol><p>ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±æœ‰ä¸¤ç§<strong>å®ç°æ–¹å¼</strong>ï¼š</p><ul><li><p>å¼€å¯äº‹åŠ¡æ¨¡å¼ (ä¸æ¨è)</p></li><li><p>æ¶ˆæ¯æ¯ç¡®è®¤æ¨¡å¼ï¼ˆç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…ï¼‰</p></li></ul><p>è¯´æ˜ï¼šå¼€å¯äº‹åŠ¡ä¼šå¤§å¹…<strong>é™ä½æ¶ˆæ¯å‘é€åŠæ¥æ”¶æ•ˆç‡</strong>ï¼Œä½¿ç”¨çš„<strong>ç›¸å¯¹è¾ƒå°‘</strong>ï¼Œå› æ­¤æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒä¸€èˆ¬éƒ½é‡‡å–æ¶ˆæ¯<strong>ç¡®è®¤æ¨¡å¼</strong></p><h3 id="4-2ã€æ¶ˆæ¯ç¡®è®¤"><a href="#4-2ã€æ¶ˆæ¯ç¡®è®¤" class="headerlink" title="4.2ã€æ¶ˆæ¯ç¡®è®¤"></a>4.2ã€æ¶ˆæ¯ç¡®è®¤</h3><h5 id="1ã€æ¶ˆæ¯æŒä¹…åŒ–"><a href="#1ã€æ¶ˆæ¯æŒä¹…åŒ–" class="headerlink" title="1ã€æ¶ˆæ¯æŒä¹…åŒ–"></a>1ã€æ¶ˆæ¯æŒä¹…åŒ–</h5><p>å¦‚æœå¸Œæœ›RabbitMQé‡å¯ä¹‹åæ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œé‚£ä¹ˆéœ€è¦å¯¹ä»¥ä¸‹3ç§å®ä½“å‡é…ç½®æŒä¹…åŒ–</p><ul><li><strong>Exchange</strong></li><li><strong>Queue</strong></li><li><strong>message</strong></li></ul><p>å£°æ˜exchangeæ—¶è®¾ç½®æŒä¹…åŒ–ï¼ˆ<code>durable = true</code>ï¼‰å¹¶ä¸”ä¸è‡ªåŠ¨åˆ é™¤ (<code>autoDelete = false</code>)</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">boolean</span> durable <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> autoDelete <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">"dlx"</span><span class="token punctuation">,</span> <span class="token constant">TOPIC</span><span class="token punctuation">,</span> durable<span class="token punctuation">,</span> autoDelete<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å£°æ˜queueæ—¶è®¾ç½®æŒä¹…åŒ–ï¼ˆ<code>durable = true</code>ï¼‰å¹¶ä¸”ä¸è‡ªåŠ¨åˆ é™¤ (<code>autoDelete = false</code>)</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">boolean</span> durable <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> autoDelete <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"order-summary-queue"</span><span class="token punctuation">,</span> durable<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> autoDelete<span class="token punctuation">,</span> queueArguments<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å‘é€æ¶ˆæ¯æ—¶é€šè¿‡è®¾ç½®ï¼ˆ<code>deliveryMode=2</code>ï¼‰æŒä¹…åŒ–æ¶ˆæ¯ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token string">"application/json"</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">deliveryMode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">priority</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">"order"</span><span class="token punctuation">,</span> <span class="token string">"order.created"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> properties<span class="token punctuation">,</span> <span class="token string">"sample-data"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2ã€å‘é€ç¡®è®¤"><a href="#2ã€å‘é€ç¡®è®¤" class="headerlink" title="2ã€å‘é€ç¡®è®¤"></a>2ã€å‘é€ç¡®è®¤</h5><p>æœ‰æ—¶ï¼Œä¸šåŠ¡å¤„ç†æˆåŠŸï¼Œæ¶ˆæ¯ä¹Ÿå‘äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“æ¶ˆæ¯æ˜¯å¦æˆåŠŸåˆ°è¾¾äº†<code>rabbitmq</code>ï¼Œå¦‚æœç”±äºç½‘ç»œç­‰åŸå› å¯¼è‡´ä¸šåŠ¡æˆåŠŸè€Œæ¶ˆæ¯å‘é€å¤±è´¥ï¼Œé‚£ä¹ˆå‘é€æ–¹å°†å‡ºç°ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>rabbitmq</code>çš„å‘é€ç¡®è®¤åŠŸèƒ½ï¼Œå³è¦æ±‚<code>rabbitmq</code>æ˜¾å¼å‘ŠçŸ¥æˆ‘ä»¬æ¶ˆæ¯æ˜¯å¦å·²æˆåŠŸå‘é€ã€‚</p><h5 id="3ã€æ‰‹åŠ¨æ¶ˆè´¹ç¡®è®¤"><a href="#3ã€æ‰‹åŠ¨æ¶ˆè´¹ç¡®è®¤" class="headerlink" title="3ã€æ‰‹åŠ¨æ¶ˆè´¹ç¡®è®¤"></a>3ã€æ‰‹åŠ¨æ¶ˆè´¹ç¡®è®¤</h5><p>æœ‰æ—¶ï¼Œæ¶ˆæ¯è¢«æ­£ç¡®æŠ•é€’åˆ°æ¶ˆè´¹æ–¹ï¼Œä½†æ˜¯æ¶ˆè´¹æ–¹å¤„ç†å¤±è´¥ï¼Œé‚£ä¹ˆä¾¿ä¼šå‡ºç°æ¶ˆè´¹æ–¹çš„ä¸ä¸€è‡´é—®é¢˜ã€‚æ¯”å¦‚:è®¢å•å·²åˆ›å»ºçš„æ¶ˆæ¯å‘é€åˆ°ç”¨æˆ·ç§¯åˆ†å­ç³»ç»Ÿä¸­ç”¨äºå¢åŠ ç”¨æˆ·ç§¯åˆ†ï¼Œä½†æ˜¯ç§¯åˆ†æ¶ˆè´¹æ–¹å¤„ç†å´éƒ½å¤±è´¥äº†ï¼Œç”¨æˆ·å°±ä¼šé—®ï¼šæˆ‘è´­ä¹°äº†ä¸œè¥¿ä¸ºä»€ä¹ˆç§¯åˆ†å¹¶æ²¡æœ‰å¢åŠ å‘¢ï¼Ÿ</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å¼•å…¥æ¶ˆè´¹æ–¹ç¡®è®¤ï¼Œå³åªæœ‰æ¶ˆæ¯è¢«æˆåŠŸå¤„ç†ä¹‹åæ‰å‘ŠçŸ¥<code>rabbitmq</code>ä»¥<code>ack</code>ï¼Œå¦åˆ™å‘ŠçŸ¥<code>rabbitmq</code>ä»¥<code>nack</code></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯é˜Ÿåˆ— </category>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisç³»åˆ—ï¼ˆä¸€ï¼‰| å•æœºé›†ç¾¤æ­å»º3ä¸»3ä»</title>
      <link href="/posts/12892.html"/>
      <url>/posts/12892.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Redisé›†ç¾¤éƒ¨ç½²-å•ä¸»æœº-6èŠ‚ç‚¹-3M-3S"><a href="#Redisé›†ç¾¤éƒ¨ç½²-å•ä¸»æœº-6èŠ‚ç‚¹-3M-3S" class="headerlink" title="Redisé›†ç¾¤éƒ¨ç½²-å•ä¸»æœº 6èŠ‚ç‚¹ 3M+3S"></a>Redisé›†ç¾¤éƒ¨ç½²-å•ä¸»æœº 6èŠ‚ç‚¹ 3M+3S</h1><h2 id="ä¸‹è½½docker-redis-é•œåƒ"><a href="#ä¸‹è½½docker-redis-é•œåƒ" class="headerlink" title="ä¸‹è½½docker redis é•œåƒ"></a>ä¸‹è½½docker redis é•œåƒ</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker pull redis:4.0# æˆ–è€…ç›´æ¥ä¸‹è½½æœ€æ–°ç‰ˆredisé•œåƒdocker pull redis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>!!! æ³¨æ„ redis 5.0ä»¥ä¸Šåˆ›å»ºé›†ç¾¤ä¸åœ¨ä½¿ç”¨rubyï¼Œå› æ­¤å¦‚æœä½¿ç”¨æœ€æ–°ç‰ˆçš„redis ä¸€ä¸‹rubyéƒ¨åˆ†å†…å®¹ç›´æ¥è·³è¿‡</strong></p><h2 id="åœ¨-dataä¸‹æ–°å»º-redis-cluster-æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º-redis-cluster-tmpl-æ–‡ä»¶"><a href="#åœ¨-dataä¸‹æ–°å»º-redis-cluster-æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º-redis-cluster-tmpl-æ–‡ä»¶" class="headerlink" title="åœ¨ /dataä¸‹æ–°å»º redis-cluster æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º redis-cluster.tmpl æ–‡ä»¶"></a>åœ¨ /dataä¸‹æ–°å»º redis-cluster æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º redis-cluster.tmpl æ–‡ä»¶</h2><pre class="line-numbers language-tmpl" data-language="tmpl"><code class="language-tmpl"># bind 127.0.0.1protected-mode noport $&#123;PORT&#125;daemonize nodir &#x2F;data&#x2F;redisappendonly yescluster-enabled yescluster-config-file nodes.confcluster-node-timeout 15000cluster-announce-port $&#123;PORT&#125;cluster-announce-bus-port 1$&#123;PORT&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¼–å†™åˆå§‹åŒ–è„šæœ¬-init-redis-cluster-shï¼Œæ‰§è¡Œåˆ›å»ºç›®å½•çš„ä»»åŠ¡"><a href="#ç¼–å†™åˆå§‹åŒ–è„šæœ¬-init-redis-cluster-shï¼Œæ‰§è¡Œåˆ›å»ºç›®å½•çš„ä»»åŠ¡" class="headerlink" title="ç¼–å†™åˆå§‹åŒ–è„šæœ¬ init-redis-cluster.shï¼Œæ‰§è¡Œåˆ›å»ºç›®å½•çš„ä»»åŠ¡"></a>ç¼–å†™åˆå§‹åŒ–è„šæœ¬ init-redis-cluster.shï¼Œæ‰§è¡Œåˆ›å»ºç›®å½•çš„ä»»åŠ¡</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#! &#x2F;bin&#x2F;bash# ä¸‹è½½redisé•œåƒdocker pull redis# åˆ›å»ºredisåŸºç¡€å¯¹åº”çš„è™šæ‹Ÿç½‘ç»œdocker network create redis-net# åˆ›å»ºredisé›†ç¾¤ç¯å¢ƒæ‰€éœ€è¦çš„ç›®å½• å•æœº 6èŠ‚ç‚¹ 3ä¸»3ä»mkdir -p &#x2F;data&#x2F;cluster&#x2F;rediscp &#x2F;data&#x2F;redis-cluster.tmpl &#x2F;data&#x2F;cluster&#x2F;redis# åˆ›å»º6ä¸ªèŠ‚ç‚¹å¯¹åº”çš„ç›®å½• 7001-7003 ä¸ºmaster  7004-7006ä¸ºslavefor port in &#96;seq 7000 7005&#96;; do        mkdir -p &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;$port&#x2F; \        &amp;&amp; mkdir -p &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;$port&#x2F;data \        &amp;&amp; PORT&#x3D;$port envsubst &lt; &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;redis-cluster.tmpl &gt; &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;$port&#x2F;redis$port.conf;done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¯åŠ¨redis-ç¼–å†™rediså¯åŠ¨è„šæœ¬-create-redis-instance-sh"><a href="#å¯åŠ¨redis-ç¼–å†™rediså¯åŠ¨è„šæœ¬-create-redis-instance-sh" class="headerlink" title="å¯åŠ¨redis ç¼–å†™rediså¯åŠ¨è„šæœ¬ create-redis-instance.sh"></a>å¯åŠ¨redis ç¼–å†™rediså¯åŠ¨è„šæœ¬ create-redis-instance.sh</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#! &#x2F;bin&#x2F;bash# è¿è¡Œdocker redis çš„ master å’Œ slave å®ä¾‹for port in &#96;seq 7000 7005&#96;; do    docker run -d --net host \    --privileged&#x3D;true \    -v &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;$&#123;port&#125;&#x2F;redis$&#123;port&#125;.conf:&#x2F;data&#x2F;redis.conf \    -v &#x2F;data&#x2F;cluster&#x2F;redis&#x2F;$&#123;port&#125;&#x2F;data:&#x2F;data&#x2F;redis \    --restart always --name redis-$&#123;port&#125; \    redis redis-server &#x2F;data&#x2F;redis.conf;done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¼–å†™å…³é—­å¹¶åˆ é™¤rediså®¹å™¨çš„è„šæœ¬"><a href="#ç¼–å†™å…³é—­å¹¶åˆ é™¤rediså®¹å™¨çš„è„šæœ¬" class="headerlink" title="ç¼–å†™å…³é—­å¹¶åˆ é™¤rediså®¹å™¨çš„è„šæœ¬"></a>ç¼–å†™å…³é—­å¹¶åˆ é™¤rediså®¹å™¨çš„è„šæœ¬</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#! &#x2F;bin&#x2F;bashdocker stop redis-7000docker stop redis-7001docker stop redis-7002docker stop redis-7003docker stop redis-7004docker stop redis-7005# é—´éš”5såç»§ç»­æ‰§è¡Œsleep 5sdocker rm redis-7000docker rm redis-7001docker rm redis-7002docker rm redis-7003docker rm redis-7004docker rm redis-7005<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ£€æŸ¥é›†ç¾¤æ˜¯å¦è¿è¡Œæ­£å¸¸"><a href="#æ£€æŸ¥é›†ç¾¤æ˜¯å¦è¿è¡Œæ­£å¸¸" class="headerlink" title="æ£€æŸ¥é›†ç¾¤æ˜¯å¦è¿è¡Œæ­£å¸¸"></a>æ£€æŸ¥é›†ç¾¤æ˜¯å¦è¿è¡Œæ­£å¸¸</h2><p>è¿›å…¥7000 å®¹å™¨</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker exec -it redis-7000 &#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="åˆ›å»ºredisé›†ç¾¤"><a href="#åˆ›å»ºredisé›†ç¾¤" class="headerlink" title="åˆ›å»ºredisé›†ç¾¤"></a>åˆ›å»ºredisé›†ç¾¤</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">redis-cli --cluster create \172.162.0.202:6000 \172.162.0.202:6001 \172.162.0.202:6002 \172.162.0.202:6003 \172.162.0.202:6004 \172.162.0.202:6005 \--cluster-replicas 1è¾“å…¥yesç¡®è®¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoç³»åˆ—ï¼ˆä¸‰ï¼‰| æ•´åˆå…¨å±€éŸ³ä¹</title>
      <link href="/posts/9338.html"/>
      <url>/posts/9338.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Hexoç³»åˆ—ï¼ˆä¸‰ï¼‰-æ•´åˆå…¨å±€éŸ³ä¹"><a href="#Hexoç³»åˆ—ï¼ˆä¸‰ï¼‰-æ•´åˆå…¨å±€éŸ³ä¹" class="headerlink" title="Hexoç³»åˆ—ï¼ˆä¸‰ï¼‰| æ•´åˆå…¨å±€éŸ³ä¹"></a>Hexoç³»åˆ—ï¼ˆä¸‰ï¼‰| æ•´åˆå…¨å±€éŸ³ä¹</h1><h2 id="1ã€hexo-ç›®å½•ä¸‹å®‰è£…"><a href="#1ã€hexo-ç›®å½•ä¸‹å®‰è£…" class="headerlink" title="1ã€hexo ç›®å½•ä¸‹å®‰è£…"></a>1ã€hexo ç›®å½•ä¸‹å®‰è£…</h2><p><code>npm install â€“save hexo-tag-aplayer</code></p><h2 id="2ã€ä¿®æ”¹-hexo-ç›®å½•ä¸‹-Hexo-é…ç½®æ–‡ä»¶-config-yml"><a href="#2ã€ä¿®æ”¹-hexo-ç›®å½•ä¸‹-Hexo-é…ç½®æ–‡ä»¶-config-yml" class="headerlink" title="2ã€ä¿®æ”¹ hexo ç›®å½•ä¸‹ Hexo é…ç½®æ–‡ä»¶_config.yml"></a>2ã€ä¿®æ”¹ hexo ç›®å½•ä¸‹ Hexo é…ç½®æ–‡ä»¶_config.yml</h2><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">aplayer</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">asset_inject</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="3ã€ä¿®æ”¹-hexo-ç›®å½•ä¸‹ä¸»é¢˜é…ç½®æ–‡ä»¶-config-butterfly-yml"><a href="#3ã€ä¿®æ”¹-hexo-ç›®å½•ä¸‹ä¸»é¢˜é…ç½®æ–‡ä»¶-config-butterfly-yml" class="headerlink" title="3ã€ä¿®æ”¹ hexo ç›®å½•ä¸‹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml"></a>3ã€ä¿®æ”¹ hexo ç›®å½•ä¸‹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</h2><p>æ‰¾åˆ°ï¼š <code>aplayerInject</code></p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">aplayerInject</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>   <span class="token key atrule">per_page</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰¾åˆ°ï¼š<code>pjax</code></p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">pjax</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰¾åˆ°ï¼š<code>inject</code> åœ¨ <code>bottom</code> é‡Œæ·»åŠ </p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">inject</span><span class="token punctuation">:</span>  <span class="token key atrule">head</span><span class="token punctuation">:</span>  <span class="token key atrule">bottom</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> <span class="token string">'&lt;div data-id="60198" data-server="netease" data-type="song" data-fixed="true" data-autoplay="true"> &lt;/div>'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä»¥ä¸Šä¿®æ”¹åï¼Œæ—¢å¯å®ç°å…¨å±€æ’­æ”¾å™¨ï¼Œä¸ä¼šå› ä¸ºé¡µé¢åˆ‡æ¢ä¸­æ–­</strong></p><h2 id="ä»¥ä¸‹æ˜¯æ·»åŠ éŸ³ä¹çš„æ–¹æ³•ï¼šä¿®æ”¹ä»¥ä¸Šbottomå†…çš„ä»£ç "><a href="#ä»¥ä¸‹æ˜¯æ·»åŠ éŸ³ä¹çš„æ–¹æ³•ï¼šä¿®æ”¹ä»¥ä¸Šbottomå†…çš„ä»£ç " class="headerlink" title="ä»¥ä¸‹æ˜¯æ·»åŠ éŸ³ä¹çš„æ–¹æ³•ï¼šä¿®æ”¹ä»¥ä¸Šbottomå†…çš„ä»£ç "></a>ä»¥ä¸‹æ˜¯æ·»åŠ éŸ³ä¹çš„æ–¹æ³•ï¼šä¿®æ”¹ä»¥ä¸Šbottomå†…çš„ä»£ç </h2><p>å¼•ç”¨è‡ª <a href="https://butterfly.js.org/posts/507c070f/#%E9%97%9C%E9%96%89-asset-inject">butterfly ä¸»é¢˜æ–‡æ¡£è¯´æ˜</a>ï¼ŒåŠ äº†ç¿»è¯‘</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">&lt;div data<span class="token punctuation">-</span>id="60198" data<span class="token punctuation">-</span>server="netease" data<span class="token punctuation">-</span>type="playlist" data<span class="token punctuation">-</span>fixed="true" data<span class="token punctuation">-</span>autoplay="`false`"<span class="token punctuation">></span> &lt;/div<span class="token punctuation">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><table><thead><tr><th>option</th><th>default</th><th>description</th></tr></thead><tbody><tr><td>data-id</td><td><strong>require</strong></td><td>song id / playlist id / album id / search keyword</td></tr><tr><td>data-server</td><td><strong>require</strong></td><td>music platform: <code>netease</code>, <code>tencent</code>, <code>kugou</code>, <code>xiami</code>, <code>baidu</code></td></tr><tr><td>data-type</td><td><strong>require</strong></td><td><code>song</code>, <code>playlist</code>, <code>album</code>, <code>search</code>, <code>artist</code></td></tr><tr><td>data-fixed</td><td><code>false</code></td><td>enable fixed mode ã€å¼€å¯å›ºå®šæ¨¡å¼ã€‘</td></tr><tr><td>data-mini</td><td><code>false</code></td><td>enable mini mode ã€å¼€å¯è¿·ä½ æ¨¡å¼ã€‘</td></tr><tr><td>data-autoplay</td><td><code>false</code></td><td>audio autoplay ã€è‡ªåŠ¨æ’­æ”¾ï¼Œç§»åŠ¨ç«¯æµè§ˆå™¨æš‚æ—¶ä¸æ”¯æŒæ­¤åŠŸèƒ½ã€‘</td></tr><tr><td>data-theme</td><td><code>#2980b9</code></td><td>main color ã€ä¸»é¢˜é¢œè‰²ã€‘</td></tr><tr><td>data-loop</td><td><code>all</code></td><td>player loop play, values: â€˜allâ€™, â€˜oneâ€™, â€˜noneâ€™ ã€åˆ—è¡¨å¾ªç¯æ¨¡å¼ï¼š<code>all</code>, <code>one</code>,<code>none</code>ã€‘</td></tr><tr><td>data-order</td><td><code>list</code></td><td>player play order, values: â€˜listâ€™, â€˜randomâ€™ ã€åˆ—è¡¨æ’­æ”¾æ¨¡å¼ï¼š <code>list</code>, <code>random</code>ã€‘</td></tr><tr><td>data-preload</td><td><code>auto</code></td><td>values: â€˜noneâ€™, â€˜metadataâ€™, â€˜autoâ€™ ã€éŸ³ä¹æ–‡ä»¶é¢„è½½å…¥æ¨¡å¼ï¼Œå¯é€‰é¡¹ï¼š <code>none</code>, <code>metadata</code>, <code>auto</code>ã€‘</td></tr><tr><td>data-volume</td><td><code>0.7</code></td><td>default volume, notice that player will remember user setting, default volume will not work after user set volume themselves ã€é»˜è®¤éŸ³é‡ï¼Œæ³¨æ„æ’­æ”¾å™¨ä¼šè®°ä½ç”¨æˆ·çš„è®¾ç½®ï¼Œç”¨æˆ·è‡ªå·±è®¾ç½®éŸ³é‡åï¼Œé»˜è®¤éŸ³é‡å°†ä¸èµ·ä½œç”¨ã€‘</td></tr><tr><td>data-mutex</td><td><code>true</code></td><td>prevent to play multiple player at the same time, pause other players when this player start play ã€é˜²æ­¢åŒæ—¶æ’­æ”¾å¤šä¸ªæ’­æ”¾å™¨ï¼Œåœ¨è¯¥æ’­æ”¾å™¨å¼€å§‹æ’­æ”¾æ—¶æš‚åœå…¶ä»–æ’­æ”¾å™¨ã€‘</td></tr><tr><td>data-lrctype</td><td><code>0</code></td><td>lyric type ã€æ­Œè¯æ ¼å¼ç±»å‹ã€‘</td></tr><tr><td>data-listfolded</td><td><code>false</code></td><td>indicate whether list should folded at first ã€è¡¨ç¤ºåˆ—è¡¨æ˜¯å¦åº”é¦–å…ˆæŠ˜å ã€‘</td></tr><tr><td>data-listmaxheight</td><td><code>340px</code></td><td>list max height ã€åˆ—è¡¨æœ€å¤§é«˜åº¦ã€‘</td></tr><tr><td>data-storagename</td><td><code>metingjs</code></td><td>localStorage key that store player settingã€å­˜å‚¨æ’­æ”¾å™¨è®¾ç½®çš„æœ¬åœ°å­˜å‚¨é”®ã€‘</td></tr></tbody></table></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆä¹ï¼‰| Javaå¤šçº¿ç¨‹</title>
      <link href="/posts/19057.html"/>
      <url>/posts/19057.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><p><strong><a href="https://blog.csdn.net/twotwo22222/article/details/128450613?spm=1001.2014.3001.5502">java å¤šçº¿ç¨‹åŠçº¿ç¨‹æ± åŸç†è®²è§£</a></strong></p><h2 id="1-çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>â€‹    <strong>çº¿ç¨‹ï¼š</strong> æ˜¯æœ€å°çš„è°ƒåº¦å•ä½ï¼ŒåŒ…å«åœ¨è¿›ç¨‹ä¸­ã€‚<br>â€‹    <strong>å¤šçº¿ç¨‹ï¼š</strong> å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚</p><h2 id="2-å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹"><a href="#2-å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹" class="headerlink" title="2. å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹"></a>2. å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹</h2><p><strong>å®ˆæŠ¤çº¿ç¨‹ï¼š</strong> <code>jvm</code> ç»™çš„çº¿ç¨‹ã€‚æ¯”å¦‚ï¼š<code>GC</code> å®ˆæŠ¤çº¿ç¨‹ã€‚ </p><p><strong>ç”¨æˆ·çº¿ç¨‹ï¼š</strong> ç”¨æˆ·è‡ªå·±å®šä¹‰çš„çº¿ç¨‹ã€‚æ¯”å¦‚ï¼š<code>main()</code> çº¿ç¨‹ã€‚</p><p><strong>æ‹“å±•ï¼š</strong></p><ul><li><code>Thread.setDaemon(false)</code> è®¾ç½®ä¸ºç”¨æˆ·çº¿ç¨‹  </li><li><code>Thread.setDaemon(true)</code> è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</li></ul><h2 id="3-çº¿ç¨‹çš„å„ä¸ªçŠ¶æ€"><a href="#3-çº¿ç¨‹çš„å„ä¸ªçŠ¶æ€" class="headerlink" title="3. çº¿ç¨‹çš„å„ä¸ªçŠ¶æ€"></a>3. çº¿ç¨‹çš„å„ä¸ªçŠ¶æ€</h2><ul><li><strong>æ–°å»º (New):</strong> æ–°å»ºä¸€ä¸ªçº¿ç¨‹ã€‚</li><li><strong>å°±ç»ª (Runnable):</strong> æŠ¢å¤º <code>cpu</code> çš„ä½¿ç”¨æƒã€‚  </li><li><strong>è¿è¡Œ (Running):</strong> å¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚  </li><li><strong>é˜»å¡ (Blocked)ï¼š</strong> è®©çº¿ç¨‹ç­‰å¾…ï¼Œç­‰å¾…ç»“æŸè¿›å…¥å°±ç»ªé˜Ÿåˆ—ã€‚  </li><li><strong>æ­»äº¡ (Dead)ï¼š</strong> çº¿ç¨‹æ­£å¸¸ç»“æŸæˆ–å¼‚å¸¸ç»“æŸã€‚</li></ul><h2 id="4-çº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰-waitï¼Œnotifyï¼ŒnotifyAllï¼Œsleepï¼Œjoinï¼Œyield-ç­‰"><a href="#4-çº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰-waitï¼Œnotifyï¼ŒnotifyAllï¼Œsleepï¼Œjoinï¼Œyield-ç­‰" class="headerlink" title="4. çº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsleepï¼Œjoinï¼Œyield ç­‰"></a>4. çº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰ <code>wait</code>ï¼Œ<code>notify</code>ï¼Œ<code>notifyAll</code>ï¼Œ<code>sleep</code>ï¼Œ<code>join</code>ï¼Œ<code>yield</code> ç­‰</h2><ul><li><strong>wait()ï¼š</strong> çº¿ç¨‹ç­‰å¾…ï¼Œä¼šé‡Šæ”¾é”ï¼Œç”¨äºåŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€  </li><li><strong>sleep()ï¼š</strong> çº¿ç¨‹ç¡çœ ï¼Œä¸ä¼šé‡Šæ”¾é”ï¼Œè¿›å…¥è¶…æ—¶ç­‰å¾…çŠ¶æ€  </li><li><strong>yield()ï¼š</strong> çº¿ç¨‹è®©æ­¥ï¼Œä¼šä½¿çº¿ç¨‹è®©å‡º <code>cpu</code> ä½¿ç”¨æƒï¼Œè¿›å…¥å°±ç»ªçŠ¶æ€  </li><li><strong>join()ï¼š</strong> æŒ‡å®šçš„çº¿ç¨‹åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼Œå¯ä»¥å°†ä¸¤ä¸ªäº¤æ›¿æ‰§è¡Œçš„çº¿ç¨‹åˆå¹¶ä¸ºé¡ºåºæ‰§è¡Œçš„çº¿ç¨‹ã€‚  </li><li><strong>notify()ï¼š</strong> éšæœºå”¤é†’ä¸€ä¸ªåœ¨ç­‰å¾…ä¸­çš„çº¿ç¨‹ï¼Œè¿›å…¥å°±ç»ªçŠ¶æ€ã€‚  </li><li><strong><code>notifyAll</code>()ï¼š</strong> å”¤é†’å…¨éƒ¨åœ¨ç­‰å¾…ä¸­çš„çº¿ç¨‹ï¼Œè¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</li></ul><h2 id="5-wait-å’Œ-sleep-çš„åŒºåˆ«ï¼Ÿ"><a href="#5-wait-å’Œ-sleep-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="5.wait() å’Œ sleep() çš„åŒºåˆ«ï¼Ÿ"></a>5.wait() å’Œ sleep() çš„åŒºåˆ«ï¼Ÿ</h2><table><thead><tr><th>wait()</th><th>sleep()</th></tr></thead><tbody><tr><td>æ¥è‡ª<code>Object</code></td><td>æ¥è‡ª<code>Thread</code></td></tr><tr><td>é‡Šæ”¾é”</td><td>ä¸ä¼šé‡Šæ”¾é”</td></tr><tr><td>ä¸ç”¨æ•è·å¼‚å¸¸</td><td>éœ€è¦æ•è·å¼‚å¸¸</td></tr><tr><td>åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–ä»£ç å—ä¸­</td><td>ä»»ä½•åœ°æ–¹</td></tr></tbody></table><h2 id="6-ä¸ºä»€ä¹ˆ-wait-ã€notify-ã€notifyAll-æ–¹æ³•å®šä¹‰åœ¨-Object-ç±»é‡Œé¢ï¼Œè€Œä¸æ˜¯-Thread-ç±»ï¼Ÿ"><a href="#6-ä¸ºä»€ä¹ˆ-wait-ã€notify-ã€notifyAll-æ–¹æ³•å®šä¹‰åœ¨-Object-ç±»é‡Œé¢ï¼Œè€Œä¸æ˜¯-Thread-ç±»ï¼Ÿ" class="headerlink" title="6. ä¸ºä»€ä¹ˆ wait()ã€notify()ã€notifyAll() æ–¹æ³•å®šä¹‰åœ¨ Object ç±»é‡Œé¢ï¼Œè€Œä¸æ˜¯ Thread ç±»ï¼Ÿ"></a>6. ä¸ºä»€ä¹ˆ <code>wait()</code>ã€<code>notify()</code>ã€<code>notifyAll()</code> æ–¹æ³•å®šä¹‰åœ¨ <code>Object</code> ç±»é‡Œé¢ï¼Œè€Œä¸æ˜¯ <code>Thread</code> ç±»ï¼Ÿ</h2><p>â€‹    â‘  é”å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œå¦‚æœåœ¨ <code>Thread</code> ç±»ä¸­ï¼Œé‚£åªèƒ½æ˜¯ <code>Thread</code> ç±»çš„å¯¹è±¡æ‰èƒ½è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•äº†ã€‚  </p><p>â€‹    â‘¡ <code>java</code> ä¸­è¿›å…¥<strong>ä¸´ç•ŒåŒº</strong> (åŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•)ï¼Œçº¿ç¨‹åªéœ€è¦æ‹¿åˆ°é”å°±è¡Œï¼Œè€Œå¹¶ä¸å…³å¿ƒé”è¢«é‚£ä¸ªçº¿ç¨‹æŒæœ‰ã€‚  </p><p>â€‹    â‘¢ ä¸Šé¢æ–¹æ³•æ˜¯ <code>java</code> ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æœºåˆ¶ï¼Œå¦‚æœä¸èƒ½é€šè¿‡ç±»ä¼¼ <code>synchronized</code> è¿™æ ·çš„ <code>Java</code> å…³é”®å­—æ¥å®ç°è¿™ç§æœºåˆ¶ï¼Œé‚£ä¹ˆ <code>Object</code> ç±»ä¸­å°±æ˜¯å®šä¹‰å®ƒä»¬æœ€å¥½çš„åœ°æ–¹ï¼Œä»¥æ­¤æ¥ä½¿ä»»ä½• <code>Java</code> å¯¹è±¡éƒ½å¯ä»¥æ‹¥æœ‰å®ç°çº¿ç¨‹é€šä¿¡æœºåˆ¶çš„èƒ½åŠ›ã€‚</p><h2 id="7-start-å’Œ-run-çš„åŒºåˆ«"><a href="#7-start-å’Œ-run-çš„åŒºåˆ«" class="headerlink" title="7.start() å’Œ run() çš„åŒºåˆ«"></a>7.start() å’Œ run() çš„åŒºåˆ«</h2><p>â€‹    <strong>start() æ–¹æ³•ï¼š</strong> æ˜¯<strong>å¯åŠ¨çº¿ç¨‹</strong>ï¼Œè°ƒç”¨äº†ä¹‹åçº¿ç¨‹ä¼šè¿›å…¥<strong>å°±ç»ª</strong>çŠ¶æ€ï¼Œä¸€æ—¦æ‹¿åˆ° <code>cpu</code> ä½¿ç”¨æƒå°±å¼€å§‹æ‰§è¡Œ <strong>run()</strong> æ–¹æ³•, ä¸èƒ½é‡å¤è°ƒç”¨ <strong>start()</strong>, å¦åˆ™ä¼šæŠ¥å¼‚å¸¸ã€‚<br>â€‹    <strong>run() æ–¹æ³•ï¼š</strong> å°±ç›¸å½“äºä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è€Œå·²ã€‚ç›´æ¥è°ƒç”¨ <strong>run()</strong> æ–¹æ³•å°±è¿˜åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œè¿˜æ˜¯ä¼šé¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥é‡å¤è°ƒç”¨ run() æ–¹æ³•ã€‚</p><h2 id="8-å®ç°å¤šçº¿ç¨‹çš„æ–¹å¼"><a href="#8-å®ç°å¤šçº¿ç¨‹çš„æ–¹å¼" class="headerlink" title="8. å®ç°å¤šçº¿ç¨‹çš„æ–¹å¼"></a>8. å®ç°å¤šçº¿ç¨‹çš„æ–¹å¼</h2><p>â€‹    â‘ ç»§æ‰¿ Thread ç±»ã€‚  </p><p>â€‹    â‘¡å®ç° Runnable æ¥å£  </p><p>â€‹    â‘¢å®ç° Callable æ¥å£  </p><p>â€‹    â‘£çº¿ç¨‹æ± </p><h2 id="9-Runnable-å’Œ-Callable-çš„åŒºåˆ«"><a href="#9-Runnable-å’Œ-Callable-çš„åŒºåˆ«" class="headerlink" title="9.Runnable å’Œ Callable çš„åŒºåˆ«"></a>9.Runnable å’Œ Callable çš„åŒºåˆ«</h2><p>â€‹    â‘ <code>Runnable</code> æ²¡æœ‰è¿”å›å€¼ï¼Œ<code>Callable</code> æœ‰è¿”å›å€¼ã€‚  </p><p>â€‹    â‘¡<code>Runnable</code> åªèƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œä¸èƒ½æ•è·ï¼Œ<code>Callable</code> èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿèƒ½æ•è·ã€‚</p><h2 id="10-çº¿ç¨‹æ± çš„å¥½å¤„"><a href="#10-çº¿ç¨‹æ± çš„å¥½å¤„" class="headerlink" title="10. çº¿ç¨‹æ± çš„å¥½å¤„"></a>10. çº¿ç¨‹æ± çš„å¥½å¤„</h2><p>â€‹    â‘  çº¿ç¨‹æ˜¯<strong>ç¨€ç¼ºèµ„æº</strong>ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥å‡å°‘çº¿ç¨‹çš„<strong>åˆ›å»ºå’Œé”€æ¯</strong>ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¯é‡å¤ä½¿ç”¨ã€‚  </p><p>â€‹    â‘¡ å¯ä»¥æ ¹æ®ç³»ç»Ÿçš„éœ€æ±‚ï¼Œè°ƒæ•´çº¿ç¨‹æ± é‡Œé¢çº¿ç¨‹çš„ä¸ªæ•°ï¼Œé˜²æ­¢äº†å› ä¸ºæ¶ˆè€—å†…å­˜è¿‡å¤šå¯¼è‡´æœåŠ¡å™¨å´©æºƒã€‚</p><h2 id="11-ğŸŒŸçº¿ç¨‹æ± çš„ä¸ƒå¤§å‚æ•°"><a href="#11-ğŸŒŸçº¿ç¨‹æ± çš„ä¸ƒå¤§å‚æ•°" class="headerlink" title="11. ğŸŒŸçº¿ç¨‹æ± çš„ä¸ƒå¤§å‚æ•°"></a>11. ğŸŒŸçº¿ç¨‹æ± çš„ä¸ƒå¤§å‚æ•°</h2><ul><li><strong><code>corePoolSize</code>ï¼š</strong> æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ›å»ºä¸èƒ½è¢«å›æ”¶ï¼Œå¯ä»¥è®¾ç½®è¢«å›æ”¶ã€‚  </li><li><strong><code>maximumPoolSize</code>ï¼š</strong> æœ€å¤§çº¿ç¨‹æ•°ã€‚  </li><li><strong><code>keepAliveTime</code>ï¼š</strong> ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´ã€‚  </li><li><strong><code>unit</code>ï¼š</strong> å•ä½ã€‚  </li><li><strong><code>workQueue</code>ï¼š</strong> ç­‰å¾…é˜Ÿåˆ—ã€‚  </li><li><strong><code>threadFactory</code>ï¼š</strong> çº¿ç¨‹å·¥ç¨‹ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ã€‚ </li><li><strong><code>handler</code>ï¼š</strong> æ‹’ç»ç­–ç•¥ã€‚</li></ul><h2 id="12-çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹"><a href="#12-çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="12. çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹"></a>12. çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹</h2><p>â€‹    â‘ æ¥åˆ°ä»»åŠ¡ï¼Œåˆ¤æ–­æ ¸å¿ƒçº¿ç¨‹æ± æ˜¯å¦æ»¡äº†ï¼Œæ²¡æ»¡æ‰§è¡Œä»»åŠ¡ï¼Œæ»¡äº†æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚  </p><p>â€‹    â‘¡ç­‰å¾…é˜Ÿåˆ—æ²¡æ»¡ï¼Œå­˜å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…æ‰§è¡Œï¼Œæ»¡äº†å»æŸ¥çœ‹æœ€å¤§çº¿ç¨‹æ•°ã€‚  </p><p>â€‹    â‘¢æœ€å¤§çº¿ç¨‹æ•°æ²¡æ»¡ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œæ»¡äº†æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</p><h2 id="13-ğŸŒŸå››å¤§æ–¹æ³•"><a href="#13-ğŸŒŸå››å¤§æ–¹æ³•" class="headerlink" title="13. ğŸŒŸå››å¤§æ–¹æ³•"></a>13. ğŸŒŸå››å¤§æ–¹æ³•</h2><table><thead><tr><th><code>ExecutorService executor = Executors.newCachedThreadPool()</code></th><th>ç¼“å­˜çº¿ç¨‹æ± </th><th>çµæ´»å›æ”¶çº¿ç¨‹ï¼Œä»»åŠ¡è¿‡å¤šï¼Œä¼š OOM</th></tr></thead><tbody><tr><td><code>ExecutorService executor = Executors.newFixedThreadPool()</code></td><td>æŒ‡å®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± </td><td>æé«˜äº†çº¿ç¨‹æ± çš„æ•ˆç‡å’Œçº¿ç¨‹çš„åˆ›å»ºçš„å¼€é”€ï¼Œç­‰å¾…é˜Ÿåˆ—å¯èƒ½å †ç§¯å¤§é‡è¯·æ±‚ï¼Œå¯¼è‡´ OOM</td></tr><tr><td><code>ExecutorService executor = Executors.newSingleThreadPool()</code></td><td>å•çº¿ç¨‹</td><td>ä¿è¯çº¿ç¨‹çš„æœ‰åºï¼Œå‡ºç°å¼‚å¸¸å†æ¬¡åˆ›å»ºï¼Œé€Ÿåº¦æ²¡é‚£ä¹ˆå¿«ã€‚</td></tr><tr><td><code>ExecutorService executor = Executors.newScheduleThreadPool()</code></td><td>å®šé•¿çš„çº¿ç¨‹æ± </td><td>æ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚</td></tr></tbody></table><h2 id="14-å››å¤§æ‹’ç»ç­–ç•¥"><a href="#14-å››å¤§æ‹’ç»ç­–ç•¥" class="headerlink" title="14. å››å¤§æ‹’ç»ç­–ç•¥"></a>14. å››å¤§æ‹’ç»ç­–ç•¥</h2><p>â€‹    <strong>â‘ <code>new ThreadPoolExecutor.AbortPolicy()</code>ï¼š</strong> æ·»åŠ çº¿ç¨‹æ± è¢«æ‹’ç»ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ (é»˜è®¤ç­–ç•¥)ã€‚  </p><p>â€‹    <strong>â‘¡<code>new ThreadPoolExecutor.CallerRunsPolicy()</code>ï¼š</strong> æ·»åŠ çº¿ç¨‹æ± è¢«æ‹’ç»ï¼Œä¸ä¼šæ”¾å¼ƒä»»åŠ¡ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¼šè®©è°ƒç”¨è€…çº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ (å°±æ˜¯ä¸ä¼šä½¿ç”¨çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œä¼šè®©è°ƒç”¨çº¿ç¨‹æ± çš„çº¿ç¨‹å»æ‰§è¡Œ)ã€‚  </p><p>â€‹    <strong>â‘¢<code>new ThreadPoolExecutor.DiscardPolicy()</code>ï¼š</strong> æ·»åŠ çº¿ç¨‹æ± è¢«æ‹’ç»ï¼Œä¸¢æ‰ä»»åŠ¡ï¼Œä¸æŠ›å¼‚å¸¸ã€‚  </p><p>â€‹    <strong>â‘£<code>new ThreadPoolExecutor.DiscardOldestPolicy()</code>ï¼š</strong> æ·»åŠ çº¿ç¨‹æ± è¢«æ‹’ç»ï¼Œä¼šæŠŠçº¿ç¨‹æ± é˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡æ”¾å¼ƒï¼ŒæŠŠæ‹’ç»ä»»åŠ¡æ”¾è¿›å»ã€‚</p><h2 id="15-shutdown-å’Œ-shutdownNow-çš„åŒºåˆ«ï¼Ÿ"><a href="#15-shutdown-å’Œ-shutdownNow-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="15.shutdown å’Œ shutdownNow çš„åŒºåˆ«ï¼Ÿ"></a>15.shutdown å’Œ shutdownNow çš„åŒºåˆ«ï¼Ÿ</h2><p>â€‹    â‘ <code>shutdown</code> æ²¡æœ‰è¿”å›å€¼ï¼Œ<code>shutdownNow</code> ä¼šè¿”å›æ²¡æœ‰æ‰§è¡Œå®Œä»»åŠ¡çš„é›†åˆã€‚  </p><p>â€‹    â‘¡<code>shutdown</code> ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œ<code>shutdownNow</code> ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚  </p><p>â€‹    â‘¢<code>shutdown</code> ä¼šç­‰å¾…æ‰§è¡Œå®Œçº¿ç¨‹æ± çš„ä»»åŠ¡å†å…³é—­ï¼Œ<code>shutdownNow</code> ä¼šç»™æ‰€ä»¥çº¿ç¨‹å‘é€<strong>ä¸­æ–­ä¿¡å·</strong>ï¼Œç„¶åä¸­æ–­ä»»åŠ¡ï¼Œå…³é—­çº¿ç¨‹æ± ã€‚</p><h2 id="16-ğŸŒŸä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"><a href="#16-ğŸŒŸä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ" class="headerlink" title="16. ğŸŒŸä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"></a>16. ğŸŒŸä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ</h2><p>â€‹    å„è¿›ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹æ‰‹é‡Œçš„èµ„æºï¼Œå¯¼è‡´å„è¿›ç¨‹éƒ½é˜»å¡ï¼Œæ— æ³•å‘å‰æ¨è¿›çš„ç°è±¡ã€‚</p><h2 id="17-ğŸŒŸé€ æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶"><a href="#17-ğŸŒŸé€ æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶" class="headerlink" title="17. ğŸŒŸé€ æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶"></a>17. ğŸŒŸé€ æˆæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶</h2><p><strong>äº’æ–¥ï¼š</strong> å½“èµ„æºè¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨æ—¶ï¼Œåˆ«çš„çº¿ç¨‹ä¸èƒ½ä½¿ç”¨ã€‚<br><strong>ä¸å¯æŠ¢å ï¼š</strong> è¿›ç¨‹é˜»å¡æ—¶ï¼Œå¯¹å ç”¨çš„èµ„æºä¸é‡Šæ”¾ã€‚<br><strong>ä¸å‰¥å¤ºï¼š</strong> è¿›ç¨‹è·å¾—èµ„æºæœªä½¿ç”¨å®Œï¼Œä¸èƒ½è¢«å¼ºè¡Œå‰¥å¤ºã€‚<br><strong>å¾ªç¯ç­‰å¾…ï¼š</strong> è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆå¤´å°¾ç›¸è¿çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚</p><h2 id="18-çº¿ç¨‹å®‰å…¨ä¸»è¦æ˜¯ä¸‰æ–¹é¢"><a href="#18-çº¿ç¨‹å®‰å…¨ä¸»è¦æ˜¯ä¸‰æ–¹é¢" class="headerlink" title="18. çº¿ç¨‹å®‰å…¨ä¸»è¦æ˜¯ä¸‰æ–¹é¢"></a>18. çº¿ç¨‹å®‰å…¨ä¸»è¦æ˜¯ä¸‰æ–¹é¢</h2><p>â€‹    <strong>åŸå­æ€§ï¼š</strong> ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ (æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æ˜¯ä¸ä¼šè¢«ä»»ä½•å› ç´ æ‰“æ–­çš„)ã€‚  </p><p>â€‹    <strong>å¯è§æ€§ï¼š</strong> ä¸€ä¸ªçº¿ç¨‹å¯¹ä¸»å†…å­˜çš„ä¿®æ”¹å¯ä»¥åŠæ—¶çš„è¢«å…¶ä»–çº¿ç¨‹è§‚å¯Ÿåˆ°ã€‚  </p><p>â€‹    <strong>æœ‰åºæ€§ï¼š</strong> ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚</p><h3 id="ä¿è¯åŸå­æ€§"><a href="#ä¿è¯åŸå­æ€§" class="headerlink" title="ä¿è¯åŸå­æ€§"></a><strong>ä¿è¯åŸå­æ€§</strong></h3><p>ä½¿ç”¨é” <code>synchronized</code> å’Œ <code>lock</code>ã€‚<br>ä½¿ç”¨ <code>CAS (compareAndSet</code>ï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰ï¼Œ<code>CAS</code> æ˜¯ <code>cpu</code> çš„å¹¶å‘åŸè¯­)ã€‚</p><h3 id="ä¿è¯å¯è§æ€§"><a href="#ä¿è¯å¯è§æ€§" class="headerlink" title="ä¿è¯å¯è§æ€§"></a><strong>ä¿è¯å¯è§æ€§</strong></h3><p>ä½¿ç”¨é” <code>synchronized</code> å’Œ <code>lock</code>ã€‚<br>ä½¿ç”¨ <code>volatile</code> å…³é”®å­— ã€‚</p><h3 id="ä¿è¯æœ‰åºæ€§"><a href="#ä¿è¯æœ‰åºæ€§" class="headerlink" title="ä¿è¯æœ‰åºæ€§"></a><strong>ä¿è¯æœ‰åºæ€§</strong></h3><p>ä½¿ç”¨ <code>volatile</code> å…³é”®å­—<br>ä½¿ç”¨ <code>synchronized</code> å…³é”®å­—ã€‚</p><h2 id="19-volatile-å’Œ-synchronized-çš„åŒºåˆ«"><a href="#19-volatile-å’Œ-synchronized-çš„åŒºåˆ«" class="headerlink" title="19.volatile å’Œ synchronized çš„åŒºåˆ«"></a>19.<code>volatile</code> å’Œ <code>synchronized</code> çš„åŒºåˆ«</h2><p>â€‹    â‘  <code>volatile</code> ä»…èƒ½ä½¿ç”¨åœ¨<strong>å˜é‡</strong>çº§åˆ«çš„ï¼Œ<code>synchronized</code> å¯ä»¥ä½¿ç”¨åœ¨<strong>å˜é‡ã€æ–¹æ³•ã€ç±»</strong>çº§åˆ«çš„  </p><p>â€‹    â‘¡ <code>volatile</code> ä¸å…·å¤‡<strong>åŸå­æ€§</strong>ï¼Œå…·å¤‡<strong>å¯è§æ€§</strong>ï¼Œ<code>synchronized</code> æœ‰<strong>åŸå­æ€§å’Œå¯è§æ€§</strong>ã€‚  </p><p>â€‹    â‘¢ <code>volatile</code> ä¸ä¼šé€ æˆ<strong>çº¿ç¨‹é˜»å¡</strong>ï¼Œ<code>synchronized</code> ä¼šé€ æˆçº¿ç¨‹é˜»å¡ã€‚  </p><p>â€‹    â‘£ <code>volatile</code> å…³é”®å­—æ˜¯<strong>çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§</strong>å®ç°ï¼Œæ‰€ä»¥ <code>volatile</code> æ€§èƒ½è‚¯å®šæ¯” <code>synchronized</code> è¦å¥½ã€‚</p><h2 id="20-synchronized-å’Œ-lock-çš„åŒºåˆ«"><a href="#20-synchronized-å’Œ-lock-çš„åŒºåˆ«" class="headerlink" title="20.synchronized å’Œ lock çš„åŒºåˆ«"></a>20.synchronized å’Œ lock çš„åŒºåˆ«</h2><p>â€‹    â‘  <code>synchronized</code> æ˜¯å…³é”®å­—ï¼Œ<code>lock</code> æ˜¯ <code>java</code> ç±»ï¼Œé»˜è®¤æ˜¯ä¸å…¬å¹³é”ï¼ˆæºç ï¼‰ã€‚  </p><p>â€‹    â‘¡ <code>synchronized</code> é€‚åˆ<strong>å°‘é‡åŒæ­¥ä»£ç </strong>ï¼Œ<code>lock</code> é€‚åˆ<strong>å¤§é‡åŒæ­¥ä»£ç </strong>ã€‚  </p><p>â€‹    â‘¢ <code>synchronized</code> ä¼š<strong>è‡ªåŠ¨é‡Šæ”¾é”</strong>ï¼Œ<code>lock</code> å¿…é¡»æ”¾åœ¨ <strong>finally</strong> ä¸­æ‰‹å·¥ <code>unlock</code> é‡Šæ”¾é”ï¼Œä¸ç„¶å®¹æ˜“<strong>æ­»é”</strong>ã€‚</p><h2 id="21-JMM-java-å†…å­˜æ¨¡å‹"><a href="#21-JMM-java-å†…å­˜æ¨¡å‹" class="headerlink" title="21.JMM(java å†…å­˜æ¨¡å‹)"></a>21.JMM(java å†…å­˜æ¨¡å‹)</h2><p>â€‹    <strong>java</strong> å†…å­˜æ¨¡å‹ï¼Œä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œä¸æ˜¯çœŸæ˜¯å­˜åœ¨ï¼Œæè¿°çš„æ˜¯ä¸€ç§<strong>è§„åˆ™æˆ–è§„èŒƒ</strong>ï¼Œå’Œå¤šçº¿ç¨‹ç›¸å…³çš„è§„åˆ™ã€‚éœ€è¦æ¯ä¸ª JVM éƒ½éµå¾ªã€‚</p><h2 id="22-JMM-çš„çº¦å®š"><a href="#22-JMM-çš„çº¦å®š" class="headerlink" title="22.JMM çš„çº¦å®š"></a>22.JMM çš„çº¦å®š</h2><p>â€‹    â‘ çº¿ç¨‹è§£é”å‰ï¼Œå¿…é¡»æŠŠ<strong>å…±äº«å˜é‡</strong>ç«‹å³åˆ·å›ä¸»å­˜ã€‚  </p><p>â€‹    â‘¡çº¿ç¨‹åŠ é”å‰ï¼Œå¿…é¡»è¯»å–ä¸»å­˜ä¸­çš„<strong>æœ€æ–°å€¼åˆ°å·¥ä½œå†…å­˜</strong>ä¸­ã€‚  </p><p>â€‹    â‘¢åŠ é”å’Œè§£é”å¿…é¡»æ˜¯<strong>åŒä¸€æŠŠé”</strong>ã€‚</p><h2 id="23-JMM-çš„å…«ä¸ªå‘½ä»¤"><a href="#23-JMM-çš„å…«ä¸ªå‘½ä»¤" class="headerlink" title="23.JMM çš„å…«ä¸ªå‘½ä»¤"></a>23.JMM çš„å…«ä¸ªå‘½ä»¤</h2><p>ä¸ºäº†æ”¯æŒ <code>JMM</code>ï¼Œå®šä¹‰äº† 8 æ¡åŸå­æ“ä½œï¼Œç”¨äºä¸»å­˜å’Œå·¥ä½œå†…å­˜çš„äº¤äº’ã€‚</p><ul><li><strong>lockï¼ˆé”å®šï¼‰ï¼š</strong> ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çŠ¶æ€ã€‚  </li><li><strong>unlockï¼ˆè§£é”ï¼‰ï¼š</strong> ä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šã€‚</li><li><strong>readï¼ˆè¯»å–ï¼‰ï¼š</strong> ä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„ load åŠ¨ä½œä½¿ç”¨ã€‚  </li><li><strong>loadï¼ˆè½½å…¥ï¼‰ï¼š</strong> ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠ read æ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ã€‚</li><li><strong>useï¼ˆä½¿ç”¨ï¼‰ï¼š</strong> ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ã€‚  </li><li><strong>assignï¼ˆèµ‹å€¼ï¼‰ï¼š</strong> ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹å€¼ç»™å·¥ä½œå†…å­˜çš„å˜é‡ã€‚</li><li><strong>storeï¼ˆå­˜å‚¨ï¼‰ï¼š</strong> ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ééšåçš„ write çš„æ“ä½œã€‚  </li><li><strong>writeï¼ˆå†™å…¥ï¼‰ï¼š</strong> ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠ store æ“ä½œä»å·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜çš„å˜é‡ä¸­ã€‚</li></ul><h2 id="24-ä¸ºä»€ä¹ˆè¦æœ‰-JMMï¼Œç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#24-ä¸ºä»€ä¹ˆè¦æœ‰-JMMï¼Œç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="24. ä¸ºä»€ä¹ˆè¦æœ‰ JMMï¼Œç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>24. ä¸ºä»€ä¹ˆè¦æœ‰ JMMï¼Œç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2><p>â€‹    è§£å†³ç”±äºå¤šçº¿ç¨‹é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡æ—¶ï¼Œå­˜åœ¨çš„<strong>æœ¬åœ°å†…å­˜æ•°æ®ä¸ä¸€è‡´</strong>ã€ç¼–è¯‘å™¨ä¼šå¯¹ä»£ç <strong>æŒ‡ä»¤é‡æ’åº</strong>ã€å¤„ç†å™¨ä¼šå¯¹<strong>ä»£ç ä¹±åº</strong>æ‰§è¡Œç­‰å¸¦æ¥çš„é—®é¢˜ã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆå…«ï¼‰| Javaé›†åˆ</title>
      <link href="/posts/19057.html"/>
      <url>/posts/19057.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="Javaæ ¸å¿ƒæŠ€æœ¯-é›†åˆç±»"><a href="#Javaæ ¸å¿ƒæŠ€æœ¯-é›†åˆç±»" class="headerlink" title="Javaæ ¸å¿ƒæŠ€æœ¯ é›†åˆç±»"></a>Javaæ ¸å¿ƒæŠ€æœ¯ é›†åˆç±»</h2><p><code>Java</code> é›†åˆï¼Œä¹Ÿå«ä½œå®¹å™¨ï¼Œä¸»è¦æ˜¯ç”±ä¸¤å¤§æ¥å£æ´¾ç”Ÿè€Œæ¥ï¼šä¸€ä¸ªæ˜¯ <code>Collection</code> æ¥å£ï¼Œä¸»è¦ç”¨äºå­˜æ”¾å•ä¸€å…ƒç´ ï¼›å¦ä¸€ä¸ªæ˜¯ <code>Map</code> æ¥å£ï¼Œä¸»è¦ç”¨äºå­˜æ”¾é”®å€¼å¯¹ã€‚</p><h2 id="Collection-æ¥å£å…³ç³»å›¾"><a href="#Collection-æ¥å£å…³ç³»å›¾" class="headerlink" title="Collection æ¥å£å…³ç³»å›¾"></a>Collection æ¥å£å…³ç³»å›¾</h2><p>å…·ä½“å®ç°ï¼š<code>List</code>ã€<code>Queue</code>ã€<code>Set</code>ï¼Œå¯ä»¥çœ‹ä¸‹<code>Collection</code>å…³ç³»å›¾</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2025/01/20250107230336720.png" title="image-20250107162007452" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2025/01/20250107230336720.png" alt="image-20250107162007452"></a></p><h2 id="Map-é”®å€¼å¯¹å…³ç³»å›¾"><a href="#Map-é”®å€¼å¯¹å…³ç³»å›¾" class="headerlink" title="Map é”®å€¼å¯¹å…³ç³»å›¾"></a>Map é”®å€¼å¯¹å…³ç³»å›¾</h2><p>å…·ä½“å®ç°ï¼š<code>Hashtable</code>ã€<code>LinkedHashMap</code>ã€<code>TreeMap</code>ï¼Œå¯ä»¥çœ‹ä¸‹<code>Map</code> å…³ç³»å›¾</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2025/01/20250107230342470.png" title="image-20250107162107726" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2025/01/20250107230342470.png" alt="image-20250107162107726"></a> </p><h2 id="1-Listã€Setã€Queueã€Map-åŒºåˆ«"><a href="#1-Listã€Setã€Queueã€Map-åŒºåˆ«" class="headerlink" title="1.Listã€Setã€Queueã€Map åŒºåˆ«"></a>1.Listã€Setã€Queueã€Map åŒºåˆ«</h2><ul><li><code>List</code>ï¼šæœ‰åºåˆ—è¡¨ï¼Œå¯é‡å¤</li><li><code>Set</code>ï¼šæ— åºåˆ—è¡¨ï¼Œä¸å¯é‡å¤</li><li><code>Queue</code>ï¼šç‰¹æ€§çš„æ’é˜Ÿé¡ºåºç¡®å®šå…ˆåå…³ç³»ï¼Œå­˜å‚¨å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œå¯é‡å¤</li><li><code>Map</code>ï¼šä½¿ç”¨é”®å€¼å¯¹ï¼ˆkey-valueï¼‰å­˜å‚¨</li></ul><h2 id="2-Listã€Setã€Map-å¸¸ç”¨é›†åˆæœ‰å“ªäº›ï¼Ÿ"><a href="#2-Listã€Setã€Map-å¸¸ç”¨é›†åˆæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="2.Listã€Setã€Map å¸¸ç”¨é›†åˆæœ‰å“ªäº›ï¼Ÿ"></a>2.Listã€Setã€Map å¸¸ç”¨é›†åˆæœ‰å“ªäº›ï¼Ÿ</h2><h3 id="List"><a href="#List" class="headerlink" title="List"></a><strong>List</strong></h3><ul><li><strong>vectorï¼š</strong> åº•å±‚æ˜¯æ•°ç»„ï¼Œæ–¹æ³•åŠ äº† <code>synchronized</code> æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥æ•ˆç‡è¾ƒæ…¢ï¼Œä½¿ç”¨ <code>ArrayList</code> æ›¿ä»£ã€‚  </li><li><strong>ArrayListï¼š</strong> çº¿ç¨‹ä¸å®‰å…¨ï¼Œåº•å±‚æ˜¯æ•°ç»„ï¼Œå› ä¸ºæ•°ç»„éƒ½æ˜¯è¿ç»­çš„åœ°å€ï¼Œæ‰€ä»¥æŸ¥è¯¢æ¯”è¾ƒå¿«ã€‚å¢åˆ æ¯”è¾ƒæ…¢ï¼Œå¢ä¼šç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ï¼ŒæŠŠæ–°å¢çš„å…ƒç´ å’ŒåŸæœ‰å…ƒç´ æ”¾åˆ°æ–°æ•°ç»„ä¸­ï¼Œåˆ é™¤ä¼šå¯¼è‡´å…ƒç´ ç§»åŠ¨ï¼Œæ‰€ä»¥å¢åˆ é€Ÿåº¦è¾ƒæ…¢ã€‚  </li><li><strong>LinkedListï¼š</strong> çº¿ç¨‹ä¸å®‰å…¨ï¼Œåº•å±‚æ˜¯é“¾è¡¨ï¼Œå› ä¸ºåœ°å€ä¸æ˜¯è¿ç»­çš„ï¼Œéƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹å’Œä¸€ä¸ªèŠ‚ç‚¹ç›¸è¿ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½å¾—é‡å¤´å¼€å§‹æŸ¥è¯¢ï¼Œæ‰€ä»¥æŸ¥è¯¢æ…¢ï¼Œå¢åˆ åªæ˜¯æ–­è£‚æŸä¸ªèŠ‚ç‚¹å¯¹æ•´ä½“å½±å“ä¸å¤§ï¼Œæ‰€ä»¥å¢åˆ é€Ÿåº¦è¾ƒå¿«ã€‚</li></ul><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><ul><li><strong>HashSetï¼š</strong> åº•å±‚æ˜¯å“ˆå¸Œè¡¨ (æ•°ç»„ + é“¾è¡¨æˆ–æ•°ç»„ + çº¢é»‘æ ‘)ï¼Œåœ¨é“¾è¡¨é•¿åº¦å¤§äº 8 æ—¶è½¬ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘èŠ‚ç‚¹å°äº 6 æ—¶è½¬ä¸ºé“¾è¡¨ã€‚å…¶å®å°±æ˜¯å®ç°äº† <code>HashMap</code>ï¼Œå€¼å­˜å…¥ <code>keyï¼Œvalue</code> æ˜¯ä¸€ä¸ª <code>final</code> ä¿®é¥°çš„å¯¹è±¡ã€‚  </li><li><strong>TreeSetï¼š</strong> åº•å±‚æ˜¯çº¢é»‘æ ‘ç»“æ„ï¼Œå°±æ˜¯ <strong>TreeMap</strong> å®ç°ï¼Œå¯ä»¥å®ç°æœ‰åºçš„é›†åˆã€‚<strong>String</strong> å’Œ <strong>Integer</strong> å¯ä»¥æ ¹æ®å€¼è¿›è¡Œæ’åºã€‚å¦‚æœæ˜¯å¯¹è±¡éœ€è¦å®ç° Comparator æ¥å£ï¼Œé‡å†™ compareTo() æ–¹æ³•åˆ¶å®šæ¯”è¾ƒè§„åˆ™ã€‚  </li><li><strong>LinkedHashSetï¼š</strong> å®ç°äº† <strong>HashSet</strong>ï¼Œå¤šä¸€æ¡é“¾è¡¨æ¥è®°å½•ä½ç½®ï¼Œæ‰€ä»¥æ˜¯æœ‰åºçš„ã€‚</li></ul><h3 id="Map-lt-key-value-gt-åŒä¾‹ç»“æ„"><a href="#Map-lt-key-value-gt-åŒä¾‹ç»“æ„" class="headerlink" title="Map&lt;key,value&gt; åŒä¾‹ç»“æ„"></a><strong>Map&lt;key,value&gt; åŒä¾‹ç»“æ„</strong></h3><ul><li><strong>TreeMapï¼š</strong> åº•å±‚æ˜¯çº¢é»‘æ ‘ï¼Œkey å¯ä»¥æŒ‰é¡ºåºæ’åˆ—ã€‚  </li><li><strong>HashMapï¼š</strong> åº•å±‚æ˜¯å“ˆå¸Œè¡¨ï¼Œå¯ä»¥å¾ˆå¿«çš„å‚¨å­˜å’Œæ£€ç´¢ï¼Œæ— åºï¼Œå¤§é‡è¿­ä»£æƒ…å†µä¸ä½³ã€‚  </li><li><strong>LinkedHashMapï¼š</strong> åº•å±‚æ˜¯å“ˆå¸Œè¡¨ + é“¾è¡¨ï¼Œæœ‰åºï¼Œå¤§é‡è¿­ä»£æƒ…å†µä½³ã€‚</li></ul><h2 id="3-ArrayList-çš„åˆå§‹å®¹é‡æ˜¯å¤šå°‘ï¼Ÿæ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæ‰©å®¹è¿‡ç¨‹æ˜¯æ€æ ·ï¼Ÿ"><a href="#3-ArrayList-çš„åˆå§‹å®¹é‡æ˜¯å¤šå°‘ï¼Ÿæ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæ‰©å®¹è¿‡ç¨‹æ˜¯æ€æ ·ï¼Ÿ" class="headerlink" title="3.ArrayList çš„åˆå§‹å®¹é‡æ˜¯å¤šå°‘ï¼Ÿæ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæ‰©å®¹è¿‡ç¨‹æ˜¯æ€æ ·ï¼Ÿ"></a>3.ArrayList çš„åˆå§‹å®¹é‡æ˜¯å¤šå°‘ï¼Ÿæ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæ‰©å®¹è¿‡ç¨‹æ˜¯æ€æ ·ï¼Ÿ</h2><ul><li><p><strong>åˆå§‹å®¹é‡ï¼š</strong> é»˜è®¤ 10ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥å¤§å°ã€‚</p></li><li><p><strong>æ‰©å®¹æœºåˆ¶ï¼š</strong> åŸæ•°ç»„é•¿åº¦ + åŸæ•°ç»„é•¿åº¦ / 2 (æºç ä¸­æ˜¯åŸæ•°ç»„å³ç§»ä¸€ä½ï¼Œä¹Ÿå°±ç›¸å½“äºé™¤ä»¥ 2)<br>æ³¨æ„ï¼šæ‰©å®¹åçš„ <strong>ArrayList</strong> åº•å±‚æ•°ç»„<strong>ä¸æ˜¯åŸæ¥çš„æ•°ç»„</strong>ã€‚</p></li><li><p><strong>æ‰©å®¹è¿‡ç¨‹ï¼š</strong> å› ä¸º <strong>ArrayList</strong> åº•å±‚æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å®ƒçš„æ‰©å®¹æœºåˆ¶å’Œæ•°ç»„ä¸€æ ·ï¼Œé¦–å…ˆæ–°å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œé•¿åº¦æ˜¯åŸæ•°ç»„çš„ <strong>1.5</strong> å€ï¼Œç„¶åè°ƒç”¨ <strong>Arrays.copyof()</strong> å¤åˆ¶åŸæ•°ç»„çš„å€¼ï¼Œç„¶åèµ‹å€¼ç»™æ–°æ•°ç»„ã€‚</p></li></ul><h2 id="4-ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨"><a href="#4-ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨" class="headerlink" title="4. ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨"></a>4. ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨</h2><p>â€‹    æ ¹æ®å…³é”®ç å€¼ (<strong>Key value</strong>) è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ï¼Œåœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œé€šè¿‡ **H(key)<strong>è®¡ç®—å‡º <strong>key</strong> åœ¨è¡¨ä¸­çš„ä½ç½®ï¼Œ</strong>H(key)**å°±æ˜¯å“ˆå¸Œå‡½æ•°ï¼Œè¡¨å°±æ˜¯å“ˆå¸Œè¡¨ã€‚</p><h2 id="5-ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çª"><a href="#5-ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çª" class="headerlink" title="5. ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çª"></a>5. ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çª</h2><p>â€‹    ä¸åŒçš„ <strong>key</strong> é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡º<strong>ç›¸åŒçš„å‚¨å­˜åœ°å€</strong>ï¼Œè¿™å°±æ˜¯å“ˆå¸Œå†²çªã€‚</p><h2 id="6-è§£å†³å“ˆå¸Œå†²çª"><a href="#6-è§£å†³å“ˆå¸Œå†²çª" class="headerlink" title="6. è§£å†³å“ˆå¸Œå†²çª"></a>6. è§£å†³å“ˆå¸Œå†²çª</h2><ul><li>å¼€æ”¾åœ°å€æ³•ï¼šå¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œå°±ä¼šä»¥å½“å‰åœ°å€ä¸ºåŸºå‡†ï¼Œå†å»å¯»æ‰¾è®¡ç®—å¦ä¸€ä¸ªä½ç½®ï¼Œç›´åˆ°ä¸å‘ç”Ÿå“ˆå¸Œå†²çªã€‚ å¯»æ‰¾çš„æ–¹æ³•æœ‰ï¼š</li></ul><ol><li> çº¿æ€§æ¢æµ‹ 1ï¼Œ2ï¼Œ3ï¼Œm  </li><li> äºŒæ¬¡æ¢æµ‹ 1 çš„å¹³æ–¹ï¼Œ-1 çš„å¹³æ–¹ï¼Œ2 çš„å¹³æ–¹ï¼Œ-2 çš„å¹³æ–¹ï¼Œk çš„å¹³æ–¹ï¼Œ-k çš„å¹³æ–¹ï¼Œk&lt;=m/2  </li><li> éšæœºæ¢æµ‹ ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åä»éšæœºåœ°å€ + éšæœºæ•° ++ã€‚</li></ol><ul><li><p><strong>é“¾åœ°å€æ³•</strong> ï¼šå†²çªçš„å“ˆå¸Œå€¼ï¼Œè¿åˆ°åˆ°åŒä¸€ä¸ªé“¾è¡¨ä¸Šã€‚</p></li><li><p><strong>å†å“ˆå¸Œæ³• (å†æ•£åˆ—æ–¹æ³•)</strong>  ï¼šå¤šä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå‘ç”Ÿå†²çªï¼Œå°±åœ¨ç”¨å¦ä¸€ä¸ªç®—è®¡ï¼Œç›´åˆ°æ²¡æœ‰å†²çªã€‚</p></li><li><p><strong>å»ºç«‹å…¬å…±æº¢å‡ºåŒº</strong> ï¼šå“ˆå¸Œè¡¨åˆ†æˆåŸºæœ¬è¡¨å’Œæº¢å‡ºè¡¨ï¼Œä¸åŸºæœ¬è¡¨å‘ç”Ÿå†²çªçš„éƒ½å¡«å…¥æº¢å‡ºè¡¨ã€‚</p></li></ul><h2 id="7-HashMap-çš„-hash-ç®—æ³•ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯-h-key-hashcode-è€Œæ˜¯-key-hashcode-h-gt-gt-gt-16"><a href="#7-HashMap-çš„-hash-ç®—æ³•ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯-h-key-hashcode-è€Œæ˜¯-key-hashcode-h-gt-gt-gt-16" class="headerlink" title="7.HashMap çš„ hash() ç®—æ³•ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ h=key.hashcode(), è€Œæ˜¯ key.hashcode()^ (h&gt;&gt;&gt;16)"></a>7.HashMap çš„ hash() ç®—æ³•ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ h=key.hashcode(), è€Œæ˜¯ key.hashcode()^ (h&gt;&gt;&gt;16)</h2><p>â€‹    å¾—åˆ°å“ˆå¸Œå€¼ç„¶åå³ç§» 16 ä½ï¼Œç„¶åè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·ä½¿å“ˆå¸Œå€¼çš„ä½ 16 ä½ä¹Ÿå…·æœ‰äº†ä¸€éƒ¨åˆ†é«˜ 16 ä½çš„ç‰¹æ€§ï¼Œå¢åŠ æ›´å¤šçš„å˜åŒ–æ€§ï¼Œå‡å°‘äº†å“ˆå¸Œå†²çªã€‚</p><h2 id="8-ä¸ºä»€ä¹ˆ-HashMap-çš„åˆå§‹å®¹é‡å’Œæ‰©å®¹éƒ½æ˜¯-2-çš„æ¬¡å¹‚"><a href="#8-ä¸ºä»€ä¹ˆ-HashMap-çš„åˆå§‹å®¹é‡å’Œæ‰©å®¹éƒ½æ˜¯-2-çš„æ¬¡å¹‚" class="headerlink" title="8. ä¸ºä»€ä¹ˆ HashMap çš„åˆå§‹å®¹é‡å’Œæ‰©å®¹éƒ½æ˜¯ 2 çš„æ¬¡å¹‚"></a>8. ä¸ºä»€ä¹ˆ HashMap çš„åˆå§‹å®¹é‡å’Œæ‰©å®¹éƒ½æ˜¯ 2 çš„æ¬¡å¹‚</h2><p>â€‹    å› ä¸ºè®¡ç®—å…ƒç´ å­˜å‚¨çš„ä¸‹æ ‡æ˜¯ (n-1)&amp; å“ˆå¸Œå€¼ï¼Œæ•°ç»„åˆå§‹å®¹é‡ -1ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶éƒ½æ˜¯ 1ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å“ˆå¸Œå†²çªï¼Œå¯ä»¥æ›´å¥½çš„å‡åŒ€æ’å…¥ã€‚</p><h2 id="9-HashMap-å¦‚æœæŒ‡å®šäº†ä¸æ˜¯-2-çš„æ¬¡å¹‚çš„å®¹é‡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#9-HashMap-å¦‚æœæŒ‡å®šäº†ä¸æ˜¯-2-çš„æ¬¡å¹‚çš„å®¹é‡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="9.HashMap å¦‚æœæŒ‡å®šäº†ä¸æ˜¯ 2 çš„æ¬¡å¹‚çš„å®¹é‡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>9.HashMap å¦‚æœæŒ‡å®šäº†ä¸æ˜¯ 2 çš„æ¬¡å¹‚çš„å®¹é‡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</h2><p>â€‹    ä¼šè·å¾—ä¸€ä¸ªå¤§äºæŒ‡å®šçš„åˆå§‹å€¼çš„æœ€æ¥è¿‘ 2 çš„æ¬¡å¹‚çš„å€¼ä½œä¸ºåˆå§‹å®¹é‡ã€‚</p><h2 id="10-HashMap-ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨"><a href="#10-HashMap-ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="10.HashMap ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨"></a>10.HashMap ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨</h2><ul><li> <strong>jdk1.7</strong> ä¸­å› ä¸ºä½¿ç”¨<strong>å¤´æ’æ³•</strong>ï¼Œå†æ‰©å®¹çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé€ æˆ<strong>é—­ç¯å’Œæ•°æ®ä¸¢å¤±</strong>ã€‚ </li><li><strong>jdk1.8</strong> ä¸­ä½¿ç”¨<strong>å°¾æ’æ³•</strong>ï¼Œä¸ä¼šå‡ºç°é—­ç¯å’Œæ•°æ®ä¸¢å¤±ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¼š<strong>å‘ç”Ÿæ•°æ®è¦†ç›–</strong>ã€‚<ul><li><strong>put</strong> æ“ä½œä¸­ï¼Œåœ¨ <strong>putVal</strong> å‡½æ•°é‡Œï¼Œ<strong>å€¼çš„è¦†ç›–è¿˜æœ‰é•¿åº¦çš„è¦†ç›–</strong>ã€‚</li></ul></li></ul><h2 id="11-è§£å†³-Hashmap-çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#11-è§£å†³-Hashmap-çš„çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="11. è§£å†³ Hashmap çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>11. è§£å†³ Hashmap çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</h2><p>â€‹    (1) ä½¿ç”¨ <code>Hashtable</code> è§£å†³ï¼Œåœ¨æ–¹æ³•åŠ åŒæ­¥å…³é”®å­—ï¼Œæ‰€ä»¥<strong>æ•ˆç‡ä½ä¸‹</strong>ï¼Œå·²ç»è¢«å¼ƒç”¨ã€‚<br>â€‹    (2) ä½¿ç”¨ <code>Collections.synchronizedMap(new HashMap&lt;&gt;()),</code> ä¸å¸¸ç”¨ã€‚<br>â€‹    (3)<code>ConcurrentHashMap</code>(å¸¸ç”¨)</p><h2 id="12-ConcurrentHashMap-çš„åŸç†"><a href="#12-ConcurrentHashMap-çš„åŸç†" class="headerlink" title="12.ConcurrentHashMap çš„åŸç†"></a>12.ConcurrentHashMap çš„åŸç†</h2><ul><li><strong>jdk1.7ï¼š</strong> é‡‡ç”¨<strong>åˆ†æ®µé”</strong>ï¼Œæ˜¯ç”± <code>Segment</code>(ç»§æ‰¿ <code>ReentrantLock</code>ï¼šå¯é‡å…¥é”ï¼Œé»˜è®¤æ˜¯ 16ï¼Œå¹¶å‘åº¦æ˜¯ 16) å’Œ <code>HashEntry</code> å†…éƒ¨ç±»ç»„æˆï¼Œæ¯ä¸€ä¸ª <code>Segment</code>(é”) å¯¹åº” 1 ä¸ª <code>HashEntry(keyï¼Œvalue)</code> æ•°ç»„ï¼Œæ•°ç»„ä¹‹é—´äº’ä¸å½±å“ï¼Œå®ç°äº†å¹¶å‘è®¿é—®ã€‚  </li><li><strong>jdk1.8ï¼š</strong> æŠ›å¼ƒåˆ†æ®µé”ï¼Œé‡‡ç”¨ <strong>CAS(ä¹è§‚é”)+synchronized</strong> å®ç°æ›´åŠ <strong>ç»†ç²’åº¦çš„é”</strong>ï¼Œã€<strong>Node æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</strong>ã€‘ç»“æ„ã€‚åªè¦é”ä½é“¾è¡¨çš„<strong>å¤´èŠ‚ç‚¹</strong> (æ ‘çš„æ ¹èŠ‚ç‚¹)ï¼Œå°±ä¸ä¼šå½±å“å…¶ä»–æ•°ç»„çš„è¯»å†™ï¼Œæé«˜äº†å¹¶å‘åº¦ã€‚</li></ul><h2 id="13-ä¸ºä»€ä¹ˆç”¨-synchronized-ä»£æ›¿-ReentrantLock"><a href="#13-ä¸ºä»€ä¹ˆç”¨-synchronized-ä»£æ›¿-ReentrantLock" class="headerlink" title="13. ä¸ºä»€ä¹ˆç”¨ synchronized ä»£æ›¿ ReentrantLock"></a>13. ä¸ºä»€ä¹ˆç”¨ synchronized ä»£æ›¿ ReentrantLock</h2><p>â€‹    â‘ èŠ‚çœå†…å­˜å¼€é”€ã€‚<code>ReentrantLock</code> åŸºäº <code>AQS</code> æ¥è·å¾—åŒæ­¥æ”¯æŒï¼Œä½†ä¸æ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦åŒæ­¥æ”¯æŒï¼Œåªæœ‰<strong>é“¾è¡¨å¤´èŠ‚ç‚¹</strong>æˆ–<strong>æ ‘çš„æ ¹èŠ‚ç‚¹</strong>éœ€è¦åŒæ­¥ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>ReentrantLock</code> ä¼šå¸¦æ¥å¾ˆå¤§çš„<strong>å†…å­˜å¼€é”€</strong>ã€‚<br>â€‹    â‘¡è·å¾— <code>jvm</code> æ”¯æŒï¼Œå¯é‡å…¥é”åªæ˜¯ <code>api</code> çº§åˆ«ï¼Œè€Œ <code>synchronized</code> æ˜¯ <code>jvm</code> ç›´æ¥æ”¯æŒçš„ï¼Œèƒ½å¤Ÿåœ¨ <code>jvm</code> è¿è¡Œæ—¶åšå‡ºç›¸åº”çš„ä¼˜åŒ–ã€‚<br>â€‹    â‘¢åœ¨ <code>jdk1.6</code> ä¹‹åï¼Œå¯¹ <code>synchronized</code> åšäº†å¤§é‡çš„ä¼˜åŒ–ï¼Œè€Œä¸”æœ‰<strong>å¤šç§é”çŠ¶æ€</strong>ï¼Œä¼šä» ã€<strong>æ— é” -&gt; åå‘é” -&gt; è½»é‡çº§é” -&gt; é‡é‡çº§é”</strong>ã€‘ä¸€æ­¥æ­¥è½¬æ¢ã€‚</p><p>â€‹    <strong>AQS (Abstract Queued Synchronizer)ï¼š</strong> ä¸€ä¸ª<strong>æŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨</strong>ï¼Œé€šè¿‡ç»´æŠ¤ä¸€ä¸ªå…±äº«èµ„æºçŠ¶æ€ï¼ˆ <strong>Volatile Int State</strong> ï¼‰å’Œä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆ <strong>FIFO</strong> ï¼‰çš„çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—æ¥å®ç°ä¸€ä¸ªå¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„<strong>åŒæ­¥æ¡†æ¶</strong>ã€‚</p><h2 id="14-HashMap-ä¸ºä»€ä¹ˆä½¿ç”¨é“¾è¡¨"><a href="#14-HashMap-ä¸ºä»€ä¹ˆä½¿ç”¨é“¾è¡¨" class="headerlink" title="14.HashMap ä¸ºä»€ä¹ˆä½¿ç”¨é“¾è¡¨"></a>14.HashMap ä¸ºä»€ä¹ˆä½¿ç”¨é“¾è¡¨</h2><p>â€‹    å‡å°‘å’Œè§£å†³å“ˆå¸Œå†²çªï¼ŒæŠŠå†²çªçš„å€¼æ”¾åœ¨åŒä¸€é“¾è¡¨ä¸‹ã€‚</p><h2 id="15-HashMap-ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘"><a href="#15-HashMap-ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘" class="headerlink" title="15.HashMap ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘"></a>15.HashMap ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘</h2><p>â€‹    å½“æ•°æ®è¿‡å¤šï¼Œé“¾è¡¨éå†è¾ƒæ…¢ï¼Œæ‰€ä»¥å¼•å…¥çº¢é»‘æ ‘ã€‚</p><h2 id="16-HashMap-ä¸ºä»€ä¹ˆä¸ä¸€ä¸Šæ¥å°±ä½¿ç”¨çº¢é»‘æ ‘"><a href="#16-HashMap-ä¸ºä»€ä¹ˆä¸ä¸€ä¸Šæ¥å°±ä½¿ç”¨çº¢é»‘æ ‘" class="headerlink" title="16.HashMap ä¸ºä»€ä¹ˆä¸ä¸€ä¸Šæ¥å°±ä½¿ç”¨çº¢é»‘æ ‘"></a>16.HashMap ä¸ºä»€ä¹ˆä¸ä¸€ä¸Šæ¥å°±ä½¿ç”¨çº¢é»‘æ ‘</h2><p>â€‹    ç»´æŠ¤æˆæœ¬è¾ƒå¤§ï¼Œçº¢é»‘æ ‘åœ¨æ’å…¥æ–°çš„æ•°æ®åï¼Œå¯èƒ½ä¼šè¿›è¡Œã€<strong>å˜è‰²ã€å·¦æ—‹ã€å³æ—‹</strong>ã€‘æ¥ä¿æŒå¹³è¡¡ï¼Œæ‰€ä»¥å½“æ•°æ®å°‘æ—¶ï¼Œå°±ä¸éœ€è¦çº¢é»‘æ ‘ã€‚</p><h2 id="17-è¯´è¯´ä½ å¯¹çº¢é»‘æ ‘çš„ç†è§£-â•â•éœ€è¦æ‰©å±•"><a href="#17-è¯´è¯´ä½ å¯¹çº¢é»‘æ ‘çš„ç†è§£-â•â•éœ€è¦æ‰©å±•" class="headerlink" title="17. è¯´è¯´ä½ å¯¹çº¢é»‘æ ‘çš„ç†è§£(â•â•éœ€è¦æ‰©å±•)"></a>17. è¯´è¯´ä½ å¯¹çº¢é»‘æ ‘çš„ç†è§£(â•â•éœ€è¦æ‰©å±•)</h2><p>â€‹    â‘ æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²ã€‚</p><p>â€‹    â‘¡èŠ‚ç‚¹æ˜¯é»‘è‰²æˆ–çº¢è‰²ã€‚</p><p>â€‹    â‘¢å¶å­èŠ‚ç‚¹æ˜¯é»‘è‰²ã€‚</p><p>â€‹    â‘£çº¢è‰²èŠ‚ç‚¹çš„å­èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²ã€‚ </p><p>â€‹    â‘¤ä»ä»»æ„èŠ‚ç‚¹åˆ°å…¶å­èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚ </p><p><strong>çº¢é»‘æ ‘ä»æ ¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸ä¼šè¶…è¿‡æœ€çŸ­è·¯å¾„çš„ 2 å€ã€‚ä¿è¯äº†çº¢é»‘æ ‘çš„é«˜æ•ˆã€‚</strong></p><h2 id="18-ä¸ºä»€ä¹ˆé“¾è¡¨é•¿åº¦å¤§äº-8ï¼Œå¹¶ä¸”è¡¨çš„é•¿åº¦å¤§äº-64-çš„æ—¶å€™ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ï¼Ÿ"><a href="#18-ä¸ºä»€ä¹ˆé“¾è¡¨é•¿åº¦å¤§äº-8ï¼Œå¹¶ä¸”è¡¨çš„é•¿åº¦å¤§äº-64-çš„æ—¶å€™ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ï¼Ÿ" class="headerlink" title="18. ä¸ºä»€ä¹ˆé“¾è¡¨é•¿åº¦å¤§äº 8ï¼Œå¹¶ä¸”è¡¨çš„é•¿åº¦å¤§äº 64 çš„æ—¶å€™ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ï¼Ÿ"></a>18. ä¸ºä»€ä¹ˆé“¾è¡¨é•¿åº¦å¤§äº 8ï¼Œå¹¶ä¸”è¡¨çš„é•¿åº¦å¤§äº 64 çš„æ—¶å€™ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ï¼Ÿ</h2><p>â€‹    å› ä¸ºé“¾è¡¨é•¿åº¦è¶Šé•¿ï¼Œå“ˆå¸Œå†²çªæ¦‚ç‡å°±è¶Šå°ï¼Œå½“é“¾è¡¨ç­‰äº 8 æ—¶ï¼Œå“ˆå¸Œå†²çªå°±éå¸¸ä½äº†ï¼Œæ˜¯åƒä¸‡åˆ†ä¹‹ä¸€ï¼Œæˆ‘ä»¬çš„ <code>map</code> ä¹Ÿä¸ä¼šå­˜é‚£ä¹ˆå¤šæ•°æ®ï¼Œå¦‚æœçœŸè¦å­˜é‚£ä¹ˆå¤šæ•°æ®ï¼Œé‚£å°±è½¬ä¸ºçº¢é»‘æ ‘ï¼Œæé«˜<strong>æŸ¥è¯¢å’Œæ’å…¥</strong>çš„æ•ˆç‡ã€‚</p><h2 id="19-ä¸ºä»€ä¹ˆè½¬æˆçº¢é»‘æ ‘æ˜¯-8-å‘¢ï¼Ÿè€Œé‡æ–°è½¬ä¸ºé“¾è¡¨é˜ˆå€¼æ˜¯-6-å‘¢ï¼Ÿ"><a href="#19-ä¸ºä»€ä¹ˆè½¬æˆçº¢é»‘æ ‘æ˜¯-8-å‘¢ï¼Ÿè€Œé‡æ–°è½¬ä¸ºé“¾è¡¨é˜ˆå€¼æ˜¯-6-å‘¢ï¼Ÿ" class="headerlink" title="19. ä¸ºä»€ä¹ˆè½¬æˆçº¢é»‘æ ‘æ˜¯ 8 å‘¢ï¼Ÿè€Œé‡æ–°è½¬ä¸ºé“¾è¡¨é˜ˆå€¼æ˜¯ 6 å‘¢ï¼Ÿ"></a>19. ä¸ºä»€ä¹ˆè½¬æˆçº¢é»‘æ ‘æ˜¯ 8 å‘¢ï¼Ÿè€Œé‡æ–°è½¬ä¸ºé“¾è¡¨é˜ˆå€¼æ˜¯ 6 å‘¢ï¼Ÿ</h2><p>â€‹    å› ä¸ºå¦‚æœéƒ½æ˜¯ 8 çš„è¯ï¼Œé‚£ä¹ˆä¼š<strong>é¢‘ç¹è½¬æ¢ï¼Œä¼šæµªè´¹èµ„æº</strong>ã€‚</p><h2 id="20-ä¸ºä»€ä¹ˆè´Ÿè½½å› å­æ˜¯-0-75ï¼Ÿ-å†²çªå’Œåˆ©ç”¨ç‡"><a href="#20-ä¸ºä»€ä¹ˆè´Ÿè½½å› å­æ˜¯-0-75ï¼Ÿ-å†²çªå’Œåˆ©ç”¨ç‡" class="headerlink" title="20. ä¸ºä»€ä¹ˆè´Ÿè½½å› å­æ˜¯ 0.75ï¼Ÿ(å†²çªå’Œåˆ©ç”¨ç‡)"></a>20. ä¸ºä»€ä¹ˆè´Ÿè½½å› å­æ˜¯ 0.75ï¼Ÿ(å†²çªå’Œåˆ©ç”¨ç‡)</h2><p>â€‹    åŠ è½½å› å­è¶Šå¤§ï¼Œ<strong>å¡«æ»¡çš„å…ƒç´ è¶Šå¤š</strong>ï¼Œ<strong>ç©ºé—´åˆ©ç”¨ç‡è¶Šé«˜</strong>ï¼Œä½†å‘ç”Ÿå†²çªçš„æœºä¼šå˜å¤§äº†ï¼› </p><p>â€‹    åŠ è½½å› å­è¶Šå°ï¼Œå¡«æ»¡çš„å…ƒç´ è¶Šå°‘ï¼Œ<strong>å†²çªå‘ç”Ÿçš„æœºä¼šå‡å°</strong>ï¼Œä½†<strong>ç©ºé—´æµªè´¹</strong>äº†æ›´å¤šäº†ï¼Œè€Œä¸”è¿˜ä¼šæé«˜æ‰©å®¹ <strong>rehash</strong> æ“ä½œçš„æ¬¡æ•°ã€‚  </p><p>â€‹    â€œå†²çªçš„æœºä¼šâ€ä¸ â€œç©ºé—´åˆ©ç”¨ç‡â€ ä¹‹é—´ï¼Œå¯»æ‰¾ä¸€ç§å¹³è¡¡ä¸æŠ˜ä¸­ã€‚ </p><p>â€‹    åˆå› ä¸ºæ ¹æ®<strong>æ³Šæ¾åˆ†å¸ƒ</strong>ï¼Œå½“è´Ÿè½½å› å­æ˜¯ 0.75 æ—¶ï¼Œå¹³å‡å€¼æ˜¯ 0.5ï¼Œå¸¦å…¥å¯å¾—ï¼Œå½“é“¾è¡¨ä¸º 8 æ—¶ï¼Œå“ˆå¸Œå†²çªå‘ç”Ÿæ¦‚ç‡å°±å¾ˆä½äº†ã€‚</p><h2 id="21-ä»€ä¹ˆæ—¶å€™ä¼šæ‰©å®¹ï¼Ÿ"><a href="#21-ä»€ä¹ˆæ—¶å€™ä¼šæ‰©å®¹ï¼Ÿ" class="headerlink" title="21. ä»€ä¹ˆæ—¶å€™ä¼šæ‰©å®¹ï¼Ÿ"></a>21. ä»€ä¹ˆæ—¶å€™ä¼šæ‰©å®¹ï¼Ÿ</h2><p>â€‹    å…ƒç´ ä¸ªæ•° &gt; æ•°ç»„é•¿åº¦ * è´Ÿè½½å› å­ ä¾‹å¦‚ 16 * 0.75 = 12, å½“å…ƒç´ è¶…è¿‡ 12 ä¸ªæ—¶å°±ä¼šæ‰©å®¹ã€‚<br>â€‹    é“¾è¡¨é•¿åº¦å¤§äº 8 å¹¶ä¸”è¡¨é•¿å°äº 64ï¼Œä¹Ÿä¼šæ‰©å®¹</p><h2 id="22-ä¸ºä»€ä¹ˆä¸æ˜¯æ»¡äº†æ‰©å®¹ï¼Ÿ"><a href="#22-ä¸ºä»€ä¹ˆä¸æ˜¯æ»¡äº†æ‰©å®¹ï¼Ÿ" class="headerlink" title="22. ä¸ºä»€ä¹ˆä¸æ˜¯æ»¡äº†æ‰©å®¹ï¼Ÿ"></a>22. ä¸ºä»€ä¹ˆä¸æ˜¯æ»¡äº†æ‰©å®¹ï¼Ÿ</h2><p>â€‹    å› ä¸ºå…ƒç´ è¶Šå¤šï¼Œç©ºé—´åˆ©ç”¨ç‡æ˜¯é«˜äº†ï¼Œä½†æ˜¯å‘ç”Ÿå“ˆå¸Œ<strong>å†²çª</strong>çš„å‡ ç‡ä¹Ÿ<strong>å¢åŠ </strong>äº†ã€‚</p><h2 id="23-æ‰©å®¹è¿‡ç¨‹"><a href="#23-æ‰©å®¹è¿‡ç¨‹" class="headerlink" title="23. æ‰©å®¹è¿‡ç¨‹"></a>23. æ‰©å®¹è¿‡ç¨‹</h2><ul><li><strong>jdk1.7ï¼š</strong> ä¼šç”Ÿæˆä¸€ä¸ªæ–° <code>table</code>ï¼Œé‡æ–°è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹æ”¾è¿›æ–° <code>table</code>ï¼Œå› ä¸ºæ˜¯<strong>å¤´æ’æ³•</strong>ï¼Œåœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æ—¶å€™ï¼Œå¯èƒ½ä¼š<strong>å‡ºç°é—­ç¯å’Œæ•°æ®ä¸¢å¤±</strong>ã€‚  </li><li><strong>jdk1.8ï¼š</strong> ä¼šç”Ÿæˆä¸€ä¸ªæ–° <code>table</code>ï¼Œæ–°ä½ç½®åªéœ€è¦çœ‹ <code>(e.hash &amp; oldCap)</code> ç»“æœæ˜¯ 0 è¿˜æ˜¯ 1ï¼›0 å°±æ”¾åœ¨æ—§ä¸‹æ ‡ï¼Œ1 å°±æ˜¯æ—§ä¸‹æ ‡ + æ—§æ•°ç»„é•¿åº¦ã€‚é¿å…äº†å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œ hash è®¡ç®—ï¼Œå¤§å¤§æé«˜äº†æ•ˆç‡ã€‚<strong>e.hash</strong> æ˜¯æ•°ç»„çš„ <strong>hash</strong> å€¼ï¼Œï¼Œ<strong>oldCap</strong> æ˜¯æ—§æ•°ç»„çš„é•¿åº¦ã€‚</li></ul><h2 id="24-HashMap-å’Œ-Hashtable-çš„åŒºåˆ«"><a href="#24-HashMap-å’Œ-Hashtable-çš„åŒºåˆ«" class="headerlink" title="24.HashMap å’Œ Hashtable çš„åŒºåˆ«"></a>24.HashMap å’Œ Hashtable çš„åŒºåˆ«</h2><table><thead><tr><th>HashTable</th><th>HashMap</th></tr></thead><tbody><tr><td>Key Value ä¸èƒ½ null</td><td>Key Value å¯ä¸º null</td></tr><tr><td>çº¿ç¨‹å®‰å…¨</td><td>çº¿ç¨‹ä¸å®‰å…¨</td></tr></tbody></table><h2 id="25-é›†åˆä¸ºä»€ä¹ˆè¦ç”¨è¿­ä»£å™¨-Iterator"><a href="#25-é›†åˆä¸ºä»€ä¹ˆè¦ç”¨è¿­ä»£å™¨-Iterator" class="headerlink" title="25. é›†åˆä¸ºä»€ä¹ˆè¦ç”¨è¿­ä»£å™¨ (Iterator)"></a>25. é›†åˆä¸ºä»€ä¹ˆè¦ç”¨è¿­ä»£å™¨ (Iterator)</h2><p>â€‹    æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º <code>ConcurrentModificationException</code> å¼‚å¸¸ã€‚<br>å¦‚æœä¸ç”¨è¿­ä»£å™¨ï¼Œåªèƒ½ for å¾ªç¯ï¼Œè¿˜å¿…é¡»çŸ¥é“é›†åˆçš„æ•°æ®ç»“æ„ï¼Œå¤ç”¨æ€§ä¸å¼ºã€‚</p><h2 id="å‚è€ƒè‡ªï¼š"><a href="#å‚è€ƒè‡ªï¼š" class="headerlink" title="å‚è€ƒè‡ªï¼š"></a>å‚è€ƒè‡ªï¼š</h2><p><strong><a href="https://blog.csdn.net/twotwo22222/article/details/128424569?spm=1001.2014.3001.5502">java é›†åˆæ¡†æ¶è¯¦è§£</a></strong></p><p><strong><a href="https://blog.csdn.net/twotwo22222/article/details/128426417?spm=1001.2014.3001.5502">HashMap åº•å±‚åŸç†è¯¦è§£</a></strong></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œç³»åˆ—ï¼ˆä¸€ï¼‰| TCP å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/14054.html"/>
      <url>/posts/14054.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>äº’è”ç½‘æœ‰ä¸€æ•´å¥—åè®®æ„æˆï¼ŒTCPæ˜¯å…¶ä¸­çš„ä¸€å±‚</p><p><a href="https://s2.loli.net/2024/12/20/XqyWG5sZdevSAVf.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/XqyWG5sZdevSAVf.png"></a> </p><h3 id="ä»¥å¤ªç½‘"><a href="#ä»¥å¤ªç½‘" class="headerlink" title="ä»¥å¤ªç½‘"></a>ä»¥å¤ªç½‘</h3><ul><li>ä½œç”¨ï¼šç”µå­ä¿¡å·å¦‚ä½•ç»„æˆæ•°æ®åŒ…ï¼ˆpacketï¼‰ï¼Œè§£å†³äº†<code>å­ç½‘å†…éƒ¨ç‚¹å¯¹ç‚¹é€šä¿¡</code></li><li>ç¼ºç‚¹ï¼š<code>æ— æ³•è¿æ¥å¤šä¸ªå±€åŸŸç½‘</code>ï¼ŒIPåè®®è§£å†³</li></ul><h3 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h3><ul><li>ä½œç”¨ï¼šå®šä¹‰ä¸€å¥—è‡ªå·±çš„åœ°å€è§„åˆ™ï¼Œé€šè¿‡<code>è·¯ç”±</code>çš„å½¢å¼å°†å„ä¸ªå±€åŸŸç½‘ç›¸è¿ã€‚è·¯ç”±å™¨åŸºäºIPåè®®</li><li>è·¯ç”±å™¨å†…éƒ¨æœ‰ä¸€å¼ è·¯ç”±è¡¨ï¼Œè§„å®š IP å‡ºå£ï¼Œå®ç°æ•°æ®åŒ…è½¬å‘</li><li>ç¼ºç‚¹ï¼š<code>æ˜¯åœ°å€åè®®ï¼Œä¸èƒ½ä¿è¯æ•°æ®å®Œæ•´</code>ï¼ŒTCP åè®®è§£å†³</li></ul><h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><ul><li>ä½œç”¨ï¼š ä¿è¯æ•°æ®é€šä¿¡çš„å®Œæ•´æ€§å’Œå¯é æ€§ï¼Œé˜²æ­¢ä¸¢åŒ…</li></ul><h2 id="TCP-æ•°æ®åŒ…"><a href="#TCP-æ•°æ®åŒ…" class="headerlink" title="TCP æ•°æ®åŒ…"></a>TCP æ•°æ®åŒ…</h2><p>ä»¥å¤ªç½‘çš„æ•°æ®åŒ… å¤§å°å›ºå®šï¼Œæœ€åˆ1518 å¢åŠ åˆ° 1522 å­—èŠ‚ ã€‚å…¶ä¸­å¤´ä¿¡æ¯ï¼ˆheadï¼‰22 å­—èŠ‚ï¼Œè´Ÿè½½ï¼ˆ<code>payload</code>ï¼‰ï¼š1500å­—èŠ‚</p><p><a href="https://s2.loli.net/2024/12/20/6LlB7hW5z2ecNQa.png" title="æ•°æ®åŒ…" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/6LlB7hW5z2ecNQa.png" alt="æ•°æ®åŒ…"></a></p><p>ä»¥å¤ªç½‘æ•°æ®åŒ…ï¼š1522 å­—èŠ‚</p><ul><li>å¤´ä¿¡æ¯ï¼š22</li><li>è´Ÿè½½ï¼š1500<ul><li>IPæ•°æ®åŒ…<ul><li>å¤´ä¿¡æ¯ï¼š20ï¼ˆæœ€å°‘ï¼‰</li><li>è´Ÿè½½ï¼š1480<ul><li>TCP æ•°æ®åŒ…<ul><li>å¤´ä¿¡æ¯ï¼š20 ï¼ˆæœ€å°‘ï¼‰</li><li>è´Ÿè½½ï¼š1400</li></ul></li></ul></li></ul></li></ul></li></ul><p><a href="https://s2.loli.net/2024/12/20/ADXmMy1SJqC4wbe.png" title="æ•°æ®åŒ…" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ADXmMy1SJqC4wbe.png" alt="æ•°æ®åŒ…"></a></p><h2 id="TCP-æ•°æ®åŒ…ç¼–å·ï¼ˆSEQï¼‰"><a href="#TCP-æ•°æ®åŒ…ç¼–å·ï¼ˆSEQï¼‰" class="headerlink" title="TCP æ•°æ®åŒ…ç¼–å·ï¼ˆSEQï¼‰"></a>TCP æ•°æ®åŒ…ç¼–å·ï¼ˆSEQï¼‰</h2><p><code>TCP</code> ä¸ºæ¯ä¸ªæ•°æ®åŒ…ç¼–å·<code>ï¼ˆsequence numberï¼‰</code>ï¼Œç›®çš„æ˜¯ä¸ºäº†æ¥æ”¶æ–¹æŒ‰ç…§é¡ºåºè¿˜åŸã€‚å¦å¤–ï¼Œä¸‡ä¸€ä¸¢åŒ…ä¹Ÿå¯çŸ¥é“ä¸¢å¤±å“ªä¸€ä¸ªåŒ…ã€‚</p><p>æ¯ä¸ªæ•°æ®åŒ…éƒ½æœ‰ä¸¤ä¸ªç¼–å·</p><ul><li>è‡ªèº«ç¼–å·ï¼š<code>sequence number</code></li><li>ä¸‹ä¸€ä¸ªåŒ…ç¼–å·ï¼š<code>next sequence number</code></li></ul><p>å¦‚ä¸‹å›¾è¡¨ç¤ºï¼šå½“å‰åŒ…çš„è´Ÿè½½å¤§å°ä¸º <code>46183-45943 = 240</code> å­—èŠ‚</p><p><a href="https://s2.loli.net/2024/12/20/F7QTwmoiWqH3ZRP.png" title="ç¼–å· SEQ" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/F7QTwmoiWqH3ZRP.png" alt="ç¼–å· SEQ"></a></p><h2 id="TCP-æ•°æ®åŒ…ç»„è£…"><a href="#TCP-æ•°æ®åŒ…ç»„è£…" class="headerlink" title="TCP æ•°æ®åŒ…ç»„è£…"></a>TCP æ•°æ®åŒ…ç»„è£…</h2><p><code>æ“ä½œç³»ç»Ÿ</code>æŒç»­æ¥æ”¶ <code>TCP</code> æ•°æ®åŒ…ï¼ŒæŒ‰ç…§é¡ºåº<code>ç»„è£…</code>å¥½ã€‚ä¸€æ—¦ç»„è£…å®Œæˆåï¼Œæ ¹æ®æ•°æ®åŒ…ä¸­çš„<code>ç«¯å£ï¼ˆportï¼‰å‚æ•°</code>ï¼Œäº¤ç»™ç›‘å¬è¯¥ç«¯å£çš„åº”ç”¨ç¨‹åºå¤„ç†ã€‚åº”ç”¨ç¨‹åºæ”¶åˆ°ç»„è£…å¥½çš„åŸå§‹æ•°æ®ï¼Œä¼šæ ¹æ® <code>HTTP</code> åè®®ä¸­çš„ <code>Content-Length</code> å­—æ®µå¼€å§‹ä¸€æ®µæ®µè¯»å–æ•°æ®ã€‚å…¶ä¸­åº”ç”¨ç¨‹åºéœ€è¦çš„æ•°æ®æ”¾åœ¨ <code>TCP</code> æ•°æ®åŒ…ä¸­ï¼Œ <code>TCP</code> åŸå§‹æ–‡ä»¶çš„å¤§å°ç”±åº”ç”¨å±‚çš„åè®®æ¥è§„å®šã€‚</p><p><a href="https://s2.loli.net/2024/12/20/1TAQdlP7HCrZzYk.png" title="ç›‘å¬ç«¯å£" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/1TAQdlP7HCrZzYk.png" alt="ç›‘å¬ç«¯å£"></a></p><h2 id="æ…¢å¯åŠ¨å’ŒACK"><a href="#æ…¢å¯åŠ¨å’ŒACK" class="headerlink" title="æ…¢å¯åŠ¨å’ŒACK"></a>æ…¢å¯åŠ¨å’ŒACK</h2><blockquote><p>åŸå› ï¼šæœåŠ¡å™¨å¯èƒ½ç”±äºå¸¦å®½å°ã€è·¯ç”±å™¨è¿‡çƒ­ã€ç¼“å­˜æº¢å‡ºç­‰æƒ…å†µï¼Œå¯¼è‡´ä¸¢åŒ…ï¼Œå› æ­¤æœåŠ¡å™¨å‘åŒ…çš„é€Ÿåº¦ä¸æ˜¯è¶Šå¿«è¶Šå¥½ã€‚</p><p>ä½œç”¨ï¼šæœåŠ¡å™¨ä¸ºäº†è¾¾åˆ°çº¿è·¯çš„æœ€é«˜é€Ÿç‡ï¼Œè·çŸ¥å¯¹æ–¹çº¿è·¯çš„ç†æƒ³é€Ÿç‡ï¼Œä½¿ç”¨æ…¢å¯åŠ¨ã€‚</p></blockquote><p><code>Linux</code> å†…æ ¸è®¾è®¡ä¸€ä¸ª <code>TCP_INIT_CWND</code> åˆšå¼€å§‹é€šä¿¡çš„æ—¶å€™ï¼Œä¼šä¸€æ¬¡æ€§å‘é€10ä¸ªæ•°æ®åŒ…ï¼Œç„¶ååœä¸‹æ¥ï¼Œç­‰å¾…æ¥æ”¶æ–¹ç¡®è®¤ï¼Œå†ç»§ç»­å‘é€ã€‚</p><p>æ¥æ”¶æ–¹æ¯æ”¶åˆ°ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œå°±è¦å‘é€ä¸€ä¸ªç¡®è®¤æ¶ˆæ¯ï¼ˆ<code>acknowledgement</code>ï¼Œ<code>ACK</code>ï¼‰</p><p><code>ACK</code>ä¸¤ä¸ªä¿¡æ¯ï¼š</p><ul><li><code>ACK NUM</code>ï¼š<code>æœŸå¾…è¦æ”¶åˆ°ä¸‹ä¸€ä¸ªæ•°æ®åŒ…çš„ç¼–å·</code></li><li><code>WINDOW</code>ï¼š<code>æ¥æ”¶æ–¹çš„æ¥æ”¶çª—å£çš„å‰©ä½™å®¹é‡</code></li></ul><p>å‘é€æ–¹æœ‰äº†è¿™ä¸¤ä¸ªä¿¡æ¯ï¼Œå†åŠ ä¸Šè‡ªå·±å·²ç»å‘å‡ºçš„<code>æ•°æ®åŒ…çš„æœ€æ–°ç¼–å·</code>ï¼Œå°±ä¼šæ¨æµ‹å‡ºæ¥æ”¶æ–¹<code>å¤§æ¦‚çš„æ¥æ”¶é€Ÿåº¦</code>ï¼Œä»è€Œé™ä½æˆ–å¢åŠ å‘é€é€Ÿç‡ã€‚ è¿™è¢«ç§°ä¸ºâ€å‘é€çª—å£â€ï¼Œè¿™ä¸ªçª—å£çš„å¤§å°æ˜¯å¯å˜çš„ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/zhiG9MOQaL2461o.png" title="ACK" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/zhiG9MOQaL2461o.png" alt="ACK"></a></p><h2 id="æ•°æ®åŒ…ä¸¢å¤±å¤„ç†"><a href="#æ•°æ®åŒ…ä¸¢å¤±å¤„ç†" class="headerlink" title="æ•°æ®åŒ…ä¸¢å¤±å¤„ç†"></a>æ•°æ®åŒ…ä¸¢å¤±å¤„ç†</h2><p>â€‹    æ¯ä¸ªæ•°æ®åŒ…éƒ½æ˜¯å¸¦æœ‰ä¸‹ä¸€ä¸ªæ•°æ®åŒ…çš„ç¼–å·ï¼Œå¦‚æœä¸‹ä¸€ä¸ªæ•°æ®åŒ…æ²¡æœ‰æ”¶åˆ°ï¼Œé‚£ä¹ˆ <code>ACK çš„ç¼–å·å°±ä¸ä¼šæ”¹å˜</code>ã€‚</p><p>â€‹    å¦‚æœå‘é€æ–¹æ”¶åˆ°ä¸‰ä¸ªè¿ç»­çš„é‡å¤ACK æˆ–è€… è¶…æ—¶äº†è¿˜æ²¡æœ‰æ”¶åˆ°ä»»ä½•<code>ACK</code>ï¼Œå°±ä¼šç¡®è®¤ä¸¢åŒ…ï¼Œé€šè¿‡è¿™ä¸ªæœºåˆ¶ï¼Œä¿è¯äº†åŒ…ä¸ä¸¢å¤±ã€‚</p><p>â€‹    ä¸¾ä¾‹æ¥è¯´ï¼Œç°åœ¨æ”¶åˆ°äº†4å·åŒ…ï¼Œä½†æ˜¯æ²¡æœ‰æ”¶åˆ°5å·åŒ…ã€‚<code>ACK</code> å°±ä¼šè®°å½•ï¼ŒæœŸå¾…æ”¶åˆ°5å·åŒ…ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œ5å·åŒ…æ”¶åˆ°äº†ï¼Œé‚£ä¹ˆä¸‹ä¸€è½® <code>ACK</code> ä¼šæ›´æ–°ç¼–å·ã€‚å¦‚æœ5å·åŒ…è¿˜æ˜¯æ²¡æ”¶åˆ°ï¼Œä½†æ˜¯æ”¶åˆ°äº†6å·åŒ…æˆ–7å·åŒ…ï¼Œé‚£ä¹ˆ <code>ACK</code> é‡Œé¢çš„ç¼–å·ä¸ä¼šå˜åŒ–ï¼Œæ€»æ˜¯æ˜¾ç¤º5å·åŒ…ã€‚è¿™ä¼šå¯¼è‡´å¤§ é‡é‡å¤å†…å®¹çš„ <code>ACK</code>ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/w6k24BK9bj1QzHX.png" title="ä¸‰æ¬¡é‡å¤ACKçš„é‡å‘æœºåˆ¶" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/w6k24BK9bj1QzHX.png" alt="ä¸‰æ¬¡é‡å¤ACKçš„é‡å‘æœºåˆ¶"></a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html">TCP åè®®ç®€ä»‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)</a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°·ç²’å•†åŸï¼ˆä¸‰ï¼‰| å‰ç«¯åŸºç¡€</title>
      <link href="/posts/31297.html"/>
      <url>/posts/31297.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å‰ç«¯åŸºç¡€"><a href="#å‰ç«¯åŸºç¡€" class="headerlink" title="å‰ç«¯åŸºç¡€"></a>å‰ç«¯åŸºç¡€</h1><h2 id="å‰åç«¯å¯¹æ¯”"><a href="#å‰åç«¯å¯¹æ¯”" class="headerlink" title="å‰åç«¯å¯¹æ¯”"></a>å‰åç«¯å¯¹æ¯”</h2><p><a href="https://s2.loli.net/2024/12/20/jEKNqZz3WMwuG4y.png" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/jEKNqZz3WMwuG4y.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></a> </p><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><blockquote><p>ECMAScript 6.0ï¼ˆä»¥ä¸‹ç®€ç§° ES6ï¼ŒECMAScriptæ˜¯ä¸€ç§ç”±<code>Ecma</code>å›½é™…é€šè¿‡ECMA-262æ ‡å‡†åŒ–çš„è„šæœ¬ï¼‰ï¼Œ æ˜¯JavaScriptè¯­è¨€çš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œ2015å¹´6æœˆæ­£å¼å‘å¸ƒï¼Œä»ES6å¼€å§‹çš„ç‰ˆæœ¬å·é‡‡ç”¨å¹´å·ï¼Œå¦‚ES2015ï¼Œå°±æ˜¯ES6ã€‚ES2016å°±æ˜¯ES7ã€‚ ECMAScriptæ˜¯è§„èŒƒï¼ŒJSçš„è§„èŒƒçš„å…·ä½“å®ç°ã€‚</p></blockquote><h3 id="let-amp-const"><a href="#let-amp-const" class="headerlink" title="let &amp; const"></a>let &amp; const</h3><ul><li>ä½œç”¨åŸŸï¼švaråœ¨{}ä¹‹å¤–ä¹Ÿèµ·ä½œç”¨ letåœ¨{}ä¹‹å¤–ä¸èµ·ä½œç”¨ </li><li>å£°æ˜æ¬¡æ•°ï¼švar å¤šæ¬¡å£°æ˜åŒä¸€å˜é‡ä¸ä¼šæŠ¥é”™ï¼Œletå¤šæ¬¡å£°æ˜ä¼šæŠ¥é”™ï¼Œåªèƒ½å£°æ˜ä¸€æ¬¡ã€‚</li><li>å˜é‡æå‡ï¼švar ä¼šå˜é‡æå‡ï¼ˆæ‰“å°å’Œå®šä¹‰å¯ä»¥é¡ºåºåï¼‰ï¼›let ä¸å­˜åœ¨å˜é‡æå‡ï¼ˆé¡ºåºä¸èƒ½åï¼‰ </li><li>const å£°æ˜ä¹‹åä¸å…è®¸æ”¹å˜</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">       <span class="token comment">// var å£°æ˜çš„å˜é‡å¾€å¾€ä¼šè¶ŠåŸŸ</span>       <span class="token comment">// let å£°æ˜çš„å˜é‡æœ‰ä¸¥æ ¼å±€éƒ¨ä½œç”¨åŸŸ</span><span class="token comment">//         &#123;</span><span class="token comment">//             var a = 1;</span><span class="token comment">//             let b = 2;</span><span class="token comment">//         &#125;</span><span class="token comment">//         console.log(a);  // 1</span><span class="token comment">//         console.log(b);  // ReferenceError: b is not defined</span>    <span class="token comment">// var å¯ä»¥å£°æ˜å¤šæ¬¡</span>            <span class="token comment">// let åªèƒ½å£°æ˜ä¸€æ¬¡</span><span class="token comment">//         var m = 1</span><span class="token comment">//         var m = 2</span><span class="token comment">//         let n = 3</span><span class="token comment">//       let n = 4</span><span class="token comment">//         console.log(m)  // 2</span><span class="token comment">//         console.log(n)  // Identifier 'n' has already been declared</span>        <span class="token comment">// var ä¼šå˜é‡æå‡</span>        <span class="token comment">// let ä¸å­˜åœ¨å˜é‡æå‡</span><span class="token comment">//         console.log(x);  // undefined</span><span class="token comment">//         var x = 10;</span><span class="token comment">//         console.log(y);   //ReferenceError: y is not defined</span><span class="token comment">//         let y = 20;</span>        <span class="token comment">// const</span>        <span class="token comment">// 1. constå£°æ˜ä¹‹åä¸å…è®¸æ”¹å˜</span>        <span class="token comment">// 2. ä¸€ä½†å£°æ˜å¿…é¡»åˆå§‹åŒ–ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>        <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Uncaught TypeError: Assignment to constant variable.</span>        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ„è¡¨è¾¾å¼"><a href="#è§£æ„è¡¨è¾¾å¼" class="headerlink" title="è§£æ„è¡¨è¾¾å¼"></a>è§£æ„è¡¨è¾¾å¼</h3><ul><li>æ•°ç»„è§£æ„ï¼šæ”¯æŒ <code>let arr = [1,2,3]; let [a,b,c] = arr</code></li><li>å†’å·æ”¹åï¼š<code>const &#123; name: abc, age, language &#125; = person</code></li><li>å­—ç¬¦ä¸²å‡½æ•°ï¼šæ”¯æŒä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºå¤šè¡Œ å ä½ç¬¦åŠŸèƒ½ ${}</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token comment">//æ•°ç»„è§£æ„</span>        <span class="token comment">// let arr = [1,2,3];</span>        <span class="token comment">// // let a = arr[0];</span>        <span class="token comment">// // let b = arr[1];</span>        <span class="token comment">// // let c = arr[2];</span>        <span class="token comment">// let [a,b,c] = arr;</span>        <span class="token comment">// console.log(a,b,c)</span>        <span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"jack"</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>            <span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'java'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//         const name = person.name;</span>        <span class="token comment">//         const age = person.age;</span>        <span class="token comment">//         const language = person.language;</span>        <span class="token comment">//å¯¹è±¡è§£æ„</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> abc<span class="token punctuation">,</span> age<span class="token punctuation">,</span> language <span class="token punctuation">&#125;</span> <span class="token operator">=</span> person<span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>abc<span class="token punctuation">,</span> age<span class="token punctuation">,</span> language<span class="token punctuation">)</span>        <span class="token comment">// å­—ç¬¦ä¸²æ‰©å±•</span>        <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"hello.vue"</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".vue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>        <span class="token comment">//å­—ç¬¦ä¸²æ¨¡æ¿</span>        <span class="token keyword">let</span> ss <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div>                    &lt;span>hello world&lt;span>                &lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å­—ç¬¦ä¸²æ’å…¥å˜é‡å’Œè¡¨è¾¾å¼ã€‚å˜é‡åå†™åœ¨ $&#123;&#125; ä¸­ï¼Œ$&#123;&#125; ä¸­å¯ä»¥æ”¾å…¥ JavaScript è¡¨è¾¾å¼ã€‚</span>        <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string">"è¿™æ˜¯ä¸€ä¸ªå‡½æ•°"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æˆ‘æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>abc<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">ï¼Œä»Šå¹´</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>age <span class="token operator">+</span> <span class="token number">10</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">äº†, æˆ‘æƒ³è¯´ï¼š </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‡½æ•°ä¼˜åŒ–"><a href="#å‡½æ•°ä¼˜åŒ–" class="headerlink" title="å‡½æ•°ä¼˜åŒ–"></a>å‡½æ•°ä¼˜åŒ–</h3><ul><li>å‡½æ•°é»˜è®¤å€¼ï¼š <code>b = b || 1;</code> ç°åœ¨å¯ä»¥ç›´æ¥å†™äº†<code>function add2(a, b = 1)</code> </li><li>ä¸å®šå‚æ•°ï¼š<code>function fun(...values) &#123;</code></li><li>æ”¯æŒç®­å¤´å‡½æ•°ï¼ˆ<code>lambda</code>è¡¨è¾¾å¼ï¼‰ï¼Œè¿˜æ”¯æŒä½¿ç”¨{}ç»“æ„ä¼ å…¥å¯¹è±¡çš„æˆå‘˜</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token comment">//åœ¨ES6ä»¥å‰ï¼Œæˆ‘ä»¬æ— æ³•ç»™ä¸€ä¸ªå‡½æ•°å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œåªèƒ½é‡‡ç”¨å˜é€šå†™æ³•ï¼š</span>        <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// åˆ¤æ–­bæ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºå°±ç»™é»˜è®¤å€¼1</span>            b <span class="token operator">=</span> b <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// ä¼ ä¸€ä¸ªå‚æ•°</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//ç°åœ¨å¯ä»¥è¿™ä¹ˆå†™ï¼šç›´æ¥ç»™å‚æ•°å†™ä¸Šé»˜è®¤å€¼ï¼Œæ²¡ä¼ å°±ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼</span>        <span class="token keyword">function</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//ä¸å®šå‚æ•°</span>        <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>values</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>length<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>      <span class="token comment">//2</span>        <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">//4</span>        <span class="token comment">//ç®­å¤´å‡½æ•°</span>        <span class="token comment">//ä»¥å‰å£°æ˜ä¸€ä¸ªæ–¹æ³•</span>        <span class="token comment">// var print = function (obj) &#123;</span>        <span class="token comment">//     console.log(obj);</span>        <span class="token comment">// &#125;</span>        <span class="token keyword">var</span> <span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">return</span> a <span class="token operator">+</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">var</span> <span class="token function-variable function">sum2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum2</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> <span class="token function-variable function">sum3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>            c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>            <span class="token keyword">return</span> a <span class="token operator">+</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"jack"</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>            <span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'java'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello,"</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//ç®­å¤´å‡½æ•°+è§£æ„</span>        <span class="token keyword">var</span> <span class="token function-variable function">hello2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello,"</span> <span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">hello2</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¯¹è±¡ä¼˜åŒ–"><a href="#å¯¹è±¡ä¼˜åŒ–" class="headerlink" title="å¯¹è±¡ä¼˜åŒ–"></a>å¯¹è±¡ä¼˜åŒ–</h3><ul><li><code>map</code>ï¼šè·å–<code>map</code>çš„é”®å€¼å¯¹ç­‰<code>Object.keys()ã€valuesã€entries</code></li><li>å¯¹è±¡åˆå¹¶ï¼š<code>Object.assign(target,source1,source2)</code></li><li>å£°æ˜ç®€å†™ï¼š<code>const person2 = &#123; age, name &#125;</code></li><li>å¯¹è±¡æ‹·è´ï¼š<code>let someone = &#123; â€¦p1 &#125;</code></li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"jack"</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>            <span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'java'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//["name", "age", "language"]</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//["jack", 21, Array(3)]</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[Array(2), Array(2), Array(2)]</span>        <span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> source1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> source2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">//&#123;a:1,b:2,c:3&#125;</span>        Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> source1<span class="token punctuation">,</span> source2<span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//["name", "age", "language"]</span>        <span class="token comment">// å£°æ˜å¯¹è±¡ç®€å†™</span>        <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">23</span>        <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"å¼ ä¸‰"</span>        <span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">age</span><span class="token operator">:</span> age<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> name <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> age<span class="token punctuation">,</span> name <span class="token punctuation">&#125;</span><span class="token comment">//å£°æ˜å¯¹è±¡ç®€å†™</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¯¹è±¡çš„å‡½æ•°å±æ€§ç®€å†™</span>        <span class="token keyword">let</span> person3 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"jack"</span><span class="token punctuation">,</span>            <span class="token comment">// ä»¥å‰ï¼š</span>            <span class="token function-variable function">eat</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">food</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"åœ¨åƒ"</span> <span class="token operator">+</span> food<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token comment">//ç®­å¤´å‡½æ•°thisä¸èƒ½ä½¿ç”¨ï¼Œå¯¹è±¡.å±æ€§</span>            <span class="token function-variable function">eat2</span><span class="token operator">:</span> <span class="token parameter">food</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person3<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"åœ¨åƒ"</span> <span class="token operator">+</span> food<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token function">eat3</span><span class="token punctuation">(</span><span class="token parameter">food</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"åœ¨åƒ"</span> <span class="token operator">+</span> food<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        person3<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token string">"é¦™è•‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        person3<span class="token punctuation">.</span><span class="token function">eat2</span><span class="token punctuation">(</span><span class="token string">"è‹¹æœ"</span><span class="token punctuation">)</span>        person3<span class="token punctuation">.</span><span class="token function">eat3</span><span class="token punctuation">(</span><span class="token string">"æ©˜å­"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¯¹è±¡æ‹“å±•è¿ç®—ç¬¦</span>        <span class="token comment">//  æ‹·è´å¯¹è±¡ï¼ˆæ·±æ‹·è´ï¼‰</span>        <span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Amy"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">let</span> someone <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>p1 <span class="token punctuation">&#125;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>someone<span class="token punctuation">)</span>  <span class="token comment">//&#123;name: "Amy", age: 15&#125;</span>        <span class="token comment">//  åˆå¹¶å¯¹è±¡</span>        <span class="token keyword">let</span> age1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">let</span> name1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Amy"</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">let</span> p2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"zhangsan"</span><span class="token punctuation">&#125;</span>        p2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>age1<span class="token punctuation">,</span> <span class="token operator">...</span>name1 <span class="token punctuation">&#125;</span>         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="mapå’Œreduce"><a href="#mapå’Œreduce" class="headerlink" title="mapå’Œreduce"></a>mapå’Œreduce</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token comment">//æ•°ç»„ä¸­æ–°å¢äº†mapå’Œreduceæ–¹æ³•ã€‚</span>        <span class="token comment">//map()ï¼šæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œå°†åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ç”¨è¿™ä¸ªå‡½æ•°å¤„ç†åæ”¾å…¥æ–°æ•°ç»„è¿”å›ã€‚</span>         <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">,</span> <span class="token string">'-5'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                 <span class="token comment">//  arr = arr.map((item)=>&#123;</span>        <span class="token comment">//     return item*2</span>        <span class="token comment">//  &#125;);</span>         arr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=></span> item<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//reduce() ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¾æ¬¡æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œä¸åŒ…æ‹¬æ•°ç»„ä¸­è¢«åˆ é™¤æˆ–ä»æœªè¢«èµ‹å€¼çš„å…ƒç´ ï¼Œ</span>        <span class="token comment">//[2, 40, -10, 6]</span>        <span class="token comment">//arr.reduce(callback,[initialValue])</span>        <span class="token comment">/**     1ã€previousValue ï¼ˆä¸Šä¸€æ¬¡è°ƒç”¨å›è°ƒè¿”å›çš„å€¼ï¼Œæˆ–è€…æ˜¯æä¾›çš„åˆå§‹å€¼ï¼ˆinitialValueï¼‰ï¼‰    2ã€currentValue ï¼ˆæ•°ç»„ä¸­å½“å‰è¢«å¤„ç†çš„å…ƒç´ ï¼‰    3ã€index ï¼ˆå½“å‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ï¼‰    4ã€array ï¼ˆè°ƒç”¨ reduce çš„æ•°ç»„ï¼‰*/</span>        <span class="token keyword">let</span> result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ä¸Šä¸€æ¬¡å¤„ç†åï¼š"</span><span class="token operator">+</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ­£åœ¨å¤„ç†ï¼š"</span><span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h3><ul><li>å°è£…ï¼šèµ‹å€¼ç»™ <code>let p</code> åœ¨<code>Ajax</code>ä¸­æˆåŠŸä½¿ç”¨ <code>resolve(data)</code>ï¼Œäº¤ç»™thenå¤„ç†ï¼Œ å¤±è´¥ä½¿ç”¨<code>reject(err)</code>ï¼Œäº¤ç»™<code>catch</code>å¤„ç†<code>p.then().catch()</code></li></ul><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">//corse_score_10.json å¾—åˆ†</span><span class="token punctuation">&#123;</span>    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>    <span class="token property">"score"</span><span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">&#125;</span><span class="token comment">//user.json ç”¨æˆ·</span><span class="token punctuation">&#123;</span>    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"zhangsan"</span><span class="token punctuation">,</span>    <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"123456"</span><span class="token punctuation">&#125;</span><span class="token comment">//user_corse_1.json è¯¾ç¨‹</span><span class="token punctuation">&#123;</span>    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"chinese"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token comment">//1ã€æŸ¥å‡ºå½“å‰ç”¨æˆ·ä¿¡æ¯</span>        <span class="token comment">//2ã€æŒ‰ç…§å½“å‰ç”¨æˆ·çš„idæŸ¥å‡ºä»–çš„è¯¾ç¨‹</span>        <span class="token comment">//3ã€æŒ‰ç…§å½“å‰è¯¾ç¨‹idæŸ¥å‡ºåˆ†æ•°</span>        <span class="token comment">// $.ajax(&#123;</span>        <span class="token comment">//     url: "mock/user.json",</span>        <span class="token comment">//     success(data) &#123;</span>        <span class="token comment">//         console.log("æŸ¥è¯¢ç”¨æˆ·ï¼š", data);</span>        <span class="token comment">//         $.ajax(&#123;</span>        <span class="token comment">//             url: `mock/user_corse_$&#123;data.id&#125;.json`,</span>        <span class="token comment">//             success(data) &#123;</span>        <span class="token comment">//                 console.log("æŸ¥è¯¢åˆ°è¯¾ç¨‹ï¼š", data);</span>        <span class="token comment">//                 $.ajax(&#123;</span>        <span class="token comment">//                     url: `mock/corse_score_$&#123;data.id&#125;.json`,</span>        <span class="token comment">//                     success(data) &#123;</span>        <span class="token comment">//                         console.log("æŸ¥è¯¢åˆ°åˆ†æ•°ï¼š", data);</span>        <span class="token comment">//                     &#125;,</span>        <span class="token comment">//                     error(error) &#123;</span>        <span class="token comment">//                         console.log("å‡ºç°å¼‚å¸¸äº†ï¼š" + error);</span>        <span class="token comment">//                     &#125;</span>        <span class="token comment">//                 &#125;);</span>        <span class="token comment">//             &#125;,</span>        <span class="token comment">//             error(error) &#123;</span>        <span class="token comment">//                 console.log("å‡ºç°å¼‚å¸¸äº†ï¼š" + error);</span>        <span class="token comment">//             &#125;</span>        <span class="token comment">//         &#125;);</span>        <span class="token comment">//     &#125;,</span>        <span class="token comment">//     error(error) &#123;</span>        <span class="token comment">//         console.log("å‡ºç°å¼‚å¸¸äº†ï¼š" + error);</span>        <span class="token comment">//     &#125;</span>        <span class="token comment">// &#125;);</span>        <span class="token comment">//1ã€Promiseå¯ä»¥å°è£…å¼‚æ­¥æ“ä½œ</span>        <span class="token comment">// let p = new Promise((resolve, reject) => &#123; //ä¼ å…¥æˆåŠŸè§£æï¼Œå¤±è´¥æ‹’ç»</span>        <span class="token comment">//     //1ã€å¼‚æ­¥æ“ä½œ</span>        <span class="token comment">//     $.ajax(&#123;</span>        <span class="token comment">//         url: "mock/user.json",</span>        <span class="token comment">//         success: function (data) &#123;</span>        <span class="token comment">//             console.log("æŸ¥è¯¢ç”¨æˆ·æˆåŠŸ:", data)</span>        <span class="token comment">//             resolve(data);</span>        <span class="token comment">//         &#125;,</span>        <span class="token comment">//         error: function (err) &#123;</span>        <span class="token comment">//             reject(err);</span>        <span class="token comment">//         &#125;</span>        <span class="token comment">//     &#125;);</span>        <span class="token comment">// &#125;);</span>        <span class="token comment">// p.then((obj) => &#123; //æˆåŠŸä»¥ååšä»€ä¹ˆ</span>        <span class="token comment">//     return new Promise((resolve, reject) => &#123;</span>        <span class="token comment">//         $.ajax(&#123;</span>        <span class="token comment">//             url: `mock/user_corse_$&#123;obj.id&#125;.json`,</span>        <span class="token comment">//             success: function (data) &#123;</span>        <span class="token comment">//                 console.log("æŸ¥è¯¢ç”¨æˆ·è¯¾ç¨‹æˆåŠŸ:", data)</span>        <span class="token comment">//                 resolve(data);</span>        <span class="token comment">//             &#125;,</span>        <span class="token comment">//             error: function (err) &#123;</span>        <span class="token comment">//                 reject(err)</span>        <span class="token comment">//             &#125;</span>        <span class="token comment">//         &#125;);</span>        <span class="token comment">//     &#125;)</span>        <span class="token comment">// &#125;).then((data) => &#123; //æˆåŠŸä»¥åå¹²ä»€ä¹ˆ</span>        <span class="token comment">//     console.log("ä¸Šä¸€æ­¥çš„ç»“æœ", data)</span>        <span class="token comment">//     $.ajax(&#123;</span>        <span class="token comment">//         url: `mock/corse_score_$&#123;data.id&#125;.json`,</span>        <span class="token comment">//         success: function (data) &#123;</span>        <span class="token comment">//             console.log("æŸ¥è¯¢è¯¾ç¨‹å¾—åˆ†æˆåŠŸ:", data)</span>        <span class="token comment">//         &#125;,</span>        <span class="token comment">//         error: function (err) &#123;</span>        <span class="token comment">//         &#125;</span>        <span class="token comment">//     &#125;);</span>        <span class="token comment">// &#125;)</span>        <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è‡ªå·±å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ•´åˆä¸€ä¸‹</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>                $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                    <span class="token literal-property property">url</span><span class="token operator">:</span> url<span class="token punctuation">,</span>                    <span class="token literal-property property">data</span><span class="token operator">:</span> data<span class="token punctuation">,</span>                    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                    <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"mock/user.json"</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·æŸ¥è¯¢æˆåŠŸ~~~:"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mock/user_corse_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>data<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¯¾ç¨‹æŸ¥è¯¢æˆåŠŸ~~~:"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mock/corse_score_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>data<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¯¾ç¨‹æˆç»©æŸ¥è¯¢æˆåŠŸ~~~:"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span> <span class="token comment">//å¤±è´¥çš„è¯catch</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å‡ºç°å¼‚å¸¸"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h3><ul><li>ä»£ç æ‹†åˆ†ï¼šç±»ä¼¼<code>Java</code>å¯¼åŒ…ï¼Œå¯¼æ¨¡å—ã€‚ </li><li>å‘½ä»¤ï¼š<code>export å’Œ import</code> <ul><li><code>export</code> ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ </li><li><code>import</code> ç”¨äºå¯¼å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½</li></ul></li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">user<span class="token punctuation">.</span>js<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"jack"</span><span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">21</span><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">export</span> <span class="token punctuation">&#123;</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>add<span class="token punctuation">&#125;</span>hello<span class="token punctuation">.</span>js<span class="token comment">// export const util = &#123;</span><span class="token comment">//     sum(a, b) &#123;</span><span class="token comment">//         return a + b;</span><span class="token comment">//     &#125;</span><span class="token comment">// &#125;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// export &#123;util&#125;</span><span class="token comment">//`export`ä¸ä»…å¯ä»¥å¯¼å‡ºå¯¹è±¡ï¼Œä¸€åˆ‡JSå˜é‡éƒ½å¯ä»¥å¯¼å‡ºã€‚æ¯”å¦‚ï¼šåŸºæœ¬ç±»å‹å˜é‡ã€å‡½æ•°ã€æ•°ç»„ã€å¯¹è±¡ã€‚</span>main<span class="token punctuation">.</span>js<span class="token keyword">import</span> abc <span class="token keyword">from</span> <span class="token string">"./hello.js"</span><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>name<span class="token punctuation">,</span>add<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./user.js"</span>abc<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><h3 id="MVVMæ€æƒ³"><a href="#MVVMæ€æƒ³" class="headerlink" title="MVVMæ€æƒ³"></a>MVVMæ€æƒ³</h3><ul><li><p><code>Mï¼šmodel</code> åŒ…æ‹¬æ•°æ®å’Œä¸€äº›åŸºæœ¬æ“ä½œ </p></li><li><p><code>Vï¼šview</code> è§†å›¾ï¼Œé¡µé¢æ¸²æŸ“ç»“æœ </p></li><li><p><code>VMï¼šView-model</code>ï¼Œæ¨¡å‹ä¸è§†å›¾é—´çš„åŒå‘æ“ä½œï¼ˆæ— éœ€å¼€å‘äººå‘˜å¹²æ¶‰ï¼‰ è§†å›¾å’Œæ•°æ®é€šè¿‡VMç»‘å®šèµ·æ¥ï¼Œ<code>model</code>é‡Œæœ‰å˜åŒ–ä¼šè‡ªåŠ¨åœ°é€šè¿‡<code>Directives</code>å¡«å†™åˆ°è§†<code>view</code>ä¸­ï¼Œ è§†å›¾è¡¨å•ä¸­æ·»åŠ äº†å†…å®¹ä¹Ÿä¼šè‡ªåŠ¨åœ°é€šè¿‡<code>DOM Listeners</code>ä¿å­˜åˆ°æ¨¡å‹ä¸­ã€‚</p></li></ul><h3 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h3><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">npm init -y&#x2F;&#x2F;æ•™å­¦çš„ç‰ˆæœ¬æ˜¯Vue2ï¼Œç›®å‰ç‰ˆæœ¬æ˜¯Vue3npm i vue@2 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html" data-language="html"><code class="language-html">åœ¨VSCodeä¸­å®‰è£…vue 2 snippetsè¯­æ³•æç¤ºæ’ä»¶ï¼Œåœ¨è°·æ­Œæµè§ˆå™¨ä¸­å®‰è£…vue.js devtools<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        v-modelå®ç°åŒå‘ç»‘å®š        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>num++<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç‚¹èµ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        v-on:clickç»‘å®šäº‹ä»¶ï¼Œå®ç°è‡ªå¢        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cancel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>å–æ¶ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        å›åˆ°è‡ªå®šä¹‰çš„æ–¹æ³•                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span> &#123;&#123;name&#125;&#125; ,éå¸¸å¸…ï¼Œæœ‰&#123;&#123;num&#125;&#125;ä¸ªäººä¸ºä»–ç‚¹èµ&#123;&#123;hello()&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- å¯¼å…¥ä¾èµ– --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./node_modules/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token comment">//1ã€vueå£°æ˜å¼æ¸²æŸ“</span>        <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token comment">//ç”Ÿæˆvueå¯¹è±¡</span>            <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span><span class="token comment">//ç»‘å®šå…ƒç´  div id="app"</span>            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//å°è£…æ•°æ®</span>                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span>  <span class="token comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨&#123;&#125; //è¡¨å•ä¸­å¯ä»¥å–å‡º</span>                <span class="token literal-property property">num</span><span class="token operator">:</span> <span class="token number">1</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>  <span class="token comment">//å°è£…æ–¹æ³•</span>                <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">--</span> <span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token string">"1"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        è¿˜å¯ä»¥åœ¨htmlæ§åˆ¶å° vm<span class="token punctuation">.</span>name <span class="token punctuation">,</span>vm è¡¨ç¤º Vueå¯¹è±¡çš„å®ä¾‹        <span class="token comment">//2ã€åŒå‘ç»‘å®š,æ¨¡å‹å˜åŒ–ï¼Œè§†å›¾å˜åŒ–ã€‚åä¹‹äº¦ç„¶ã€‚</span>        <span class="token comment">//3ã€äº‹ä»¶å¤„ç†</span>        <span class="token comment">//v-xxï¼šæŒ‡ä»¤</span>        <span class="token comment">//1ã€åˆ›å»ºvueå®ä¾‹ï¼Œå…³è”é¡µé¢çš„æ¨¡æ¿ï¼Œå°†è‡ªå·±çš„æ•°æ®ï¼ˆdataï¼‰æ¸²æŸ“åˆ°å…³è”çš„æ¨¡æ¿ï¼Œå“åº”å¼çš„</span>        <span class="token comment">//2ã€æŒ‡ä»¤æ¥ç®€åŒ–å¯¹domçš„ä¸€äº›æ“ä½œã€‚</span>        <span class="token comment">//3ã€å£°æ˜æ–¹æ³•æ¥åšæ›´å¤æ‚çš„æ“ä½œã€‚methodsé‡Œé¢å¯ä»¥å°è£…æ–¹æ³•ã€‚</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»„ä»¶åŒ–"><a href="#ç»„ä»¶åŒ–" class="headerlink" title="ç»„ä»¶åŒ–"></a>ç»„ä»¶åŒ–</h3><blockquote><p>åœ¨å¤§å‹åº”ç”¨å¼€å‘çš„æ—¶å€™ï¼Œé¡µé¢å¯ä»¥åˆ’åˆ†æˆå¾ˆå¤šéƒ¨åˆ†ã€‚å¾€å¾€ä¸åŒçš„é¡µé¢ï¼Œä¹Ÿä¼šæœ‰ç›¸åŒçš„éƒ¨åˆ†ã€‚ ä¾‹å¦‚å¯èƒ½ä¼šæœ‰ç›¸åŒçš„å¤´éƒ¨å¯¼èˆªã€‚ ä½†æ˜¯å¦‚æœæ¯ä¸ªé¡µé¢éƒ½è‡ªå¼€å‘ï¼Œè¿™æ— ç–‘å¢åŠ äº†æˆ‘ä»¬å¼€å‘çš„æˆæœ¬ã€‚</p><p>æŠŠé¡µé¢æ‹†æˆä¸åŒçš„ç»„ä»¶ï¼Œç„¶åå…±äº«ç»„ä»¶ï¼Œé¿å…é‡å¤å¼€å‘ã€‚ åœ¨vueé‡Œï¼Œæ‰€æœ‰çš„vueå®ä¾‹éƒ½æ˜¯ç»„ä»¶ï¼Œç»„ä»¶å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªvueå®ä¾‹ï¼Œå› æ­¤å®ƒåœ¨å®šä¹‰æ—¶ä¹Ÿä¼šæ¥æ”¶ï¼šdataã€methodsã€ç”Ÿå‘½å‘¨æœŸå‡½ç­‰ ä¸åŒçš„æ˜¯ç»„ä»¶ä¸ä¼šä¸é¡µé¢çš„å…ƒç´ ç¶å®šï¼Œå¦åˆ™å°±æ— æ³•å¤ç”¨äº†ï¼Œå› æ­¤æ²¡æœ‰elå±æ€§ã€‚ </p><p>ä½†æ˜¯ç»„ä»¶æ¸²æŸ“éœ€è¦htmlæ¨¡æ¿ï¼Œæ‰€ä»¥å¢åŠ äº†templateå±æ€§ï¼Œå€¼å°±æ˜¯HTMLæ¨¡æ¿ å…¨å±€ç»„ä»¶å®šä¹‰å®Œæ¯•ï¼Œä»»ä½•vueå®ä¾‹éƒ½å¯ä»¥ç›´æ¥åœ¨HTMLä¸­é€šè¿‡ç»„ä»¶åç§°æ¥ä½¿ç”¨ç»„äº† dataå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸å†æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote><h3 id="Vueè„šæ‰‹æ¶"><a href="#Vueè„šæ‰‹æ¶" class="headerlink" title="Vueè„šæ‰‹æ¶"></a>Vueè„šæ‰‹æ¶</h3><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># å…¨å±€å®‰è£… Webpacknpm i webpack -g# å…¨å±€å®‰è£…è„šæ‰‹æ¶npm i vue-cli -g# æŸ¥çœ‹ç‰ˆæœ¬ 2.9.6vue -V# ä½¿ç”¨ webpack æ¨¡æ¿é¡¹ç›® åˆå§‹åŒ–ä¸€ä¸ª appname é¡¹ç›®vue init webpack appname:vue # å¯åŠ¨é¡¹ç›®ï¼Œé¡¹ç›®ä¸­çš„package.json ä¸­ scriptsï¼Œä»£è¡¨è¿è¡Œå‘½ä»¤npm start &#x3D; npm run dev # é¡¹ç›®æ‰“åŒ…npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">$ &#96;vue init webpack app&#96;? Target directory exists. Continue? (Y&#x2F;n) y? Target directory exists. Continue? Yes? Project name app? Project description (A Vue.js project)? Project description A Vue.js project? Author (lingzhexi &lt;lingzhexi@gmail.com&gt;)? Author lingzhexi &lt;lingzhexi@gmail.com&gt;? Vue build (Use arrow keys)? Vue build standalone? Install vue-router? (Y&#x2F;n) &#96;y&#96;? Install vue-router? Yes? Use ESLint to lint your code? (Y&#x2F;n) &#96;n&#96;? Use ESLint to lint your code? No? Set up unit tests (Y&#x2F;n) &#96;n&#96;? Set up unit tests No? Setup e2e tests with Nightwatch? (Y&#x2F;n) &#96;y&#96;? Setup e2e tests with Nightwatch? Yes? Should we run &#96;npm install&#96; for you after the project has been created? (recom? Should we run &#96;npm install&#96; for you after the project has been created? (recommended) yarn   vue-cli Â· Generated &quot;app&quot;.# Installing project dependencies ...# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#39;yarn&#39; is not recognized as an internal or external command,operable program or batch file.# Project initialization finished!# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;To get started:  cd app  npm run devDocumentation can be found at https:&#x2F;&#x2F;vuejs-templates.github.io&#x2F;webpack<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨element-UI"><a href="#ä½¿ç”¨element-UI" class="headerlink" title="ä½¿ç”¨element-UI"></a>ä½¿ç”¨element-UI</h3><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># å®‰è£…npm i elemenet-ui -S<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js"># åœ¨ main<span class="token punctuation">.</span>js ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span><span class="token punctuation">;</span>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># è¡¥å……ä¾èµ–npm i webpack-dev-server --save-dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> è°·ç²’å•†åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è°·ç²’å•†åŸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°·ç²’å•†åŸï¼ˆäºŒï¼‰| æ•´åˆå¾®æœåŠ¡</title>
      <link href="/posts/57306.html"/>
      <url>/posts/57306.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="æ•´åˆå¾®æœåŠ¡"><a href="#æ•´åˆå¾®æœåŠ¡" class="headerlink" title="æ•´åˆå¾®æœåŠ¡"></a>æ•´åˆå¾®æœåŠ¡</h1><p> <a href="https://s2.loli.net/2024/12/20/5dY8KzaGhRHTxJi.png" title="image-20220411213056325" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/5dY8KzaGhRHTxJi.png" alt="image-20220411213056325"></a></p><h2 id="æ­é…æ–¹æ¡ˆ"><a href="#æ­é…æ–¹æ¡ˆ" class="headerlink" title="æ­é…æ–¹æ¡ˆ"></a>æ­é…æ–¹æ¡ˆ</h2><ul><li><code>SpringCloud Alibaba - Nacos</code> : æ³¨å†Œä¸­å¿ƒ ï¼ˆæœåŠ¡å‘ç°/æ³¨å†Œï¼‰</li><li><code>SpringCloud Alibaba - Nacos</code> : é…ç½®ä¸­å¿ƒ ï¼ˆåŠ¨æ€é…ç½®ç®¡ç†ï¼‰</li><li><code>SpringCloud - Ribbon</code> :  è´Ÿè½½å‡è¡¡</li><li><code>SpringCloud - Feign</code> : å£°æ˜å¼ HTTP å®¢æˆ·ç«¯ ï¼ˆè°ƒç”¨è¿œç¨‹æœåŠ¡ï¼‰</li><li><code>SpringCloud Alibaba - Sentinel</code> : æœåŠ¡å®¹é”™ ï¼ˆé™æµã€é™çº§ã€ç†”æ–­ï¼‰</li><li><code>SpringCloud - Gateway</code> : API ç½‘å…³ ï¼ˆ<code>webflux</code> ç¼–ç¨‹æ¨¡å¼ï¼‰</li><li><code>SpringCloud - Sleuth</code> : è°ƒç”¨é“¾ç›‘æ§</li><li><code>SpringCloud Alibaba - Seata</code> : åŸ <code>Fescar</code> å³åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ     </li></ul><p>é˜¿é‡Œå·´å·´ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/spring-cloud-alibaba/blob/2021.x/README-zh.md"><code>SpringCloud Alibab ä¸­æ–‡æ–‡æ¡£</code></a></p><h2 id="ç‰ˆæœ¬é€‰æ‹©"><a href="#ç‰ˆæœ¬é€‰æ‹©" class="headerlink" title="ç‰ˆæœ¬é€‰æ‹©"></a>ç‰ˆæœ¬é€‰æ‹©</h2><h3 id="SpringCloudä¸SpringBoot"><a href="#SpringCloudä¸SpringBoot" class="headerlink" title="SpringCloudä¸SpringBoot"></a>SpringCloudä¸SpringBoot</h3><p><a href="https://s2.loli.net/2024/12/20/4tlKwGon8NMrmXc.png" title="image-20220411215026972" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/4tlKwGon8NMrmXc.png" alt="image-20220411215026972"></a>  </p><p><code>SpringCloud - SpringBoo</code>t ç‰ˆæœ¬å¯¹æ¯”ï¼ˆ<a href="https://spring.io/projects/spring-cloud">SpringCloud å®˜ç½‘</a>ï¼‰</p><p><a href="https://s2.loli.net/2024/12/20/2r1UOopabiySQT7.png" title="image-20220411215056217" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/2r1UOopabiySQT7.png" alt="image-20220411215056217"></a> </p><h3 id="SpringAlibabaä¸SpringBoot"><a href="#SpringAlibabaä¸SpringBoot" class="headerlink" title="SpringAlibabaä¸SpringBoot"></a>SpringAlibabaä¸SpringBoot</h3><p><code>SpringCloud Alibaba - SpringBoot</code> ç‰ˆæœ¬å¯¹æ¯” ï¼ˆ <a href="https://github.com/alibaba/spring-cloud-alibaba/blob/2021.x/README-zh.md">SpringCloud Alibaba Github</a>ï¼‰</p><p><a href="https://s2.loli.net/2024/12/20/IF39t1RPLksHofE.png" title="image-20220411220224816" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/IF39t1RPLksHofE.png" alt="image-20220411220224816"></a> </p><p>å°† <code>SpringCloud Alibaba</code> ä¾èµ– åŠ å…¥ <code>gulimall-common</code> ä¸­  </p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ³¨å†Œä¸­å¿ƒ"><a href="#æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="æ³¨å†Œä¸­å¿ƒ"></a>æ³¨å†Œä¸­å¿ƒ</h2><p><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/2021.x/spring-cloud-alibaba-docs/src/main/asciidoc-zh/nacos-discovery.adoc">nacos æ³¨å†Œä¸­å¿ƒ</a></p><h3 id="æœåŠ¡æ³¨å†Œ-å‘ç°-Nacos-Discovery"><a href="#æœåŠ¡æ³¨å†Œ-å‘ç°-Nacos-Discovery" class="headerlink" title="æœåŠ¡æ³¨å†Œ/å‘ç° Nacos Discovery"></a>æœåŠ¡æ³¨å†Œ/å‘ç° Nacos Discovery</h3><ol><li><p>å¼•å…¥ä¾èµ–ï¼ŒåŠ å…¥<code>gulimall-common</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼˜æƒ å·æ¨¡å—å¼•å…¥ nacos discovery ä¾èµ–</p><p> <a href="https://s2.loli.net/2024/12/20/1ZQkPU5OgAKzoR3.png" title="image-20220411222218474" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/1ZQkPU5OgAKzoR3.png" alt="image-20220411222218474"></a> </p></li><li><p>é…ç½®<code>Nacos Server</code> åœ°å€</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span>  <span class="token key atrule">discovery</span><span class="token punctuation">:</span>    <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä½¿ç”¨ <code>@EnableDiscoveryClient</code> æ³¨è§£å¼€å¯æœåŠ¡æ³¨å†Œå’Œå‘ç°<br><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204112228697.png" title="image-20220411222803578" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204112228697.png" alt="image-20220411222803578"></a> </p></li><li><p>æŸ¥çœ‹æ³¨å†Œçš„æœåŠ¡</p><blockquote><p> ç™»å½•åå° 127.0.0.1:8848/nacos </p><p> ç”¨æˆ·ä¿¡æ¯ï¼šnacos/nacos</p></blockquote><p><a href="https://s2.loli.net/2024/12/20/47RDns6HXGTPlMC.png" title="image-20220411223200216" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/47RDns6HXGTPlMC.png" alt="image-20220411223200216"></a> </p></li></ol><h2 id="è¿œç¨‹è°ƒç”¨"><a href="#è¿œç¨‹è°ƒç”¨" class="headerlink" title="è¿œç¨‹è°ƒç”¨"></a>è¿œç¨‹è°ƒç”¨</h2><ol><li><p>å¼•å…¥ <code>open-feign</code></p></li><li><p>ç¼–å†™ä¸€ä¸ªæ¥å£ï¼Œå‘Šè¯‰<code>SpringCloud</code> éœ€è¦è°ƒç”¨è¿œç¨‹æ¥å£</p><ul><li><p>æ–°å»ºä¸€ä¸ª<code>feign</code> åŒ…</p></li><li><p>å†™ä¸€ä¸ªæ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span><span class="token string">"gulimall-coupon"</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨ç¤º nacos æ³¨å†Œä¸­å¿ƒä¸­çš„æ‰¾åˆ°æœåŠ¡åä¸º gulimall-coupon çš„æœåŠ¡</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponFeignService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/coupon/coupon/member/coupon"</span><span class="token punctuation">)</span> <span class="token comment">// æ‰¾åˆ°ä¼˜æƒ åˆ¸æœåŠ¡ä¸­çš„è¯¥æ¥å£</span>    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">memberCoupons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>å¼€å¯è¿œç¨‹è°ƒç”¨åŠŸèƒ½ </p><p>åœ¨ä¸»å¯åŠ¨ä¸­æ·»åŠ  <code>@EnableFeignClients(basePackages=&quot;xx&quot;)</code> <code>xx</code>è¡¨ç¤ºæŒ‡å®š<code>feign</code>çš„æ¥å£åŒ…</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.atguigu.gulimall.member.feign"</span><span class="token punctuation">)</span> <span class="token comment">//æ­¤æ—¶çš„basePackages å¯ä»¥çœç•¥</span><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">"com.atguigu.gulimall.member.dao"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GulimallMemberApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">GulimallMemberApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç¤ºä¾‹</p><ul><li><p>æ·»åŠ è¿œç¨‹æ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"coupon/coupon"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CouponService</span> couponService<span class="token punctuation">;</span>    <span class="token comment">/**     * ä¼šå‘˜ä¼˜æƒ åˆ¸     */</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/member/coupon"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">memberCoupons</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">CouponEntity</span> couponEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        couponEntity<span class="token punctuation">.</span><span class="token function">setCouponName</span><span class="token punctuation">(</span><span class="token string">"æ»¡100å‡10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"coupons"</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>couponEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ·»åŠ è°ƒç”¨æ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"member/member"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MemberController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MemberService</span> memberService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token class-name">CouponFeignService</span> couponFeignService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/coupons"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">MemberEntity</span> memberEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MemberEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        memberEntity<span class="token punctuation">.</span><span class="token function">setNickname</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">R</span> r <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">memberCoupons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"member"</span><span class="token punctuation">,</span> memberEntity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"coupons"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"coupons"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è¯·æ±‚æ¥å£ <code>localhost:8000/member/member/coupons</code></p></li></ul></li></ol><h2 id="é…ç½®ä¸­å¿ƒï¼šåŠ¨æ€ç®¡ç†é…ç½®"><a href="#é…ç½®ä¸­å¿ƒï¼šåŠ¨æ€ç®¡ç†é…ç½®" class="headerlink" title="é…ç½®ä¸­å¿ƒï¼šåŠ¨æ€ç®¡ç†é…ç½®"></a>é…ç½®ä¸­å¿ƒï¼šåŠ¨æ€ç®¡ç†é…ç½®</h2><p><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/2021.x/spring-cloud-alibaba-examples/nacos-example/nacos-config-example/readme-zh.md">nacos é…ç½®ä¸­å¿ƒæ–‡æ¡£</a></p><ol><li><p>å¼•å…¥ <code>Nacos Config  Starter</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»º <code>bootstrap.yml</code>ï¼Œé…ç½® <code>Nacos</code> å…ƒæ•°æ®</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>coupon<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½®ä¸­å¿ƒ æ·»åŠ  æ•°æ®é›†<code>ï¼ˆData Idï¼‰ gulimall-coupon.properties</code> ï¼Œé»˜è®¤è§„åˆ™ï¼Œåº”ç”¨å.<code>properties</code><br><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204122135151.png" title="image-20220412213509978" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204122135151.png" alt="image-20220412213509978"></a> </p><p><a href="https://s2.loli.net/2024/12/20/xuvoJZNPcyQghM1.png" title="image-20220412214528762" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/xuvoJZNPcyQghM1.png" alt="image-20220412214528762"></a> </p></li><li><p>åŠ¨æ€è·å–é…ç½®<br><code>@RefreshScope</code> ï¼šåŠ¨æ€è·å–å¹¶åˆ·æ–°é…ç½®</p><p><code>@Value(&quot;$&#123;é…ç½®é¡¹çš„å&#125;&quot;)</code> ï¼šè·å–åˆ°é…ç½®</p><p>å¦‚æœé…ç½®ä¸­å¿ƒå’Œå½“å‰åº”ç”¨éƒ½é…ç½®ç›¸åŒçš„é¡¹ï¼Œä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒçš„é…ç½®</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RefreshScope</span> <span class="token comment">//åŠ¨æ€åˆ·æ–°</span><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"coupon/coupon"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CouponService</span> couponService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;coupon.user.name&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;coupon.user.age&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ ¸å¿ƒæ¦‚å¿µ</p><p><a href="https://s2.loli.net/2024/12/20/Ggy1T8tbxdC2Y4K.png" title="image-20220412220641506" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/Ggy1T8tbxdC2Y4K.png" alt="image-20220412220641506"></a></p><ul><li><p>å‘½åç©ºé—´ï¼šé…ç½®éš”ç¦» </p><p>é»˜è®¤ <code>public</code> ï¼šé»˜è®¤æ–°å¢çš„æ‰€æœ‰éƒ½åœ¨è¯¥ç©ºé—´ä¸‹</p><ol><li><p>å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ ï¼šåˆ©ç”¨å‘½åç©ºé—´æ¥åšç¯å¢ƒéš”ç¦»</p><p>æ³¨æ„ï¼šåœ¨<code>bootstrap.yml</code> é…ç½®ä¸­ï¼Œéœ€è¦ä½¿ç”¨é‚£ä¸ªå‘½åç©ºé—´ä¸‹çš„é…ç½®</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">cc749289-b027-486f-bb6a-3febcabecbdb</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://s2.loli.net/2024/12/20/8nlSj5ma7KZQEcg.png" title="image-20220412220837375" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/8nlSj5ma7KZQEcg.png" alt="image-20220412220837375"></a> </p></li><li><p>æ¯ä¸ªæœåŠ¡åº”ç”¨ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œç®¡ç†å¾®æœåŠ¡è‡ªå·±çš„é…ç½®<br><a href="https://s2.loli.net/2024/12/20/yaIEOv29ZWSQB3R.png" title="image-20220412223231969" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/yaIEOv29ZWSQB3R.png" alt="image-20220412223231969"></a></p></li></ol></li><li><p>é…ç½®é›†ï¼šæ‰€æœ‰é…ç½®çš„é›†åˆ</p></li><li><p>é…ç½®é›†IDï¼šç±»ä¼¼æ–‡ä»¶å ï¼ˆ<code>Data IDï¼š</code> æ–‡ä»¶åï¼‰</p></li><li><p>é…ç½®åˆ†ç»„ï¼šé»˜è®¤æ‰€æœ‰çš„é…ç½®é›†éƒ½å±äºï¼š<code>DEFAULT_GROUP</code>ï¼›</p><ul><li><p>ç»„åï¼š<code>1111 ã€618 ã€1212</code></p></li><li><p><a href="https://s2.loli.net/2024/12/20/sbvGAordepQkS7N.png" title="image-20220412224056530" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/sbvGAordepQkS7N.png" alt="image-20220412224056530"></a> </p></li><li><p>æ·»åŠ åˆ†ç»„é…ç½®</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.cloud.nacos.config.group</span><span class="token punctuation">=</span><span class="token value attr-value">1111</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li><li><p>æ¯ä¸ªå¾®æœåŠ¡åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨é…ç½®åˆ†ç»„åŒºåˆ†ç¯å¢ƒï¼Œ<code>devã€testã€prod</code> ç¯å¢ƒ</p><p><a href="https://s2.loli.net/2024/12/20/fnXI5ZrPdv2jCY3.png" title=" " class="gallery-item"><img src="https://s2.loli.net/2024/12/20/fnXI5ZrPdv2jCY3.png" alt=" "></a>     </p></li></ul></li><li><p>åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®é›†</p><ul><li><p>å¾®æœåŠ¡ä»»ä½•é…ç½®ä¿¡æ¯ï¼Œä»»ä½•é…ç½®æ–‡ä»¶éƒ½å¯ä»¥æ”¾åœ¨é…ç½®ä¸­å¿ƒä¸­<br><a href="https://s2.loli.net/2024/12/20/RvCm6I5d9pjtSKu.png" title="image-20220412233717240" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/RvCm6I5d9pjtSKu.png" alt="image-20220412233717240"></a></p></li><li><p>åªéœ€è¦åœ¨ <code>bootstrap.yml</code> è¯´æ˜ åŠ è½½é…ç½®ä¸­å¿ƒä¸­çš„é‚£äº›é…ç½®æ–‡ä»¶å³å¯</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">appliation</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>coupon  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>      <span class="token key atrule">config</span><span class="token punctuation">:</span>        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> d6545d08<span class="token punctuation">-</span>333c<span class="token punctuation">-</span>4806<span class="token punctuation">-</span>bf43<span class="token punctuation">-</span>6acc99acecc6        <span class="token comment"># æ•°æ®åº“é…ç½®</span>        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.data<span class="token punctuation">-</span><span class="token key atrule">id</span><span class="token punctuation">:</span> datasource.yml        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.group<span class="token punctuation">:</span> dev        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.refresh<span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token comment"># mybatis é…ç½®</span>        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.data<span class="token punctuation">-</span><span class="token key atrule">id</span><span class="token punctuation">:</span> mybatis.yml        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.group<span class="token punctuation">:</span> dev        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.refresh<span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token comment"># å…¶ä»–é…ç½®</span>        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>.data<span class="token punctuation">-</span><span class="token key atrule">id</span><span class="token punctuation">:</span> other.yml        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>.group<span class="token punctuation">:</span> dev        ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>.refresh<span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://s2.loli.net/2024/12/20/MNUXrtH9vuDmEgZ.png" title="image-20220412233550198" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/MNUXrtH9vuDmEgZ.png" alt="image-20220412233550198"></a></p></li><li><p><code>@Value</code>ï¼Œ<code>@ConfigurationProperties</code>  ä»¥å‰<code>SpringBoot</code> ä»»ä½•æ–¹æ³•ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼Œéƒ½èƒ½ä½¿ç”¨</p></li><li><p>é…ç½®ä¸­å¿ƒæœ‰ä¼˜å…ˆä½¿ç”¨é…ç½®</p></li></ul></li></ol><h2 id="ç½‘å…³-GateWay"><a href="#ç½‘å…³-GateWay" class="headerlink" title="ç½‘å…³ GateWay"></a>ç½‘å…³ GateWay</h2><p> <a href="https://spring.io/projects/spring-cloud-gateway">SpringGateway å®˜æ–¹æ–‡æ¡£</a>    </p><p>â€‹    ç½‘å…³ä½œä¸ºæµé‡çš„å…¥å£ï¼Œå¸¸ç”¨åŠŸèƒ½åŒ…æ‹¬ <strong>è·¯ç”±è½¬å‘ã€æƒé™æ ¡éªŒã€é™æµæ§åˆ¶</strong>ç­‰ï¼Œè€Œ<code>SpringCloud Gateway</code><br>ä½œä¸º<code>SpringCloud</code>å®˜æ–¹æ¨å‡ºçš„ç¬¬äºŒä»£ç½‘å…³æ¡†æ¶ï¼Œå–ä»£äº†<code>Zuul</code>ç½‘å…³ã€‚</p><h3 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><p><code>Spring Cloud Gateway</code> çš„ç‰¹ç‚¹ï¼š</p><ul><li>åŸºäº<code>Spring Framework 5</code>ã€<code>Project Reactor</code>å’Œ<code>Spring Boot 2.0</code>æ„å»º</li><li>èƒ½å¤ŸåŒ¹é…ä»»ä½•è¯·æ±‚å±æ€§ä¸Šçš„è·¯ç”±ã€‚</li><li>è°“è¯å’Œç­›é€‰å™¨ç‰¹å®šäºè·¯ç”±ã€‚</li><li>æ–­è·¯å™¨é›†æˆã€‚</li><li>æ˜¥äº‘å‘ç°å®¢æˆ·ç«¯é›†æˆ</li><li>æ˜“äºç¼–å†™è°“è¯å’Œç­›é€‰å™¨</li><li>è¯·æ±‚é€Ÿç‡é™åˆ¶</li><li>è·¯å¾„é‡å†™</li></ul><p><a href="https://s2.loli.net/2024/12/20/zZOUHXPC5EI7yAT.png" title="image-20220415142458247" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/zZOUHXPC5EI7yAT.png" alt="image-20220415142458247"></a> </p><p><a href="https://s2.loli.net/2024/12/20/bigeJUwmpxR5NK7.png" title="image-20220415142513181" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/bigeJUwmpxR5NK7.png" alt="image-20220415142513181"></a> </p><p><a href="https://s2.loli.net/2024/12/20/eUG3JvshIdFityg.png" title="image-20220415143618115" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/eUG3JvshIdFityg.png" alt="image-20220415143618115"></a> </p><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><ul><li><p><code>Route</code>ï¼ˆè·¯ç”±ï¼‰ï¼šç½‘å…³çš„åŸºæœ¬æ„å»ºåŸºå—ã€‚å®ƒç”± <strong>IDã€ç›®æ ‡ URI</strong>ã€<strong>æ–­è¨€é›†åˆ</strong>å’Œ<strong>è¿‡æ»¤å™¨é›†åˆ</strong>å®šä¹‰ã€‚å¦‚æœ<strong>æ–­è¨€é›†åˆä¸º true</strong>ï¼Œåˆ™åŒ¹é…è·¯ç”±</p></li><li><p><code>Predicate</code>ï¼ˆæ–­è¨€ï¼‰ï¼šè¿™æ˜¯ä¸€ä¸ª <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html">Java 8 å‡½æ•°æ–­è¨€</a>ã€‚è¾“å…¥ç±»å‹æ˜¯<a href="https://docs.spring.io/spring/docs/5.0.x/javadoc-api/org/springframework/web/server/ServerWebExchange.html">Spring Framework <code>ServerWebExchange</code></a>ã€‚è¿™ä½¿æ‚¨å¯ä»¥åŒ¹é… HTTP è¯·æ±‚ä¸­çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚æ ‡å¤´æˆ–å‚æ•°ã€‚</p></li><li><p><code>Filter</code>ï¼ˆè¿‡æ»¤å™¨ï¼‰ï¼šè¿™äº›æ˜¯ä½¿ç”¨ç‰¹å®šå·¥å‚æ„å»ºçš„<a href="https://github.com/spring-cloud/spring-cloud-gateway/tree/2.2.x/spring-cloud-gateway-server/src/main/java/org/springframework/cloud/gateway/filter/GatewayFilter.java"><code>ç½‘å…³è¿‡æ»¤å™¨</code></a>å®ä¾‹ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥ä¿®æ”¹å‘é€ä¸‹æ¸¸è¯·æ±‚ä¹‹å‰æˆ–ä¹‹åçš„è¯·æ±‚å’Œå“åº”</p></li></ul><h3 id="å·¥ä½œåŸç†ï¼š"><a href="#å·¥ä½œåŸç†ï¼š" class="headerlink" title="å·¥ä½œåŸç†ï¼š"></a>å·¥ä½œåŸç†ï¼š</h3><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204151448583.png" title="Spring Cloud Gateway Diagram" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204151448583.png" alt="Spring Cloud Gateway Diagram"></a> </p><p>æ€»ç»“ï¼šå½“è¯·æ±‚åˆ°è¾¾ç½‘å…³ï¼Œç½‘å…³åˆ©ç”¨æ–­è¨€ï¼Œåˆ¤æ–­æ­¤æ¬¡è¯·æ±‚æ˜¯ä¸æ˜¯ç¬¦åˆæŸä¸ªè·¯ç”±è§„åˆ™ï¼Œå¦‚æœç¬¦åˆäº†å°±æŒ‰ç…§è·¯ç”±è§„åˆ™ï¼Œè·¯ç”±åˆ°æŒ‡å®šçš„åœ°æ–¹ã€‚å½“è¦å»æŒ‡å®šçš„åœ°æ–¹å°±è¦ç»è¿‡ä¸€ç³»åˆ—çš„<code>filter</code>è¿›è¡Œè¿‡æ»¤</p><h3 id="é…ç½®ç¤ºä¾‹"><a href="#é…ç½®ç¤ºä¾‹" class="headerlink" title="é…ç½®ç¤ºä¾‹"></a>é…ç½®ç¤ºä¾‹</h3><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#gateway-request-predicates-factories">è·¯ç”±æ–­è¨€å·¥å‚</a></p><h4 id="After-Route-Predicate-Factoryï¼šåè·¯ç”±æ–­è¨€å·¥å‚"><a href="#After-Route-Predicate-Factoryï¼šåè·¯ç”±æ–­è¨€å·¥å‚" class="headerlink" title="After Route Predicate Factoryï¼šåè·¯ç”±æ–­è¨€å·¥å‚"></a>After Route Predicate Factoryï¼šåè·¯ç”±æ–­è¨€å·¥å‚</h4><p>è·¯ç”±æ–­è¨€å·¥å‚é‡‡ç”¨ä¸€ä¸ªå‚æ•° aï¼ˆè¿™æ˜¯ä¸€ä¸ª javaï¼‰ã€‚æ­¤æ–­è¨€åŒ¹é…åœ¨æŒ‡å®šæ—¥æœŸæ—¶é—´ä¹‹åå‘ç”Ÿçš„è¯·æ±‚ã€‚ä»¥ä¸‹ç¤ºä¾‹é…ç½®è·¯ç”±ä¹‹åæ–­è¨€ï¼š</p><p>application.yml</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      <span class="token key atrule">routes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> after_route        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org        <span class="token comment"># æ–­è¨€ï¼ˆæ¡ä»¶ï¼‰ï¼šåˆ¤æ–­è¯·æ±‚æ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´åï¼ˆAfter)å‘ç”Ÿçš„</span>        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> After=2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>20T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#gatewayfilter-factories">ç½‘å…³è¿‡æ»¤å™¨å·¥å‚</a></p><h4 id="AddRequestHeader-GatewayFilter-Factoryï¼šæ·»åŠ è¯·æ±‚å¤´ç½‘å…³è¿‡æ»¤å™¨å·¥å‚"><a href="#AddRequestHeader-GatewayFilter-Factoryï¼šæ·»åŠ è¯·æ±‚å¤´ç½‘å…³è¿‡æ»¤å™¨å·¥å‚" class="headerlink" title="AddRequestHeader GatewayFilter Factoryï¼šæ·»åŠ è¯·æ±‚å¤´ç½‘å…³è¿‡æ»¤å™¨å·¥å‚"></a><code>AddRequestHeader GatewayFilter Factory</code>ï¼šæ·»åŠ è¯·æ±‚å¤´ç½‘å…³è¿‡æ»¤å™¨å·¥å‚</h4><p>æ·»åŠ  <code>application.yml</code>é…ç½®</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      <span class="token key atrule">routes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> add_request_header_route      <span class="token comment"># è¯·æ±‚æ²¡æœ‰æ–­è¨€ï¼Œä»»ä½•è¯·æ±‚ç›´æ¥è·³è½¬åˆ°è¿™ä¸ªé“¾æ¥</span>        <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org        <span class="token key atrule">filters</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> AddRequestHeader=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>red<span class="token punctuation">,</span> blue<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤åˆ—è¡¨å°†æ ‡å¤´æ·»åŠ åˆ°æ‰€æœ‰åŒ¹é…è¯·æ±‚çš„ä¸‹æ¸¸è¯·æ±‚å¤´ä¸­<code>X-Request-red:blue</code></p><p><strong>AddRequestHeader</strong> äº†è§£ç”¨äºåŒ¹é…è·¯å¾„æˆ–ä¸»æœºçš„ <code>URI</code> å˜é‡ã€‚<code>URI</code> å˜é‡å¯ä»¥åœ¨å€¼ä¸­ä½¿ç”¨ï¼Œå¹¶åœ¨è¿è¡Œæ—¶å±•å¼€ã€‚ä¸‹é¢çš„ç¤ºä¾‹é…ç½®ä½¿ç”¨å˜é‡çš„ ä¸€ä¸ªï¼š<code>AddRequestHeaderGatewayFilter</code></p><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#global-filters">å…¨å±€è¿‡æ»¤å™¨å·¥å‚</a></p><h3 id="åˆ›å»ºç½‘å…³"><a href="#åˆ›å»ºç½‘å…³" class="headerlink" title="åˆ›å»ºç½‘å…³"></a>åˆ›å»ºç½‘å…³</h3><ol><li><p>åˆ›å»ºæ–° <code>module gulimall-gateway</code></p></li><li><p>æ·»åŠ  <code>gateway</code> ä¾èµ–ï¼Œ<del>æ·»åŠ  gulimall-common ä¾èµ–</del>ï¼Œæ·»åŠ <code>nacos</code> é…ç½®ä¸­å¿ƒå’ŒæœåŠ¡ä¸­å¿ƒä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-boot.version</span><span class="token punctuation">></span></span>2.1.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-boot.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud.alibaba.version</span><span class="token punctuation">></span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud.alibaba.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud.version</span><span class="token punctuation">></span></span>Greenwich.SR3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--nacos æœåŠ¡æ³¨å†Œ/å‘ç°--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring-cloud.alibaba.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--naocs é…ç½®ä¸­å¿ƒ--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring-cloud.alibaba.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç»Ÿä¸€ <code>Spring bootã€Spring Cloud</code> ç‰ˆæœ¬</p><ul><li><code>bootï¼š2.1.8.RELEASE</code></li><li><code>cloudï¼šGreenwich.SR3</code> </li></ul></li><li><p>é¡¹ç›®æ–°å»º <code>bootstrap.yml</code> å¡«å†™ <code>nacos</code> é…ç½®ä¸­å¿ƒ </p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>    <span class="token key atrule">application</span><span class="token punctuation">:</span>        <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>gateway    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>        <span class="token key atrule">nacos</span><span class="token punctuation">:</span>            <span class="token key atrule">config</span><span class="token punctuation">:</span>                <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>                <span class="token key atrule">namespace</span><span class="token punctuation">:</span> 4b9add0d<span class="token punctuation">-</span>df21<span class="token punctuation">-</span>4fc6<span class="token punctuation">-</span>ad9c<span class="token punctuation">-</span>35936b491b10s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½®ä¸­å¿ƒ æ–°å»ºç½‘å…³é…ç½®å‘½åç©ºé—´</p><ul><li><p>æ–°å»ºå‘½åç©ºé—´ <code>gateway</code></p></li><li><p>æ–°å»ºé…ç½®æ–‡ä»¶ <code>gulimall-gateway.propertie</code> </p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">gulimall-gateway</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><a href="https://s2.loli.net/2024/12/20/Nc7w9mnxVKisTaZ.png" title="image-20220421225143278" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/Nc7w9mnxVKisTaZ.png" alt="image-20220421225143278"></a> </p></li></ul></li><li><p><code>application.properties</code> é…ç½®æœåŠ¡ä¸­å¿ƒ</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">88</span><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">gulimall-gateway</span><span class="token key attr-name">spring.cloud.nacos.discovery.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>å¯åŠ¨æˆåŠŸ<br><a href="https://s2.loli.net/2024/12/20/o2Bpxrjy1ZiQlFw.png" title="image-20220421230109723" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/o2Bpxrjy1ZiQlFw.png" alt="image-20220421230109723"></a></p></li><li><p>é…ç½®è·¯ç”±æ–­è¨€</p><p>æ–°å»ºä¸€ä¸ªapplication.yml</p><p><a href="https://s2.loli.net/2024/12/20/PAQhmYa7orKBps9.png" title="image-20220421230443693" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/PAQhmYa7orKBps9.png" alt="image-20220421230443693"></a></p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token key atrule">routes</span><span class="token punctuation">:</span>                <span class="token key atrule">-id</span><span class="token punctuation">:</span> bing_route                <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.bing.com                <span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token comment"># query è¡¨ç¤ºè¯·æ±‚å‚æ•° ï¼Œå‚æ•° url ï¼Œå‚æ•°å€¼æ­£åˆ™ baidu</span>                <span class="token punctuation">-</span>Query=url<span class="token punctuation">,</span>bing                 <span class="token key atrule">-id</span><span class="token punctuation">:</span> bing_route                <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.bing.com                <span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token comment"># query è¡¨ç¤ºè¯·æ±‚å‚æ•° ï¼Œå‚æ•° url ï¼Œå‚æ•°å€¼æ­£åˆ™ baidu</span>                <span class="token punctuation">-</span>Query=url<span class="token punctuation">,</span>bing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯·æ±‚è·¯å¾„ï¼š</p><ul><li><p><del>ç™¾åº¦åœ°å€ï¼š<a href="http://127.0.0.1:88/hello?url=baidu~~~~%EF%BC%8C%E6%97%A0%E6%B3%95%E8%B7%B3%E8%BD%AC%E5%88%B0%E7%99%BE%E5%BA%A6">http://127.0.0.1:88/hello?url=baidu~~~~ï¼Œæ— æ³•è·³è½¬åˆ°ç™¾åº¦</a></del></p></li><li><p>å¿…åº”åœ°å€ï¼š<a href="http://127.0.0.1:88/hello?url=bing">http://127.0.0.1:88/hello?url=bing</a></p></li><li><p>QQåœ°å€ï¼š<a href="http://127.0.0.1:88/hello?url=qq">http://127.0.0.1:88/hello?url=qq</a></p></li></ul></li></ol></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> è°·ç²’å•†åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è°·ç²’å•†åŸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°·ç²’å•†åŸï¼ˆä¸€ï¼‰| ç¯å¢ƒæ­å»º</title>
      <link href="/posts/57306.html"/>
      <url>/posts/57306.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Docker-å®‰è£…"><a href="#Docker-å®‰è£…" class="headerlink" title="Docker å®‰è£…"></a>Docker å®‰è£…</h1><h2 id="Docker-å®‰è£…MySQL"><a href="#Docker-å®‰è£…MySQL" class="headerlink" title="Docker å®‰è£…MySQL"></a>Docker å®‰è£…MySQL</h2><ol><li><p>ä¸‹è½½é•œåƒ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker pull mysql:5.7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åˆ›å»ºå®ä¾‹</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker run -p 3307:3306 --name mysql \-v &#x2F;mydata&#x2F;mysql&#x2F;log:&#x2F;var&#x2F;log&#x2F;mysql \-v &#x2F;mydata&#x2F;mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql \-v &#x2F;mydata&#x2F;mysql&#x2F;conf:&#x2F;etc&#x2F;mysql \-e MYSQL_ROOT_PASSWORD&#x3D;root \-d mysql:5.7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li>-p 3306:3306ï¼š-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ï¼Œå°†å®¹å™¨çš„3306ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„3306ç«¯å£</li><li>-v /mydata/mysql/conf:/etc/mysqlï¼šå°†é…ç½®æ–‡ä»¶å¤¹æŒ‚è½½åˆ°ä¸»æœº</li><li>-v /mydata/mysql/log:/var/log/mysqlï¼šå°†æ—¥å¿—æ–‡ä»¶å¤¹æŒ‚è½½åˆ°ä¸»æœº</li><li>-v /mydata/mysql/data:/var/lib/mysqlï¼šå°†é…ç½®æ–‡ä»¶å¤¹æŒ‚è½½åˆ°ä¸»æœº</li><li>-e MYSQL_ROOT_PASSWORD=rootï¼šåˆå§‹åŒ–rootç”¨æˆ·å¯†ç </li><li>-d mysql:5.7ï¼šè¡¨ç¤ºåå°è¿è¡Œ(-d) é•œåƒmysql:5.7   â€“&gt;æŸ¥çœ‹é•œåƒdocekr images</li></ul></li><li><p>è¿›å»docker å®¹å™¨</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">root@af26dd647c9a:&#x2F;# docker exec -it mysql &#x2F;bin&#x2F;bashroot@af26dd647c9a:&#x2F;# whereis mysqlmysql: &#x2F;usr&#x2F;bin&#x2F;mysql &#x2F;usr&#x2F;lib&#x2F;mysql &#x2F;etc&#x2F;mysql &#x2F;usr&#x2F;share&#x2F;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>mysqlé…ç½® my.cnf</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@lingzx conf]# vi &#x2F;mydata&#x2F;mysql&#x2F;conf&#x2F;my.cnf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[client]default-character-set&#x3D;utf8[mysql]default-character-set&#x3D;utf8[mysqld]init_connect&#x3D;&#39;SET collation_connection&#x3D;utf8_unicode_ci&#39;init_connect&#x3D;&#39;SET NAMES utf8&#39;character-set-server&#x3D;utf8collation-server&#x3D;utf8_unicode_ciskip-character-set-client-handshakeskip-name-resolvelower_case_table_names&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æŸ¥çœ‹dockerä¸­MySQLçš„é…ç½®</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cd &#x2F;etc&#x2F;mysqlcat my.cnf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>å¼€æœºè‡ªå¯</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker update mysql --restart&#x3D;always<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><h2 id="Docker-å®‰è£…Redis"><a href="#Docker-å®‰è£…Redis" class="headerlink" title="Docker å®‰è£…Redis"></a>Docker å®‰è£…Redis</h2><ol><li><p>ä¸‹è½½redis é•œåƒ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker pull redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åˆ›å»ºå®ä¾‹å¹¶å¯åŠ¨</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># ç”±äº rediså®¹å™¨ &#x2F;etc&#x2F;redisç›®å½•ä¸‹æ²¡æœ‰ redis.conf ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬é¢„å…ˆåœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ª redis.confmkdir -p &#x2F;mydata&#x2F;redis&#x2F;conftouch &#x2F;mydata&#x2F;redis&#x2F;conf&#x2F;redis.confdocker run -p 6379:6379 --name redis \-v &#x2F;mydata&#x2F;redis&#x2F;data:&#x2F;data \-v &#x2F;mydata&#x2F;redis&#x2F;conf&#x2F;redis.conf:&#x2F;etc&#x2F;redis&#x2F;redis.conf \-d redis redis-server &#x2F;etc&#x2F;redis&#x2F;redis.conf# è¿æ¥ dockerä¸­çš„ redisçš„æ§åˆ¶å°docker exec -it redis redis-cli<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½®æŒä¹…åŒ–</p><blockquote><p>å½“å‰ç‰ˆæœ¬çš„redisé»˜è®¤é…ç½®äº†ã€æ–‡ä»¶è¿½åŠ å†™æŒä¹…åŒ–ã€‘aof</p></blockquote><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">vi &#x2F;mydata&#x2F;redis&#x2F;redis.confappendonly yesdocker restart redis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¼€æœºè‡ªå¯</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker update redis --restart&#x3D;always<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><h1 id="ç»Ÿä¸€ç¯å¢ƒ"><a href="#ç»Ÿä¸€ç¯å¢ƒ" class="headerlink" title="ç»Ÿä¸€ç¯å¢ƒ"></a>ç»Ÿä¸€ç¯å¢ƒ</h1><h2 id="Maven-3-6-1"><a href="#Maven-3-6-1" class="headerlink" title="Maven 3.6.1"></a>Maven 3.6.1</h2><blockquote><p>é“¾æ¥: <a href="https://pan.baidu.com/s/1Jd5EAXADSEFop2QT8sxzBA">https://pan.baidu.com/s/1Jd5EAXADSEFop2QT8sxzBA</a> æå–ç : 38iw å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><p>é…ç½®é˜¿é‡Œäº‘é•œåƒ</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus-aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">></span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Nexus aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://maven.aliyun.com/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½® JDK 1.8 ç¼–è¯‘ç¯å¢ƒ</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>jdk-1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compile.source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compile.source</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compile.target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compile.target</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compile.compilerVersion</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compile.compilerVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®æœ¬åœ°ä»“åº“</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localRepository</span><span class="token punctuation">></span></span>D:\Program Files\Maven\LocalWareHouse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localRepository</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="IDEA-å®‰è£…æ’ä»¶"><a href="#IDEA-å®‰è£…æ’ä»¶" class="headerlink" title="IDEA å®‰è£…æ’ä»¶"></a>IDEA å®‰è£…æ’ä»¶</h2><ul><li><code>lombok</code></li><li><code>MybatisX</code></li></ul><h2 id="Vscode-å®‰è£…é…ç½®"><a href="#Vscode-å®‰è£…é…ç½®" class="headerlink" title="Vscode å®‰è£…é…ç½®"></a>Vscode å®‰è£…é…ç½®</h2><ul><li><code>Auto Close Tag</code></li><li><code>Auto Rename Tag</code></li><li><code>Chinese (Simplified)</code></li><li><code>ESLint</code></li><li><code>HTML CSS Support</code></li><li><code>HTML Snippets</code></li><li><code>JavaScriptï¼ˆES6ï¼‰</code></li><li><code>Live Server</code></li><li><code>open in browser</code></li><li><code>Vetur</code></li></ul><h2 id="å®‰è£…é…ç½®-Git"><a href="#å®‰è£…é…ç½®-Git" class="headerlink" title="å®‰è£…é…ç½® Git"></a>å®‰è£…é…ç½® Git</h2><ol><li><p>ä¸‹è½½ <code>git</code>ï¼š<a href="https://git-scm.com/">https://git-scm.com</a></p></li><li><p>é…ç½® <code>git</code> ï¼Œè¿›å…¥<code>git bash</code></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># é…ç½®ç”¨æˆ·ågit config --global user.name &#39;username&#39;# é…ç½®é‚®ç®±git config --global user.email &#39;username@email.com&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½® <code>shh</code> å…å¯†ç™»å½•ï¼Œè¿›å…¥<code>git bash</code></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh-keygen -t rsa -C &#39;xx@xxx.com&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> ä¸‰æ¬¡å›è½¦ï¼ŒæŸ¥æ‰¾ <code>id_rsa</code> å’Œ <code>id_rsa.pub</code></p></li><li><p>ç™»å½• <code>gitee</code>ï¼Œåœ¨è®¾ç½®é‡Œé¢æ‰¾åˆ° <code>SSH KEY</code> å°† <code>.pub</code> æ–‡ä»¶çš„å†…å®¹ç²˜è´´è¿›å»</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># æŸ¥çœ‹æ˜¯å¦æˆåŠŸssh -T git@gitee.com <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><h1 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h1><ol><li><p>å•†å“æœåŠ¡ã€ä»“å‚¨æœåŠ¡ã€è®¢å•æœåŠ¡ã€ä¼˜æƒ åˆ¸æœåŠ¡ã€ç”¨æˆ·æœåŠ¡</p><p>å…±ç”¨ï¼š</p><ol><li><code>web ã€openfeign</code></li><li>æ¯ä¸ªæœåŠ¡ï¼ŒåŒ…å <strong>com.atguigu.gulimall</strong>.xxx(<code>product/order/ware/coupon/member</code>)</li><li>æ¨¡å—åï¼š<code>gulimall-coupon</code></li></ol></li><li><p>æ·»åŠ <code>pom</code>æ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.atguigu.gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>èšåˆæœåŠ¡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>gulimall-coupon<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>gulimall-member<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>gulimall-order<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>gulimall-product<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>gulimall-ware<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è®¾ç½®å¿½ç•¥æäº¤å†…å®¹ <code>.gitgnore</code></p><pre class="line-numbers language-.gitgnore" data-language=".gitgnore"><code class="language-.gitgnore">**&#x2F;mvnw**&#x2F;mvnw.cmd**&#x2F;.mvn**&#x2F;target&#x2F;.idea**&#x2F;.gitignore<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://s2.loli.net/2024/12/20/CqEJajDhoykvR7X.png" title="image-20220323234601504" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/CqEJajDhoykvR7X.png" alt="image-20220323234601504"></a> </p></li><li><p>æäº¤å¹¶æ¨é€åˆ°ä»“åº“</p></li></ol><h2 id="æ•°æ®åº“è®¾è®¡-PowerDesigner"><a href="#æ•°æ®åº“è®¾è®¡-PowerDesigner" class="headerlink" title="æ•°æ®åº“è®¾è®¡ PowerDesigner"></a>æ•°æ®åº“è®¾è®¡ PowerDesigner</h2><ol><li><p><a href="https://s2.loli.net/2024/12/20/Xp6OcxDIhiGKJSq.png" title="image-20220324004223247" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/Xp6OcxDIhiGKJSq.png" alt="image-20220324004223247"></a> </p></li><li><p><a href="https://s2.loli.net/2024/12/20/tfe6YIMug8EbpwZ.png" title="image-20220324004234654" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/tfe6YIMug8EbpwZ.png" alt="image-20220324004234654"></a> </p></li><li><p>æ¯ä¸ªå¾®æœåŠ¡åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“</p></li></ol><h2 id="äººäººå¼€æºå¿«é€Ÿå¼€å‘"><a href="#äººäººå¼€æºå¿«é€Ÿå¼€å‘" class="headerlink" title="äººäººå¼€æºå¿«é€Ÿå¼€å‘"></a>äººäººå¼€æºå¿«é€Ÿå¼€å‘</h2><h3 id="åç«¯ç®¡ç†-renren-fast"><a href="#åç«¯ç®¡ç†-renren-fast" class="headerlink" title="åç«¯ç®¡ç† renren-fast"></a>åç«¯ç®¡ç† renren-fast</h3><ol><li><p>å…‹éš†é¡¹ç›®</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git clone git@gitee.com:renrenio&#x2F;renren-fast.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å°†<code>renren-fast</code> æ”¾åœ¨<code>gulimall</code>é¡¹ç›®<code>pom</code>ä¸­ <code>module</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>renren-fast<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æ–°å¢æ•°æ®åº“ <code>gulimall_admin</code></p></li><li><p>ä¿®æ”¹<code>pom</code></p><ol><li><p>å…³è”<code>gulimall</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è§£å†³<code>@NotBlank</code> å’Œ <code>@Email</code> æŠ¥é”™</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ol></li><li><p>ä¿®æ”¹æ•°æ®åº“é…ç½®ï¼Œè¿æ¥åˆ° <code>gulimall_admin</code> çš„é…ç½®ä¿¡æ¯</p></li></ol><h3 id="å‰ç«¯ç®¡ç†-renren-fast-vue"><a href="#å‰ç«¯ç®¡ç†-renren-fast-vue" class="headerlink" title="å‰ç«¯ç®¡ç† renren-fast-vue"></a>å‰ç«¯ç®¡ç† renren-fast-vue</h3><ol><li><p>å…‹éš†é¡¹ç›®</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git clone git@gitee.com:renrenio&#x2F;renren-fast-vue.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å°†é¡¹ç›®æ‹–åˆ°<code>VSCode</code>ä¸­</p></li><li><p>ç»Ÿä¸€é…ç½®</p><ol><li><p><code>nodeJs</code>ï¼Œ</p><blockquote><p>node ç‰ˆæœ¬ 14 å¯ä»¥è§£å†³æ‰€æœ‰çš„æŠ¥é”™</p><p>å…³æ³¨ node.js çš„ npm åŠŸèƒ½</p><p>NPM æ˜¯NodeJSçš„åŒ…ç®¡ç†å·¥å…·ï¼ŒJS-NPMï¼ŒJava-Maven</p></blockquote><ul><li><p>å®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œ<code>node -v</code> æ£€æŸ¥ç‰ˆæœ¬</p></li><li><p>é…ç½®npm æ·˜å®é•œåƒ</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">npm config set registry http:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä¸‹è½½ä¾èµ–åŒ…</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">npm install<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æŠ¥é”™å¤„ç†</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">npm install --save  -g core-js@^3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><code>node-sass</code>æŠ¥é”™ æ˜¯ç”±äºç‰ˆæœ¬çš„é—®é¢˜ï¼Œåœ¨<code>package.json</code>ä¸­å¯ä»¥è§£å†³</p></li></ul></li><li><p>Vue</p></li></ol></li></ol><h3 id="ä»£ç ç”Ÿæˆ-renren-generator"><a href="#ä»£ç ç”Ÿæˆ-renren-generator" class="headerlink" title="ä»£ç ç”Ÿæˆ renren-generator"></a>ä»£ç ç”Ÿæˆ renren-generator</h3><ol><li><p>å…‹éš†é¡¹ç›®</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">git clone git@gitee.com:renrenio&#x2F;renren-generator.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å°†é¡¹ç›®æ‹–åˆ° <code>idea</code> ä¸­</p></li><li><p>ä¿®æ”¹é…ç½®ï¼ˆä»¥ <code>product</code> æ¨¡å—ä¸ºä¾‹å­ï¼‰</p><ul><li><p>ä¿®æ”¹ <code>generator.properties</code></p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#ä»£ç ç”Ÿæˆå™¨ï¼Œé…ç½®ä¿¡æ¯</span><span class="token key attr-name">mainPath</span><span class="token punctuation">=</span><span class="token value attr-value">com.atguigu</span><span class="token comment">#åŒ…å</span><span class="token key attr-name">package</span><span class="token punctuation">=</span><span class="token value attr-value">com.atguigu.gulimall</span><span class="token key attr-name">moduleName</span><span class="token punctuation">=</span><span class="token value attr-value">product</span><span class="token comment">#ä½œè€…</span><span class="token key attr-name">author</span><span class="token punctuation">=</span><span class="token value attr-value">Mr.Ling</span><span class="token comment">#Email</span><span class="token key attr-name">email</span><span class="token punctuation">=</span><span class="token value attr-value">lingzhexi@163.com</span><span class="token comment">#è¡¨å‰ç¼€(ç±»åä¸ä¼šåŒ…å«è¡¨å‰ç¼€)</span><span class="token key attr-name">tablePrefix</span><span class="token punctuation">=</span><span class="token value attr-value">pms_</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¿®æ”¹ <code>Controller.java.vm</code> æ¨¡æ¿</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">æ³¨é‡Š <span class="token annotation punctuation">@RequeiresPermissions</span> æ³¨è§£<span class="token comment">//@RequiresPermissions("$&#123;moduleName&#125;:$&#123;pathName&#125;:list")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>ä¿®æ”¹æ•°æ®åº“é…ç½®( <code>pms</code> )</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource    <span class="token comment">#MySQLé…ç½®</span>    <span class="token key atrule">driverClassName</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>13306/gulimall_pms<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span>    <span class="token key atrule">username</span><span class="token punctuation">:</span> root    <span class="token key atrule">password</span><span class="token punctuation">:</span> root<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ol start="4"><li>å¯åŠ¨é¡¹ç›®ï¼Œç”Ÿæˆä»£ç </li></ol><ul><li><p>ç‚¹å‡»ç”Ÿæˆä»£ç </p><p><a href="https://s2.loli.net/2024/12/20/d24fsNH6nGO8XmM.png" title="image-20220407215910844" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/d24fsNH6nGO8XmM.png" alt="image-20220407215910844"></a></p></li><li><p>å°†ä»£ç æ”¾åˆ° <code>product</code> æ¨¡å—ä¸­</p></li></ul></li></ol><h3 id="æ–°å¢-gulimall-common"><a href="#æ–°å¢-gulimall-common" class="headerlink" title="æ–°å¢ gulimall-common"></a>æ–°å¢ gulimall-common</h3><ul><li><p>é€šç”¨çš„ä¾èµ–æ¨¡å— ï¼Œproduct æ¨¡å—å¼•ç”¨è¯¥æ¨¡å—</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.18.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.httpcomponents<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>httpcore<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.4.14<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.7.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="æ•´åˆMybatis-pus"><a href="#æ•´åˆMybatis-pus" class="headerlink" title="æ•´åˆMybatis-pus"></a>æ•´åˆMybatis-pus</h2><ol><li><p>å¯¼å…¥ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½®</p><ol><li><p>é…ç½®æ•°æ®æº</p><ol><li><p>å¯¼å…¥<code>MySql</code> é©±åŠ¨</p><p>æ¨èä½¿ç”¨ <code>8</code> ç‰ˆæœ¬çš„<code>Mysql connector</code></p><p><a href="https://s2.loli.net/2024/12/20/suOzDAlFX14evnx.png" title="image-20220410002401508" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/suOzDAlFX14evnx.png" alt="image-20220410002401508"></a></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>8.0.28<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ•´åˆ <code>application.yml</code></p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span>    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span><span class="token key atrule">spring</span><span class="token punctuation">:</span>    <span class="token key atrule">application</span><span class="token punctuation">:</span>        <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>product    <span class="token key atrule">datasource</span><span class="token punctuation">:</span>        <span class="token key atrule">username</span><span class="token punctuation">:</span> root        <span class="token key atrule">password</span><span class="token punctuation">:</span> root        <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>13306/gulimall_pms        <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol></li><li><p>é…ç½® <code>mybaits-plus</code></p><ol><li><p>ä¸»å¯åŠ¨é…ç½® <code>@MapperScan(&quot;com.atguigu.gulimall.product.dao&quot;)</code></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204100043736.png" title="image-20220410004352680" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202204100043736.png" alt="image-20220410004352680"></a> </p></li><li><p>å‘Šè¯‰ <code>MyBatis-Plus ï¼Œ sql</code> æ˜ å°„æ–‡ä»¶ä½ç½®</p><p>é»˜è®¤ä½ç½®ç±»è·¯å¾„ä¸‹çš„ <code>classpath*:/mapper/**/*.xml</code></p><p><a href="https://s2.loli.net/2024/12/20/GJwsycKh9eI4krq.png" title="image-20220410004908204" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/GJwsycKh9eI4krq.png" alt="image-20220410004908204"></a> </p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span><span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>/mapper/<span class="token important">**/*.xml</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>è®¾ç½®ä¸»é”®è‡ªå¢é…ç½®</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment"># å¡«å†™ id è‡ªåŠ¨è”æƒ³å‡ºæ¥</span><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span>  <span class="token key atrule">global-config</span><span class="token punctuation">:</span>        <span class="token key atrule">db-config</span><span class="token punctuation">:</span>            <span class="token key atrule">id-type</span><span class="token punctuation">:</span> auto<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol></li></ol><p>â€‹    <strong>å„æ¨¡å—æœ€ç»ˆéœ€è¦ä¾èµ–åˆ° gulimall-common</strong> </p></li></ol></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> è°·ç²’å•†åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è°·ç²’å•†åŸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªå®šä¹‰æ³¨è§£åœºæ™¯ä½¿ç”¨</title>
      <link href="/posts/45688.html"/>
      <url>/posts/45688.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h1><blockquote><p>ä½¿ç”¨åœºæ™¯</p><ul><li><p>ç™»å½•æ ¡éªŒ</p></li><li><p>AOPæ—¥å¿—æ‰“å°</p><p>é¡¹ç›®ç¤ºä¾‹ï¼š<a href="https://gitee.com/lingzhexi/customer-annotation-demo">https://gitee.com/lingzhexi/customer-annotation-demo</a></p></li></ul></blockquote><p><code>Java</code> è‡ªå®šä¹‰æ³¨è§£ä¸€èˆ¬ä½¿ç”¨åœºæ™¯ä¸ºï¼šã€<strong>è‡ªå®šä¹‰æ³¨è§£ + æ‹¦æˆªå™¨æˆ–è€… AOP</strong>ã€‘</p><h2 id="ä¸€-ä»€ä¹ˆæ˜¯æ³¨è§£-Annotation"><a href="#ä¸€-ä»€ä¹ˆæ˜¯æ³¨è§£-Annotation" class="headerlink" title="ä¸€. ä»€ä¹ˆæ˜¯æ³¨è§£ (Annotation)"></a>ä¸€. ä»€ä¹ˆæ˜¯æ³¨è§£ (<code>Annotation</code>)</h2><p>Java æ³¨è§£æ˜¯ä»€ä¹ˆï¼Œä»¥ä¸‹æ˜¯å¼•ç”¨è‡ªç»´åŸºç™¾ç§‘çš„å†…å®¹</p><blockquote><p>Java æ³¨è§£åˆç§° <code>Java</code> æ ‡æ³¨ï¼Œæ˜¯ <code>JDK5.0</code> ç‰ˆæœ¬å¼€å§‹æ”¯æŒåŠ å…¥æºä»£ç çš„ç‰¹æ®Šè¯­æ³•å…ƒæ•°æ®ã€‚</p><p>Java è¯­è¨€ä¸­çš„ç±»ã€æ–¹æ³•ã€å˜é‡ã€å‚æ•°å’ŒåŒ…ç­‰éƒ½å¯ä»¥è¢«æ ‡æ³¨ã€‚å’Œ <code>Javadoc</code> ä¸åŒï¼ŒJava æ ‡æ³¨å¯ä»¥é€šè¿‡åå°„è·å–æ ‡æ³¨å†…å®¹ã€‚</p><p>åœ¨ç¼–è¯‘å™¨ç”Ÿæˆç±»æ–‡ä»¶æ—¶ï¼Œæ ‡æ³¨å¯ä»¥è¢«åµŒå…¥åˆ°å­—èŠ‚ç ä¸­ã€‚<code>Java</code> è™šæ‹Ÿæœºå¯ä»¥ä¿ç•™æ ‡æ³¨å†…å®¹ï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥è·å–åˆ°æ ‡æ³¨å†…å®¹ã€‚ å½“ç„¶å®ƒä¹Ÿæ”¯æŒè‡ªå®šä¹‰ Java æ ‡æ³¨ã€‚</p></blockquote><h2 id="äºŒ-æ³¨è§£ä½“ç³»å›¾"><a href="#äºŒ-æ³¨è§£ä½“ç³»å›¾" class="headerlink" title="äºŒ. æ³¨è§£ä½“ç³»å›¾"></a>äºŒ. æ³¨è§£ä½“ç³»å›¾</h2><p>å…ƒæ³¨è§£ï¼š<code>java.lang.annotation</code>ä¸­æä¾›äº†å…ƒæ³¨è§£ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›æ³¨è§£æ¥å®šä¹‰è‡ªå·±çš„æ³¨è§£ã€‚ä¸»è¦ä½¿ç”¨çš„æ˜¯ <code>Target</code> å’Œ Retention æ³¨è§£</p><p><a href="https://s2.loli.net/2024/12/20/v4AxIa6kPe9VwXn.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/v4AxIa6kPe9VwXn.png"></a></p><p>æ³¨è§£å¤„ç†ç±»ï¼šæ—¢ç„¶ä¸Šé¢å®šä¹‰äº†æ³¨è§£ï¼Œé‚£å¾—æœ‰åŠæ³•æ‹¿åˆ°æˆ‘ä»¬å®šä¹‰çš„æ³¨è§£å•Šã€‚</p><p><code>java.lang.reflect.AnnotationElement</code></p><p>æ¥å£åˆ™æä¾›äº†è¯¥åŠŸèƒ½ã€‚æ³¨è§£çš„å¤„ç†æ˜¯é€šè¿‡ java åå°„æ¥å¤„ç†çš„ã€‚å¦‚ä¸‹ï¼Œåå°„ç›¸å…³çš„ç±» <code>Class, Method, Field</code> éƒ½å®ç°äº† <code>AnnotationElement</code> æ¥å£ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/wIVapLrX2s64hUk.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/wIVapLrX2s64hUk.png"></a> åå°„å¤„ç†</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203041436928.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203041436928.png"></a> AnnotationElement æ¥å£æ–¹æ³•</p><p>å› æ­¤ï¼Œåªè¦æˆ‘ä»¬é€šè¿‡åå°„æ‹¿åˆ° <code>Class, Method, Field</code> ç±»ï¼Œå°±èƒ½å¤Ÿé€šè¿‡ <code>getAnnotation</code>(Class<T>) æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„æ³¨è§£å¹¶å–å€¼ã€‚</p><h2 id="ä¸‰-å¸¸ç”¨å…ƒæ³¨è§£"><a href="#ä¸‰-å¸¸ç”¨å…ƒæ³¨è§£" class="headerlink" title="ä¸‰. å¸¸ç”¨å…ƒæ³¨è§£"></a>ä¸‰. å¸¸ç”¨å…ƒæ³¨è§£</h2><p><strong>Target</strong>ï¼šæè¿°äº†æ³¨è§£ä¿®é¥°çš„å¯¹è±¡èŒƒå›´ï¼Œå–å€¼åœ¨<code>java.lang.annotation.ElementType</code>å®šä¹‰ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬ï¼š</p><ul><li><code>METHOD</code>ï¼šç”¨äºæè¿°æ–¹æ³•</li><li><code>PACKAGE</code>ï¼šç”¨äºæè¿°åŒ…</li><li><code>PARAMETER</code>ï¼šç”¨äºæè¿°æ–¹æ³•å˜é‡</li><li><code>TYPE</code>ï¼šç”¨äºæè¿°ç±»ã€æ¥å£æˆ– <code>enum</code> ç±»å‹</li></ul><p><strong><code>Retention</code></strong>: è¡¨ç¤ºæ³¨è§£ä¿ç•™æ—¶é—´é•¿çŸ­ã€‚å–å€¼åœ¨<code>java.lang.annotation.RetentionPolicy</code>ä¸­ï¼Œå–å€¼ä¸ºï¼š</p><ul><li><code>SOURCE</code>ï¼šåœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šè¢«å¿½ç•¥</li><li><code>CLASS</code>ï¼šéšæºæ–‡ä»¶ä¸€èµ·ç¼–è¯‘åœ¨ class æ–‡ä»¶ä¸­ï¼Œè¿è¡Œæ—¶å¿½ç•¥</li><li><code>RUNTIME</code>ï¼šåœ¨è¿è¡Œæ—¶æœ‰æ•ˆ</li></ul><p>åªæœ‰å®šä¹‰ä¸º<code>RetentionPolicy.RUNTIME</code>æ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½é€šè¿‡æ³¨è§£åå°„è·å–åˆ°æ³¨è§£ã€‚<br>æ‰€ä»¥ï¼Œå‡è®¾æˆ‘ä»¬è¦è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Œå®ƒç”¨åœ¨å­—æ®µä¸Šï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åå°„è·å–åˆ°ï¼ŒåŠŸèƒ½æ˜¯ç”¨æ¥æè¿°å­—æ®µçš„é•¿åº¦å’Œä½œç”¨ã€‚å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼Œ<a href="https://gitee.com/lingzhexi/annotation">ä»£ç è§</a></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">)</span>  <span class="token comment">//  æ³¨è§£ç”¨äºå­—æ®µä¸Š</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  <span class="token comment">// ä¿ç•™åˆ°è¿è¡Œæ—¶ï¼Œå¯é€šè¿‡æ³¨è§£è·å–</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">MyField</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å››-ç¤ºä¾‹-åå°„è·å–æ³¨è§£"><a href="#å››-ç¤ºä¾‹-åå°„è·å–æ³¨è§£" class="headerlink" title="å››. ç¤ºä¾‹ - åå°„è·å–æ³¨è§£"></a>å››. ç¤ºä¾‹ - åå°„è·å–æ³¨è§£</h2><p>å…ˆå®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">MyField</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡åå°„è·å–æ³¨è§£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFieldTest</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£</span>    <span class="token annotation punctuation">@MyField</span><span class="token punctuation">(</span>description <span class="token operator">=</span> <span class="token string">"ç”¨æˆ·å"</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testMyField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// è·å–ç±»æ¨¡æ¿</span>        <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">MyFieldTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        <span class="token comment">// è·å–æ‰€æœ‰å­—æ®µ</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Field</span> f <span class="token operator">:</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// åˆ¤æ–­è¿™ä¸ªå­—æ®µæ˜¯å¦æœ‰MyFieldæ³¨è§£</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">MyField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">MyField</span> annotation <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">MyField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­—æ®µ:["</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"], æè¿°:["</span> <span class="token operator">+</span> annotation<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"], é•¿åº¦:["</span> <span class="token operator">+</span> annotation<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœ</p><p><a href="https://s2.loli.net/2024/12/20/ifB8PyVIlQnwEkJ.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ifB8PyVIlQnwEkJ.png"></a></p><h2 id="åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£-æ‹¦æˆªå™¨-å®ç°ç™»å½•æ ¡éªŒ"><a href="#åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£-æ‹¦æˆªå™¨-å®ç°ç™»å½•æ ¡éªŒ" class="headerlink" title="åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£ + æ‹¦æˆªå™¨ å®ç°ç™»å½•æ ¡éªŒ"></a>åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£ + æ‹¦æˆªå™¨ å®ç°ç™»å½•æ ¡éªŒ</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ springboot æ‹¦æˆªå™¨å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼Œå¦‚æœæ–¹æ³•ä¸ŠåŠ äº† @LoginRequiredï¼Œåˆ™æç¤ºç”¨æˆ·è¯¥æ¥å£éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼Œå¦åˆ™ä¸éœ€è¦ç™»å½•ã€‚<br>é¦–å…ˆå®šä¹‰ä¸€ä¸ª LoginRequired æ³¨è§£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">LoginRequired</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå†™ä¸¤ä¸ªç®€å•çš„æ¥å£ï¼Œè®¿é—® sourceAï¼ŒsourceB èµ„æº</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sourceA"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sourceA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"ä½ æ­£åœ¨è®¿é—®sourceAèµ„æº"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sourceB"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sourceB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"ä½ æ­£åœ¨è®¿é—®sourceBèµ„æº"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æ·»åŠ æ‹¦æˆªå™¨ä¹‹å‰æˆåŠŸè®¿é—®</p><p><a href="https://s2.loli.net/2024/12/20/1GzmKLSO2u9vP57.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/1GzmKLSO2u9vP57.png"></a> sourceB</p><p>å®ç° spring çš„ HandlerInterceptor ç±»å…ˆå®ç°æ‹¦æˆªå™¨ï¼Œä½†ä¸æ‹¦æˆªï¼Œåªæ˜¯ç®€å•æ‰“å°æ—¥å¿—ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SourceAccessInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿›å…¥æ‹¦æˆªå™¨äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç° <code>spring</code> ç±» <code>WebMvcConfigurer</code>ï¼Œåˆ›å»ºé…ç½®ç±»æŠŠæ‹¦æˆªå™¨æ·»åŠ åˆ°æ‹¦æˆªå™¨é“¾ä¸­</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InterceptorTrainConfigurer</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SourceAccessInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¦æˆªæˆåŠŸå¦‚ä¸‹</p><p><a href="https://s2.loli.net/2024/12/20/tb1C4yhFBRLfnXg.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/tb1C4yhFBRLfnXg.png"></a> æ‹¦æˆªäº†</p><p>åœ¨ sourceB æ–¹æ³•ä¸Šæ·»åŠ æˆ‘ä»¬çš„ç™»å½•æ³¨è§£ @LoginRequired</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sourceA"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sourceA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"ä½ æ­£åœ¨è®¿é—®sourceAèµ„æº"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@LoginRequired</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sourceB"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sourceB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"ä½ æ­£åœ¨è®¿é—®sourceBèµ„æº"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç®€å•å®ç°ç™»å½•æ‹¦æˆªé€»è¾‘</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿›å…¥æ‹¦æˆªå™¨äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// åå°„è·å–æ–¹æ³•ä¸Šçš„LoginRequredæ³¨è§£</span>        <span class="token class-name">HandlerMethod</span> handlerMethod <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HandlerMethod</span><span class="token punctuation">)</span>handler<span class="token punctuation">;</span>        <span class="token class-name">LoginRequired</span> loginRequired <span class="token operator">=</span> handlerMethod<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">LoginRequired</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>loginRequired <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æœ‰LoginRequiredæ³¨è§£è¯´æ˜éœ€è¦ç™»å½•ï¼Œæç¤ºç”¨æˆ·ç™»å½•</span>        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ä½ è®¿é—®çš„èµ„æºéœ€è¦ç™»å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡ŒæˆåŠŸï¼Œè®¿é—® sourceB æ—¶éœ€è¦ç™»å½•äº†ï¼Œè®¿é—® sourceA åˆ™ä¸ç”¨ç™»å½•</p><p><a href="https://s2.loli.net/2024/12/20/gY2ASF4Xbjc8iMN.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/gY2ASF4Xbjc8iMN.png"></a></p><p><a href="https://s2.loli.net/2024/12/20/D4V52oAO8xz9grt.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/D4V52oAO8xz9grt.png"></a></p><h2 id="åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£-AOP-å®ç°æ—¥å¿—æ‰“å°"><a href="#åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£-AOP-å®ç°æ—¥å¿—æ‰“å°" class="headerlink" title="åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£ + AOP å®ç°æ—¥å¿—æ‰“å°"></a>åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£ + AOP å®ç°æ—¥å¿—æ‰“å°</h2><p>å…ˆå¯¼å…¥åˆ‡é¢éœ€è¦çš„ä¾èµ–åŒ…</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å®šä¹‰ä¸€ä¸ªæ³¨è§£ @MyLog</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">MyLog</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±»ï¼Œè§å¦‚ä¸‹ä»£ç æ³¨é‡Šç†è§£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Aspect</span> <span class="token comment">// 1.è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLogAspect</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 2. PointCutè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåˆ‡ç‚¹ï¼Œ@annotationè¡¨ç¤ºè¿™ä¸ªåˆ‡ç‚¹åˆ‡åˆ°ä¸€ä¸ªæ³¨è§£ä¸Šï¼Œåé¢å¸¦è¯¥æ³¨è§£çš„å…¨ç±»å</span>    <span class="token comment">// åˆ‡é¢æœ€ä¸»è¦çš„å°±æ˜¯åˆ‡ç‚¹ï¼Œæ‰€æœ‰çš„æ•…äº‹éƒ½å›´ç»•åˆ‡ç‚¹å‘ç”Ÿ</span>    <span class="token comment">// logPointCut()ä»£è¡¨åˆ‡ç‚¹åç§°</span>    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"@annotation(me.zebin.demo.annotationdemo.aoplog.MyLog)"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logPointCut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">// 3. ç¯ç»•é€šçŸ¥</span>    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">"logPointCut()"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// è·å–æ–¹æ³•åç§°</span>        <span class="token class-name">String</span> methodName <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è·å–å…¥å‚</span>        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> param <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o <span class="token operator">:</span> param<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>o <span class="token operator">+</span> <span class="token string">"; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿›å…¥["</span> <span class="token operator">+</span> methodName <span class="token operator">+</span> <span class="token string">"]æ–¹æ³•,å‚æ•°ä¸º:"</span> <span class="token operator">+</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ç»§ç»­æ‰§è¡Œæ–¹æ³•</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methodName <span class="token operator">+</span> <span class="token string">"æ–¹æ³•æ‰§è¡Œç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æ­¥éª¤äºŒä¸­çš„ IndexController å†™ä¸€ä¸ª sourceC è¿›è¡Œæµ‹è¯•ï¼ŒåŠ ä¸Šæˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@MyLog</span><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sourceC/&#123;source_name&#125;"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sourceC</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"source_name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> sourceName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"ä½ æ­£åœ¨è®¿é—®sourceCèµ„æº"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨ springboot web é¡¹ç›®ï¼Œè¾“å…¥è®¿é—®åœ°å€</p><p><a href="https://s2.loli.net/2024/12/20/MV3qmhBCnysbwKf.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/MV3qmhBCnysbwKf.png"></a></p><p>åˆ‡é¢æˆåŠŸ</p><p><a href="https://s2.loli.net/2024/12/20/I8EtHPARLXkBexl.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/I8EtHPARLXkBexl.png"></a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸå¸‚åœ°é“AFCç³»ç»Ÿ</title>
      <link href="/posts/30078.html"/>
      <url>/posts/30078.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="åŸå¸‚åœ°é“-AFC-ç³»ç»Ÿç®€æ"><a href="#åŸå¸‚åœ°é“-AFC-ç³»ç»Ÿç®€æ" class="headerlink" title="åŸå¸‚åœ°é“ AFC ç³»ç»Ÿç®€æ"></a><strong>åŸå¸‚åœ°é“ AFC ç³»ç»Ÿç®€æ</strong></h1><h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a><strong>ä¸€ã€æ¦‚è¿°</strong></h2><h3 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a><strong>1.1 å®šä¹‰</strong></h3><p>AFC ç³»ç»Ÿçš„å…¨ç§°æ˜¯ <code>Automatic Fare Collection System</code>ï¼ˆåŸå¸‚è½¨é“äº¤é€šè‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿï¼‰ï¼Œæ˜¯åŸºäºè®¡ç®—æœºã€é€šä¿¡ã€ç½‘ç»œã€è‡ªåŠ¨æ§åˆ¶ç­‰æŠ€æœ¯ï¼Œå®ç°è½¨é“äº¤é€šå”®ç¥¨ã€æ£€ç¥¨ã€è®¡è´¹ã€æ”¶è´¹ã€ç»Ÿè®¡ã€æ¸…åˆ†ã€ç®¡ç†ç­‰å…¨è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ç³»ç»Ÿã€‚</p><h3 id="1-2-ä¸»è¦å·¥ä½œå†…å®¹"><a href="#1-2-ä¸»è¦å·¥ä½œå†…å®¹" class="headerlink" title="1.2 ä¸»è¦å·¥ä½œå†…å®¹"></a><strong>1.2 ä¸»è¦å·¥ä½œå†…å®¹</strong></h3><p>1ã€å®ç°ä¸­å¤®ç³»ç»Ÿã€è½¦ç«™ç³»ç»Ÿå’Œç»ˆç«¯è®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“å’Œå¤„ç†;</p><p>2ã€å®Œæˆè½¦ ç¥¨åˆ¶ä½œã€å”®ç¥¨ã€æ£€ç¥¨ã€ç¥¨åŠ¡ç»Ÿè®¡åˆ†æç­‰å·¥ä½œ;</p><p>3ã€åŠæ—¶ã€å‡†ç¡®åœ°è¿›è¡Œå®¢æµã€ç¥¨åŠ¡æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€æ±‡æ€»å’Œåˆ†æ;</p><p>4ã€å®ç°è½¨é“äº¤é€šæ”¶ç›Šæ–¹å¾—æ¸…åˆ†ç»“ç®—ä»¥åŠä¸å…³è”ç³»ç»Ÿç­‰å¤–éƒ¨æ¥å£ä¹‹é—´çš„æ¸…åˆ†ç»“ç®—ï¼ŒåŒæ—¶å¯é€šè¿‡é“¶è¡Œæˆ–é‡‘èæœºæ„å®ç°è´¦åŠ¡åˆ’æ‹¨ã€‚</p><h3 id="1-3-ä¼˜ç‚¹"><a href="#1-3-ä¼˜ç‚¹" class="headerlink" title="1.3 ä¼˜ç‚¹"></a><strong>1.3 ä¼˜ç‚¹</strong></h3><p>1ï¼‰äººæ€§åŒ–</p><p>è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿä¸ºä¹˜å®¢è®¾ç½®ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„å”®ç¥¨æœºå’Œæ£€ç¥¨æœºï¼Œæ–¹ä¾¿ä¹˜å®¢çš„è´­ç¥¨å’Œæ£€ç¥¨è¿‡ç¨‹ï¼ŒåŒæ—¶æä¾›ç¬¦åˆåœ°æ–¹ç‰¹è‰²çš„æ“ä½œæ–¹å¼ã€‚</p><p>2ï¼‰å®¢æµå¯¼å‘</p><p>è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿå¯æ–¹ä¾¿åœ°å®ç°ä¹˜è½¦è·¯å¾„å’Œä¼˜æƒ ç¥¨ä»·ç®¡ç†ï¼Œå¯ä»¥é€šè¿‡ç¥¨ä»·è®¾å®šæ¥ä¸ºä¹˜å®¢æä¾›å¯¼å‘æ€§æœåŠ¡ï¼Œå®ç°æŸ”æ€§çš„ä¹˜å®¢è‡ªä¸»å¯¹å‡ºè¡Œè·¯å¾„æˆ–æ—¶æ®µçš„é€‰æ‹©ï¼Œåˆç†è°ƒæ•´å®¢æµåˆ†å¸ƒã€‚</p><p>3ï¼‰ç¤¾ä¼šæ•ˆç›Š</p><p>ä¸€æ–¹é¢å¯é€šè¿‡è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿå½¢æˆå¯¹åŒºåŸŸäº¤é€šå®¢æµçŠ¶å†µçš„è°ƒæ•´ï¼Œå¯¹è®¾å¤‡ç”Ÿæ´»äº§ç”Ÿå½±å“ï¼›å¦ä¸€æ–¹é¢å¯é€šè¿‡è‡ªåŠ¨åŒ–çš„è®¾æ–½å½±å“äººä»¬çš„è¡Œä¸ºæ¨¡å¼ï¼Œè§„èŒƒç®¡ç†æ¨¡å¼ï¼Œå®¢æœç¥¨åŠ¡å·¥ä½œä¸­çš„èˆå¼Šè¡Œä¸ºã€‚</p><p>4ï¼‰æä¾›ä¿¡æ¯æ”¯æŒ</p><p>è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿèƒ½å¤Ÿæä¾›å®¢æµé‡ã€ç¥¨åŠ¡æ”¶å…¥ç­‰ç»Ÿè®¡ä¿¡æ¯ï¼Œä¸ºè½¨é“äº¤é€šçš„è¿è¥ã€è§„åˆ’å’Œç®¡ç†å†³ç­–æä¾›ä¿¡æ¯æ”¯æŒã€‚</p><p>5ï¼‰æé«˜è¿è¡Œæ•ˆç‡</p><p>è½¨é“äº¤é€šè¿è¥å•ä½å¯æ ¹æ®è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿçš„å®¢æµä¿¡æ¯åŠæ—¶è°ƒæ•´è¿è¡Œç»„ç»‡ï¼Œåˆç†å®‰æ’è¿èƒ½ï¼Œæé«˜è¿è¡Œæ•ˆç‡ã€‚</p><p>6ï¼‰å¼ºåŒ–å®‰å…¨ç®¡ç†</p><p>å€ŸåŠ©è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿä»˜è´¹åŒºçš„å°é—­æ¡ä»¶ï¼Œå¯å¯¹ä¹˜å®¢åœ¨è½¦ç«™å†…çš„è¡Œä¸ºè¿›è¡Œç®¡ç†ã€‚åœ¨ç´§æ€¥æƒ…å†µä¸‹ï¼Œå¯é€šè¿‡é—¸æœºçš„ç¦æ­¢å’Œæ–¹å½¢æªæ–½ç–å¯¼äººç¾¤ï¼Œå®ç°å®‰å…¨ç®¡ç†ã€‚</p><p>7ï¼‰æå‡å½¢è±¡</p><p>é€šè¿‡è‡ªåŠ¨å”®æ£€ç¥¨ç³»ç»Ÿï¼Œå¢åŠ äº†è½¨é“äº¤é€šä¸ä¹˜å®¢çš„æ“ä½œäº¤äº’æ€§å’Œä¹˜å®¢çš„ä¸»åŠ¨æ€§ï¼Œè‰¯å¥½çš„åº”ç”¨æ•ˆæœå¯ä»¥æå‡è¿è¥ä¼ä¸šå’Œæ‰€åœ¨åœ°çš„å½¢è±¡ã€‚</p><h2 id="äºŒã€ç»“æ„åŠåŠŸèƒ½"><a href="#äºŒã€ç»“æ„åŠåŠŸèƒ½" class="headerlink" title="äºŒã€ç»“æ„åŠåŠŸèƒ½"></a><strong>äºŒã€ç»“æ„åŠåŠŸèƒ½</strong></h2><p>AFC çš„ç»“æ„æŒ‰å±‚æ¬¡åˆ’åˆ†ä¸€èˆ¬åˆ†ä¸ºè½¦ç¥¨ã€è½¦ç«™ç»ˆç«¯è®¾å¤‡ï¼ˆSLEï¼‰ã€è½¦ç«™è®¡ç®—æœºç³»ç»Ÿï¼ˆSCï¼‰ã€çº¿è·¯ä¸­å¤®è®¡ç®—æœºç³»ç»Ÿï¼ˆLC/LCCï¼‰ã€æ¸…åˆ†ç³»ç»Ÿï¼ˆCCï¼‰äº”ä¸ªå±‚æ¬¡ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/uPUb5AzcRrkJVIK.jpg" title="æ¸…åˆ†ã€çº¿è·¯ã€è½¦ç«™ã€è®¾å¤‡ã€ç¥¨å¡" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/uPUb5AzcRrkJVIK.jpg" alt="æ¸…åˆ†ã€çº¿è·¯ã€è½¦ç«™ã€è®¾å¤‡ã€ç¥¨å¡"></a></p><p><a href="https://s2.loli.net/2024/12/20/uaciEpHKy71zCvo.jpg" title="æ•´ä½“ç»“æ„å›¾" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/uaciEpHKy71zCvo.jpg" alt="æ•´ä½“ç»“æ„å›¾"></a></p><h3 id="2-1-æ¸…åˆ†ç»“ç®—ç®¡ç†ä¸­å¿ƒ-ACC"><a href="#2-1-æ¸…åˆ†ç»“ç®—ç®¡ç†ä¸­å¿ƒ-ACC" class="headerlink" title="2.1 æ¸…åˆ†ç»“ç®—ç®¡ç†ä¸­å¿ƒ (ACC)"></a><strong>2.1 æ¸…åˆ†ç»“ç®—ç®¡ç†ä¸­å¿ƒ (ACC)</strong></h3><p>æ¸…åˆ†ç»“ç®—ä¸­å¿ƒä½œä¸ºæ•´ä¸ª AFC ç³»ç»Ÿçš„é¡¶å±‚ï¼Œä¸»è¦æ˜¯è´Ÿè´£å¯¹åœ°é“çº¿è·¯ä¹‹é—´ã€åœ°é“ä¸åŸå¸‚ä¸€å¡é€šç³»ç»Ÿä¹‹é—´çš„æ¸…åˆ†ç»“ç®—ï¼Œå¯¹ä¸åŒè¿è¥å®ä½“ (æˆ–çº¿è·¯) è¿›è¡Œç®¡ç†ï¼Œåˆ¶å®šä¸šåŠ¡è§„ç¨‹å’Œç¥¨åŠ¡è§„åˆ™ï¼Œåˆ¶ä½œå‘è¡Œç¥¨å¡å…¨é¢åè°ƒä¸åŒçº¿è·¯é—´çš„æ—¥å¸¸è¿è¥ã€‚</p><h3 id="2-2-çº¿è·¯ä¸­å¿ƒ-LC"><a href="#2-2-çº¿è·¯ä¸­å¿ƒ-LC" class="headerlink" title="2.2 çº¿è·¯ä¸­å¿ƒ (LC)"></a><strong>2.2 çº¿è·¯ä¸­å¿ƒ (LC)</strong></h3><p>çº¿è·¯ä¸­å¿ƒç®¡ç†çº¿è·¯å†…äº¤æ˜“ã€å®¢æµã€è®¾å¤‡ã€ç¥¨åŠ¡ç­‰æ•°æ®, è´Ÿè´£æœ¬çº¿è·¯ç³»ç»Ÿçš„ AFC æ”¶è´¹æ•°æ®ã€è®¾å¤‡çŠ¶æ€æ•°æ®ã€å®¢æµé‡æ•°æ®çš„é‡‡é›†ï¼Œç”ŸæˆæŠ¥è¡¨ä»¥åŠå¯¹è´¦ç­‰ã€‚LC å°†æ”¶é›†çš„æœ¬çº¿è·¯æ•°æ®ä¸Šä¼ åˆ°æ¸…ç»“ç®—ç®¡ç†ä¸­å¿ƒï¼Œæ¥å—æ¸…ç»“ç®—ç®¡ç†ä¸­å¿ƒçš„å‘½ä»¤ä¸å‚æ•°ï¼Œå¹¶å°†å…¶ä¸‹å‘åˆ°å„è½¦ç«™ç³»ç»Ÿ; åŒæ—¶ï¼ŒLC ä¹Ÿç®¡ç†å’Œä¸‹å‘çº¿è·¯çº§çš„å‘½ä»¤åŠç³»ç»Ÿå‚æ•°ï¼Œå®Œæˆæœ¬çº¿è·¯çš„ç¥¨åŠ¡ç®¡ç†ï¼Œå…·å¤‡ç¥¨å¡çš„åº“å­˜ç®¡ç†å’Œè°ƒé…ç­‰åŠŸèƒ½ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/eAZI2KjF8nPr9uX.jpg" title="LC ç‰©ç†ç»“æ„å›¾" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/eAZI2KjF8nPr9uX.jpg" alt="LC ç‰©ç†ç»“æ„å›¾"></a></p><h3 id="2-3-è½¦ç«™ä¸­å¿ƒ-SC"><a href="#2-3-è½¦ç«™ä¸­å¿ƒ-SC" class="headerlink" title="2.3 è½¦ç«™ä¸­å¿ƒ (SC)"></a><strong>2.3 è½¦ç«™ä¸­å¿ƒ (SC)</strong></h3><p>è½¦ç«™ä¸­å¿ƒç”¨æ¥ç›‘æ§å’Œé…ç½®è½¦ç«™æœ¬åœ°è®¾å¤‡ï¼Œé‡‡é›†æœ¬åœ°è½¦ç«™è®¾å¤‡æ•°æ®, å¯¹è½¦ç«™çš„æ¯ä¸€å°è®¾å¤‡å®æ–½ç›‘ç£ã€æ§åˆ¶ã€å‚æ•°åŒ–ã€æ•°æ®é‡‡é›†å’Œå®¡è®¡ã€‚SC æ¥æ”¶ LC çš„æŒ‡ä»¤å’Œå‚æ•°, å¹¶ä¸‹å‘åˆ°ç›¸åº”çš„è®¾å¤‡ã€‚åŒæ—¶ï¼ŒSC é‡‡é›†è®¾å¤‡çš„äº¤æ˜“ã€äº‹ä»¶å’Œå®¡è®¡æ•°æ®ï¼Œä¸Šä¼ åˆ° LCã€‚</p><p><a href="https://s2.loli.net/2024/12/20/yGOxvIPpZaQroNf.jpg" title="è½¦ç«™ä¸­å¿ƒ" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/yGOxvIPpZaQroNf.jpg" alt="è½¦ç«™ä¸­å¿ƒ"></a></p><h3 id="2-4-AFC-è½¦ç«™ç»ˆç«¯è®¾å¤‡-SLE"><a href="#2-4-AFC-è½¦ç«™ç»ˆç«¯è®¾å¤‡-SLE" class="headerlink" title="2.4 AFC è½¦ç«™ç»ˆç«¯è®¾å¤‡ (SLE)"></a><strong>2.4 AFC è½¦ç«™ç»ˆç«¯è®¾å¤‡ (SLE)</strong></h3><p>AFC è®¾å¤‡å±‚åŒ…æ‹¬é—¸æœºã€åŠè‡ªåŠ¨å”®ç¥¨æœºã€è‡ªåŠ¨å”®ç¥¨æœºã€è‡ªåŠ¨å……å€¼æœºã€é“¶è¡Œåœˆå­˜æœºã€è‡ªåŠ©æŸ¥è¯¢æœºã€ç§»åŠ¨æ”¯ä»˜è®¾å¤‡å’Œå…¶ä»–è®¾å¤‡ç­‰ã€‚</p><h3 id="2-4-1-è‡ªåŠ¨æ£€ç¥¨æœº-AGM"><a href="#2-4-1-è‡ªåŠ¨æ£€ç¥¨æœº-AGM" class="headerlink" title="2.4.1 è‡ªåŠ¨æ£€ç¥¨æœº (AGM)"></a><strong>2.4.1 è‡ªåŠ¨æ£€ç¥¨æœº (AGM)</strong></h3><p>è‡ªåŠ¨æ£€ç¥¨æœºè®¾ç½®åœ¨ä»˜è´¹åŒºä¸éä»˜è´¹åŒºçš„äº¤ç•Œå¤„ï¼Œèµ·ç€åˆ†å‰²ä»˜è´¹åŒºä¸éä»˜è´¹åŒºçš„ä½œç”¨ï¼Œå®ç°ç¥¨å¡æœ‰æ•ˆæ€§éªŒè¯ã€æ£€ç¥¨ã€é€šè¡Œæ§åˆ¶ã€è½¦ç¥¨å›æ”¶ç­‰åŠŸèƒ½ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/ZrGCOTpvwDV9Ys3.jpg" title="é—¸æœºAGMï¼ˆä¹Ÿæœ‰ç§° GATEï¼‰" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ZrGCOTpvwDV9Ys3.jpg" alt="é—¸æœºAGMï¼ˆä¹Ÿæœ‰ç§° GATEï¼‰"></a></p><p>è‡ªåŠ¨æ£€ç¥¨æœºä¸»è¦ç”±è¿›ç«™ç”¨ä¹˜å®¢æ˜¾ç¤ºå™¨ã€å‡ºç«™ç”¨ä¹˜å®¢æ˜¾ç¤ºå™¨ã€è¿›ç«™ç”¨è¯»å†™å™¨ã€å‡ºç«™ç”¨è¯»å†™å™¨ã€è½¦ç¥¨å›æ”¶æ¨¡å—ã€ç«™å‘˜æ“ä½œéƒ¨ã€é€šé“æ˜¾ç¤ºéƒ¨ã€é—¸é—¨ã€ä¸»æ§å•å…ƒã€ç”µæºæ¨¡å—ã€äººä½“æ£€æµ‹éƒ¨ã€å¤–éƒ¨æ¥å£ç­‰æ„æˆã€‚</p><h3 id="2-4-2-åŠè‡ªåŠ¨å”®ç¥¨æœº-BOM"><a href="#2-4-2-åŠè‡ªåŠ¨å”®ç¥¨æœº-BOM" class="headerlink" title="2.4.2 åŠè‡ªåŠ¨å”®ç¥¨æœº (BOM)"></a><strong>2.4.2 åŠè‡ªåŠ¨å”®ç¥¨æœº (BOM)</strong></h3><p>è®¾äºè½¦ç«™æœåŠ¡ä¸­å¿ƒï¼Œå…·æœ‰å”®ç¥¨ã€è¡¥ç¥¨å’Œå”®è¡¥ç¥¨åŠŸèƒ½ï¼Œå¯¹äºä¸€å¡é€šè½¦ç¥¨çš„å¤„ç†å¯ä»¥æŒ‰ç…§ä¸€å¡é€šç³»ç»Ÿçš„è§„åˆ™è¿›è¡Œã€‚</p><p>åŒæ—¶å¯å‘è¡Œå„ç§ç±»å‹çš„è½¦ç¥¨ï¼Œå…¼æœ‰å¯¹è½¦ç¥¨è¿›è¡ŒæŸ¥éªŒå’Œç¥¨æ®æ‰“å°ç­‰åŠŸèƒ½ï¼Œæ‰€èƒ½å®ç°çš„åŠŸèƒ½å¯ç”±ç³»ç»Ÿå‚æ•°çµæ´»è®¾ç½®ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/kxGnaP92EIjHbBN.jpg" title="åŠè‡ªåŠ¨å”®ç¥¨æœº BOM" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/kxGnaP92EIjHbBN.jpg" alt="åŠè‡ªåŠ¨å”®ç¥¨æœº BOM"></a></p><p>å½“ä¸ SC é€šä¿¡ä¸­æ–­æ—¶ï¼Œå…·æœ‰ç¦»çº¿å·¥ä½œå’Œæ•°æ®ä¿å­˜èƒ½åŠ›ã€‚BOM å¯ä»¥ä¿å­˜ 30 å¤©çš„è¿è¥æ•°æ®ã€‚åœ¨é€šä¿¡æ¢å¤æ—¶ï¼Œèƒ½å°†ä¿å­˜çš„äº¤æ˜“æ•°æ®åŠæ—¶ä¸Šä¼ ç»™ SCã€‚</p><p>æˆ‘æ–¹æä¾›åŠè‡ªåŠ¨å”®ç¥¨æœºä¸Šç”µå¯åŠ¨åä¸€åˆ†é’Ÿä¹‹å†…å³å¯è¿›å…¥æ­£å¸¸æœåŠ¡çŠ¶æ€ã€‚</p><h3 id="2-4-3-è‡ªåŠ¨æŸ¥è¯¢æœº-TCM"><a href="#2-4-3-è‡ªåŠ¨æŸ¥è¯¢æœº-TCM" class="headerlink" title="2.4.3 è‡ªåŠ¨æŸ¥è¯¢æœº (TCM)"></a><strong>2.4.3 è‡ªåŠ¨æŸ¥è¯¢æœº (TCM)</strong></h3><p>è‡ªåŠ¨æŸ¥è¯¢æœºå®‰è£…åœ¨åœ°é“è½¦ç«™éä»˜è´¹åŒº, ä¾›åœ¨è½¨é“äº¤é€šå†…ä½¿ç”¨çš„åœ°é“ä¸“ç”¨ç¥¨åŠåŸå¸‚ â€œä¸€å¡é€š â€œ çš„è‡ªåŠ©æŸ¥è¯¢éªŒç¥¨åŠå‘å¸ƒåœ°é“é€šçŸ¥ä¿¡æ¯ç­‰æœåŠ¡ã€‚è‡ªåŠ¨æŸ¥è¯¢æœºæ“ä½œç•Œé¢é‡‡ç”¨è§¦æ‘¸å±æ“ä½œæ–¹å¼ï¼Œç”± LC ä¸‹è½½ä¹˜å®¢æœåŠ¡ä¿¡æ¯ï¼Œå¯ä»¥å›æº¯è½¦ç¥¨å†…è®°å½•çš„ä½¿ç”¨å†å²ï¼ŒåŒ…æ‹¬ç¥¨ç§ã€è´­ç¥¨æ—¶é—´ã€è¿›ç«™æ—¶é—´ã€å‡ºç«™æ—¶é—´ã€è¿›ç«™åœ°ç‚¹ã€å‡ºç«™åœ°ç‚¹ã€æ‰£è´¹é‡‘é¢ã€å‰©ä½™é‡‘é¢ã€æœ‰æ•ˆæœŸç­‰ã€‚æ¯ç¬”äº¤æ˜“ä¿¡æ¯åº”é€æ¡æ˜¾ç¤ºã€‚å¯¹æœ‰é—®é¢˜çš„äº¤æ˜“è®°å½•åº”å¯ä»¥é†’ç›®çš„æç¤ºã€‚è‡ªåŠ¨æŸ¥è¯¢æœºåœ¨è¿›è¡Œè½¦ç¥¨æŸ¥è¯¢æ—¶ï¼Œèƒ½å¯¹è½¦ç¥¨çš„æœ‰æ•ˆæ€§è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœ‰é—®é¢˜èƒ½æ˜¾ç¤ºåŸå› ï¼Œå¹¶æç¤ºä¹˜å®¢å»åŠè‡ªåŠ¨å”®ç¥¨æœºå¤„å¤„ç†ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/KT87wpZHt2QURFz.jpg" title="è‡ªåŠ¨å”®ç¥¨æœº TCM (åˆç§°TVM)" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/KT87wpZHt2QURFz.jpg" alt="è‡ªåŠ¨å”®ç¥¨æœº TCM (åˆç§°TVM)"></a></p><p>è‡ªåŠ¨æŸ¥è¯¢æœºå…·æœ‰å¦‚ä¸‹åŠŸèƒ½:</p><ol><li>æ‰€æœ‰è½¦ç¥¨å‡å¯æŸ¥è¯¢ï¼›å¯ä»¥è‡ªåŠ¨æ’­æ”¾é¢„å…ˆå½•åˆ¶çš„å½±éŸ³ç‰‡æ–­ï¼Œå¯ä»¥å‘ä¹˜å®¢ä»‹ç»ç³»ç»Ÿä½¿. ç”¨æ–¹æ³•ã€æ˜¾ç¤ºå…¬å¸é€šå‘ŠåŠæ“ä½œæŒ‡å—åŠ¨ç”»çŸ­ç‰‡ç­‰ä¿¡æ¯ï¼›</li><li>å¯ä»¥å›æº¯è½¦ç¥¨å†…è®°å½•çš„ä½¿ç”¨å†å² (åŒ…æ‹¬ç¥¨ç§ã€è´­ç¥¨æ—¶é—´ã€è¿›ç«™æ—¶é—´ã€å‡ºç«™æ—¶é—´ã€è¿›ç«™åœ°ç‚¹ã€å‡ºç«™åœ°ç‚¹ã€æ‰£è´¹é‡‘é¢ã€å‰©ä½™é‡‘é¢ã€æœ‰æ•ˆæœŸç­‰) ;</li><li>äº¤æ˜“ä¿¡æ¯é€æ¡æ˜¾ç¤º;</li><li>é—®é¢˜çš„äº¤æ˜“è®°å½•å¯ä»¥é†’ç›®çš„æç¤º;</li><li>è½¦ç¥¨æœ‰æ•ˆæ€§è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœ‰é—®é¢˜æ˜¾ç¤ºåŸå› å¹¶æç¤ºã€‚</li></ol><h3 id="2-5-ç¥¨å¡-Ticketï¼‰"><a href="#2-5-ç¥¨å¡-Ticketï¼‰" class="headerlink" title="2.5 ç¥¨å¡ (Ticketï¼‰"></a><strong>2.5 ç¥¨å¡ (Ticketï¼‰</strong></h3><p>äº”å±‚æ¶æ„ä½“ç³»çš„åº•å±‚ä¸ºç¥¨å¡å±‚ï¼Œå®ƒæ˜¯ä¹˜å®¢æ‰€æŒçš„è½¦è´¹æ”¯ä»˜åª’ä»‹ï¼ŒåŒ…æ‹¬è®¡æ¬¡ç¥¨ã€å‚¨å€¼ç¥¨ã€å•ç¨‹ç¥¨ã€å‘˜å·¥ç¥¨å’Œå…¶ä»–è½¦ç¥¨ç­‰ã€‚</p><h2 id="ä¸‰ã€AFC-ç³»ç»Ÿä¸»è¦ä¸šåŠ¡æµç¨‹"><a href="#ä¸‰ã€AFC-ç³»ç»Ÿä¸»è¦ä¸šåŠ¡æµç¨‹" class="headerlink" title="ä¸‰ã€AFC ç³»ç»Ÿä¸»è¦ä¸šåŠ¡æµç¨‹"></a><strong>ä¸‰ã€AFC ç³»ç»Ÿä¸»è¦ä¸šåŠ¡æµç¨‹</strong></h2><p>AFC ç³»ç»Ÿè¿è¥ç®¡ç†çš„ä¸šåŠ¡æµç¨‹æ˜¯ä¸€ä½“ä¸‰é¢ï¼Œé¢å‘ä¿¡æ¯æµï¼Œç‰©æµå’Œè´£ä»»é“¾ï¼Œä¸»è¦åŒ…æ‹¬ä¸‰å¤§ä¸šåŠ¡æµç¨‹ï¼š</p><h3 id="ï¼ˆ1ï¼‰ç¥¨åŠ¡ç®¡ç†æµç¨‹"><a href="#ï¼ˆ1ï¼‰ç¥¨åŠ¡ç®¡ç†æµç¨‹" class="headerlink" title="ï¼ˆ1ï¼‰ç¥¨åŠ¡ç®¡ç†æµç¨‹"></a>ï¼ˆ1ï¼‰ç¥¨åŠ¡ç®¡ç†æµç¨‹</h3><p><a href="https://s2.loli.net/2024/12/20/L8ezRji1sp2ToYD.jpg" title="ç®¡ç†æµç¨‹" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/L8ezRji1sp2ToYD.jpg" alt="ç®¡ç†æµç¨‹"></a></p><h3 id="ï¼ˆ2ï¼‰æ”¶ç›Šç®¡ç†æµç¨‹"><a href="#ï¼ˆ2ï¼‰æ”¶ç›Šç®¡ç†æµç¨‹" class="headerlink" title="ï¼ˆ2ï¼‰æ”¶ç›Šç®¡ç†æµç¨‹"></a>ï¼ˆ2ï¼‰æ”¶ç›Šç®¡ç†æµç¨‹</h3><p><a href="https://s2.loli.net/2024/12/20/3ndgfcEh9bsSZHj.jpg" title="æ”¶ç›Šç®¡ç†" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/3ndgfcEh9bsSZHj.jpg" alt="æ”¶ç›Šç®¡ç†"></a></p><h3 id="ï¼ˆ3ï¼‰è¿è¥ç»´æŠ¤æµç¨‹"><a href="#ï¼ˆ3ï¼‰è¿è¥ç»´æŠ¤æµç¨‹" class="headerlink" title="ï¼ˆ3ï¼‰è¿è¥ç»´æŠ¤æµç¨‹"></a>ï¼ˆ3ï¼‰è¿è¥ç»´æŠ¤æµç¨‹</h3><p><a href="https://s2.loli.net/2024/12/20/5ea3zI61jmgrGfW.jpg" title="è¿è¥ç»´æŠ¤" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/5ea3zI61jmgrGfW.jpg" alt="è¿è¥ç»´æŠ¤"></a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> åœ°é“ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åœ°é“ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆå…«ï¼‰| æ¶ˆæ¯é˜Ÿåˆ—</title>
      <link href="/posts/43028.html"/>
      <url>/posts/43028.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h1><blockquote><p>æ¶ˆæ¯é˜Ÿåˆ—è§£å†³çš„æ ¸å¿ƒåœºæ™¯ï¼šè§£æ„ã€å¼‚æ­¥ã€å‰Šå³°</p></blockquote><h2 id="1-ä¸ºä»€ä¹ˆä½¿ç”¨MQ"><a href="#1-ä¸ºä»€ä¹ˆä½¿ç”¨MQ" class="headerlink" title="1.ä¸ºä»€ä¹ˆä½¿ç”¨MQ"></a>1.ä¸ºä»€ä¹ˆä½¿ç”¨MQ</h2><p>â€‹    å…¬å¸ä¸šåŠ¡åœºæ™¯ï¼Œæ ¸å¿ƒï¼šè§£è€¦ã€å¼‚æ­¥ã€å‰Šå³°</p><h3 id="è§£è€¦ï¼š"><a href="#è§£è€¦ï¼š" class="headerlink" title="è§£è€¦ï¼š"></a>è§£è€¦ï¼š</h3><p>â€‹    Aç³»ç»Ÿå‘æ•°æ®ç»™åˆ°BCDç³»ç»Ÿï¼Œå¦‚æœEç³»ç»Ÿéœ€è¦æ¥å…¥ï¼ŸCç³»ç»Ÿä¸éœ€è¦äº†ï¼ŸAç³»ç»Ÿçš„è´Ÿè´£äººå°±éœ€è¦æ¥å›ä¿®æ”¹æ¥å£å¯¹æ¥å…¶ä»–ç³»ç»Ÿã€‚</p><p><a href="https://s2.loli.net/2024/12/20/MJBsElgtxwnzc1i.png" title="è§£è€¦-1" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/MJBsElgtxwnzc1i.png" alt="è§£è€¦-1"></a></p><p>â€‹    å¦‚æœä½¿ç”¨MQï¼ŒAç³»ç»Ÿäº§ç”Ÿä¸€æ¡æ•°æ®ï¼Œå‘é€åˆ°MQä¸­ï¼Œé‚£ä¸ªç³»ç»Ÿéœ€è¦æ•°æ®è‡ªå·±å»MQæ¶ˆè´¹ã€‚å¦‚æœæ–°çš„ç³»ç»Ÿéœ€è¦æ•°æ®ï¼Œç›´æ¥ä»MQä¸­æ¶ˆè´¹ï¼›æŸä¸ªç³»ç»Ÿä¸éœ€è¦æ•°æ®çš„è¯ï¼Œå–æ¶ˆæ¶ˆè´¹è¿™ä¸ªMQå³å¯ã€‚è¿™æ ·Aç³»ç»Ÿä¸éœ€è¦è€ƒè™‘è°å‘é€æ•°æ®ç»™è°ï¼Œä¸éœ€è¦è€ƒè™‘æ˜¯å¦è°ƒç”¨æˆåŠŸã€å¤±è´¥è¶…æ—¶ç­‰é—®é¢˜ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/xGc1uptaSZyEN3I.png" title="è§£è€¦-2" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/xGc1uptaSZyEN3I.png" alt="è§£è€¦-2"></a></p><p><strong>æ€»ç»“</strong>ï¼šé€šè¿‡ä¸€ä¸ªMQï¼ŒPub/Subå‘å¸ƒè®¢é˜…æ¶ˆæ¯æ¨¡å‹ï¼ŒAç³»ç»Ÿå°±å’Œå…¶ä»–ç³»ç»Ÿå½»åº•è€¦åˆäº†ã€‚</p><h4 id="é¡¹ç›®åº”ç”¨ï¼š"><a href="#é¡¹ç›®åº”ç”¨ï¼š" class="headerlink" title="é¡¹ç›®åº”ç”¨ï¼š"></a>é¡¹ç›®åº”ç”¨ï¼š</h4><p>â€‹    è½¦ç«™ç³»ç»Ÿé€šè¿‡æ§åˆ¶å‘½ä»¤ä¸‹å‘ç»™å„ä¸ªè®¾å¤‡ï¼Œå…¶ä¸­è½¦ç«™çš„è®¾å¤‡é€šå¸¸åŒ…å«ï¼šé—¸æœºã€åŠè‡ªåŠ¨å”®ç¥¨æœºã€è‡ªåŠ¨å”®ç¥¨æœºã€æ‰‹æŒæœºç­‰è®¾å¤‡ã€‚å¦‚æœæŒ‰ç…§å¸¸è§„çš„åŒæ­¥æ–¹å¼æ¥å¯¹æ¥ä¸åŒçš„è®¾å¤‡ï¼Œè¿™å°†ä½¿å¾—ç³»ç»Ÿå†—ä½™çš„ä»£ç å¾ˆå¤šï¼Œå½“è½¦ç«™å¢å‡ä¸€ä¸ªè®¾å¤‡å°±å¯èƒ½éœ€è¦é‡æ–°å¯¹æ¥æ¥å£ï¼Œé€ æˆç³»ç»Ÿè€¦åˆæ€§å¾ˆé«˜ï¼Œè¿™æ ·çš„æ•ˆç‡ä¸é«˜ä¸”ä¸ä¼˜é›…ã€‚æ‰€ä»¥å½“ç³»ç»Ÿéœ€è¦å‘é€å‘½ä»¤ï¼ˆç”Ÿäº§ä¸€ä¸ªæ•°æ®ï¼‰ï¼Œå°†æ•°æ®æ”¾åˆ°MQä¸­ï¼Œä¸éœ€è¦çŸ¥é“é‚£ä¸ªè®¾å¤‡æ”¶åˆ°æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œå…¶ä¸­éœ€è¦æ¶ˆè´¹çš„è®¾å¤‡è‡ªå·±å»è®¢é˜…å¹¶ä¸”è·å–ç›¸åº”çš„æ¶ˆæ¯å³å¯ã€‚è¿™æ ·å°±å¯ä»¥è¾¾åˆ°ï¼Œç³»ç»Ÿä¸‹å‘è®¾å¤‡æ§åˆ¶å‘½ä»¤ï¼Œä¸åŒè®¾å¤‡å“åº”ã€‚</p><h3 id="å¼‚æ­¥ï¼š"><a href="#å¼‚æ­¥ï¼š" class="headerlink" title="å¼‚æ­¥ï¼š"></a>å¼‚æ­¥ï¼š</h3><p>â€‹    Aç³»ç»Ÿæ¥æ”¶è¯·æ±‚ï¼Œéœ€è¦æœ¬åœ°å…¥åº“ï¼Œè¿˜éœ€è¦BCDä¸‰ä¸ªç³»ç»Ÿå…¥åº“ï¼Œæœ¬åœ°å…¥åº“ï¼ˆ3msï¼‰ï¼ŒBCDï¼ˆ300ms+400ms+500msï¼‰ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå·®ç­‰å¾…æ—¶é—´å¤ªé•¿ã€‚ä¸šå†…è¯·æ±‚éœ€è¦åšåˆ° 200ms ä»¥å†…ï¼Œå¯¹ç”¨æˆ·å‡ ä¹æ— æ„Ÿã€‚</p><p><a href="https://s2.loli.net/2024/12/20/MsQuDc6RBeNX9bA.png" title="å¼‚æ­¥-1" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/MsQuDc6RBeNX9bA.png" alt="å¼‚æ­¥-1"></a></p><p>â€‹    ä½¿ç”¨MQï¼ŒAç³»ç»Ÿè¿ç»­å‘é€3æ¡æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‡å¦‚æ¶ˆè€—5msï¼Œè¯·æ±‚èŠ±äº† 5 + 3 = 8ms ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´å°±æ˜¯ç‚¹äº†ä¸€ä¸ªæŒ‰é’®è¿”å›å¾ˆå¿«ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/uXJyG6mpRbg1TPQ.png" title="å¼‚æ­¥-2" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/uXJyG6mpRbg1TPQ.png" alt="å¼‚æ­¥-2"></a></p><h3 id="å‰Šå³°ï¼š"><a href="#å‰Šå³°ï¼š" class="headerlink" title="å‰Šå³°ï¼š"></a>å‰Šå³°ï¼š</h3><p>â€‹    æ¯å¤©ä¸€æ®µæ—¶é—´ï¼ŒAç³»ç»Ÿé£å¹³æµªé™ï¼Œæ¯ç§’è¯·æ±‚æ•°é‡å°±50ä¸ªã€‚ç»“æœæ¯æ¬¡ä¸€åˆ° 12:00~13:00ï¼Œæ¯ç§’å¹¶å‘è¯·æ±‚æ•°é‡çªç„¶æš´å¢åˆ°5k+æ¡ã€‚ä½†æ˜¯ç³»ç»Ÿæ˜¯ç›´æ¥åŸºäºMySQLï¼Œå¤§é‡è¯·æ±‚æ¶Œå…¥MySQLï¼Œæ¯ç§’æ‰§è¡Œçº¦5kæ¡SQLï¼Œ</p><p>â€‹    ä¸€èˆ¬æƒ…å†µä¸‹MySQL æ¯ç§’å¯æŠ— 2kè¯·æ±‚ï¼Œ5kçš„è¯·æ±‚å¯èƒ½æ‰“æ­»MySQLï¼Œå¯¼è‡´æ— æ³•ä½¿ç”¨ã€‚</p><p>â€‹    ä¸€æ—¦è¿‡äº†é«˜å³°ï¼Œåˆ°äº†ä¸‹åˆå°±åˆ°äº†ä½å³°æœŸï¼Œæ¯ç§’è¯·æ±‚æ•°é‡ 50 å·¦å³ï¼Œå¯¹æ•´ä¸ªç³»ç»Ÿæ²¡æœ‰å¤šå°‘å‹åŠ›äº†ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/g73yPmI2ANQtGTv.png" title="å‰Šå³°-1" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/g73yPmI2ANQtGTv.png" alt="å‰Šå³°-1"></a></p><p>å¦‚æœä½¿ç”¨MQï¼Œæ¯ç§’ 5k è¯·æ±‚å†™å…¥ MQ , Aç³»ç»Ÿæ¯ç§’æœ€å¤šå¤„ç† 2k ä¸ªè¯·æ±‚ï¼Œå› ä¸º MySQLæ¯ç§’æœ€å¤šè¯·æ±‚ 2k ä¸ªè¯·æ±‚ã€‚Aç³»ç»Ÿä»MQä¸­æ…¢æ…¢æ‹‰å–è¯·æ±‚ï¼Œæ¯ç§’2kä¸ªè¯·æ±‚ï¼Œä¸è¶…è¿‡è‡ªå·±æ¯ç§’æœ€å¤§çš„è¯·æ±‚æ•°é‡å³å¯ã€‚æ‰€ä»¥å†é«˜å³°æœŸï¼ŒAç³»ç»Ÿä¸ä¼šæŒ‚æ‰ã€‚è€ŒMQæ¯ç§’è¿› 5k ï¼Œå‡º 2kï¼Œè¯·æ±‚å°±ä¼šåœ¨é«˜å³°æœŸç§¯å‹å¯èƒ½å¤šå¤§åå‡ ä¸‡ç”šè‡³ç™¾ä¸‡çš„æ¶ˆæ¯å† MQä¸­ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/LR5tQUckPYBvDxO.png" title="å‰Šå³°-2" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/LR5tQUckPYBvDxO.png" alt="å‰Šå³°-2"></a></p><p>â€‹    çŸ­æš‚çš„æŒ¤å‹åæ˜¯å¯å…è®¸çš„ï¼Œç­‰åˆ°é«˜å³°æœŸè¿‡åï¼Œæ¯ç§’è¿›å…¥MQçš„æ¶ˆæ¯é™ä½å¾ˆå¤šï¼Œä½†æ˜¯ç³»ç»Ÿä¾ç„¶æŒ‰ç…§ 2k çš„è¯·æ±‚å–æ¶ˆè´¹ï¼ŒAç³»ç»Ÿå¾ˆå¿«çš„å°±ä¼šæŠŠæŒ¤å‹è§£å†³æ‰äº†ã€‚</p><h2 id="2-MQçš„ä¼˜ç¼ºç‚¹"><a href="#2-MQçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="2.MQçš„ä¼˜ç¼ºç‚¹"></a>2.MQçš„ä¼˜ç¼ºç‚¹</h2><ul><li>é™ä½ç³»ç»Ÿå¯ç”¨æ€§ï¼Œå¼•å‡ºå¦‚ä½•ä¿è¯æ¶ˆæ¯é«˜å¯ç”¨</li><li>ç³»ç»Ÿå¤æ‚åº¦æé«˜ï¼Œå¼•å‡ºå¦‚ä½•ä¿è¯æ¶ˆæ¯æ²¡æœ‰é‡å¤æ¶ˆè´¹ã€å¤„ç†æ¶ˆæ¯ä¸¢å¤±ã€ä¿è¯æ¶ˆæ¯ä¼ é€’é¡ºåºæ€§</li><li>ä¸€è‡´æ€§é—®é¢˜ï¼šAç³»ç»Ÿå¤„ç†å®Œè¿”å›æˆåŠŸï¼ŒBCå¤„ç†å®Œå†™åº“æˆåŠŸï¼ŒDå†™åº“å¤±è´¥äº†ï¼Œæ•°æ®ä¸èƒ½ä¸€è‡´äº†ã€‚</li></ul><h2 id="3-ä¸åŒMQçš„åŒºåˆ«ï¼ˆkafkaã€RabbitMQã€RocketMQï¼‰"><a href="#3-ä¸åŒMQçš„åŒºåˆ«ï¼ˆkafkaã€RabbitMQã€RocketMQï¼‰" class="headerlink" title="3.ä¸åŒMQçš„åŒºåˆ«ï¼ˆkafkaã€RabbitMQã€RocketMQï¼‰"></a>3.ä¸åŒMQçš„åŒºåˆ«ï¼ˆkafkaã€RabbitMQã€RocketMQï¼‰</h2><table><thead><tr><th>ç‰¹æ€§</th><th>ActiveMQ</th><th>RabbitMQ</th><th>RocketMQ</th><th>Kafka</th></tr></thead><tbody><tr><td>å•æœºååé‡</td><td>ä¸‡çº§ï¼Œæ¯” RocketMQã€Kafka ä½ä¸€ä¸ªæ•°é‡çº§</td><td>ä¸‡çº§åˆ«</td><td>10 ä¸‡çº§ï¼Œæ”¯æ’‘é«˜åå</td><td>10 ä¸‡çº§ï¼Œé«˜ååï¼Œä¸€èˆ¬é…åˆå¤§æ•°æ®ç±»çš„ç³»ç»Ÿæ¥è¿›è¡Œå®æ—¶æ•°æ®è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯</td></tr><tr><td>topic æ•°é‡å¯¹ååé‡çš„å½±å“</td><td></td><td></td><td><strong>topic å¯ä»¥è¾¾åˆ°å‡ ç™¾/å‡ åƒçš„çº§åˆ«ï¼Œååé‡ä¼šæœ‰è¾ƒå°å¹…åº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ RocketMQ çš„ä¸€å¤§ä¼˜åŠ¿ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼Œå¯ä»¥æ”¯æ’‘å¤§é‡çš„ topic</strong></td><td>topic ä»å‡ ååˆ°å‡ ç™¾ä¸ªæ—¶å€™ï¼Œååé‡ä¼šå¤§å¹…åº¦ä¸‹é™ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼ŒKafka å°½é‡ä¿è¯ topic æ•°é‡ä¸è¦è¿‡å¤šï¼Œå¦‚æœè¦æ”¯æ’‘å¤§è§„æ¨¡çš„ topicï¼Œéœ€è¦å¢åŠ æ›´å¤šçš„æœºå™¨èµ„æº</td></tr><tr><td>æ—¶æ•ˆæ€§</td><td>ms çº§</td><td><strong>å¾®ç§’çº§ï¼Œè¿™æ˜¯ RabbitMQ çš„ä¸€å¤§ç‰¹ç‚¹ï¼Œå»¶è¿Ÿæœ€ä½</strong></td><td>ms çº§</td><td>å»¶è¿Ÿåœ¨ ms çº§ä»¥å†…</td></tr><tr><td>å¯ç”¨æ€§</td><td>é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨</td><td>åŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨</td><td><strong>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„</strong></td><td>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨</td></tr><tr><td>æ¶ˆæ¯å¯é æ€§</td><td>æœ‰è¾ƒä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®</td><td>åŸºæœ¬ä¸ä¸¢</td><td><strong>ç»è¿‡å‚æ•°ä¼˜åŒ–é…ç½®ï¼Œå¯ä»¥åšåˆ° 0 ä¸¢å¤±</strong></td><td>åŒ RocketMQ</td></tr><tr><td>åŠŸèƒ½æ”¯æŒ</td><td>MQ é¢†åŸŸçš„åŠŸèƒ½æå…¶å®Œå¤‡</td><td>åŸºäº erlang å¼€å‘ï¼Œå¹¶å‘èƒ½åŠ›å¾ˆå¼ºï¼Œæ€§èƒ½æå¥½ï¼Œå»¶æ—¶å¾ˆä½</td><td>MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½</td><td>åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠæ—¥å¿—é‡‡é›†è¢«å¤§è§„æ¨¡ä½¿ç”¨</td></tr></tbody></table><ul><li>å•æœºååé‡ï¼š<strong>RocketMQ</strong> <strong>10ä¸‡çº§</strong></li><li>æ—¶æ•ˆæ€§ï¼š<strong>RabbitMQ</strong> <strong>å¾®ç§’çº§</strong></li><li>å¯ç”¨æ€§ï¼š<strong>RocketMQ</strong> <strong>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„</strong></li><li>æ¶ˆæ¯å¯é æ€§ï¼š<strong>RocketMQ</strong> <strong>å‚æ•°ä¼˜åŒ–ï¼Œå¯ä»¥åšåˆ°0ä¸¢å¤±</strong></li></ul><h2 id="4-ä¿è¯MQçš„é«˜å¯ç”¨"><a href="#4-ä¿è¯MQçš„é«˜å¯ç”¨" class="headerlink" title="4.ä¿è¯MQçš„é«˜å¯ç”¨"></a>4.ä¿è¯MQçš„é«˜å¯ç”¨</h2><h3 id="RabbitMQé«˜å¯æ€§"><a href="#RabbitMQé«˜å¯æ€§" class="headerlink" title="RabbitMQé«˜å¯æ€§"></a>RabbitMQé«˜å¯æ€§</h3><p>â€‹    RabbitMQæ˜¯å…¸å‹çš„åŸºäºä¸»ä»ï¼ˆéåˆ†å¸ƒå¼ï¼‰åšé«˜å¯ç”¨ã€‚</p><p>â€‹    ä¸‰ç§æ¨¡å¼ï¼šå•æœºæ¨¡å¼ã€æ™®é€šé›†ç¾¤æ¨¡å¼ã€é•œåƒé›†ç¾¤æ¨¡å¼</p><h4 id="å•æœºæ¨¡å¼ï¼š"><a href="#å•æœºæ¨¡å¼ï¼š" class="headerlink" title="å•æœºæ¨¡å¼ï¼š"></a>å•æœºæ¨¡å¼ï¼š</h4><p>â€‹    Demoçº§åˆ«ï¼Œæ²¡æœ‰ç”Ÿäº§ä½¿ç”¨è¿™ä¸ª</p><h4 id="æ™®é€šé›†ç¾¤æ¨¡å¼ï¼š-lt-æ— é«˜å¯ç”¨-gt"><a href="#æ™®é€šé›†ç¾¤æ¨¡å¼ï¼š-lt-æ— é«˜å¯ç”¨-gt" class="headerlink" title="æ™®é€šé›†ç¾¤æ¨¡å¼ï¼š&lt;æ— é«˜å¯ç”¨&gt;"></a>æ™®é€šé›†ç¾¤æ¨¡å¼ï¼š&lt;æ— é«˜å¯ç”¨&gt;</h4><p>â€‹    å¤šå°æœºå™¨å¯åŠ¨å¤šä¸ªRabbitMQå®ä¾‹ï¼Œæ¯å°æœºå™¨å¯åŠ¨ä¸€ä¸ªã€‚<strong>åˆ›å»ºçš„queueï¼Œåªä¼šæ”¾åœ¨ä¸€ä¸ªRabbitMQå®ä¾‹ä¸Š</strong>ï¼Œ  ä½†æ¯ä¸ªå®ä¾‹åŒæ­¥ queue å…ƒæ•°æ®ï¼ˆqueueçš„é…ç½®ï¼Œå¯é€šè¿‡è¿™ä¸ªæ‰¾åˆ°queueå®ä¾‹ï¼‰ã€‚å®é™…æ¶ˆè´¹çš„æ—¶å€™è¿æ¥åˆ°å¦ä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹ä»queueæ‰€åœ¨çš„å®ä¾‹æ‹‰å–æ•°æ®ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/WaQZHls739OMVhx.png" title="æ™®é€šé›†ç¾¤" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/WaQZHls739OMVhx.png" alt="æ™®é€šé›†ç¾¤"></a></p><p>â€‹    <strong>æ²¡æœ‰åšåˆ°åˆ†å¸ƒå¼</strong>ï¼Œåªæ˜¯æ™®é€šçš„é›†ç¾¤ã€‚å¯¼è‡´æ¶ˆè´¹è€…æ¯æ¬¡éšæœºè·å–ä¸€ä¸ªå®ä¾‹ç„¶åæ‹‰å–æ•°æ®ï¼Œè¦ä¹ˆæ˜¯å›ºå®šè¿æ¥ queue çš„é‚£ä¸ªå®ä¾‹ï¼Œå‰è€…æœ‰<strong>æ•°æ®æ‹‰å–çš„å¼€é”€</strong>ï¼Œåè€…æœ‰<strong>å•å®ä¾‹æ€§èƒ½å¼€é”€</strong>ã€‚</p><p>â€‹    è¿™æ ·åªæ˜¯<strong>æé«˜äº†ååé‡</strong>ï¼Œé›†ç¾¤å¤šä¸ªèŠ‚ç‚¹æœåŠ¡æŸä¸ª queue çš„è¯»å†™æ“ä½œã€‚</p><h4 id="é•œåƒé›†ç¾¤æ¨¡å¼ï¼š-lt-é«˜å¯ç”¨-gt"><a href="#é•œåƒé›†ç¾¤æ¨¡å¼ï¼š-lt-é«˜å¯ç”¨-gt" class="headerlink" title="é•œåƒé›†ç¾¤æ¨¡å¼ï¼š&lt;é«˜å¯ç”¨&gt;"></a>é•œåƒé›†ç¾¤æ¨¡å¼ï¼š&lt;é«˜å¯ç”¨&gt;</h4><p>â€‹    RabbitMQ çš„é«˜å¯ç”¨æ¨¡å¼ã€‚å’Œæ™®é€šé›†ç¾¤æ¨¡å‹ä¸ä¸€æ ·ï¼Œè¯¥æ¨¡å¼ä¸‹ï¼Œåˆ›å»ºçš„ queueï¼Œæ— è®ºæ˜¯å…ƒæ•°æ®è¿˜æ˜¯ queue é‡Œçš„æ¶ˆæ¯éƒ½ä¼šå­˜åœ¨å¤šä¸ªå®ä¾‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ queue çš„<strong>å®Œæ•´é•œåƒ</strong>ã€‚æ¯æ¬¡å†™æ¶ˆæ¯åˆ° queue æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨<strong>æ¶ˆæ¯åŒæ­¥</strong>åˆ°å¤šä¸ªå®ä¾‹ä¸Š queue ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/ZjqFkB1QHfmIg8R.png" title="RabbitMQ-é«˜å¯ç”¨-é•œåƒé›†ç¾¤" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ZjqFkB1QHfmIg8R.png" alt="RabbitMQ-é«˜å¯ç”¨-é•œåƒé›†ç¾¤"></a></p><h5 id="å¦‚ä½•å¼€å¯é•œåƒé›†ç¾¤æ¨¡å¼ï¼Ÿ"><a href="#å¦‚ä½•å¼€å¯é•œåƒé›†ç¾¤æ¨¡å¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å¯é•œåƒé›†ç¾¤æ¨¡å¼ï¼Ÿ"></a><strong>å¦‚ä½•å¼€å¯é•œåƒé›†ç¾¤æ¨¡å¼</strong>ï¼Ÿ</h5><p>â€‹    åœ¨åå°<strong>æ–°å¢ä¸€ä¸ªç­–ç•¥</strong>ï¼Œè¿™ä¸ªç­–ç•¥å°±æ˜¯é•œåƒé›†ç¾¤æ¨¡å¼çš„ç­–ç•¥ã€‚å¯ä»¥æŒ‡å®šæ•°æ®<strong>åŒæ­¥åˆ°æ‰€æœ‰</strong>èŠ‚ç‚¹ï¼Œä¹Ÿå¯åŒæ­¥åˆ°<strong>æŒ‡å®šæ•°é‡</strong>çš„èŠ‚ç‚¹ï¼Œå†æ¬¡åˆ›å»ºqueue çš„æ—¶å€™ï¼Œåº”ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå°±ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šå»äº†ã€‚<strong>å¥½å¤„åœ¨äº</strong>ï¼Œä½ ä»»ä½•ä¸€ä¸ªæœºå™¨å®•æœºäº†ï¼Œæ²¡äº‹ï¼Œå…¶ä»–èŠ‚ç‚¹æœ‰å®Œæ•´çš„æ•°æ®ï¼Œåˆ«çš„æ¶ˆè´¹è€…éƒ½å¯ä»¥åˆ°å…¶ä»–çš„èŠ‚ç‚¹æ¶ˆè´¹ã€‚<strong>åå¤„æ˜¯</strong>ï¼Œç¬¬ä¸€ï¼Œ<strong>åŒæ­¥æ€§èƒ½å¼€é”€å¤§</strong>ï¼Œç½‘ç»œå¸¦å®½å‹åŠ›å’Œæ¶ˆè€—å¾ˆé‡ã€‚ç¬¬äºŒï¼Œä¸<strong>æ˜¯åˆ†å¸ƒå¼ï¼Œæ²¡æœ‰æ‰©å±•æ€§</strong>ï¼ŒæŸä¸ªqueue è´Ÿè½½å¾ˆé‡ï¼ŒåŠ æœºå™¨ï¼Œæ–°å¢çš„æœºå™¨åŒ…å«è¿™ä¸ª queue çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶<strong>æ²¡æœ‰åŠæ³•çº¿æ€§æ‰©å±•</strong>ã€‚å¦‚æœ queue çš„æ•°é‡å¾ˆå¤§ï¼Œå¤§åˆ°è¿™ä¸ªæœºå™¨ä¸Šçš„å®¹é‡æ— æ³•å®¹çº³è¯¥æ€ä¹ˆåŠï¼Ÿ</p><h3 id="Kafka-çš„é«˜å¯ç”¨æ€§"><a href="#Kafka-çš„é«˜å¯ç”¨æ€§" class="headerlink" title="Kafka çš„é«˜å¯ç”¨æ€§"></a>Kafka çš„é«˜å¯ç”¨æ€§</h3><p>â€‹    Kafka åŸºæœ¬æ¶æ„è®¤è¯†ï¼šç”±å¤šä¸ªbrokerç»„æˆï¼Œæ¯ä¸ªbrokeræ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼›ä½ åˆ›å»ºä¸€ä¸ªtopic ï¼Œè¿™ä¸ªtopicå¯ä»¥åˆ’åˆ†å¤šä¸ªpartitionï¼Œæ¯ä¸ª partition å¯ä»¥å­˜åœ¨ä¸åŒçš„ broker ä¸Šï¼Œæ¯ä¸ªpartition å°±æ”¾ä¸€éƒ¨åˆ†çš„æ•°æ®ã€‚</p><p>â€‹    å¤©ç„¶çš„åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€ä¸ªtopic çš„æ•°æ®ï¼Œ<strong>åˆ†æ•£åˆ°å¤šä¸ªæœºå™¨ä¸Šï¼Œæ¯ä¸ªæœºå™¨æ”¾ä¸€éƒ¨åˆ†</strong>ã€‚</p><p>â€‹    RabbitMQ ä¹‹ç±»çš„å¹¶ä¸æ˜¯ä»€ä¹ˆåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¼ ç»Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåªä¸è¿‡æä¾›äº†é›†ç¾¤ã€HAçš„æœºåˆ¶ï¼Œæ— è®ºå¦‚ä½•æ“ä½œï¼ŒRabbitMQ ä¸€ä¸ª queue çš„æ•°æ®éƒ½æ˜¯æ”¾åœ¨ä¸€ä¸ªèŠ‚ç‚¹é‡Œçš„ï¼Œé•œåƒé›†ç¾¤æ¨¡å¼ä¸‹ï¼Œä¹Ÿæ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½æ”¾ queue çš„å®Œæ•´æ•°æ®ã€‚</p><p>â€‹    Kafka 0.8 ä¹‹å‰æ²¡æœ‰ HA æœºåˆ¶ï¼Œä»»ä½•çš„ broker æŒ‚äº†ï¼Œé‚£ä¸ª broker ä¸Šçš„ partition å°±åºŸäº†ï¼Œå°±æ²¡æœ‰åŠæ³•è¯»å†™ï¼Œæ— æ³•ä¿è¯é«˜å¯ç”¨ã€‚</p><p>â€‹    æˆ‘ä»¬å‡å¦‚åˆ›å»ºä¸€ä¸ª topic ï¼ŒæŒ‡å®šäº†å…¶ partition æ•°é‡æ˜¯ 3 ä¸ª ï¼Œåˆ†åˆ«åœ¨ä¸‰å°æœºå™¨ä¸Šã€‚ä½†æ˜¯ï¼Œå¦‚æœç¬¬äºŒå°å®•æœºäº†ï¼Œä¼šå¯¼è‡´1/3çš„æ•°æ®ä¸¢å¤±ï¼Œåšä¸åˆ°é«˜å¯ç”¨äº†ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/UznQuRP8tSAhKCa.png" title="Kafka-é«˜å¯ç”¨" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/UznQuRP8tSAhKCa.png" alt="Kafka-é«˜å¯ç”¨"></a></p><p>Kafka 0.8 åæä¾›äº† HA æœºåˆ¶ï¼Œå°±æ˜¯ <strong>replica å‰¯æœ¬æœºåˆ¶</strong>ã€‚æ¯ä¸ª partition çš„æ•°æ®éƒ½ä¼šåŒæ­¥åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œå½¢æˆå¤šä¸ª replica å‰¯æœ¬ã€‚æ‰€æœ‰ replica ä¸­é€‰ä¸¾ä¸€ä¸ª leader å‡ºæ¥ï¼Œé‚£ä¹ˆç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½è·Ÿè¿™ä¸ª <strong>leader æ‰“äº¤é“</strong>ï¼Œå…¶ä»–çš„ replica å°±æ˜¯ follower (ä»å±ï¼‰ã€‚<br>å†™çš„æ—¶å€™ï¼Œleader è´Ÿè´£å°†<strong>æ•°æ®åŒæ­¥åˆ°å…¶ä»–çš„ follower</strong> ä¸Šï¼Œè¯»çš„æ—¶å€™ï¼Œç›´æ¥è¯»å– leader ä¸Šçš„æ•°æ®ã€‚</p><h4 id="ä¸ºä»€ä¹ˆåªèƒ½è¯»å†™leader"><a href="#ä¸ºä»€ä¹ˆåªèƒ½è¯»å†™leader" class="headerlink" title="ä¸ºä»€ä¹ˆåªèƒ½è¯»å†™leader?"></a>ä¸ºä»€ä¹ˆåªèƒ½è¯»å†™leader?</h4><p>â€‹    å¦‚æœå¯ä»¥éšæ„è¯»å–çš„æ¯ä¸ª follower ï¼Œé‚£ä¹ˆå°±è¦å…³ç³»æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜äº†ï¼Œç³»ç»Ÿå¤æ‚åº¦åŠ¿å¿…å¢åŠ ã€‚Kafka ä¼šå°†ä¸€ä¸ª partition çš„æ‰€æœ‰ replica åˆ†å¸ƒåœ¨ä¸åŒçš„æœºå™¨ä¸­ï¼Œå¯ä»¥æé«˜å®¹é”™æ€§ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/VhoSM2is9LQFeUE.png" title="broker" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/VhoSM2is9LQFeUE.png" alt="broker"></a></p><p>â€‹    è¿™å°±æ˜¯æ‰€è°“çš„<strong>é«˜å¯ç”¨</strong>ï¼Œå› ä¸ºå¦‚æœæŸä¸ª broker å®•æœºäº†ï¼Œæ²¡äº‹ï¼Œé‚£ä¹ˆ broker ä¸Šé¢çš„ partition åœ¨å…¶ä»–æœºå™¨ä¸Šéƒ½æœ‰å‰¯æœ¬çš„ã€‚å¦‚æœè¿™ä¸ªå®•æœºçš„ broker ä¸Šé¢ç”±æŸä¸ª partition çš„ leader ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šä» follower ä¸­<strong>é‡æ–°é€‰ä¸¾</strong>ä¸€ä¸ªæ–°çš„ leader å‡ºæ¥ï¼Œç»§ç»­è¯»å†™è¿™ä¸ª leader å³å¯ã€‚</p><p>â€‹    <strong>å†™æ•°æ®</strong>çš„æ—¶å€™ï¼Œç”Ÿäº§è€…å°±å†™ leader ,ç„¶å leader å°†æ•°æ®è½åœ°åˆ°å†™æœ¬åœ°ç£ç›˜ï¼Œæ¥ç€å…¶ä»– follower è‡ªå·±ä¸»åŠ¨ä» leader æ¥ pull æ•°æ®ã€‚ä¸€æ—¦æ‰€æœ‰ follower åŒæ­¥å¥½æ•°æ®ï¼Œå°±ä¼šå‘é€ ack ç»™ leaderï¼Œleader æ”¶åˆ°æ‰€æœ‰ follower çš„ ack ä¹‹åï¼Œå°±ä¼šè¿”å›å†™æˆåŠŸæ¶ˆæ¯ç»™ç”Ÿäº§è€…ï¼ˆä¸€ç§æ¨¡å¼ä¹‹ä¸€ï¼‰ã€‚</p><p>â€‹    <strong>æ¶ˆè´¹çš„æ—¶å€™</strong>ï¼Œåªä¼šä» leader å»è¯»ï¼Œä½†æ˜¯åªæœ‰å½“ä¸€ä¸ªæ¶ˆè´¹å·²ç»è¢«æ‰€æœ‰ follower éƒ½åŒæ­¥æˆåŠŸè¿”å› ack åï¼Œè¿™ä¸ªæ¶ˆæ¯æ‰ä¼šè¢«æ¶ˆè´¹è€…è¯»åˆ°ã€‚ </p><h2 id="5-ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹ï¼ˆæ¶ˆè´¹é˜Ÿåˆ—ä¿è¯å¹‚ç­‰æ€§ï¼‰"><a href="#5-ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹ï¼ˆæ¶ˆè´¹é˜Ÿåˆ—ä¿è¯å¹‚ç­‰æ€§ï¼‰" class="headerlink" title="5.ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹ï¼ˆæ¶ˆè´¹é˜Ÿåˆ—ä¿è¯å¹‚ç­‰æ€§ï¼‰"></a>5.ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹ï¼ˆæ¶ˆè´¹é˜Ÿåˆ—ä¿è¯å¹‚ç­‰æ€§ï¼‰</h2><p><strong>å¤§æ¦‚è¯´ä¸€è¯´å¯èƒ½å“ªäº›é‡å¤æ¶ˆæ¯çš„é—®é¢˜</strong></p><p>RabbitMQã€RocketMQã€Kafka éƒ½å¯èƒ½å‡ºç°æ¶ˆæ¯é‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚</p><p>â€‹    Kafka å®é™…ä¸Šæœ‰ä¸ª <strong>offset</strong> çš„æ¦‚å¿µï¼Œæ¯ä¸ªæ¶ˆæ¯å†™è¿›å»ï¼Œéƒ½æœ‰ä¸€ä¸ª offset ï¼Œä»£è¡¨<strong>æ¶ˆæ¯çš„åºå·</strong>ï¼Œç„¶å consumer æ¶ˆè´¹äº†æ•°æ®ä¹‹åï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆ<strong>å®šæ—¶å®šæœŸ</strong>ï¼‰ï¼Œä¼šæŠŠè‡ªå·±æ¶ˆè´¹è¿‡çš„æ¶ˆ<strong>æ¯çš„ offset æäº¤</strong>ä¸€ä¸‹ï¼Œè¡¨ç¤º â€œæˆ‘æ¶ˆè´¹è¿‡æ¥ï¼Œä¸‹æ¬¡æˆ‘è¦é‡å¯ï¼Œå°±è®©æˆ‘ç»§ç»­ä»ä¸Šæ¬¡æ¶ˆè´¹çš„ offset æ¥ç»§ç»­æ¶ˆè´¹å§â€ã€‚</p><p>â€‹    å¦‚æœç”Ÿäº§é‡å¯ç³»ç»Ÿï¼Œç´§æ€¥æƒ…å†µç›´æ¥ kill è¿›ç¨‹ï¼Œå¯èƒ½å¯¼è‡´ consumer ç”±æ¶ˆæ¯å¤„ç†ï¼Œä½†æ˜¯æ²¡æœ‰æ¥çš„åŠæäº¤ offset ã€‚é‡å¯ä¹‹åå°‘æ•°æ¶ˆè´¹ä¼šå†æ¬¡æ¶ˆè´¹ä¸€æ¬¡ã€‚</p><p>â€‹    ä¸¾ä¸ªä¾‹å­ã€‚</p><p>â€‹    åœºæ™¯å¸¦å…¥ï¼Œæ•°æ® 1/2/3 ä¾æ¬¡è¿›å…¥ Kafkaï¼ŒKafka ä¼šç»™è¿™ä¸‰æ¡æ•°æ®æ¯æ¡åˆ†é…ä¸€ä¸ª offset ï¼Œä»£è¡¨è¿™æ¡æ•°æ®çš„åºå·ï¼Œæˆ‘ä»¬å°±å‡è®¾åˆ†é…çš„ offset ä¾æ¬¡æ˜¯ 152/ 153 /154 ã€‚æ¶ˆè´¹ä» Kafka å»æ¶ˆè´¹çš„æ—¶å€™ä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªé¡ºåºã€‚å‡å¦‚æ¶ˆè´¹è€…æ¶ˆè´¹äº† offset= 153 è¿™ä¸ªæ•°æ®ï¼Œåˆšå‡†å¤‡æäº¤ offset åˆ° Zookeeper ï¼Œæ­¤æ—¶æ¶ˆè´¹è€…è¿›ç¨‹è¢«é‡å¯ã€‚æ­¤æ—¶æ¶ˆè´¹è¿‡çš„æ•°æ® 1/2 çš„offset æ²¡æœ‰æäº¤ï¼ŒKafka ä¹Ÿå°±ä¸çŸ¥é“ä½ æ¶ˆè´¹ offset = 153 è¿™æ¡æ•°æ®ã€‚é‡å¯ä¹‹åï¼Œæ¶ˆè´¹è€…æ‰¾ Kafka è¯´ï¼Œå“¥ä»¬ï¼Œä½ ç»™æˆ‘æŠŠä¸Šæ¬¡æˆ‘æ¶ˆè´¹çš„çš„åœ°æ–¹åé¢çš„æ•°æ®ç»§ç»­ä¼ ç»™æˆ‘ã€‚ç”±äºæ²¡æœ‰æäº¤ 1/2 æ•°æ®å†æ¬¡ä¼ è¿‡æ¥ï¼Œå¦‚æœæ¶ˆè´¹è€…æ²¡æœ‰å»é‡çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æ¶ˆè´¹é‡å¤ã€‚</p><p>æ³¨æ„ï¼šæ–°ç‰ˆæœ¬çš„ Kafka å·²ç»å°† <code>offset</code> å­˜å‚¨åˆ° Zookeeper è½¬ç§»åˆ° <code>Kafka brokers</code>ï¼Œå¹¶ä½¿ç”¨å†…éƒ¨ä½ç§»æ³¨æ„ <code>__consumer_offsets</code> è¿›è¡Œå­˜å‚¨ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/rqz6MyBsH1jE2UR.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/rqz6MyBsH1jE2UR.png"></a></p><p>ç»“æœå°±ä¼šå¯¼è‡´æ•°æ® 1/2 å¾€æ•°æ®æ’å…¥2 æ¬¡ï¼Œé‚£ä¹ˆæ•°æ®å°±é”™äº†ã€‚é‡å¤æ¶ˆè´¹ä¸å¯æ€•ï¼Œå¯æ€•æ²¡æœ‰è€ƒè™‘é‡å¤æ¶ˆè´¹ä¹‹åï¼Œ<strong>æ€ä¹ˆä¿è¯å¹‚ç­‰æ€§ã€‚</strong></p><p>â€‹    ä¸¾ä¾‹è¯´æ˜ã€‚å‡å¦‚æœ‰ä¸ªç³»ç»Ÿï¼Œæ¶ˆè´¹ä¸€æ¡æ¶ˆæ¯å°±æ˜¯å¾€æ•°æ®åº“æ’å…¥ä¸€æ¡æ•°æ®ï¼Œè¦æ˜¯ä½ æ¶ˆæ¯é‡å¤ä¸¤æ¬¡ï¼Œå°±æ’å…¥äº†ä¸¤æ¡ï¼Œæ•°æ®å°±æ˜¯é”™äº†ã€‚ä½†æ˜¯ä½ æ¶ˆè´¹åˆ°ç¬¬äºŒæ¬¡çš„æ—¶å€™ï¼Œ<strong>åˆ¤æ–­æ˜¯å¦æ¶ˆè´¹è¿‡äº†</strong>ï¼Œè‹¥æ˜¯å°±ç›´æ¥ä¸¢äº†ï¼Œè¿™æ ·å°±ä¿è¯äº†ä¸€æ¡æ•°æ®äº†ã€‚</p><p>â€‹    ä¸€æ¡æ•°æ®é‡å¤å‡ºç°ä¸¤æ¬¡ï¼Œæ•°æ®åº“åªæœ‰ä¸€æ¡æ•°æ®ï¼Œè¿™å°±ä¿è¯äº†ç³»ç»Ÿçš„å¹‚ç­‰æ€§ã€‚</p><p>â€‹    å¹‚ç­‰æ€§ï¼šå°±æ˜¯ä¸€ä¸ªæ•°æ®ï¼Œæˆ–è€…ä¸€ä¸ªè¯·æ±‚ï¼Œç»™ä½ é‡å¤æ¥å¤šæ¬¡ï¼Œä½ çš„ç¡®ä¿å¯¹åº”çš„æ•°æ®æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œ<strong>ä¸èƒ½å‡ºé”™ã€‚</strong></p><h4 id="å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ"></a>å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ</h4><p>â€‹    ç»“åˆä¸šåŠ¡æ€è€ƒï¼Œæ€è·¯ï¼š</p><ul><li><p>å¦‚æœæ˜¯å†™åº“ï¼Œæ ¹æ®<strong>ä¸»é”®æŸ¥ä¸€ä¸‹</strong>ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®æœ‰äº†ï¼Œå°±update </p></li><li><p><strong>å†™ Redis</strong>ï¼Œæ¯æ¬¡éƒ½æ˜¯ set ï¼Œå¤©ç„¶å¹‚ç­‰æ€§ ã€‚å½“æ•°æ®1 æ¶ˆè´¹ä¹‹åï¼Œå­˜å…¥Redis ï¼Œå†æ¬¡æ¶ˆè´¹åå°†ä¿®æ”¹æ•°æ®1çš„å€¼</p></li><li><p>å¤æ‚ä¸€ç‚¹ï¼Œç”Ÿäº§è€…å‘é€æ¯æ¡æ¶ˆæ¯æ•°æ®çš„æ—¶å€™ï¼Œé‡Œé¢å‡å¦‚ä¸€ä¸ª<strong>å…¨å±€çš„å”¯ä¸€id</strong>ï¼Œç±»ä¼¼è®¢å•idï¼Œç„¶åæ¶ˆè´¹ä¹‹åï¼Œå…ˆæ ¹æ®è¿™ä¸ª id å»æ¯”å¦‚ Redis é‡Œå»æŸ¥ï¼Œä¹‹å‰çš„æ¶ˆè´¹è¿‡å—ï¼Ÿå¦‚æœæ²¡æœ‰æ¶ˆè´¹è¿‡ï¼Œä½ å°±å¤„ç†ï¼Œç„¶åè¿™ä¸ªidå†™ Redisã€‚å¦‚æœæ¶ˆè´¹ï¼Œé‚£å°±åˆ«å¤„ç†ï¼Œä¿é‡åˆ«é‡å¤å¤„ç†ç›¸åŒçš„æ¶ˆæ¯å³å¯ã€‚</p></li><li><p>åŸºäºæ•°æ®åº“çš„<strong>å”¯ä¸€é”®</strong>æ¥ä¿è¯é‡å¤æ•°æ®ä¸ä¼šé‡å¤æ’å…¥å¤šæ¡ã€‚å› ä¸ºæœ‰å”¯ä¸€é”®çº¦æŸï¼Œé‡å¤æ•°æ®æ’å…¥åªä¼šæŠ¥é”™ï¼Œä¸ä¼šå¯¼è‡´æ•°æ®åº“ä¸­å‡ºç°è„æ•°æ®ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/y4BC9rMukdGE7cQ.png" title="å¹‚ç­‰æ€§" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/y4BC9rMukdGE7cQ.png" alt="å¹‚ç­‰æ€§"></a></p></li></ul><h2 id="6-ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ä¼ è¾“ï¼Ÿä¿è¯æ¶ˆè´¹ä¸ä¸¢å¤±"><a href="#6-ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ä¼ è¾“ï¼Ÿä¿è¯æ¶ˆè´¹ä¸ä¸¢å¤±" class="headerlink" title="6.ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ä¼ è¾“ï¼Ÿä¿è¯æ¶ˆè´¹ä¸ä¸¢å¤±"></a>6.ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ä¼ è¾“ï¼Ÿä¿è¯æ¶ˆè´¹ä¸ä¸¢å¤±</h2><p>â€‹    MQçš„åŸºæœ¬åŸåˆ™ï¼Œ<strong>æ•°æ®ä¸èƒ½å¤šä¸€æ¡ï¼Œä¹Ÿä¸èƒ½å°‘ä¸€æ¡</strong>ï¼Œä¸èƒ½å¤šï¼Œå°±æ˜¯ä¸Šé¢è¯´çš„ é‡å¤æ¶ˆè´¹å’Œå¹‚ç­‰æ€§çš„é—®é¢˜ã€‚ä¸èƒ½å°‘ã€‚å°±æ˜¯æ•°æ®åˆ«å¼„ä¸¢ã€‚</p><p>â€‹    å¦‚æœç”¨MQæ¥ä¼ é€’éå¸¸æ ¸å¿ƒçš„è‚–ï¼Œå¦‚è®¡è´¹ã€æ‰£è´¹ï¼Œå°±éœ€è¦ä¿è¯ MQ <strong>ç»å¯¹ä¸ä¼šæŠŠè®¡è´¹æ¶ˆæ¯ç»™å¼„ä¸¢</strong></p><h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><p><a href="https://s2.loli.net/2024/12/20/b5TLjxft9I3dQs8.png" title="æ¶ˆæ¯å¯é æ€§" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/b5TLjxft9I3dQs8.png" alt="æ¶ˆæ¯å¯é æ€§"></a></p><h4 id="ç”Ÿäº§è€…å¼„ä¸¢äº†æ•°æ®"><a href="#ç”Ÿäº§è€…å¼„ä¸¢äº†æ•°æ®" class="headerlink" title="ç”Ÿäº§è€…å¼„ä¸¢äº†æ•°æ®"></a>ç”Ÿäº§è€…å¼„ä¸¢äº†æ•°æ®</h4><p>â€‹    ç”Ÿäº§è€…å°†æ•°æ®å‘é€åˆ° RabbitMQ ï¼Œå¯èƒ½åœ¨åŠè·¯å¼„ä¸¢äº†ï¼Œå› ä¸ºç½‘ç»œè·å–å…¶ä»–é—®é¢˜ã€‚</p><h5 id="äº‹åŠ¡æœºåˆ¶â€“æ¶ˆè€—æ€§èƒ½ï¼š"><a href="#äº‹åŠ¡æœºåˆ¶â€“æ¶ˆè€—æ€§èƒ½ï¼š" class="headerlink" title="äº‹åŠ¡æœºåˆ¶â€“æ¶ˆè€—æ€§èƒ½ï¼š"></a>äº‹åŠ¡æœºåˆ¶â€“æ¶ˆè€—æ€§èƒ½ï¼š</h5><p>â€‹    é€‰æ‹© RabbitMQ æä¾›çš„<strong>äº‹åŠ¡åŠŸèƒ½</strong>ï¼Œå°±æ˜¯ç”Ÿäº§è€…<strong>å‘é€æ•°æ®ä¹‹å‰</strong>å¼€å¯ RabbitMQäº‹åŠ¡ <code>channel.txSelect()</code> ï¼Œç„¶åå‘é€æ¶ˆæ¯ï¼Œå¦‚æœæ¶ˆæ¯æ²¡æœ‰æˆåŠŸè¢« RabbitMQ æ¥æ”¶ï¼Œé‚£ä¹ˆç”Ÿäº§è€…ä¼šæ”¶åˆ°å¼‚å¸¸æŠ¥é”™çš„æ¶ˆæ¯ï¼Œæ­¤æ—¶å¯ä»¥å›æ»šäº‹åŠ¡ <code>channel.txRollback()</code>ï¼Œç„¶åé‡è¯•å‘é€æ¶ˆæ¯ï¼›å¦‚æœæ”¶åˆ°æ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥æäº¤äº‹åŠ¡äº† <code>channel.txCommit()</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// é€šè¿‡å·¥å‚åˆ›å»ºè¿æ¥</span>    connection <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è·å–é€šé“</span>    channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å¼€å¯äº‹åŠ¡</span>    channel<span class="token punctuation">.</span><span class="token function">txSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¿™é‡Œå‘é€æ¶ˆæ¯</span>    channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span>exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span><span class="token constant">PERSISTENT_TEXT_PLAIN</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ¨¡æ‹Ÿå‡ºç°å¼‚å¸¸</span>    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// æäº¤äº‹åŠ¡</span>    channel<span class="token punctuation">.</span><span class="token function">txCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">TimeoutException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ•æ‰å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡</span>    channel<span class="token punctuation">.</span><span class="token function">txRollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é—®é¢˜æ˜¯ï¼ŒRabbitMQ äº‹åŠ¡æœºåˆ¶ï¼Œå¯¼è‡´ååé‡ä¸‹æ¥ï¼Œå› ä¸ºæ¶ˆè€—æ€§èƒ½ã€‚</p><h5 id="confirm-æ¨¡å¼ï¼š"><a href="#confirm-æ¨¡å¼ï¼š" class="headerlink" title="confirm æ¨¡å¼ï¼š"></a>confirm æ¨¡å¼ï¼š</h5><p>â€‹    å¦‚æœè¦ä¿è¯ RabbitMQ æ¶ˆæ¯ä¸ä¸¢ï¼Œå¯ä»¥å¼€å¯ <code>confirm</code> æ¨¡å¼ï¼Œä½ æ¯æ¬¡äº›çš„<strong>æ¶ˆæ¯éƒ½ä¼šåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„id</strong>ã€‚<br>â€‹    å¦‚æœå†™å…¥äº† RabbitMQ ä¸­ï¼ŒRabbitMQ ä¼šç»™ä½ å›ä¼ ä¸€ä¸ª <code>ack</code> æ¶ˆæ¯ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªæ¶ˆæ¯ ok äº†ã€‚å¦‚æœ RabbitMQ æ²¡èƒ½å¤„ç†è¿™ä¸ªæ¶ˆæ¯ï¼Œä¼šå›è°ƒä½ ä¸€ä¸ª <code>nack</code> æ¥å£ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªæ¶ˆæ¯æ¥æ”¶å¤±è´¥äº†ï¼Œä½ å¯ä»¥é‡è¯•ã€‚è€Œä¸”ä½ å¯ä»¥ç»“åˆè¿™ä¸ªæœºåˆ¶è‡ªå·±åœ¨<strong>å†…å­˜é‡Œç»´æŠ¤æ¯ä¸ªæ¶ˆæ¯ id çŠ¶æ€</strong>ï¼Œå¦‚æœè¶…è¿‡ä¸€å®šæ—¶é—´è¿˜æ²¡æœ‰æ¥æ”¶è¿™ä¸ªæ¶ˆæ¯çš„å›è°ƒï¼Œé‚£ä¸ªå¯ä»¥é‡å‘ã€‚</p><p>â€‹    äº‹åŠ¡æœºåˆ¶å’Œ <code>confirm</code> æœºåˆ¶æœ€å¤§ä¸åŒåœ¨äºï¼Œ<strong>äº‹åŠ¡æœºåˆ¶æ˜¯åŒæ­¥çš„</strong>ï¼Œä½ æäº¤ä¸€ä¸ªäº‹åŠ¡ä¹‹åä¼š<strong>é˜»å¡</strong>ï¼Œä½†æ˜¯ <code>confirm</code> æœºåˆ¶æ˜¯<strong>å¼‚æ­¥</strong>çš„ï¼Œå‘é€æ¶ˆæ¯ä¹‹åå°±å¯ä»¥å‘é€ä¸‹ä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åé‚£ä¸ªæ¶ˆæ¯ RabbitMQ æ¥æ”¶äº†ä¹‹åä¼š<strong>å¼‚æ­¥å›è°ƒ</strong>ä¸€ä¸ªæ¥å£é€šçŸ¥ä½ è¿™ä¸ªæ¶ˆæ¯æ¥æ”¶åˆ°äº†ã€‚</p><p>â€‹    æ‰€ä»¥ç”Ÿäº§è€… <strong>é¿å…ä¸¢å¤±æ•°æ®</strong>ï¼Œéƒ½æ˜¯ç”¨ <code>confirm</code> æœºåˆ¶çš„</p><blockquote><p>åœ¨ transaction äº‹åŠ¡æ¨¡å¼çš„channel ä¸èƒ½è®¾ç½®æˆ confirm æ¨¡å¼çš„ï¼Œè¿™ä¸¤ç§ä¸å…±å­˜</p></blockquote><p>å®¢æˆ·ç«¯å®ç°ç”Ÿäº§è€… <code>confirm</code> ä¸‰ç§æ–¹å¼ï¼š</p><ol><li><p><strong>æ™®é€š confirm æ¨¡å¼</strong>ï¼šæ¯å‘é€ä¸€æ¡æ¶ˆæ¯åï¼Œè°ƒç”¨ <code>waitForConfirms()</code> æ–¹æ³•ï¼Œç­‰å¾…æœåŠ¡å™¨ç«¯ confirmï¼Œå¦‚æœæœåŠ¡ç«¯è¿”å› false æˆ–è€…åœ¨ä¸€æ®µæ—¶é—´å†…éƒ½æ²¡è¿”å›ï¼Œå®¢æˆ·ç«¯å¯ä»¥è¿›è¡Œæ¶ˆæ¯é‡å‘ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>exchangeName<span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>routingKey<span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span><span class="token constant">PERSISTENT_TEXT_PLAIN</span><span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>msg_10B<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>channel<span class="token punctuation">.</span><span class="token function">waitForConfirms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ¶ˆæ¯å‘é€å¤±è´¥</span>    <span class="token comment">// ...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ‰¹é‡ confirm æ¨¡å¼</strong>ï¼šæ¯å‘é€ä¸€æ‰¹æ¶ˆæ¯åï¼Œè°ƒç”¨ <code>waitForConfirms()</code> æ–¹æ³•ï¼Œç­‰å¾…æœåŠ¡ç«¯ confirmã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">channel<span class="token punctuation">.</span><span class="token function">confirmSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> batchCount<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>exchangeName<span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>routingKey<span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span><span class="token constant">PERSISTENT_TEXT_PLAIN</span><span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>msg_10B<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>channel<span class="token punctuation">.</span><span class="token function">waitForConfirms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ¶ˆæ¯å‘é€å¤±è´¥</span>    <span class="token comment">// ...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>å¼‚æ­¥ confirm æ¨¡å¼</strong>ï¼šæä¾›ä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼ŒæœåŠ¡ç«¯ confirm äº†ä¸€æ¡æˆ–è€…å¤šæ¡æ¶ˆæ¯åå®¢æˆ·ç«¯ä¼šå›è°ƒè¿™ä¸ªæ–¹æ³•ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">SortedSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">></span></span> confirmSet <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedSortedSet</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">confirmSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">addConfirmListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ConfirmListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleAck</span><span class="token punctuation">(</span><span class="token keyword">long</span> deliveryTag<span class="token punctuation">,</span> <span class="token keyword">boolean</span> multiple<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>multiple<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            confirmSet<span class="token punctuation">.</span><span class="token function">headSet</span><span class="token punctuation">(</span>deliveryTag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            confirmSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleNack</span><span class="token punctuation">(</span><span class="token keyword">long</span> deliveryTag<span class="token punctuation">,</span> <span class="token keyword">boolean</span> multiple<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Nack, SeqNo: "</span> <span class="token operator">+</span> deliveryTag <span class="token operator">+</span> <span class="token string">", multiple: "</span> <span class="token operator">+</span> multiple<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>multiple<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            confirmSet<span class="token punctuation">.</span><span class="token function">headSet</span><span class="token punctuation">(</span>deliveryTag <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            confirmSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">long</span> nextSeqNo <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">getNextPublishSeqNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>exchangeName<span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>routingKey<span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span><span class="token constant">PERSISTENT_TEXT_PLAIN</span><span class="token punctuation">,</span> <span class="token class-name">ConfirmConfig</span><span class="token punctuation">.</span>msg_10B<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    confirmSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nextSeqNo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h4 id="RabbitMQ-å¼„ä¸¢äº†æ•°æ®"><a href="#RabbitMQ-å¼„ä¸¢äº†æ•°æ®" class="headerlink" title="RabbitMQ å¼„ä¸¢äº†æ•°æ®"></a>RabbitMQ å¼„ä¸¢äº†æ•°æ®</h4><p><strong>å¼€å¯ RabbitMQçš„æŒä¹…åŒ–</strong>ï¼Œæ¶ˆæ¯å†™å…¥ä¹‹åä¼šæŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒæŒ‚åæ¢å¤ä¼š<strong>è‡ªåŠ¨è¯»å–ä¹‹å‰å­˜å‚¨çš„æ•°æ®</strong>ï¼Œä¸€èˆ¬æ•°æ®ä¸ä¼šä¸¢ã€‚å°æ¦‚ç‡æƒ…å†µï¼ŒRabbitMQè¿˜æ²¡æœ‰æŒä¹…åŒ–ï¼Œå°±æŒ‚äº†ï¼Œ<strong>å¯èƒ½å¯¼è‡´å°‘é‡æ•°æ®ä¸¢å¤±</strong>ã€‚</p><h5 id="è®¾ç½®æŒä¹…åŒ–ï¼š"><a href="#è®¾ç½®æŒä¹…åŒ–ï¼š" class="headerlink" title="è®¾ç½®æŒä¹…åŒ–ï¼š"></a>è®¾ç½®æŒä¹…åŒ–ï¼š</h5><ul><li><strong>åˆ›å»º queue æ—¶å€™è®¾ç½®ä¸ºæŒä¹…åŒ–</strong>ã€‚å¯ä»¥ä¿è¯ RabbitMQ <strong>æŒä¹…åŒ– queue çš„å…ƒæ•°æ®</strong>ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸ä¼šæŒä¹…åŒ– queue é‡Œçš„æ•°æ®çš„</li><li>ç¬¬äºŒä¸ªæ˜¯å‘é€æ¶ˆæ¯çš„æ—¶å€™å°†æ¶ˆæ¯çš„ <strong><code>deliveryMode</code> è®¾ç½®ä¸º2</strong>ã€‚å°±æ˜¯<strong>å°†æ¶ˆæ¯è®¾ç½®ä¸ºæŒä¹…åŒ–çš„</strong>ï¼Œæ­¤æ—¶RMQ å°±ä¼šå°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šäº†ã€‚</li></ul><p>å¿…é¡»åŒæ—¶è®¾ç½®è¿™ä¸ªä¸¤ä¸ªæŒä¹…åŒ–æ‰è¡Œï¼ŒRMQ å“ªæ€•æŒ‚äº†ï¼Œå†æ¬¡é‡å¯ï¼Œä¹Ÿä¼šç£ç›˜ä¸Šé‡å¯æ¢å¤ queueï¼Œæ¢å¤è¿™ä¸ª queue é‡Œçš„æ•°æ®ã€‚</p><p>æ³¨æ„ï¼Œå“ªæ€•æ˜¯å¼€å¯æŒä¹…åŒ–æœºåˆ¶äº†ï¼Œä¹Ÿæœ‰å¯èƒ½ï¼Œåœ¨æ¶ˆæ¯å†™åˆ° RMQä¸­ï¼Œè¿˜æ²¡æœ‰æ¥çš„æœºæŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œç»“æœä¸å·§ï¼Œæ­¤æ—¶çš„ RMQ æŒ‚äº†ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜é‡Œçš„çš„ä¸€ç‚¹ç‚¹æ•°æ®ä¸¢å¤±ã€‚</p><p>æ‰€ä»¥ï¼ŒæŒä¹…åŒ–å¯ä»¥è·Ÿç”Ÿäº§è€…é‚£è¾¹çš„ <code>confirm</code> æœºåˆ¶é…åˆï¼Œåªæœ‰æ¶ˆæ¯è¢«æŒä¹…åŒ–åˆ°ç£ç›˜åï¼Œæ‰ä¼šé€šçŸ¥ç”Ÿäº§è€… <code>ack</code> äº†ï¼Œå“ªæ€• æŒä¹…åŒ–åˆ°ç£ç›˜ä¹‹å‰ï¼ŒRMQ æŒ‚äº†ï¼Œæ•°æ®ä¸¢äº†ï¼Œç”Ÿäº§è€…æ”¶ä¸åˆ° <code>ack</code> ï¼Œè‡ªå·±ä¹Ÿå¯ä»¥é‡å‘ã€‚</p><h4 id="æ¶ˆè´¹è€…å¼„ä¸¢äº†æ•°æ®ï¼š-lt-å…³é—­è‡ªåŠ¨-ackï¼Œå£°æ˜é˜Ÿåˆ—ï¼ŒæŒ‡å®šnoAck-false-gt"><a href="#æ¶ˆè´¹è€…å¼„ä¸¢äº†æ•°æ®ï¼š-lt-å…³é—­è‡ªåŠ¨-ackï¼Œå£°æ˜é˜Ÿåˆ—ï¼ŒæŒ‡å®šnoAck-false-gt" class="headerlink" title="æ¶ˆè´¹è€…å¼„ä¸¢äº†æ•°æ®ï¼š&lt;å…³é—­è‡ªåŠ¨ ackï¼Œå£°æ˜é˜Ÿåˆ—ï¼ŒæŒ‡å®šnoAck = false&gt;"></a>æ¶ˆè´¹è€…å¼„ä¸¢äº†æ•°æ®ï¼š&lt;å…³é—­è‡ªåŠ¨ ackï¼Œå£°æ˜é˜Ÿåˆ—ï¼ŒæŒ‡å®šnoAck = false&gt;</h4><p>RabbitMQ å¦‚æœä¸¢å¤±æ¶ˆæ¯ï¼Œä¸»è¦æ˜¯å› ä¸ºä½ æ¶ˆè´¹çš„æ—¶å€™ï¼Œåˆšæ¶ˆè´¹ï¼Œè¿˜æ²¡å»å¤„ç†ï¼Œç»“æœè¿›ç¨‹æŒ‚äº†ã€‚é‡å¯å®Œåï¼ŒRMQè®¤ä¸ºä½ éƒ½æ¶ˆè´¹äº†ï¼Œè¿™æ•°æ®å°±ä¸¢äº†ã€‚</p><p>è¿™æ—¶å€™çš„ç”¨RabbitMQæä¾›çš„ <code>ack</code> æœºåˆ¶ã€‚å°±æ˜¯å¿…é¡»<strong>å…³é—­RMQè‡ªåŠ¨ <code>ack</code><strong>ï¼Œå¯ä»¥é€šè¿‡ api æ¥è°ƒç”¨å°±è¡Œï¼Œç„¶åæ¯æ¬¡å†ä»£ç </strong>å¤„ç†å®Œå</strong>ï¼Œå†**ä¸»åŠ¨çš„ <code>ack</code>**ã€‚è¿™æ ·æ²¡æœ‰å¤„ç†çš„è¯ï¼ŒRMQ å°±æ”¶ä¸åˆ° <code>ack</code>ï¼ŒRMQ å°±ä¼šè®¤ä¸ºä½ æ²¡æœ‰å¤„ç†å®Œï¼Œè¿™æ—¶å€™RMQ ä¼šæŠŠæ¶ˆæ¯åˆ†ç»™åˆ«çš„æ¶ˆè´¹è€…å¤„ç†ï¼Œæ¶ˆæ¯å°±ä¸ä¼šä¸¢ã€‚ </p><blockquote><p>RMQ  ä¸ºäº†ä¿è¯æ¶ˆæ¯å¯é ä¸ä¸¢å¤±æä¾›æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ã€‚æ¶ˆè´¹è€…åœ¨å£°æ˜é˜Ÿåˆ—æ—¶ï¼Œå¯ä»¥æŒ‡å®šnoAck å‚æ•°ï¼Œå½“noAck = false, RMQ ä¼šç­‰å¾…æ¶ˆè´¹è€…æ˜¾ç¤ºçš„å‘é€ ack ä¿¡å·åï¼Œæ‰ä»å†…å­˜ï¼ˆå’Œç£ç›˜ï¼Œå¦‚æœæŒä¹…åŒ–ï¼‰ç§»é™¤æ¶ˆæ¯ã€‚å¦åˆ™æ¶ˆæ¯ä¸€æ—¦è¢«æ¶ˆè´¹è€…æ¶ˆè´¹ï¼ŒRMQ ä¼šç«‹å³åˆ é™¤å®ƒã€‚</p></blockquote><p><a href="https://s2.loli.net/2024/12/20/FGJmvXY75HkIxyZ.png" title="RMQ-æŒä¹…åŒ–" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/FGJmvXY75HkIxyZ.png" alt="RMQ-æŒä¹…åŒ–"></a></p><h3 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h3><h4 id="æ¶ˆè´¹ç«¯å¼„ä¸¢äº†æ•°æ®"><a href="#æ¶ˆè´¹ç«¯å¼„ä¸¢äº†æ•°æ®" class="headerlink" title="æ¶ˆè´¹ç«¯å¼„ä¸¢äº†æ•°æ®"></a>æ¶ˆè´¹ç«¯å¼„ä¸¢äº†æ•°æ®</h4><p>å”¯ä¸€å¯èƒ½å¯¼è‡´æ¶ˆè´¹è€…å¼„ä¸¢æ•°æ®çš„æƒ…å†µï¼Œå°±æ˜¯è¯´ï¼Œä½ æ¶ˆè´¹åˆ°äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œç„¶åæ¶ˆè´¹è€…é‚£è¾¹<strong>è‡ªåŠ¨æäº¤äº† offset</strong>ï¼Œè®© Kafka ä»¥ä¸ºä½ å·²ç»æ¶ˆè´¹å¥½äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œä½†å…¶å®ä½ æ‰åˆšå‡†å¤‡å¤„ç†è¿™ä¸ªæ¶ˆæ¯ï¼Œä½ è¿˜<strong>æ²¡å¤„ç†ï¼Œä½ è‡ªå·±å°±æŒ‚äº†</strong>ï¼Œæ­¤æ—¶è¿™æ¡æ¶ˆæ¯å°±ä¸¢å’¯ã€‚</p><p>è¿™ä¸æ˜¯è·Ÿ RabbitMQ å·®ä¸å¤šå—ï¼Œå¤§å®¶éƒ½çŸ¥é“ Kafka ä¼šè‡ªåŠ¨æäº¤ offsetï¼Œé‚£ä¹ˆåªè¦<strong>å…³é—­è‡ªåŠ¨æäº¤</strong> offsetï¼Œåœ¨å¤„ç†å®Œä¹‹åè‡ªå·±æ‰‹åŠ¨æäº¤ offsetï¼Œå°±å¯ä»¥ä¿è¯æ•°æ®ä¸ä¼šä¸¢ã€‚ä½†æ˜¯æ­¤æ—¶ç¡®å®è¿˜æ˜¯<strong>å¯èƒ½ä¼šæœ‰é‡å¤æ¶ˆè´¹</strong>ï¼Œæ¯”å¦‚ä½ åˆšå¤„ç†å®Œï¼Œè¿˜æ²¡æäº¤ offsetï¼Œç»“æœè‡ªå·±æŒ‚äº†ï¼Œæ­¤æ—¶è‚¯å®šä¼šé‡å¤æ¶ˆè´¹ä¸€æ¬¡ï¼Œè‡ªå·±ä¿è¯å¹‚ç­‰æ€§å°±å¥½äº†ã€‚</p><p>ç”Ÿäº§ç¯å¢ƒç¢°åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬çš„ Kafka æ¶ˆè´¹è€…æ¶ˆè´¹åˆ°äº†æ•°æ®ä¹‹åæ˜¯å†™åˆ°ä¸€ä¸ªå†…å­˜çš„ queue é‡Œå…ˆç¼“å†²ä¸€ä¸‹ï¼Œç»“æœæœ‰çš„æ—¶å€™ï¼Œä½ åˆšæŠŠæ¶ˆæ¯å†™å…¥å†…å­˜ queueï¼Œç„¶åæ¶ˆè´¹è€…ä¼šè‡ªåŠ¨æäº¤ offsetã€‚ç„¶åæ­¤æ—¶æˆ‘ä»¬é‡å¯äº†ç³»ç»Ÿï¼Œå°±ä¼šå¯¼è‡´å†…å­˜ queue é‡Œè¿˜æ²¡æ¥å¾—åŠå¤„ç†çš„æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p><h4 id="Kafka-å¼„ä¸¢äº†æ•°æ®"><a href="#Kafka-å¼„ä¸¢äº†æ•°æ®" class="headerlink" title="Kafka å¼„ä¸¢äº†æ•°æ®"></a>Kafka å¼„ä¸¢äº†æ•°æ®</h4><p>è¿™å—æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªåœºæ™¯ï¼Œå°±æ˜¯ Kafka <strong>æŸä¸ª broker å®•æœº</strong>ï¼Œç„¶åé‡æ–°é€‰ä¸¾ partition çš„ leaderã€‚å¤§å®¶æƒ³æƒ³ï¼Œè¦æ˜¯æ­¤æ—¶å…¶ä»–çš„ <strong>follower åˆšå¥½è¿˜æœ‰äº›æ•°æ®æ²¡æœ‰åŒæ­¥</strong>ï¼Œç»“æœæ­¤æ—¶ leader æŒ‚äº†ï¼Œç„¶åé€‰ä¸¾æŸä¸ª follower æˆ leader ä¹‹åï¼Œä¸å°±å°‘äº†ä¸€äº›æ•°æ®ï¼Ÿè¿™å°±ä¸¢äº†ä¸€äº›æ•°æ®å•Šã€‚</p><p>ç”Ÿäº§ç¯å¢ƒä¹Ÿé‡åˆ°è¿‡ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯ï¼Œä¹‹å‰ Kafka çš„ leader æœºå™¨å®•æœºäº†ï¼Œå°† follower åˆ‡æ¢ä¸º leader ä¹‹åï¼Œå°±ä¼šå‘ç°è¯´è¿™ä¸ªæ•°æ®å°±ä¸¢äº†ã€‚</p><p>æ‰€ä»¥æ­¤æ—¶ä¸€èˆ¬æ˜¯è¦æ±‚èµ·ç è®¾ç½®å¦‚ä¸‹ 4 ä¸ªå‚æ•°ï¼š</p><ul><li>ç»™ topic è®¾ç½® <code>replication.factor</code> å‚æ•°ï¼šè¿™ä¸ªå€¼å¿…é¡»å¤§äº 1ï¼Œè¦æ±‚æ¯ä¸ª <strong>partition å¿…é¡»æœ‰è‡³å°‘ 2 ä¸ªå‰¯æœ¬ã€‚</strong></li><li>åœ¨ Kafka æœåŠ¡ç«¯è®¾ç½® <code>min.insync.replicas</code> å‚æ•°ï¼šè¿™ä¸ªå€¼å¿…é¡»å¤§äº 1ï¼Œè¿™ä¸ªæ˜¯è¦æ±‚ä¸€ä¸ª <strong>leader è‡³å°‘æ„ŸçŸ¥åˆ°æœ‰è‡³å°‘ä¸€ä¸ª follower</strong> è¿˜è·Ÿè‡ªå·±ä¿æŒè”ç³»ï¼Œæ²¡æ‰é˜Ÿï¼Œè¿™æ ·æ‰èƒ½ç¡®ä¿ leader æŒ‚äº†è¿˜æœ‰ä¸€ä¸ª follower å§ã€‚</li><li>åœ¨ producer ç«¯è®¾ç½® <code>acks=all</code> ï¼šè¿™ä¸ªæ˜¯è¦æ±‚æ¯æ¡æ•°æ®ï¼Œå¿…é¡»æ˜¯<strong>å†™å…¥æ‰€æœ‰ replica ä¹‹åï¼Œæ‰èƒ½è®¤ä¸ºæ˜¯å†™æˆåŠŸäº†</strong>ã€‚</li><li>åœ¨ producer ç«¯è®¾ç½® <code>retries=MAX</code> ï¼ˆå¾ˆå¤§å¾ˆå¤§å¾ˆå¤§çš„ä¸€ä¸ªå€¼ï¼Œæ— é™æ¬¡é‡è¯•çš„æ„æ€ï¼‰ï¼šè¿™ä¸ªæ˜¯<strong>è¦æ±‚ä¸€æ—¦å†™å…¥å¤±è´¥ï¼Œå°±æ— é™é‡è¯•</strong>ï¼Œå¡åœ¨è¿™é‡Œäº†ã€‚</li></ul><p>æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒå°±æ˜¯æŒ‰ç…§ä¸Šè¿°è¦æ±‚é…ç½®çš„ï¼Œè¿™æ ·é…ç½®ä¹‹åï¼Œè‡³å°‘åœ¨ Kafka broker ç«¯å°±å¯ä»¥ä¿è¯åœ¨ leader æ‰€åœ¨ broker å‘ç”Ÿæ•…éšœï¼Œè¿›è¡Œ leader åˆ‡æ¢æ—¶ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p><h4 id="ç”Ÿäº§è€…ä¼šä¸ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ"><a href="#ç”Ÿäº§è€…ä¼šä¸ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ" class="headerlink" title="ç”Ÿäº§è€…ä¼šä¸ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ"></a>ç”Ÿäº§è€…ä¼šä¸ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ</h4><p>å¦‚æœæŒ‰ç…§ä¸Šè¿°çš„æ€è·¯è®¾ç½®äº† <code>acks=all</code> ï¼Œä¸€å®šä¸ä¼šä¸¢ï¼Œè¦æ±‚æ˜¯ï¼Œä½ çš„ leader æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œæ‰€æœ‰çš„ follower éƒ½åŒæ­¥åˆ°äº†æ¶ˆæ¯ä¹‹åï¼Œæ‰è®¤ä¸ºæœ¬æ¬¡å†™æˆåŠŸäº†ã€‚å¦‚æœæ²¡æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œç”Ÿäº§è€…ä¼šè‡ªåŠ¨ä¸æ–­çš„é‡è¯•ï¼Œé‡è¯•æ— é™æ¬¡ã€‚</p><h2 id="7-ä¿è¯æ¶ˆè´¹é¡ºåº"><a href="#7-ä¿è¯æ¶ˆè´¹é¡ºåº" class="headerlink" title="7.ä¿è¯æ¶ˆè´¹é¡ºåº"></a>7.ä¿è¯æ¶ˆè´¹é¡ºåº</h2><p>æˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä»¥å‰åšè¿‡ä¸€ä¸ª mysql <code>binlog</code> åŒæ­¥çš„ç³»ç»Ÿï¼Œå‹åŠ›è¿˜æ˜¯éå¸¸å¤§çš„ï¼Œæ—¥åŒæ­¥æ•°æ®è¦è¾¾åˆ°ä¸Šäº¿ï¼Œå°±æ˜¯è¯´æ•°æ®ä»ä¸€ä¸ª mysql åº“åŸå°ä¸åŠ¨åœ°åŒæ­¥åˆ°å¦ä¸€ä¸ª mysql åº“é‡Œé¢å»ï¼ˆmysql -&gt; mysqlï¼‰ã€‚å¸¸è§çš„ä¸€ç‚¹åœ¨äºè¯´æ¯”å¦‚å¤§æ•°æ® teamï¼Œå°±éœ€è¦åŒæ­¥ä¸€ä¸ª mysql åº“è¿‡æ¥ï¼Œå¯¹å…¬å¸çš„ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®åšå„ç§å¤æ‚çš„æ“ä½œã€‚</p><p>ä½ åœ¨ mysql é‡Œå¢åˆ æ”¹ä¸€æ¡æ•°æ®ï¼Œå¯¹åº”å‡ºæ¥äº†å¢åˆ æ”¹ 3 æ¡ <code>binlog</code> æ—¥å¿—ï¼Œæ¥ç€è¿™ä¸‰æ¡ <code>binlog</code> å‘é€åˆ° MQ é‡Œé¢ï¼Œå†æ¶ˆè´¹å‡ºæ¥ä¾æ¬¡æ‰§è¡Œï¼Œèµ·ç å¾—ä¿è¯äººå®¶æ˜¯æŒ‰ç…§é¡ºåºæ¥çš„å§ï¼Ÿä¸ç„¶æœ¬æ¥æ˜¯ï¼šå¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ï¼›ä½ æ„£æ˜¯æ¢äº†é¡ºåºç»™æ‰§è¡Œæˆåˆ é™¤ã€ä¿®æ”¹ã€å¢åŠ ï¼Œä¸å…¨é”™äº†ä¹ˆã€‚</p><p>æœ¬æ¥è¿™ä¸ªæ•°æ®åŒæ­¥è¿‡æ¥ï¼Œåº”è¯¥æœ€åè¿™ä¸ªæ•°æ®è¢«åˆ é™¤äº†ï¼›ç»“æœä½ æé”™äº†è¿™ä¸ªé¡ºåºï¼Œæœ€åè¿™ä¸ªæ•°æ®ä¿ç•™ä¸‹æ¥äº†ï¼Œæ•°æ®åŒæ­¥å°±å‡ºé”™äº†ã€‚</p><p>å…ˆçœ‹çœ‹é¡ºåºä¼šé”™ä¹±çš„ä¿©åœºæ™¯ï¼š</p><ul><li><strong>RabbitMQ</strong>ï¼šä¸€ä¸ª queueï¼Œå¤šä¸ª consumerã€‚æ¯”å¦‚ï¼Œç”Ÿäº§è€…å‘ RabbitMQ é‡Œå‘é€äº†ä¸‰æ¡æ•°æ®ï¼Œé¡ºåºä¾æ¬¡æ˜¯ data1/data2/data3ï¼Œå‹å…¥çš„æ˜¯ RabbitMQ çš„ä¸€ä¸ªå†…å­˜é˜Ÿåˆ—ã€‚æœ‰ä¸‰ä¸ªæ¶ˆè´¹è€…åˆ†åˆ«ä» MQ ä¸­æ¶ˆè´¹è¿™ä¸‰æ¡æ•°æ®ä¸­çš„ä¸€æ¡ï¼Œç»“æœæ¶ˆè´¹è€… 2 å…ˆæ‰§è¡Œå®Œæ“ä½œï¼ŒæŠŠ data2 å­˜å…¥æ•°æ®åº“ï¼Œç„¶åæ˜¯ data1/data3ã€‚è¿™ä¸æ˜æ˜¾ä¹±äº†ã€‚</li></ul><p><a href="https://s2.loli.net/2024/12/20/iJCFHkzR7pA3XjQ.png" title="RMQ-æ¶ˆæ¯é¡ºåº" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/iJCFHkzR7pA3XjQ.png" alt="RMQ-æ¶ˆæ¯é¡ºåº"></a></p><ul><li><strong>Kafka</strong>ï¼šæ¯”å¦‚è¯´æˆ‘ä»¬å»ºäº†ä¸€ä¸ª topicï¼Œæœ‰ä¸‰ä¸ª partitionã€‚ç”Ÿäº§è€…åœ¨å†™çš„æ—¶å€™ï¼Œå…¶å®å¯ä»¥æŒ‡å®šä¸€ä¸ª keyï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æŒ‡å®šäº†æŸä¸ªè®¢å• id ä½œä¸º keyï¼Œé‚£ä¹ˆè¿™ä¸ªè®¢å•ç›¸å…³çš„æ•°æ®ï¼Œä¸€å®šä¼šè¢«åˆ†å‘åˆ°åŒä¸€ä¸ª partition ä¸­å»ï¼Œè€Œä¸”è¿™ä¸ª partition ä¸­çš„æ•°æ®ä¸€å®šæ˜¯æœ‰é¡ºåºçš„ã€‚<br>æ¶ˆè´¹è€…ä» partition ä¸­å–å‡ºæ¥æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿä¸€å®šæ˜¯æœ‰é¡ºåºçš„ã€‚åˆ°è¿™é‡Œï¼Œé¡ºåºè¿˜æ˜¯ ok çš„ï¼Œæ²¡æœ‰é”™ä¹±ã€‚æ¥ç€ï¼Œæˆ‘ä»¬åœ¨æ¶ˆè´¹è€…é‡Œå¯èƒ½ä¼šæ<strong>å¤šä¸ªçº¿ç¨‹æ¥å¹¶å‘å¤„ç†æ¶ˆæ¯</strong>ã€‚å› ä¸ºå¦‚æœæ¶ˆè´¹è€…æ˜¯å•çº¿ç¨‹æ¶ˆè´¹å¤„ç†ï¼Œè€Œå¤„ç†æ¯”è¾ƒè€—æ—¶çš„è¯ï¼Œæ¯”å¦‚å¤„ç†ä¸€æ¡æ¶ˆæ¯è€—æ—¶å‡ å msï¼Œé‚£ä¹ˆ 1 ç§’é’Ÿåªèƒ½å¤„ç†å‡ åæ¡æ¶ˆæ¯ï¼Œè¿™ååé‡å¤ªä½äº†ã€‚è€Œå¤šä¸ªçº¿ç¨‹å¹¶å‘è·‘çš„è¯ï¼Œé¡ºåºå¯èƒ½å°±ä¹±æ‰äº†ã€‚</li></ul><p><a href="https://s2.loli.net/2024/12/20/NWU3Eitf4jzJ8vr.png" title="Kafka-æ¶ˆæ¯é¡ºåº" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/NWU3Eitf4jzJ8vr.png" alt="Kafka-æ¶ˆæ¯é¡ºåº"></a></p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="RabbitMQ-1"><a href="#RabbitMQ-1" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h4><p>æ‹†åˆ†å¤šä¸ª queueï¼Œæ¯ä¸ª queue ä¸€ä¸ª consumerï¼Œå°±æ˜¯å¤šä¸€äº› queue è€Œå·²ï¼Œç¡®å®æ˜¯éº»çƒ¦ç‚¹ï¼›æˆ–è€…å°±ä¸€ä¸ª queue ä½†æ˜¯å¯¹åº”ä¸€ä¸ª consumerï¼Œç„¶åè¿™ä¸ª consumer å†…éƒ¨ç”¨å†…å­˜é˜Ÿåˆ—åšæ’é˜Ÿï¼Œç„¶ååˆ†å‘ç»™åº•å±‚ä¸åŒçš„ worker æ¥å¤„ç†ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/jUswEhVe1XM2DoA.png" title="æ¶ˆæ¯é¡ºåº" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/jUswEhVe1XM2DoA.png" alt="æ¶ˆæ¯é¡ºåº"></a></p><h4 id="Kafka-1"><a href="#Kafka-1" class="headerlink" title="Kafka"></a>Kafka</h4><ul><li>ä¸€ä¸ª topicï¼Œä¸€ä¸ª partitionï¼Œä¸€ä¸ª consumerï¼Œå†…éƒ¨å•çº¿ç¨‹æ¶ˆè´¹ï¼Œå•çº¿ç¨‹ååé‡å¤ªä½ï¼Œä¸€èˆ¬ä¸ä¼šç”¨è¿™ä¸ªã€‚</li><li>å†™ N ä¸ªå†…å­˜ queueï¼Œå…·æœ‰ç›¸åŒ key çš„æ•°æ®éƒ½åˆ°åŒä¸€ä¸ªå†…å­˜ queueï¼›ç„¶åå¯¹äº N ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ†åˆ«æ¶ˆè´¹ä¸€ä¸ªå†…å­˜ queue å³å¯ï¼Œè¿™æ ·å°±èƒ½ä¿è¯é¡ºåºæ€§ã€‚</li></ul><p><a href="https://s2.loli.net/2024/12/20/xwb7rRE6Lm2ka1C.png" title="æ¶ˆæ¯é¡ºåº" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/xwb7rRE6Lm2ka1C.png" alt="æ¶ˆæ¯é¡ºåº"></a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆä¸ƒï¼‰| JVMå¸¸è§å‘½ä»¤</title>
      <link href="/posts/45688.html"/>
      <url>/posts/45688.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="JVM-å¸¸ç”¨å‘½ä»¤ä»‹ç»"><a href="#JVM-å¸¸ç”¨å‘½ä»¤ä»‹ç»" class="headerlink" title="JVM å¸¸ç”¨å‘½ä»¤ä»‹ç»"></a>JVM å¸¸ç”¨å‘½ä»¤ä»‹ç»</h2><pre class="line-numbers language-none"><code class="language-none">ä¸‹é¢ä»‹ç»ä¸€ä¸‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>JVM</code> ä¸­å¸¸ç”¨çš„è°ƒä¼˜ã€æ•…éšœå¤„ç†ç­‰å·¥å…·ã€‚</p><ol><li><strong><em>jps</em></strong> ï¼šè™šæ‹Ÿæœºè¿›ç¨‹å·¥å…·ï¼Œå…¨ç§°æ˜¯ **<em>JVM Process Status Tool</em>**ï¼Œå®ƒçš„åŠŸèƒ½å’Œ <code>Linux</code> ä¸­çš„ <em><code>ps</code></em> ç±»ä¼¼ï¼Œå¯ä»¥åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œå¹¶æ˜¾ç¤ºè™šæ‹Ÿæœºæ‰§è¡Œä¸»ç±» <em><strong>Main Class</strong></em> æ‰€åœ¨çš„æœ¬åœ°è™šæ‹Ÿæœºå”¯ä¸€<code>ID</code>ï¼Œè™½ç„¶åŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼Œä½†æ˜¯è¿™ä¸ªå‘½ä»¤ç»å¯¹æ˜¯ä½¿ç”¨æœ€é«˜é¢‘çš„ä¸€ä¸ªå‘½ä»¤ã€‚</li><li>_<strong>jstat</strong>_ï¼šè™šæ‹Ÿæœºç»Ÿè®¡ä¿¡æ¯å·¥å…·ï¼Œç”¨äºç›‘è§†è™šæ‹Ÿæœºå„ç§è¿è¡ŒçŠ¶æ€çš„ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºæœ¬åœ°æˆ–è€…è¿œç¨‹è™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»åŠ è½½ã€å†…å­˜ã€åƒåœ¾æ”¶é›†ã€å³æ—¶ç¼–è¯‘ç­‰è¿è¡Œæ—¶æ•°æ®ã€‚</li><li><strong><em>jinfo</em><strong>ï¼š</strong>Java</strong> é…ç½®ä¿¡æ¯å·¥å…·ï¼Œå…¨ç§°æ˜¯ _<strong>Configuration Info for Java</strong>_ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯ä»¥å®æ—¶è°ƒæ•´è™šæ‹Ÿæœºå„é¡¹å‚æ•°ã€‚</li><li><strong>_jmap_ï¼šJava</strong> å†…å­˜æ˜ åƒå·¥å…·ï¼Œå…¨ç§°æ˜¯ _<strong>Memory Map For Java</strong>_ï¼Œå®ƒç”¨äºç”Ÿæˆè½¬å‚¨å¿«ç…§ï¼Œç”¨æ¥æ’æŸ¥å†…å­˜å ç”¨æƒ…å†µ</li><li><strong><em>jhat</em><strong>ï¼šè™šæ‹Ÿæœºå †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·ï¼Œå…¨ç§°æ˜¯ _<strong>JVM Heap Analysis Tool</strong>_ï¼Œè¿™ä¸ªæŒ‡ä»¤é€šå¸¸å’Œ <strong>jmap</strong> ä¸€èµ·æ­é…ä½¿ç”¨ï¼Œ</strong>jhat</strong> å†…ç½®äº†ä¸€ä¸ª <strong>HTTP/Web</strong> æœåŠ¡å™¨ï¼Œç”Ÿæˆè½¬å‚¨å¿«ç…§åå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚ä¸è¿‡ï¼Œä¸€èˆ¬è¿˜æ˜¯ <strong>jmap</strong> å‘½ä»¤ä½¿ç”¨çš„é¢‘ç‡æ¯”è¾ƒé«˜ã€‚</li><li><strong>_jstack_ï¼šJava</strong> å †æ ˆè·Ÿè¸ªå·¥å…·ï¼Œå…¨ç§°æ˜¯ <strong><em>Stack Trace for Java</em></strong> ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªå‘½ä»¤ç”¨æ¥è¿½è¸ªå †æ ˆçš„ä½¿ç”¨æƒ…å†µï¼Œç”¨äºè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ï¼Œçº¿ç¨‹å¿«ç…§å°±æ˜¯å½“å‰è™šæ‹Ÿæœºå†…æ¯ä¸€æ¡æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆã€‚</li></ol><h2 id="å¸¸è§çš„-JVM-è°ƒä¼˜å‚æ•°æœ‰å“ªäº›ï¼Ÿ"><a href="#å¸¸è§çš„-JVM-è°ƒä¼˜å‚æ•°æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="å¸¸è§çš„ JVM è°ƒä¼˜å‚æ•°æœ‰å“ªäº›ï¼Ÿ"></a>å¸¸è§çš„ JVM è°ƒä¼˜å‚æ•°æœ‰å“ªäº›ï¼Ÿ</h2><table><thead><tr><th>å‘½ä»¤å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>-Xms256m</td><td>åˆå§‹åŒ–å †å¤§å°ä¸º 256m</td></tr><tr><td>-Xmx2g</td><td>æœ€å¤§å†…å­˜ä¸º 2g</td></tr><tr><td>-Xmn50m</td><td>æ–°ç”Ÿä»£çš„å¤§å° 50m</td></tr><tr><td>-XX:+PrintGCDetails</td><td>æ‰“å° gc è¯¦ç»†ä¿¡æ¯</td></tr><tr><td>-XX:+HeapDumpOnOutOfMemoryError</td><td>åœ¨å‘ç”Ÿ<code>OutOfMemoryError</code> é”™è¯¯æ—¶ï¼Œæ¥ <code>dump</code> å‡ºå †å¿«ç…§</td></tr><tr><td>-XX:NewRatio=4</td><td>è®¾ç½®å¹´è½»çš„å’Œè€å¹´ä»£çš„å†…å­˜æ¯”ä¾‹ä¸º 1:4</td></tr><tr><td>-XX:SurvivorRatio=8</td><td>è®¾ç½®æ–°ç”Ÿä»£<code>Eden</code> å’Œ <code>Survivor</code> æ¯”ä¾‹ä¸º 8:2</td></tr><tr><td>-XX:+UseSerialGC</td><td>æ–°ç”Ÿä»£å’Œè€å¹´ä»£éƒ½ç”¨ä¸²è¡Œæ”¶é›†å™¨<code>Serial + Serial Old</code></td></tr><tr><td>-XX:+UseParNewGC</td><td>æŒ‡å®šä½¿ç”¨<code>ParNew + Serial Old</code> åƒåœ¾å›æ”¶å™¨ç»„åˆ</td></tr><tr><td>-XX:+UseParallelGC</td><td>æ–°ç”Ÿä»£ä½¿ç”¨<code>Parallel Scavenge</code>ï¼Œè€å¹´ä»£ä½¿ç”¨ <code>Serial Old</code></td></tr><tr><td>-XX:+UseParallelOldGC</td><td>æ–°ç”Ÿä»£<code>ParallelScavenge</code> + è€å¹´ä»£ <code>ParallelOld</code> ç»„åˆ</td></tr><tr><td>-XX:+UseConcMarkSweepGC</td><td>æ–°ç”Ÿä»£ä½¿ç”¨<code>ParNew</code>ï¼Œè€å¹´ä»£ä½¿ç”¨ <code>CMS</code></td></tr><tr><td>-XX:NewSize</td><td>æ–°ç”Ÿä»£æœ€å°å€¼</td></tr><tr><td>-XX:MaxNewSize</td><td>æ–°ç”Ÿä»£æœ€å¤§å€¼</td></tr><tr><td>-XX:MetaspaceSize</td><td>å…ƒç©ºé—´åˆå§‹åŒ–å¤§å°</td></tr><tr><td>-XX:MaxMetaspaceSize</td><td>å…ƒç©ºé—´æœ€å¤§å€¼</td></tr></tbody></table></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆå…­ï¼‰| åŒäº²å§”æ´¾æ¨¡å‹</title>
      <link href="/posts/10871.html"/>
      <url>/posts/10871.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</h2><p><strong>JVM</strong> ç±»åŠ è½½é»˜è®¤ä½¿ç”¨çš„æ˜¯<strong>åŒäº²å§”æ´¾æ¨¡å‹</strong>ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦å…ˆä»‹ç»ä¸€ä¸‹ä¸‰ç§ç±»åŠ è½½å™¨ï¼š</p><ul><li><strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>ï¼š**<em>Bootstrap Class Loader</em><strong>ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ <strong>C++</strong> å®ç°çš„ï¼Œå®ƒæ˜¯ <strong>JVM</strong> çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½å­˜æ”¾åœ¨ <strong><em><JAVA_HOME>\lib</em></strong> ç›®å½•ï¼Œå¯åŠ¨ç±»åŠ è½½å™¨æ— æ³•è¢« <strong>Java</strong> ç¨‹åºç›´æ¥å¼•ç”¨ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œ</strong>JDK** ä¸­çš„<strong>å¸¸ç”¨ç±»çš„åŠ è½½</strong>éƒ½æ˜¯ç”±å¯åŠ¨ç±»åŠ è½½å™¨æ¥å®Œæˆçš„ã€‚</li><li><strong>æ‰©å±•ç±»åŠ è½½å™¨</strong>ï¼š_<strong>Extension Class Loader</strong><em>ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ <strong>Java</strong> å®ç°çš„ï¼Œå®ƒè´Ÿè´£åŠ è½½ **</em><JAVA_HOME>\lib\ext_** ç›®å½•ã€‚</li><li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨</strong>ï¼Œ_<strong>Application Class Loader</strong>_ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ç”± <strong><em>sum.misc.Launcher$AppClassLoader</em></strong> æ¥å®ç°ï¼Œå®ƒè´Ÿè´£åŠ è½½ <strong><em>ClassPath</em></strong> ä¸Šæ‰€æœ‰çš„<strong>ç±»åº“</strong>ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰å®šä¹‰è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œé»˜è®¤ä½¿ç”¨å°±æ˜¯è¿™ä¸ªç±»åŠ è½½å™¨ã€‚</li></ul><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„ <strong>Java</strong> åº”ç”¨ç¨‹åºéƒ½æ˜¯ç”±è¿™ä¸‰ç§ç±»åŠ è½½å™¨æ¥ç›¸äº’é…åˆå®Œæˆçš„ï¼Œå½“ç„¶ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ç±»åŠ è½½å™¨ï¼Œå³ _<strong>User Class Loader</strong>_ï¼Œè¿™å‡ ä¸ªç±»åŠ è½½å™¨çš„æ¨¡å‹å¦‚ä¸‹</p><p><a href="https://s2.loli.net/2024/12/20/Gu1cUmBrb9sINDF.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/Gu1cUmBrb9sINDF.jpg"></a></p><p>ä¸Šé¢è¿™å‡ ç±»ç±»åŠ è½½å™¨æ„æˆäº†ä¸åŒçš„å±‚æ¬¡ç»“æ„ï¼Œå½“æˆ‘ä»¬éœ€è¦<strong>åŠ è½½ä¸€ä¸ªç±»</strong>æ—¶ï¼Œå­ç±»åŠ è½½å™¨å¹¶ä¸ä¼šé©¬ä¸Šå»åŠ è½½ï¼Œè€Œæ˜¯ä¾æ¬¡å»è¯·æ±‚<strong>çˆ¶ç±»åŠ è½½å™¨</strong>åŠ è½½ï¼Œä¸€ç›´å¾€ä¸Šè¯·æ±‚åˆ°æœ€é«˜ç±»åŠ è½½å™¨ï¼š<strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>ã€‚å½“å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ä¸äº†çš„æ—¶å€™ï¼Œä¾æ¬¡å¾€ä¸‹è®©<strong>å­ç±»åŠ è½½å™¨</strong>è¿›è¡ŒåŠ è½½ã€‚è¿™å°±æ˜¯<strong>åŒäº²å§”æ´¾æ¨¡å‹</strong>ã€‚</p><h2 id="åŒäº²å§”æ´¾æ¨¡å‹çš„ç¼ºé™·ï¼Ÿ"><a href="#åŒäº²å§”æ´¾æ¨¡å‹çš„ç¼ºé™·ï¼Ÿ" class="headerlink" title="åŒäº²å§”æ´¾æ¨¡å‹çš„ç¼ºé™·ï¼Ÿ"></a>åŒäº²å§”æ´¾æ¨¡å‹çš„ç¼ºé™·ï¼Ÿ</h2><pre class="line-numbers language-none"><code class="language-none">åœ¨åŒäº²å§”æ´¾æ¨¡å‹ä¸­ï¼Œå­ç±»åŠ è½½å™¨å¯ä»¥ä½¿ç”¨çˆ¶ç±»åŠ è½½å™¨å·²ç»åŠ è½½çš„ç±»ï¼Œè€Œçˆ¶ç±»åŠ è½½å™¨æ— æ³•ä½¿ç”¨å­ç±»åŠ è½½å™¨å·²ç»åŠ è½½çš„ã€‚è¿™å°±å¯¼è‡´äº†åŒäº²å§”æ´¾æ¨¡å‹å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰çš„ç±»åŠ è½½å™¨é—®é¢˜ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Java</code> æä¾›äº†å¾ˆå¤šå¤–éƒ¨æ¥å£ï¼Œè¿™äº›æ¥å£ç»Ÿç§°ä¸º _<strong>Service Provider Interface, SPI</strong>_ï¼Œå…è®¸ç¬¬ä¸‰æ–¹å®ç°è¿™äº›æ¥å£ï¼Œè€Œè¿™äº›æ¥å£å´æ˜¯ <strong>Java</strong> æ ¸å¿ƒç±»æä¾›çš„ï¼Œç”± <strong>Bootstrap Class Loader</strong> åŠ è½½ï¼Œè€Œä¸€èˆ¬çš„æ‰©å±•æ¥å£æ˜¯ç”± <strong>Application Class Loader</strong> åŠ è½½çš„ï¼Œ<strong>Bootstrap Class Loader</strong> æ˜¯æ— æ³•æ‰¾åˆ° <strong>SPI</strong> çš„å®ç°ç±»çš„ï¼Œå› ä¸ºå®ƒåªåŠ è½½ <strong>Java</strong> çš„æ ¸å¿ƒåº“ã€‚å®ƒä¹Ÿä¸èƒ½ä»£ç†ç»™ <strong>Application Class Loader</strong>ï¼Œå› ä¸ºå®ƒæ˜¯æœ€é¡¶å±‚çš„ç±»åŠ è½½å™¨ã€‚</p><h2 id="åŒäº²å§”æ´¾æœºåˆ¶çš„ä¸‰æ¬¡ç ´å"><a href="#åŒäº²å§”æ´¾æœºåˆ¶çš„ä¸‰æ¬¡ç ´å" class="headerlink" title="åŒäº²å§”æ´¾æœºåˆ¶çš„ä¸‰æ¬¡ç ´å"></a>åŒäº²å§”æ´¾æœºåˆ¶çš„ä¸‰æ¬¡ç ´å</h2><p>è™½ç„¶åŒäº²å§”æ´¾æœºåˆ¶æ˜¯ <code>Java</code> å¼ºçƒˆæ¨èç»™å¼€å‘è€…ä»¬çš„ç±»åŠ è½½å™¨çš„å®ç°æ–¹å¼ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¼ºåˆ¶è§„å®šä½ å¿…é¡»å°±è¦è¿™ä¹ˆå®ç°ï¼Œæ‰€ä»¥ï¼Œå®ƒä¸€æ ·ä¹Ÿå­˜åœ¨è¢«ç ´åçš„æƒ…å†µï¼Œå®é™…ä¸Šï¼Œå†å²ä¸Šä¸€å…±å‡ºç°ä¸‰æ¬¡åŒäº²å§”æ´¾æœºåˆ¶è¢«ç ´åçš„æƒ…å†µï¼š</p><ul><li><p>åŒäº²å§”æ´¾æœºåˆ¶<strong>ç¬¬ä¸€æ¬¡è¢«ç ´å</strong>å‘ç”Ÿåœ¨åŒäº²å§”æ´¾æœºåˆ¶å‡ºç°ä¹‹å‰ï¼Œç”±äºåŒäº²å§”æ´¾æœºåˆ¶ <strong>JDK 1.2</strong> ä¹‹åæ‰å¼•ç”¨çš„ï¼Œä½†ç±»åŠ è½½çš„æ¦‚å¿µåœ¨ <strong>Java</strong> åˆšå‡ºç°çš„æ—¶å€™å°±æœ‰äº†ï¼Œæ‰€ä»¥å¼•ç”¨åŒäº²å§”æ´¾æœºåˆ¶ä¹‹å‰ï¼Œè®¾è®¡è€…ä»¬å¿…é¡»å…¼é¡¾å¼€å‘è€…ä»¬è‡ªå®šä¹‰çš„ä¸€äº›ç±»åŠ è½½å™¨çš„ä»£ç ï¼Œæ‰€ä»¥åœ¨ <strong>JDK 1.2</strong> ä¹‹åçš„ <strong>java.lang.ClassLoader</strong> ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ <em><strong>findClass</strong>_ æ–¹æ³•ï¼Œå¼•å¯¼ç”¨æˆ·ç¼–å†™ç±»åŠ è½½å™¨é€»è¾‘çš„æ—¶å€™<strong>é‡å†™</strong>è¿™ä¸ª <strong>findClass</strong> æ–¹æ³•ï¼Œè€Œä¸æ˜¯åŸºäº _<strong>loadClass</strong></em> ç¼–å†™ã€‚</p></li><li><p>åŒäº²å§”æ´¾æœºåˆ¶<strong>ç¬¬äºŒæ¬¡è¢«ç ´å</strong>æ˜¯ç”±äºå®ƒè‡ªå·±æ¨¡å‹å¯¼è‡´çš„ï¼Œç”±äºå®ƒåªèƒ½<strong>å‘ä¸Šï¼ˆåŸºç¡€ï¼‰åŠ è½½</strong>ï¼Œè¶ŠåŸºç¡€çš„ç±»è¶Šç”±ä¸Šå±‚åŠ è½½å™¨åŠ è½½ã€‚</p><ul><li><p>å¦‚æœåŸºç¡€ç±»å‹åˆæƒ³è¦è°ƒç”¨ç”¨æˆ·çš„ä»£ç ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p><pre class="line-numbers language-none"><code class="language-none">è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢é‚£ä¸ªé—®é¢˜æ‰€è¯´çš„<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>SPI</code> æœºåˆ¶ã€‚é‚£ä¹ˆ <strong>JDK</strong> å›¢é˜Ÿæ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿ</p><pre><code>å®ƒä»¬å¼•ç”¨äº†ä¸€ä¸ª **çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ (Thread Context ClassLoader)**ï¼Œè¿™ä¸ªç±»åŠ è½½å™¨å¯ä»¥é€šè¿‡ **java.lang.Thread** ç±»çš„ **_setContextClassLoader_** è¿›è¡Œè®¾ç½®ï¼Œå¦‚æœåˆ›å»ºæ—¶çº¿ç¨‹è¿˜æœªè®¾ç½®ï¼Œå®ƒå°†ä¼šä»çˆ¶çº¿ç¨‹ä¸­ç»§æ‰¿ï¼Œå¦‚æœå…¨å±€æ²¡æœ‰è®¾ç½®ç±»åŠ è½½å™¨çš„è¯ï¼Œè¿™ä¸ª **ClassLoader** å°±æ˜¯é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚è¿™ç§è¡Œä¸ºè™½ç„¶æ˜¯ä¸€ç§çŠ¯è§„è¡Œä¸ºï¼Œä½†æ˜¯ Java ä»£ç ä¸­çš„ **JNDIã€JDBC** ç­‰éƒ½æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å®Œæˆçš„ã€‚ç›´åˆ° **JDK 6** ï¼Œå¼•ç”¨äº† **_java.util.ServiceLoader_**ï¼Œä½¿ç”¨ **META-INF/services** + **è´£ä»»é“¾**çš„è®¾è®¡æ¨¡å¼ï¼Œæ‰è§£å†³äº† **SPI** çš„è¿™ç§åŠ è½½æœºåˆ¶ã€‚</code></pre></li></ul></li><li><p>åŒäº²å§”æ´¾æœºåˆ¶ç¬¬<strong>ä¸‰æ¬¡è¢«ç ´å</strong>æ˜¯ç”±äº<strong>ç”¨æˆ·å¯¹ç¨‹åºçš„åŠ¨æ€éœ€æ±‚ä½¿çƒ­åŠ è½½ã€çƒ­éƒ¨ç½²</strong>çš„å¼•å…¥æ‰€è‡´ã€‚ç”±äºæ—¶ä»£çš„å˜åŒ–ï¼Œæˆ‘ä»¬å¸Œæœ› Java èƒ½åƒé¼ æ ‡é”®ç›˜ä¸€æ ·å®ç°çƒ­éƒ¨ç½²ï¼Œ<strong>å³æ—¶åŠ è½½ï¼ˆload classï¼‰</strong>ï¼Œå¼•å…¥äº† <code>OSGI</code>ï¼Œ<code>OSGI</code> å®ç°çƒ­éƒ¨ç½²çš„å…³é”®åœ¨äºå®ƒè‡ªå®šä¹‰ç±»åŠ è½½å™¨æœºåˆ¶çš„å®ç°ï¼Œ<code>OSGI</code> ä¸­çš„æ¯ä¸€ä¸ª _<strong>Bundle</strong>_ ä¹Ÿå°±æ˜¯æ¨¡å—éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç±»åŠ è½½å™¨ã€‚å½“éœ€è¦æ›´æ¢ <strong>Bundle</strong> æ—¶ï¼Œå°±ç›´æ¥æŠŠ <strong>Bundle</strong> è¿åŒç±»åŠ è½½å™¨ä¸€èµ·æ›¿æ¢æ‰å°±èƒ½å¤Ÿå®ç°çƒ­åŠ è½½ã€‚åœ¨ <code>OSGI</code> ç¯å¢ƒä¸‹ï¼Œç±»åŠ è½½å™¨ä¸å†éµä»åŒäº²å§”æ´¾æœºåˆ¶ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ç§æ›´å¤æ‚çš„åŠ è½½æœºåˆ¶ã€‚</p></li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒäº²å§”æ´¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆäº”ï¼‰| JVMåƒåœ¾å›æ”¶ç®—æ³•</title>
      <link href="/posts/10871.html"/>
      <url>/posts/10871.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="JVM-åˆ†ä»£æ”¶é›†ç†è®ºæœ‰å“ªäº›ï¼Ÿ"><a href="#JVM-åˆ†ä»£æ”¶é›†ç†è®ºæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="JVM åˆ†ä»£æ”¶é›†ç†è®ºæœ‰å“ªäº›ï¼Ÿ"></a>JVM åˆ†ä»£æ”¶é›†ç†è®ºæœ‰å“ªäº›ï¼Ÿ</h2><blockquote><p>å¼ºåˆ†ä»£ï¼šæ–°ç”Ÿä»£å’Œè€å¹´ä»£</p><p>å¼±åˆ†ä»£ï¼šæ–°ç”Ÿä»£å’Œè€å¹´ä»£</p><p>è·¨ä»£å¼•ç”¨ï¼šè®°å¿†é›†ã€æœ‰è·¨ä»£ï¼ˆdirtyï¼‰ã€æ— è·¨å¸¦ï¼ˆcleanï¼‰ã€‘</p></blockquote><h3 id="åˆ†ä»£æ”¶é›†"><a href="#åˆ†ä»£æ”¶é›†" class="headerlink" title="åˆ†ä»£æ”¶é›†"></a>åˆ†ä»£æ”¶é›†</h3><ul><li><strong>å¼ºåˆ†ä»£å‡è¯´</strong>ï¼šå¼ºåˆ†ä»£å‡è¯´æŒ‡çš„æ˜¯ <code>JVM</code> è®¤ä¸ºç»å¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸéƒ½æ˜¯æœç”Ÿå¤•ç­çš„ï¼›</li><li><strong>å¼±åˆ†ä»£å‡è¯´</strong>ï¼šå¼±åˆ†ä»£å‡è¯´æŒ‡çš„æ˜¯åªè¦ç†¬è¿‡è¶Šå¤šæ¬¡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡å°±è¶Šéš¾ä»¥å›æ”¶ï¼ˆçœ‹æ¥å¯¹è±¡ä¹Ÿä¼šé•¿å¿ƒçœ¼ï¼‰ã€‚</li></ul><pre class="line-numbers language-none"><code class="language-none">å°±æ˜¯åŸºäºè¿™ä¸¤ä¸ªå‡è¯´ç†è®ºï¼Œ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>JVM</code> å°†<strong>å †åŒº</strong>åˆ’åˆ†ä¸ºä¸åŒçš„åŒºåŸŸï¼Œå†å°†éœ€è¦å›æ”¶çš„å¯¹è±¡æ ¹æ®å…¶<strong>ç†¬è¿‡åƒåœ¾å›æ”¶çš„æ¬¡æ•°</strong>åˆ†é…åˆ°ä¸åŒçš„åŒºåŸŸä¸­å­˜å‚¨ã€‚</p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>JVM</code> æ ¹æ®è¿™ä¸¤æ¡åˆ†ä»£æ”¶é›†ç†è®ºæŠŠ<strong>å †åŒº</strong>åˆ’åˆ†</p><ul><li><p>æ–°ç”Ÿä»£ (<code>Young</code> <code>Generation</code>) ï¼šæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»</p></li><li><p>è€å¹´ä»£ (<code>Old</code> <code>Generation</code>)ï¼šå‰©ä¸‹æ²¡æœ‰æ­»å»çš„å¯¹è±¡ä¼šç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£ä¸­</p><h3 id="è·¨ä»£å¼•ç”¨"><a href="#è·¨ä»£å¼•ç”¨" class="headerlink" title="è·¨ä»£å¼•ç”¨"></a>è·¨ä»£å¼•ç”¨</h3></li></ul><pre class="line-numbers language-none"><code class="language-none">ä¸Šé¢è¿™ä¸¤ä¸ªå‡è¯´<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ²¡æœ‰è€ƒè™‘å¯¹è±¡çš„å¼•ç”¨å…³ç³»</strong>ï¼Œè€Œäº‹å®æƒ…å†µæ˜¯ï¼Œå¯¹è±¡ä¹‹é—´ä¼šå­˜åœ¨å¼•ç”¨å…³ç³»ï¼ŒåŸºäºæ­¤åˆè¯ç”Ÿäº†</p><ul><li><strong>è·¨ä»£å¼•ç”¨å‡è¯´ (Intergeneration Reference Hypothesis)<strong>ï¼Œè·¨ä»£å¼•ç”¨ç›¸æ¯”è¾ƒåŒä»£å¼•ç”¨æ¥è¯´ä»…å å°‘æ•°ã€‚æ­£å¸¸æ¥è¯´å­˜åœ¨ç›¸äº’å¼•ç”¨çš„ä¸¤ä¸ªå¯¹è±¡åº”è¯¥æ˜¯</strong>åŒç”Ÿå…±æ­»</strong>çš„ï¼Œä¸è¿‡ä¹Ÿä¼šå­˜åœ¨ç‰¹ä¾‹ã€‚</li></ul><pre class="line-numbers language-none"><code class="language-none">å¦‚æœä¸€ä¸ªæ–°ç”Ÿä»£å¯¹è±¡è·¨ä»£å¼•ç”¨äº†ä¸€ä¸ªè€å¹´ä»£çš„å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶çš„æ—¶å€™å°±ä¸ä¼šå›æ”¶è¿™ä¸ªæ–°ç”Ÿä»£å¯¹è±¡ï¼Œæ›´ä¸ä¼šå›æ”¶è€å¹´ä»£å¯¹è±¡ï¼Œç„¶åè¿™ä¸ªæ–°ç”Ÿä»£å¯¹è±¡ç†¬è¿‡ä¸€æ¬¡åƒåœ¾å›æ”¶è¿›å…¥åˆ°è€å¹´ä»£ä¸­ï¼Œè¿™æ—¶å€™è·¨ä»£å¼•ç”¨æ‰ä¼šæ¶ˆé™¤ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">æ ¹æ®è·¨ä»£å¼•ç”¨å‡è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦å› ä¸ºè€å¹´ä»£ä¸­å­˜åœ¨<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å°‘é‡è·¨ä»£å¼•ç”¨</strong>å°±å»ç›´æ¥æ‰«æ<strong>æ•´ä¸ªè€å¹´ä»£</strong>ï¼Œä¹Ÿä¸ç”¨åœ¨è€å¹´ä»£ä¸­ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨è®°å½•æœ‰å“ªäº›è·¨ä»£å¼•ç”¨ï¼Œå®é™…ä¸Šï¼Œå¯ä»¥ç›´æ¥åœ¨æ–°ç”Ÿä»£ä¸­ç»´æŠ¤ä¸€ä¸ª<strong>è®°å¿†é›† (Remembered Set)<strong>ï¼Œç”±è¿™ä¸ªè®°å¿†é›†æŠŠè€å¹´ä»£åˆ’åˆ†ç§°ä¸º</strong>è‹¥å¹²å°å—</strong>ï¼Œæ ‡è¯†å‡ºè€å¹´ä»£çš„å“ªä¸€å—ä¼šå­˜åœ¨<strong>è·¨ä»£å¼•ç”¨</strong>ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/dVqRNWhzC58eHQM.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/dVqRNWhzC58eHQM.jpg"></a></p><pre class="line-numbers language-none"><code class="language-none">ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè®°å¿†é›†ä¸­çš„æ¯ä¸ªå…ƒç´ åˆ†åˆ«å¯¹åº”å†…å­˜ä¸­çš„ä¸€å—<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è¿ç»­åŒºåŸŸæ˜¯å¦æœ‰è·¨ä»£å¼•ç”¨å¯¹è±¡</strong>ï¼Œå¦‚æœæœ‰ï¼Œè¯¥åŒºåŸŸä¼šè¢«æ ‡è®°ä¸º â€œè„çš„â€ï¼ˆ<code>dirty</code>ï¼‰ï¼Œå¦åˆ™å°±æ˜¯ â€œå¹²å‡€çš„â€ï¼ˆ<code>clean</code>ï¼‰ã€‚è¿™æ ·åœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œåªéœ€è¦æ‰«æè®°å¿†é›†å°±å¯ä»¥ç®€å•åœ°ç¡®å®šè·¨ä»£å¼•ç”¨çš„ä½ç½®ï¼Œæ˜¯ä¸ªå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´çš„æ€è·¯ã€‚</p><h2 id="JVM-ä¸­çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Ÿ"><a href="#JVM-ä¸­çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Ÿ" class="headerlink" title="JVM ä¸­çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Ÿ"></a>JVM ä¸­çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Ÿ</h2><blockquote><p>åœ¨èŠå…·ä½“çš„åƒåœ¾å›æ”¶ç®—æ³•ä¹‹å‰ï¼Œéœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼Œå“ªäº›å¯¹è±¡éœ€è¦è¢«åƒåœ¾æ”¶é›†å™¨è¿›è¡Œå›æ”¶ï¼Ÿä¹Ÿå°±æ˜¯è¯´éœ€è¦å…ˆåˆ¤æ–­å“ªäº›å¯¹è±¡æ˜¯ â€œåƒåœ¾â€ï¼Ÿ<br>æ¸…é™¤ç®—æ³•ï¼ˆå†…å­˜ç¢ç‰‡é—®é¢˜ï¼‰ã€å¤åˆ¶ç®—æ³•ï¼ˆç©ºé—´æµªè´¹ï¼‰ã€æ•´ç†ç®—æ³•ï¼ˆæ•´ç†å‡ºè¿ç»­çš„å¯ç”¨å†…å­˜ï¼‰</p></blockquote><pre class="line-numbers language-none"><code class="language-none">åˆ¤æ–­çš„æ ‡å‡†æˆ‘åœ¨ä¸Šé¢<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡</strong>çš„é—®é¢˜ä¸­æè¿°äº†ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯<strong>å¼•ç”¨è®¡æ•°æ³•</strong>ï¼Œè¿™ç§åˆ¤æ–­æ ‡å‡†å°±æ˜¯ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå¼•ç”¨è¿™ä¸ªå¯¹è±¡ä¼šä½¿è®¡æ•°å™¨çš„å€¼ <strong>+ 1</strong>ï¼Œå¼•ç”¨å¤±æ•ˆåï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼š <strong>-1</strong>ã€‚ä½†æ˜¯è¿™ç§æŠ€æœ¯æ— æ³•è§£å†³å¯¹è±¡ä¹‹é—´çš„<strong>å¾ªç¯å¼•ç”¨é—®é¢˜</strong>ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ <code>GC Roots</code>ï¼Œ<code>GC Roots</code> è¿™ç§æ–¹å¼æ˜¯ä»¥ <code>Root</code> æ ¹èŠ‚ç‚¹ä¸ºæ ¸å¿ƒï¼Œé€æ­¥å‘ä¸‹æœç´¢æ¯ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œæœç´¢èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå¦‚æœæœç´¢è¿‡åè¿™ä¸ªå¯¹è±¡ä¸å­˜åœ¨å¼•ç”¨é“¾ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±æ˜¯æ— ç”¨å¯¹è±¡ï¼Œå¯ä»¥è¢«å›æ”¶ã€‚<code>GC Roots</code> å¯ä»¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œæ‰€ä»¥ä¸€èˆ¬ <code>JVM</code> éƒ½é‡‡ç”¨çš„æ˜¯è¿™ç§æ–¹å¼ã€‚</p><p>è§£å†³å¾ªç¯å¼•ç”¨ä»£ç æè¿°ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> test<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">B</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        a<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>        b<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token class-name">B</span> b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">A</span> a<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŸºäº <code>GC Roots</code> çš„è¿™ç§æ€æƒ³ï¼Œå‘å±•å‡ºäº†å¾ˆå¤šåƒåœ¾å›æ”¶ç®—æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥èŠä¸€èŠè¿™äº›ç®—æ³•ã€‚</p><h3 id="æ ‡è®°-æ¸…é™¤ç®—æ³•"><a href="#æ ‡è®°-æ¸…é™¤ç®—æ³•" class="headerlink" title="æ ‡è®° - æ¸…é™¤ç®—æ³•"></a>æ ‡è®° - æ¸…é™¤ç®—æ³•</h3><pre class="line-numbers language-none"><code class="language-none">æ ‡è®° - æ¸…é™¤ (<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Mark-Sweep</code>) è¿™ä¸ªç®—æ³•å¯ä»¥è¯´æ˜¯æœ€æ—©æœ€åŸºç¡€çš„ç®—æ³•äº†ã€‚</p><pre class="line-numbers language-none"><code class="language-none">æ ‡è®° - æ¸…é™¤é¡¾åæ€ä¹‰åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œå³<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ ‡è®°</strong>å’Œ<strong>æ¸…é™¤</strong>é˜¶æ®µï¼š</p><ul><li>é¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåï¼Œç»Ÿä¸€<strong>å›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°</strong>çš„å¯¹è±¡ã€‚</li><li>å½“ç„¶ä¹Ÿå¯ä»¥æ ‡è®°å­˜æ´»çš„å¯¹è±¡ï¼Œå›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚è¿™ä¸ªæ ‡è®°çš„è¿‡ç¨‹å°±æ˜¯<strong>åƒåœ¾åˆ¤å®š</strong>çš„è¿‡ç¨‹ã€‚</li></ul><p>åç»­å¤§éƒ¨åˆ†åƒåœ¾å›æ”¶ç®—æ³•éƒ½æ˜¯åŸºäºæ ‡è®° - ç®—æ³•æ€æƒ³è¡ç”Ÿçš„ï¼Œåªä¸è¿‡åç»­çš„ç®—æ³•å¼¥è¡¥äº†æ ‡è®° - æ¸…é™¤ç®—æ³•çš„ç¼ºç‚¹ï¼Œé‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆ<strong>ç¼ºç‚¹</strong>å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ä¸ª</p><ul><li><strong>æ‰§è¡Œæ•ˆç‡ä¸ç¨³å®š</strong>ï¼šå› ä¸ºå‡å¦‚è¯´å †ä¸­å­˜åœ¨å¤§é‡æ— ç”¨å¯¹è±¡ï¼Œè€Œä¸”å¤§éƒ¨åˆ†éœ€è¦å›æ”¶çš„æƒ…å†µä¸‹ï¼Œè¿™æ—¶å¿…é¡»è¿›è¡Œå¤§é‡çš„æ ‡è®°å’Œæ¸…é™¤ï¼Œå¯¼è‡´æ ‡è®°å’Œæ¸…é™¤è¿™ä¸¤ä¸ªè¿‡ç¨‹çš„æ‰§è¡Œæ•ˆç‡éšå¯¹è±¡çš„æ•°é‡å¢é•¿è€Œé™ä½ã€‚</li><li><strong>å†…å­˜ç¢ç‰‡åŒ–</strong>ï¼šæ ‡è®° - æ¸…é™¤ç®—æ³•ä¼šåœ¨å †åŒºäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚ç¢ç‰‡å¤ªå¤šä¼šå¯¼è‡´åœ¨åˆ†é…å¤§å¯¹è±¡æ—¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œä¸å¾—ä¸è¿›è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶æ“ä½œã€‚</li></ul><p>æ ‡è®°ç®—æ³•çš„ç¤ºæ„å›¾å¦‚ä¸‹</p><p><a href="https://s2.loli.net/2024/12/20/WcCTsNxHB2R5Lbo.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/WcCTsNxHB2R5Lbo.jpg"></a></p><h3 id="æ ‡è®°-å¤åˆ¶ç®—æ³•"><a href="#æ ‡è®°-å¤åˆ¶ç®—æ³•" class="headerlink" title="æ ‡è®° - å¤åˆ¶ç®—æ³•"></a>æ ‡è®° - å¤åˆ¶ç®—æ³•</h3><pre class="line-numbers language-none"><code class="language-none">ç”±äºæ ‡è®° - æ¸…é™¤ç®—æ³•ææ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œç ”ç©¶äººå‘˜æå‡ºäº†æ ‡è®° - å¤åˆ¶ç®—æ³•ï¼Œæ ‡è®° - å¤åˆ¶ç®—æ³•ä¹Ÿå¯ä»¥ç®€ç§°ä¸º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¤åˆ¶ç®—æ³•</strong>ï¼Œå¤åˆ¶ç®—æ³•æ˜¯ä¸€ç§<strong>åŠåŒºå¤åˆ¶</strong>ï¼Œå®ƒä¼šå°†å†…å­˜å¤§å°åˆ’åˆ†ä¸ºç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œç”¨å®Œä¸€å—å†ç”¨å¦å¤–ä¸€å—ï¼Œç„¶åå†æŠŠç”¨è¿‡çš„ä¸€å—è¿›è¡Œæ¸…é™¤ã€‚è™½ç„¶è§£å†³äº†éƒ¨åˆ†å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯å¤åˆ¶ç®—æ³•ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼Œå³<strong>å¤åˆ¶å¼€é”€</strong>ï¼Œä¸è¿‡è¿™ç§å¼€é”€æ˜¯å¯ä»¥é™ä½çš„ï¼Œå¦‚æœå†…å­˜ä¸­å¤§å¤šæ•°å¯¹è±¡æ˜¯æ— ç”¨å¯¹è±¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠå°‘æ•°çš„å­˜æ´»å¯¹è±¡è¿›è¡Œå¤åˆ¶ï¼Œå†å›æ”¶æ— ç”¨çš„å¯¹è±¡ã€‚</p><pre class="line-numbers language-none"><code class="language-none">ä¸è¿‡å¤åˆ¶ç®—æ³•çš„ç¼ºé™·ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œé‚£å°±æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å†…å­˜ç©ºé—´ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠ</strong>ï¼Œ<strong>ç©ºé—´æµªè´¹</strong>å¤ªæ˜æ˜¾ã€‚æ ‡è®° - å¤åˆ¶ç®—æ³•ç¤ºæ„å›¾å¦‚ä¸‹</p><p><a href="https://s2.loli.net/2024/12/20/XVRLqxNjO3JlwK8.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/XVRLqxNjO3JlwK8.jpg"></a></p><pre class="line-numbers language-none"><code class="language-none">ç°åœ¨<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Java</code> è™šæ‹Ÿæœºå¤§å¤šæ•°éƒ½æ˜¯ç”¨äº†è¿™ç§ç®—æ³•æ¥å›æ”¶æ–°ç”Ÿä»£ï¼Œå› ä¸ºç»è¿‡ç ”ç©¶è¡¨æ˜ï¼Œæ–°ç”Ÿä»£å¯¹è±¡Â <code>98%</code> éƒ½ç†¬ä¸è¿‡ç¬¬ä¸€è½®æ”¶é›†ï¼Œå› æ­¤ä¸éœ€è¦æŒ‰ç…§ 1 ï¼š1 çš„æ¯”ä¾‹æ¥åˆ’åˆ†æ–°ç”Ÿä»£çš„å†…å­˜ç©ºé—´ã€‚</p><pre class="line-numbers language-none"><code class="language-none">åŸºäºæ­¤ï¼Œç ”ç©¶äººå‘˜æå‡ºäº†ä¸€ç§<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Appel</code> å¼å›æ”¶ï¼Œ<code>Appel</code> å¼å›æ”¶çš„å…·ä½“åšæ³•æ˜¯æŠŠæ–°ç”Ÿä»£åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ <em><code>Eden</code></em> ç©ºé—´å’Œä¸¤å— <em><code>Survivor</code></em> ç©ºé—´ï¼Œæ¯æ¬¡åˆ†é…å†…å­˜éƒ½åªä½¿ç”¨ <code>Eden</code> å’Œå…¶ä¸­çš„ä¸€å— <code>Survivor</code> ç©ºé—´ï¼Œå‘ç”Ÿåƒåœ¾æ”¶é›†æ—¶ï¼Œå°† <code>Eden</code> å’Œ <code>Survivor</code> ä¸­ä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦å¤–ä¸€å— <code>Survivor</code> ç©ºé—´ä¸Šï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ <code>Eden</code> å’Œå·²ä½¿ç”¨è¿‡çš„ <code>Survivor</code> ç©ºé—´ã€‚</p><pre class="line-numbers language-none"><code class="language-none">åœ¨ä¸»æµçš„<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>HotSpot</code> è™šæ‹Ÿæœºä¸­ï¼Œé»˜è®¤çš„ <code>Eden</code> å’Œ <code>Survivor</code> å¤§å°æ¯”ä¾‹æ˜¯ <code>8ï¼š1</code>ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æ–°ç”Ÿä»£ä¸­å¯ç”¨å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£å®¹é‡çš„ <code>90%</code>ï¼Œåªæœ‰ä¸€ä¸ª <code>Survivor</code> ç©ºé—´ï¼Œæ‰€ä»¥ä¼šæµªè´¹æ‰ <code>10%</code> çš„ç©ºé—´ã€‚è¿™ä¸ª <code>8ï¼š1</code> åªæ˜¯ä¸€ä¸ªç†è®ºå€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½ä¿è¯æ¯æ¬¡éƒ½æœ‰ä¸è¶…è¿‡ <code>10%</code> çš„å¯¹è±¡å­˜æ´»ï¼Œæ‰€ä»¥ï¼Œå½“è¿›è¡Œåƒåœ¾å›æ”¶åå¦‚æœ <code>Survivor</code> å®¹çº³ä¸äº†å¯å­˜æ´»çš„å¯¹è±¡åï¼Œå°±éœ€è¦å…¶ä»–å†…å­˜ç©ºé—´æ¥è¿›è¡Œ<strong>å¸®åŠ©</strong>ï¼Œè¿™ç§æ–¹å¼å°±å«åš<strong>å†…å­˜æ‹…ä¿ (Handle Promotion)</strong> ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä½œä¸ºæ‹…ä¿çš„æ˜¯è€å¹´ä»£ã€‚</p><h3 id="æ ‡è®°-æ•´ç†ç®—æ³•"><a href="#æ ‡è®°-æ•´ç†ç®—æ³•" class="headerlink" title="æ ‡è®° - æ•´ç†ç®—æ³•"></a>æ ‡è®° - æ•´ç†ç®—æ³•</h3><pre class="line-numbers language-none"><code class="language-none">æ ‡è®° - å¤åˆ¶ç®—æ³•è™½ç„¶è§£å†³äº†å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰è§£å†³å¤åˆ¶å¯¹è±¡å­˜åœ¨å¤§é‡å¼€é”€çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³å¤åˆ¶ç®—æ³•çš„ç¼ºé™·ï¼Œå……åˆ†åˆ©ç”¨å†…å­˜ç©ºé—´ï¼Œæå‡ºäº†æ ‡è®° - æ•´ç†ç®—æ³•ã€‚è¯¥ç®—æ³•æ ‡è®°é˜¶æ®µå’Œæ ‡è®° - æ¸…é™¤ä¸€æ ·ï¼Œä½†æ˜¯åœ¨å®Œæˆæ ‡è®°ä¹‹åï¼Œå®ƒä¸æ˜¯ç›´æ¥æ¸…ç†å¯å›æ”¶å¯¹è±¡ï¼Œè€Œæ˜¯å°†å­˜æ´»å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://s2.loli.net/2024/12/20/GILHZhe4BEJRvsr.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/GILHZhe4BEJRvsr.jpg"></a></p><h2 id="ä»€ä¹ˆæ˜¯è®°å¿†é›†ï¼Œä»€ä¹ˆæ˜¯å¡è¡¨ï¼Ÿè®°å¿†é›†å’Œå¡è¡¨æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è®°å¿†é›†ï¼Œä»€ä¹ˆæ˜¯å¡è¡¨ï¼Ÿè®°å¿†é›†å’Œå¡è¡¨æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è®°å¿†é›†ï¼Œä»€ä¹ˆæ˜¯å¡è¡¨ï¼Ÿè®°å¿†é›†å’Œå¡è¡¨æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è®°å¿†é›†ï¼Œä»€ä¹ˆæ˜¯å¡è¡¨ï¼Ÿè®°å¿†é›†å’Œå¡è¡¨æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</h2><pre class="line-numbers language-none"><code class="language-none">ä¸ºäº†è§£å†³è·¨ä»£å¼•ç”¨é—®é¢˜ï¼Œæå‡ºäº†è®°å¿†é›†è¿™ä¸ªæ¦‚å¿µï¼Œè®°å¿†é›†æ˜¯ä¸€ä¸ªåœ¨æ–°ç”Ÿä»£ä¸­ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œå®ƒç›¸å½“äºæ˜¯è®°å½•äº†ä¸€äº›<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æŒ‡é’ˆçš„é›†åˆ</strong>ï¼ŒæŒ‡å‘äº†è€å¹´ä»£ä¸­å“ªäº›å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨ã€‚</p><pre class="line-numbers language-none"><code class="language-none">è®°å¿†é›†çš„å®ç°æœ‰ä¸åŒçš„ç²’åº¦<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><strong>å­—é•¿ç²¾åº¦</strong>ï¼šæ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªå­—é•¿ï¼Œæœºå™¨å­—é•¿å°±æ˜¯å¤„ç†å™¨çš„å¯»å€ä½æ•°ï¼Œæ¯”å¦‚å¸¸è§çš„ 32 ä½æˆ–è€… 64 ä½å¤„ç†å™¨ï¼Œè¿™ä¸ªç²¾åº¦å†³å®šäº†æœºå™¨è®¿é—®ç‰©ç†å†…å­˜åœ°å€çš„æŒ‡é’ˆé•¿åº¦ï¼Œå­—ä¸­åŒ…å«è·¨ä»£æŒ‡é’ˆã€‚</p></li><li><p><strong>å¯¹è±¡ç²¾åº¦</strong>ï¼šæ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡é‡Œå«æœ‰è·¨ä»£æŒ‡é’ˆã€‚</p></li><li><p><strong>å¡ç²¾åº¦</strong>ï¼šæ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€å—å†…å­˜åŒºåŸŸï¼ŒåŒºåŸŸå†…å«æœ‰è·¨ä»£æŒ‡é’ˆã€‚</p><p>å…¶ä¸­å¡ç²¾åº¦æ˜¯ä½¿ç”¨äº†å¡è¡¨ä½œä¸ºè®°å¿†é›†çš„å®ç°ï¼Œå…³äºè®°å¿†é›†å’Œå¡è¡¨çš„å…³ç³»ï¼Œå¤§å®¶å¯ä»¥æƒ³è±¡æˆæ˜¯ HashMap å’Œ Map çš„å…³ç³»ã€‚</p></li></ul><h2 id="ä»€ä¹ˆæ˜¯å¡é¡µï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¡é¡µï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¡é¡µï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å¡é¡µï¼Ÿ</h2><p>å¡è¡¨å…¶å®å°±æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token constant">CARD_TABLE</span><span class="token punctuation">[</span><span class="token keyword">this</span> address <span class="token operator">>></span> <span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">å­—èŠ‚æ•°ç»„<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>CARD_TABLE</code> çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯¹åº”ç€å†…å­˜åŒºåŸŸä¸­ä¸€å—ç‰¹å®šå¤§å°çš„å†…å­˜å—ï¼Œè¿™ä¸ªå†…å­˜å—å°±æ˜¯<strong>å¡é¡µ</strong>ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¡é¡µéƒ½æ˜¯ 2 çš„ N æ¬¡å¹‚å­—èŠ‚æ•°ï¼Œé€šè¿‡ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¡é¡µä¸€èˆ¬æ˜¯ 2 çš„ 9 æ¬¡å¹‚ï¼Œè¿™ä¹Ÿæ˜¯ <code>HotSpot</code> ä¸­ä½¿ç”¨çš„å¡é¡µï¼Œå³ 512 å­—èŠ‚ã€‚</p><pre class="line-numbers language-none"><code class="language-none">ä¸€ä¸ªå¡é¡µçš„å†…å­˜é€šå¸¸åŒ…å«ä¸æ­¢ä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦å¡é¡µä¸­æœ‰ä¸€ä¸ªå¯¹è±¡çš„å­—æ®µå­˜åœ¨è·¨ä»£æŒ‡é’ˆï¼Œé‚£å°±å°†å¯¹åº”å¡è¡¨çš„æ•°ç»„å…ƒç´ çš„å€¼è®¾ç½®ä¸º 1ï¼Œç§°ä¹‹ä¸ºè¿™ä¸ªå…ƒç´ å˜<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>è„</code>äº†ï¼Œæ²¡æœ‰æ ‡ç¤ºåˆ™ä¸º 0 ã€‚åœ¨åƒåœ¾æ”¶é›†æ—¶ï¼Œåªè¦ç­›é€‰å‡ºå¡è¡¨ä¸­å˜è„çš„å…ƒç´ ï¼Œå°±èƒ½è½»æ˜“å¾—å‡ºå“ªäº›å¡é¡µå†…å­˜å—ä¸­åŒ…å«è·¨ä»£æŒ‡é’ˆï¼Œç„¶åæŠŠä»–ä»¬åŠ å…¥ <code>GC Roots</code> è¿›è¡Œæ‰«æã€‚</p><p>æ‰€ä»¥ï¼Œå¡é¡µå’Œå¡è¡¨ä¸»è¦ç”¨æ¥è§£å†³è·¨ä»£å¼•ç”¨é—®é¢˜çš„ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å†™å±éšœï¼Ÿå†™å±éšœå¸¦æ¥çš„é—®é¢˜ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å†™å±éšœï¼Ÿå†™å±éšœå¸¦æ¥çš„é—®é¢˜ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å†™å±éšœï¼Ÿå†™å±éšœå¸¦æ¥çš„é—®é¢˜ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å†™å±éšœï¼Ÿå†™å±éšœå¸¦æ¥çš„é—®é¢˜ï¼Ÿ</h2><h3 id="å†™å±éšœ"><a href="#å†™å±éšœ" class="headerlink" title="å†™å±éšœ"></a>å†™å±éšœ</h3><pre class="line-numbers language-none"><code class="language-none">å¦‚æœæœ‰å…¶ä»–åˆ†ä»£åŒºåŸŸä¸­å¯¹è±¡å¼•ç”¨äº†æœ¬åŒºåŸŸçš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹åº”çš„å¡è¡¨å…ƒç´ å°±ä¼šå˜è„ï¼Œè¿™ä¸ªå¼•ç”¨è¯´çš„å°±æ˜¯å¯¹è±¡èµ‹å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¡è¡¨å…ƒç´ ä¼šå˜è„å‘ç”Ÿåœ¨å¯¹è±¡èµ‹å€¼çš„æ—¶å€™ï¼Œé‚£ä¹ˆå¦‚ä½•åœ¨å¯¹è±¡èµ‹å€¼çš„æ—¶å€™æ›´æ–°ç»´æŠ¤å¡è¡¨å‘¢ï¼Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ <code>HotSpot</code> è™šæ‹Ÿæœºä¸­ä½¿ç”¨çš„æ˜¯<strong>å†™å±éšœ (Write Barrier)</strong> æ¥ç»´æŠ¤å¡è¡¨çŠ¶æ€çš„ï¼Œè¿™ä¸ªå†™å±éšœå’Œæˆ‘ä»¬å†…å­˜å±éšœå®Œå…¨ä¸åŒï¼Œå¸Œæœ›è¯»è€…ä¸è¦ææ··äº†ã€‚</p><pre class="line-numbers language-none"><code class="language-none">è¿™ä¸ªå†™å±éšœå…¶å®å°±æ˜¯ä¸€ä¸ª<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Aop</code> åˆ‡é¢ï¼Œåœ¨å¼•ç”¨å¯¹è±¡è¿›è¡Œèµ‹å€¼æ—¶ä¼šäº§ç”Ÿä¸€ä¸ª**ç¯å½¢é€šçŸ¥ (Around)**ï¼Œç¯å½¢é€šçŸ¥å°±æ˜¯åˆ‡é¢å‰ååˆ†åˆ«äº§ç”Ÿä¸€ä¸ªé€šçŸ¥ï¼Œå› ä¸ºè¿™ä¸ªåˆæ˜¯å†™å±éšœï¼Œæ‰€ä»¥åœ¨èµ‹å€¼å‰çš„éƒ¨åˆ†å†™å±éšœå«åšå†™å‰å±éšœï¼Œåœ¨èµ‹å€¼åçš„åˆ™å«åšå†™åå±éšœã€‚</p><h3 id="å†™å±éšœä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜"><a href="#å†™å±éšœä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜" class="headerlink" title="å†™å±éšœä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜"></a>å†™å±éšœä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜</h3><h4 id="æ— æ¡ä»¶å†™å±éšœå¸¦æ¥çš„æ€§èƒ½å¼€é”€"><a href="#æ— æ¡ä»¶å†™å±éšœå¸¦æ¥çš„æ€§èƒ½å¼€é”€" class="headerlink" title="æ— æ¡ä»¶å†™å±éšœå¸¦æ¥çš„æ€§èƒ½å¼€é”€"></a><strong>æ— æ¡ä»¶å†™å±éšœå¸¦æ¥çš„æ€§èƒ½å¼€é”€</strong></h4><pre class="line-numbers language-none"><code class="language-none">æ¯æ¬¡å¯¹å¼•ç”¨çš„æ›´æ–°ï¼Œæ— è®ºæ˜¯å¦æ›´æ–°äº†è€å¹´ä»£å¯¹æ–°ç”Ÿä»£å¯¹è±¡çš„å¼•ç”¨ï¼Œéƒ½ä¼šè¿›è¡Œä¸€æ¬¡å†™å±éšœæ“ä½œã€‚æ˜¾ç„¶ï¼Œè¿™ä¼šå¢åŠ ä¸€äº›é¢å¤–çš„å¼€é”€ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ä½†æ˜¯ï¼Œæ‰«ææ•´ä¸ªè€å¹´ä»£ç›¸æ¯”è¾ƒï¼Œè¿™ä¸ªå¼€é”€å°±ä½å¾—å¤šäº†ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ä¸è¿‡ï¼Œåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå†™å±éšœåˆå¸¦æ¥äº†ä¼ªå…±äº«ï¼ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>false sharing</code>ï¼‰é—®é¢˜ã€‚</p><h4 id="é«˜å¹¶å‘ä¸‹ä¼ªå…±äº«å¸¦æ¥çš„æ€§èƒ½å¼€é”€"><a href="#é«˜å¹¶å‘ä¸‹ä¼ªå…±äº«å¸¦æ¥çš„æ€§èƒ½å¼€é”€" class="headerlink" title="é«˜å¹¶å‘ä¸‹ä¼ªå…±äº«å¸¦æ¥çš„æ€§èƒ½å¼€é”€"></a><strong>é«˜å¹¶å‘ä¸‹ä¼ªå…±äº«å¸¦æ¥çš„æ€§èƒ½å¼€é”€</strong></h4><pre class="line-numbers language-none"><code class="language-none">åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œé¢‘ç¹çš„å†™å±éšœå¾ˆå®¹æ˜“å‘ç”Ÿä¼ªå…±äº«ï¼ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>false sharing</code>ï¼‰ï¼Œä»è€Œå¸¦æ¥æ€§èƒ½å¼€é”€ã€‚</p><pre class="line-numbers language-none"><code class="language-none">å‡è®¾<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>CPU</code> ç¼“å­˜è¡Œå¤§å°ä¸º 64 å­—èŠ‚ï¼Œç”±äºä¸€ä¸ªå¡è¡¨é¡¹å  1 ä¸ªå­—èŠ‚ï¼Œè¿™æ„å‘³ç€ï¼Œ64 ä¸ªå¡è¡¨é¡¹å°†å…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œã€‚</p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>HotSpot</code> æ¯ä¸ªå¡é¡µä¸º 512 å­—èŠ‚ï¼Œé‚£ä¹ˆä¸€ä¸ªç¼“å­˜è¡Œå°†å¯¹åº” 64 ä¸ªå¡é¡µä¸€å…± <code>64*512 = 32KB</code>ã€‚</p><pre class="line-numbers language-none"><code class="language-none">å¦‚æœä¸åŒçº¿ç¨‹å¯¹å¯¹è±¡å¼•ç”¨çš„æ›´æ–°æ“ä½œï¼Œæ°å¥½ä½äºåŒä¸€ä¸ª 32 KB åŒºåŸŸå†…ï¼Œè¿™å°†å¯¼è‡´åŒæ—¶æ›´æ–°å¡è¡¨çš„åŒä¸€ä¸ªç¼“å­˜è¡Œï¼Œä»è€Œé€ æˆç¼“å­˜è¡Œçš„å†™å›ã€æ— æ•ˆåŒ–æˆ–è€…åŒæ­¥æ“ä½œï¼Œé—´æ¥å½±å“ç¨‹åºæ€§èƒ½ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ä¸é‡‡ç”¨æ— æ¡ä»¶çš„å†™å±éšœï¼Œè€Œæ˜¯å…ˆæ£€æŸ¥å¡è¡¨æ ‡è®°ï¼Œåªæœ‰å½“è¯¥å¡è¡¨é¡¹æœªè¢«æ ‡è®°è¿‡æ‰å°†å…¶æ ‡è®°ä¸ºè„çš„ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">è¿™å°±æ˜¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>JDK Â 7</code> ä¸­å¼•å…¥çš„è§£å†³æ–¹æ³•ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°çš„ JVM å‚æ•° <code>-XX:+UseCondCardMark</code>ï¼Œåœ¨æ‰§è¡Œå†™å±éšœä¹‹å‰ï¼Œå…ˆç®€å•çš„åšä¸€ä¸‹åˆ¤æ–­ã€‚å¦‚æœå¡é¡µå·²è¢«æ ‡è¯†è¿‡ï¼Œåˆ™ä¸å†è¿›è¡Œæ ‡è¯†ã€‚</p><p>ç®€å•ç†è§£å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">CARD_TABLE</span> <span class="token punctuation">[</span><span class="token keyword">this</span> address <span class="token operator">>></span> <span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token constant">CARD_TABLE</span> <span class="token punctuation">[</span><span class="token keyword">this</span> address <span class="token operator">>></span> <span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ä¸åŸæ¥çš„å®ç°ç›¸æ¯”ï¼Œåªæ˜¯ç®€å•çš„å¢åŠ äº†ä¸€ä¸ªåˆ¤æ–­æ“ä½œã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">è™½ç„¶å¼€å¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>-XX:+UseCondCardMark</code> ä¹‹åå¤šäº†ä¸€äº›åˆ¤æ–­å¼€é”€ï¼Œä½†æ˜¯å´å¯ä»¥é¿å…åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹å¯èƒ½å‘ç”Ÿçš„å¹¶å‘å†™å¡è¡¨é—®é¢˜ã€‚</p><pre class="line-numbers language-none"><code class="language-none">é€šè¿‡å‡å°‘å¹¶å‘å†™æ“ä½œï¼Œè¿›è€Œé¿å…å‡ºç°ä¼ªå…±äº«é—®é¢˜ï¼ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>false sharing</code>ï¼‰ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°æ³•ï¼Ÿä¸‰è‰²æ ‡è®°æ³•ä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°æ³•ï¼Ÿä¸‰è‰²æ ‡è®°æ³•ä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°æ³•ï¼Ÿä¸‰è‰²æ ‡è®°æ³•ä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä¸‰è‰²æ ‡è®°æ³•ï¼Ÿä¸‰è‰²æ ‡è®°æ³•ä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ</h2><blockquote><p>ç™½è‰²ï¼šå¯å›æ”¶ã€ç°è‰²ï¼šè¿˜æœªè®¿é—®å®Œæ¯•ã€é»‘è‰²ï¼šå·²è®¿é—®</p></blockquote><h3 id="ä¸‰è‰²æ ‡è®°æ³•"><a href="#ä¸‰è‰²æ ‡è®°æ³•" class="headerlink" title="ä¸‰è‰²æ ‡è®°æ³•"></a>ä¸‰è‰²æ ‡è®°æ³•</h3><pre class="line-numbers language-none"><code class="language-none">æ ¹æ®å¯è¾¾æ€§ç®—æ³•çš„åˆ†æå¯çŸ¥ï¼Œå¦‚æœè¦æ‰¾å‡ºå­˜æ´»å¯¹è±¡ï¼Œéœ€è¦ä»<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>GC Roots</code> å¼€å§‹éå†ï¼Œç„¶åæœç´¢æ¯ä¸ªå¯¹è±¡æ˜¯å¦å¯è¾¾ï¼Œå¦‚æœå¯¹è±¡å¯è¾¾åˆ™ä¸ºå­˜æ´»å¯¹è±¡ï¼Œåœ¨ GC Roots çš„æœç´¢è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§<strong>å¯¹è±¡å’Œå…¶å¼•ç”¨æ˜¯å¦è¢«è®¿é—®è¿‡</strong>è¿™ä¸ªæ¡ä»¶ä¼šåˆ†æˆä¸‹é¢ä¸‰ç§é¢œè‰²ï¼š</p><ul><li><strong>ç™½è‰²</strong>ï¼šç™½è‰²è¡¨ç¤º <code>GC Roots</code> çš„éå†è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«è®¿é—®è¿‡çš„å¯¹è±¡ï¼Œå‡ºç°ç™½è‰²æ˜¾ç„¶åœ¨å¯è¾¾æ€§åˆ†æåˆšåˆšå¼€å§‹çš„é˜¶æ®µï¼Œè¿™ä¸ªæ—¶å€™æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ï¼Œå¦‚æœåœ¨åˆ†æç»“æŸçš„é˜¶æ®µï¼Œä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡ï¼Œé‚£ä¹ˆä»£è¡¨ä¸å¯è¾¾ï¼Œå¯ä»¥<strong>è¿›è¡Œå›æ”¶</strong>ã€‚</li><li><strong>ç°è‰²</strong>ï¼šç°è‰²è¡¨ç¤ºå¯¹è±¡å·²ç»<strong>è¢«è®¿é—®è¿‡ï¼Œ</strong>ä½†æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è¿˜<strong>æ²¡æœ‰è®¿é—®å®Œæ¯•</strong>ã€‚</li><li><strong>é»‘è‰²</strong>ï¼šé»‘è‰²è¡¨ç¤ºæ­¤å¯¹è±¡å·²ç»è¢«è®¿é—®è¿‡äº†ï¼Œè€Œä¸”è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ä¹Ÿå·²ç»è¢«è®¿é—®äº†ã€‚</li></ul><blockquote><p>æ³¨ï¼šå¦‚æœæ ‡è®°ç»“æŸåå¯¹è±¡ä»ä¸ºç™½è‰²ï¼Œæ„å‘³ç€å·²ç» â€œæ‰¾ä¸åˆ°â€ è¯¥å¯¹è±¡åœ¨å“ªäº†ï¼Œä¸å¯èƒ½ä¼šå†è¢«é‡æ–°å¼•ç”¨ã€‚</p></blockquote><pre class="line-numbers language-none"><code class="language-none">ç°ä»£çš„åƒåœ¾å›æ”¶å™¨å‡ ä¹éƒ½å€Ÿé‰´äº†ä¸‰è‰²æ ‡è®°çš„ç®—æ³•æ€æƒ³ï¼Œå°½ç®¡å®ç°çš„æ–¹å¼ä¸å°½ç›¸åŒï¼š<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç™½è‰² / é»‘è‰²é›†åˆä¸€èˆ¬éƒ½ä¸ä¼šå‡ºç°ï¼ˆä½†æ˜¯æœ‰å…¶ä»–ä½“ç°é¢œè‰²çš„åœ°æ–¹ï¼‰</li><li>ç°è‰²é›†åˆå¯ä»¥é€šè¿‡<strong>æ ˆ / é˜Ÿåˆ— / ç¼“å­˜æ—¥å¿—</strong>ç­‰æ–¹å¼è¿›è¡Œå®ç°ã€éå†æ–¹å¼å¯ä»¥æ˜¯å¹¿åº¦ / æ·±åº¦éå†ç­‰ç­‰ã€‚</li></ul><h3 id="é€ æˆé—®é¢˜"><a href="#é€ æˆé—®é¢˜" class="headerlink" title="é€ æˆé—®é¢˜"></a>é€ æˆé—®é¢˜</h3><pre class="line-numbers language-none"><code class="language-none">ä¸‰è‰²æ ‡è®°æ³•ä¼šé€ æˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä¸¤ç§é—®é¢˜</strong>ï¼Œè¿™ä¸¤ç§é—®é¢˜æ‰€å‡ºç°çš„ç¯å¢ƒéƒ½æ˜¯ç”±äºã€<strong>ç”¨æˆ·ç¯å¢ƒã€‘å’Œã€æ”¶é›†å™¨å¹¶è¡Œå·¥ä½œã€‘é€ æˆçš„</strong> ã€‚</p><pre class="line-numbers language-none"><code class="language-none">å½“ç”¨æˆ·çº¿ç¨‹æ­£åœ¨ä¿®æ”¹å¼•ç”¨å…³ç³»ï¼Œæ­¤æ—¶æ”¶é›†å™¨åœ¨å›æ”¶å¼•ç”¨å…³ç³»ï¼Œæ­¤æ—¶å°±ä¼šé€ æˆæŠŠåŸæœ¬å·²ç»æ¶ˆäº¡çš„å¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»ï¼Œå¦‚æœå‡ºç°è¿™ç§çŠ¶å†µçš„è¯ï¼Œé—®é¢˜ä¸å¤§ï¼Œä¸‹æ¬¡å†è®©æ”¶é›†å™¨é‡æ–°æ”¶é›†ä¸€æ³¢å°±å®Œäº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æŠŠå­˜æ´»çš„å¯¹è±¡æ ‡è®°ä¸ºæ­»äº¡ï¼Œè¿™ç§çŠ¶å†µå°±ä¼šé€ æˆä¸å¯é¢„çŸ¥çš„åæœã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">é’ˆå¯¹ä¸Šé¢è¿™ä¸¤ç§å¯¹è±¡æ¶ˆå¤±é—®é¢˜ï¼Œä¸šç•Œæœ‰ä¸¤ç§<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¤„ç†æ–¹å¼</strong>ï¼Œ</p><ul><li><strong>å¢é‡æ›´æ–° (Incremental Update)</strong> ï¼Œ</li><li>**åŸå§‹å¿«ç…§ (Snapshot At The Beginning, SATB)**ã€‚</li></ul><h2 id="è¯·ä½ ä»‹ç»ä¸€æ³¢åƒåœ¾æ”¶é›†å™¨"><a href="#è¯·ä½ ä»‹ç»ä¸€æ³¢åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="è¯·ä½ ä»‹ç»ä¸€æ³¢åƒåœ¾æ”¶é›†å™¨"></a>è¯·ä½ ä»‹ç»ä¸€æ³¢åƒåœ¾æ”¶é›†å™¨</h2><pre class="line-numbers language-none"><code class="language-none">åƒåœ¾æ”¶é›†å™¨æ˜¯é¢è¯•çš„å¸¸è€ƒï¼Œä¹Ÿæ˜¯å¿…è€ƒç‚¹ï¼Œåªè¦æ¶‰åŠåˆ°<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>JVM</code> çš„ç›¸å…³é—®é¢˜ï¼Œéƒ½ä¼šå›´ç»•ç€åƒåœ¾æ”¶é›†å™¨æ¥åšä¸€æ³¢å±•å¼€ï¼Œæ‰€ä»¥ï¼Œæœ‰å¿…è¦äº†è§£ä¸€ä¸‹è¿™äº›åƒåœ¾æ”¶é›†å™¨ã€‚</p><pre class="line-numbers language-none"><code class="language-none">åƒåœ¾æ”¶é›†å™¨æœ‰å¾ˆå¤šï¼Œä¸åŒå•†å®¶ã€ä¸åŒç‰ˆæœ¬çš„ JVM æ‰€æä¾›çš„åƒåœ¾æ”¶é›†å™¨å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®åˆ«ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>HotSpot</code> è™šæ‹Ÿæœºä¸­çš„åƒåœ¾æ”¶é›†å™¨ã€‚</p><pre class="line-numbers language-none"><code class="language-none">åƒåœ¾æ”¶é›†å™¨æ˜¯åƒåœ¾å›æ”¶ç®—æ³•çš„å…·ä½“å®ç°ï¼Œæˆ‘ä»¬ä¸Šé¢æåˆ°è¿‡ï¼Œåƒåœ¾å›æ”¶ç®—æ³•æœ‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ ‡è®° - æ¸…é™¤ç®—æ³•</strong>ã€<strong>æ ‡è®° - å¤åˆ¶</strong>ã€<strong>æ ‡è®° - æ•´ç†</strong>ï¼Œæ‰€ä»¥å¯¹åº”çš„åƒåœ¾æ”¶é›†å™¨ä¹Ÿæœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚</p><pre class="line-numbers language-none"><code class="language-none">æˆ‘ä»¬çŸ¥é“ï¼Œ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>HotSpot</code> è™šæ‹Ÿæœºä¸­çš„åƒåœ¾æ”¶é›†éƒ½æ˜¯åˆ†ä»£å›æ”¶çš„ï¼Œæ‰€ä»¥æ ¹æ®ä¸åŒçš„åˆ†ä»£ï¼Œå¯ä»¥æŠŠåƒåœ¾æ”¶é›†å™¨åˆ†ä¸º</p><ul><li>æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼š<code>Serialã€ParNewã€Parallel Scavenge</code></li><li>è€å¹´ä»£æ”¶é›†å™¨ï¼š<code>Serial Oldã€Parallel Oldã€CMS</code></li><li>æ•´å †æ”¶é›†å™¨ï¼š<code>G1</code></li></ul><h3 id="Serial-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-å•çº¿ç¨‹ï¼‰"><a href="#Serial-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-å•çº¿ç¨‹ï¼‰" class="headerlink" title="Serial æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|å•çº¿ç¨‹ï¼‰"></a>Serial æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|å•çº¿ç¨‹ï¼‰</h3><p><code>Serial</code> æ”¶é›†å™¨æ˜¯ä¸€ç§<strong>æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†å™¨</strong>ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>å•çº¿ç¨‹</strong>å·¥ä½œçš„æ”¶é›†å™¨ï¼Œä½¿ç”¨<strong>å¤åˆ¶ç®—æ³•</strong>æ¥è¿›è¡Œå›æ”¶ï¼Œå•çº¿ç¨‹å·¥ä½œä¸æ˜¯è¯´è¿™ä¸ªåƒåœ¾æ”¶é›†å™¨åªæœ‰ä¸€ä¸ªï¼Œè€Œæ˜¯è¯´è¿™ä¸ªæ”¶é›†å™¨åœ¨å·¥ä½œæ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼Œè¿™ç§æš´åŠ›çš„æš‚åœæ–¹å¼å°±æ˜¯ **<code>Stop The World</code>**ï¼ŒSerial å°±å¥½åƒæ˜¯å¯¡å¤´å„æ–­ä¸€æ ·ï¼Œåªè¦å®ƒä¸€å‘è¯ï¼Œå…¶ä»–æ‰€æœ‰çš„å°å¼Ÿï¼ˆçº¿ç¨‹ï¼‰éƒ½å¾—ç»™å®ƒè®©è·¯ã€‚<code>Serial</code> æ”¶é›†å™¨çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><a href="https://s2.loli.net/2024/12/20/XMh2GiZEJH4sRau.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/XMh2GiZEJH4sRau.jpg"></a></p><pre class="line-numbers language-none"><code class="language-none">è™½ç„¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Serial</code> æœ‰ <code>STW</code> è¿™ç§æ˜¾è€Œæ˜“è§çš„ç¼ºç‚¹ï¼Œä¸è¿‡ï¼Œä»å…¶ä»–è§’åº¦æ¥çœ‹ï¼Œ<code>Serial</code> è¿˜æ˜¯å¾ˆè®¨å–œçš„ï¼Œå®ƒè¿˜æœ‰ç€ä¼˜äºå…¶ä»–æ”¶é›†å™¨çš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯ç®€å•è€Œé«˜æ•ˆï¼Œå¯¹äºå†…å­˜èµ„æºé¦–å…ˆçš„ç¯å¢ƒï¼Œå®ƒæ˜¯æ‰€æœ‰æ”¶é›†å™¨ä¸­é¢å¤–å†…å­˜æ¶ˆè€—æœ€å°çš„ï¼Œå¯¹äºå•æ ¸å¤„ç†å™¨æˆ–è€…å¤„ç†å™¨æ ¸å¿ƒè¾ƒå°‘çš„ç¯å¢ƒæ¥è¯´ï¼Œ<code>Serial</code> æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’å¼€é”€ï¼Œæ‰€ä»¥ <code>Serial</code> ä¸“å¿ƒåšåƒåœ¾å›æ”¶æ•ˆç‡æ¯”è¾ƒé«˜ã€‚</p><h3 id="SefePoint-å…¨å±€å®‰å…¨ç‚¹"><a href="#SefePoint-å…¨å±€å®‰å…¨ç‚¹" class="headerlink" title="SefePoint å…¨å±€å®‰å…¨ç‚¹"></a>SefePoint å…¨å±€å®‰å…¨ç‚¹</h3><pre class="line-numbers language-none"><code class="language-none">å®ƒå°±æ˜¯ä»£ç ä¸­çš„ä¸€æ®µç‰¹æ®Šçš„ä½ç½®ï¼Œåœ¨æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹åˆ°è¾¾<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>SafePoint</code> ä¹‹åï¼Œç”¨æˆ·çº¿ç¨‹æŒ‚èµ·ï¼ŒGC çº¿ç¨‹ä¼šè¿›è¡Œæ¸…ç†å·¥ä½œã€‚</p><h3 id="ParNew-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-å¤šçº¿ç¨‹ï¼‰"><a href="#ParNew-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-å¤šçº¿ç¨‹ï¼‰" class="headerlink" title="ParNew æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|å¤šçº¿ç¨‹ï¼‰"></a>ParNew æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|å¤šçº¿ç¨‹ï¼‰</h3><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>ParNew</code> æ˜¯ <code>Serial</code> çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†åŒæ—¶ä½¿ç”¨å¤šæ¡çº¿ç¨‹å¤–ï¼Œå…¶ä»–å‚æ•°å’Œæœºåˆ¶ï¼ˆ<strong>STWã€å›æ”¶ç­–ç•¥ã€å¯¹è±¡åˆ†é…è§„åˆ™</strong>ï¼‰éƒ½å’Œ <code>Serial</code> å®Œå…¨ä¸€è‡´ï¼Œ<code>ParNew</code> æ”¶é›†å™¨çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><a href="https://s2.loli.net/2024/12/20/XVIwbtksjyq9EKd.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/XVIwbtksjyq9EKd.jpg"></a></p><pre class="line-numbers language-none"><code class="language-none">è™½ç„¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>ParNew</code> ä½¿ç”¨äº†å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾å›æ”¶</p><ul><li>å•çº¿ç¨‹ç¯å¢ƒä¸‹å®ƒç»å¯¹ä¸ä¼šæ¯” <code>Serial</code> æ”¶é›†æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå¤šçº¿ç¨‹å­˜åœ¨çº¿ç¨‹äº¤äº’çš„å¼€é”€</li><li>CPU<code> æ ¸æ•°çš„å¢åŠ ï¼Œ</code>ParNew<code>çš„å¤„ç†æ•ˆç‡ä¼šæ¯”</code>Serial` æ›´é«˜æ•ˆã€‚</li></ul><h3 id="Parallel-Scavenge-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-æ§åˆ¶ååï¼‰"><a href="#Parallel-Scavenge-æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ-å¤åˆ¶ç®—æ³•-æ§åˆ¶ååï¼‰" class="headerlink" title="Parallel Scavenge æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|æ§åˆ¶ååï¼‰"></a>Parallel Scavenge æ”¶é›†å™¨ï¼ˆæ–°ç”Ÿ|å¤åˆ¶ç®—æ³•|æ§åˆ¶ååï¼‰</h3><p><code>Parallel Scavenge</code> æ”¶é›†å™¨ä¹Ÿæ˜¯ä¸€æ¬¾æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå®ƒåŒæ ·æ˜¯åŸºäºæ ‡è®° - å¤åˆ¶ç®—æ³•å®ç°çš„ï¼Œè€Œä¸”å®ƒä¹Ÿèƒ½å¤Ÿ<strong>å¹¶è¡Œæ”¶é›†</strong>ï¼Œè¿™ä¹ˆçœ‹æ¥ï¼Œè¡¨é¢ä¸Š <code>Parallel Scavenge</code> ä¸ <code>ParNew</code> éå¸¸ç›¸ä¼¼ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p><code>Parallel Scavenge</code> çš„å…³æ³¨ç‚¹ä¸»è¦åœ¨<strong>è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ä¸Šé¢</strong>ã€‚ååé‡å°±æ˜¯å¤„ç†å™¨ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸å¤„ç†å™¨æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”ã€‚ä¹Ÿå°±æ˜¯</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545539.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545539.jpeg"></a></p><p>è¿™é‡Œç»™å¤§å®¶ä¸¾ä¸€ä¸ªååé‡çš„ä¾‹å­ï¼Œå¦‚æœæ‰§è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ + è¿è¡Œåƒåœ¾æ”¶é›†çš„æ—¶é—´æ€»å…±è€—è´¹äº† 100 åˆ†é’Ÿï¼Œå…¶ä¸­åƒåœ¾æ”¶é›†è€—è´¹æ‰äº† 1 åˆ†é’Ÿï¼Œé‚£ä¹ˆååé‡å°±æ˜¯ 99%ã€‚åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’æˆ–éœ€è¦ä¿è¯æœåŠ¡å“åº”è´¨é‡ï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦å¯ä»¥æå‡ç”¨æˆ·ä½“éªŒï¼Œè€Œé«˜ååé‡å¯ä»¥æœ€é«˜æ•ˆç‡åˆ©ç”¨å¤„ç†å™¨èµ„æºã€‚</p><h3 id="Serial-Old-æ”¶é›†å™¨ï¼ˆè€å¹´-å¤åˆ¶ç®—æ³•-å•çº¿ç¨‹ï¼‰"><a href="#Serial-Old-æ”¶é›†å™¨ï¼ˆè€å¹´-å¤åˆ¶ç®—æ³•-å•çº¿ç¨‹ï¼‰" class="headerlink" title="Serial Old æ”¶é›†å™¨ï¼ˆè€å¹´|å¤åˆ¶ç®—æ³•|å•çº¿ç¨‹ï¼‰"></a>Serial Old æ”¶é›†å™¨ï¼ˆè€å¹´|å¤åˆ¶ç®—æ³•|å•çº¿ç¨‹ï¼‰</h3><pre class="line-numbers language-none"><code class="language-none">å‰é¢ä»‹ç»äº†ä¸€ä¸‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Serial</code>ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªæ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†ï¼Œä½¿ç”¨äº†æ ‡è®° - å¤åˆ¶ç®—æ³•ã€‚è€Œè¿™ä¸ª <code>Serial Old</code> æ”¶é›†å™¨å´æ˜¯ Serial çš„è€å¹´ç‰ˆæœ¬ï¼Œå®ƒåŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä½¿ç”¨çš„æ˜¯<strong>æ ‡è®° - æ•´ç†</strong>ç®—æ³•ã€‚</p><p>Serial Old æ”¶é›†å™¨æœ‰ä¸¤ç§ç”¨é€”ï¼š</p><ul><li>ä¸€ç§æ˜¯åœ¨ <code>JDK 5</code> å’Œä¹‹å‰çš„ç‰ˆæœ¬ä¸ <code>Parallel Scavenge</code> æ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼Œ</li><li>å¦å¤–ä¸€ç§ç”¨æ³•å°±æ˜¯ä½œä¸º <code>CMS</code> æ”¶é›†å™¨çš„å¤‡é€‰ï¼Œ<code>CMS</code> åƒåœ¾æ”¶é›†å™¨æˆ‘ä»¬ä¸‹é¢è¯´ï¼Œ<code>Serial Old</code> çš„æ”¶é›†æµç¨‹å¦‚ä¸‹</li></ul><p><a href="https://s2.loli.net/2024/12/20/BlE1N9ztDf3TO7M.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/BlE1N9ztDf3TO7M.jpg"></a></p><h3 id="Parallel-Old-æ”¶é›†å™¨ï¼ˆè€å¹´-å¤åˆ¶ç®—æ³•-å¤šçº¿ç¨‹ï¼‰"><a href="#Parallel-Old-æ”¶é›†å™¨ï¼ˆè€å¹´-å¤åˆ¶ç®—æ³•-å¤šçº¿ç¨‹ï¼‰" class="headerlink" title="Parallel Old æ”¶é›†å™¨ï¼ˆè€å¹´|å¤åˆ¶ç®—æ³•|å¤šçº¿ç¨‹ï¼‰"></a>Parallel Old æ”¶é›†å™¨ï¼ˆè€å¹´|å¤åˆ¶ç®—æ³•|å¤šçº¿ç¨‹ï¼‰</h3><pre class="line-numbers language-none"><code class="language-none">å‰é¢æˆ‘ä»¬ä»‹ç»äº†<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Parallel Scavenge</code> æ”¶é›†å™¨ï¼Œç°åœ¨æ¥ä»‹ç»ä¸€ä¸‹ <code>Parallel Old</code> æ”¶é›†å™¨ï¼Œå®ƒæ˜¯ <code>Parallel Scavenge</code> çš„è€å¹´ç‰ˆæœ¬ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶å‘æ”¶é›†ï¼ŒåŸºäºæ ‡è®° - æ•´ç†ç®—æ³•å®ç°ï¼Œ<code>JDK 6</code> ä¹‹åå‡ºç°ï¼Œååé‡ä¼˜å…ˆå¯ä»¥è€ƒè™‘ <code>Parallel Scavenge + Parallel Old</code> çš„æ­é…</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545344.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545344.jpeg"></a></p><h3 id="CMS-æ”¶é›†å™¨-æ¸…é™¤ç®—æ³•-å››ä¸ªæ­¥éª¤-JDK9ä¸å†æ¨èé»˜è®¤"><a href="#CMS-æ”¶é›†å™¨-æ¸…é™¤ç®—æ³•-å››ä¸ªæ­¥éª¤-JDK9ä¸å†æ¨èé»˜è®¤" class="headerlink" title="CMS æ”¶é›†å™¨(æ¸…é™¤ç®—æ³•|å››ä¸ªæ­¥éª¤|JDK9ä¸å†æ¨èé»˜è®¤)"></a>CMS æ”¶é›†å™¨(æ¸…é™¤ç®—æ³•|å››ä¸ªæ­¥éª¤|JDK9ä¸å†æ¨èé»˜è®¤)</h3><blockquote><p>ä¸‰æ¬¡æ ‡è®°+1æ¬¡æ¸…é™¤</p><p>é—®é¢˜ï¼šèµ„æºæ•æ„Ÿã€æµ®åŠ¨åƒåœ¾ã€ç©ºé—´ç¢ç‰‡</p></blockquote><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>CMS</code>æ”¶é›†å™¨çš„ä¸»è¦ç›®æ ‡æ˜¯è·å–<strong>æœ€çŸ­çš„å›æ”¶åœé¡¿æ—¶é—´</strong>ï¼Œå®ƒçš„å…¨ç§°æ˜¯ã€ _<strong>Concurrent Mark Sweep</strong>_ã€‘ï¼Œä»è¿™ä¸ªåå­—å°±å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªæ”¶é›†å™¨æ˜¯åŸºäºæ ‡è®° - æ¸…é™¤ç®—æ³•å®ç°çš„ï¼Œè€Œä¸”æ”¯æŒå¹¶å‘æ”¶é›†ï¼Œå®ƒçš„è¿è¡Œè¿‡ç¨‹è¦æ¯”ä¸Šé¢æˆ‘ä»¬æåˆ°çš„æ”¶é›†å™¨å¤æ‚ä¸€äº›ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>åˆå§‹æ ‡è®°ï¼ˆ<code>CMS initial mark</code>ï¼‰ï¼š**<em>Stop The World</em>**ï¼Œåˆå§‹æ ‡è®°åªæ˜¯æ ‡è®°ä¸€ä¸‹å’Œ <code>GC Roots</code> ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼›</li><li>å¹¶å‘æ ‡è®°ï¼ˆ<code>CMS concurrent mark</code>ï¼‰: **<em>Stop The World</em>**ï¼Œä» <code>GC Roots</code> çš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹æ—¶é—´æ¯”è¾ƒé•¿ä½†æ˜¯ä¸éœ€è¦åœé¡¿ç”¨æˆ·çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸€èµ·å¹¶å‘è¿è¡Œ</li><li>é‡æ–°æ ‡è®°ï¼ˆ<code>CMS remark</code>ï¼‰ï¼šå¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰é”™æ ‡æˆ–è€…æ¼æ ‡çš„æƒ…å†µï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨é‡æ–°æ ‡è®°ä¸€ä¸‹</li><li>å¹¶å‘æ¸…é™¤ï¼ˆ<code>CMS concurrent sweep</code>ï¼‰ï¼šæ¸…ç†æ‰æ ‡è®°é˜¶æ®µä¸­åˆ¤æ–­å·²ç»æ­»äº¡çš„å¯¹è±¡</li></ul><pre class="line-numbers language-none"><code class="language-none">CMS çš„æ”¶é›†è¿‡ç¨‹å¦‚ä¸‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545859.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545859.jpeg"></a></p><p><code>CMS</code> æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•æ”¶é›†å™¨èƒ½å¤Ÿåšåˆ°å®Œç¾çš„ç¨‹åº¦ï¼Œ<code>CMS</code> ä¹Ÿæ˜¯ä¸€æ ·ï¼Œ<code>CMS</code> è‡³å°‘æœ‰<strong>ä¸‰ä¸ªç¼ºç‚¹</strong>ï¼š</p><ul><li><p><code>CMS</code> å¯¹å¤„ç†å™¨èµ„æºéå¸¸æ•æ„Ÿï¼Œåœ¨å¹¶å‘é˜¶æ®µï¼Œè™½ç„¶ä¸ä¼šé€ æˆç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯å´ä¼šå› ä¸º<strong>å ç”¨ä¸€éƒ¨åˆ†çº¿ç¨‹</strong>è€Œå¯¼è‡´<strong>åº”ç”¨ç¨‹åºå˜æ…¢</strong>ï¼Œé™ä½æ€»ååé‡ã€‚</p></li><li><p><code>CMS</code> æ— æ³•å¤„ç†<strong>æµ®åŠ¨åƒåœ¾</strong>ï¼Œæœ‰å¯èƒ½å‡ºç° <strong><em>Concurrent Mode Failure</em></strong> å¤±è´¥è¿›è€Œå¯¼è‡´å¦ä¸€æ¬¡å®Œå…¨ <strong><em>Stop The World</em></strong> çš„ <strong><em>Full GC</em></strong> äº§ç”Ÿã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯æµ®åŠ¨åƒåœ¾å‘¢ï¼Ÿ</p><pre class="line-numbers language-none"><code class="language-none">ç”±äº<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…ç†</strong>é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹ä»åœ¨ç»§ç»­è¿è¡Œï¼Œæ‰€ä»¥ç¨‹åºè‡ªç„¶è€Œç„¶å°±ä¼šä¼´éšç€æ–°çš„åƒåœ¾ä¸æ–­å‡ºç°ï¼Œè€Œä¸”è¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨<strong>æ ‡è®°ç»“æŸ</strong>ä¹‹åï¼Œ<code>CMS</code> æ— æ³•å¤„ç†è¿™äº›åƒåœ¾ï¼Œæ‰€ä»¥åªèƒ½ç­‰åˆ°<strong>ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶</strong>æ—¶åœ¨è¿›è¡Œæ¸…ç†ã€‚è¿™ä¸€éƒ¨åˆ†åƒåœ¾å°±è¢«ç§°ä¸ºæµ®åŠ¨åƒåœ¾ã€‚</p></blockquote></li><li><p><code>CMS</code> æœ€åä¸€ä¸ªç¼ºç‚¹æ˜¯å¹¶å‘ - æ¸…é™¤çš„é€šç—…ï¼Œä¹Ÿå°±æ˜¯ä¼šæœ‰å¤§é‡çš„<strong>ç©ºé—´ç¢ç‰‡</strong>å‡ºç°ï¼Œè¿™å°†ä¼šç»™åˆ†é…å¤§å¯¹è±¡å¸¦æ¥å›°éš¾ã€‚</p></li></ul><h3 id="Garbage-First-æ”¶é›†å™¨ï¼ˆå›æ”¶é›†ï¼‰"><a href="#Garbage-First-æ”¶é›†å™¨ï¼ˆå›æ”¶é›†ï¼‰" class="headerlink" title="Garbage First æ”¶é›†å™¨ï¼ˆå›æ”¶é›†ï¼‰"></a>Garbage First æ”¶é›†å™¨ï¼ˆå›æ”¶é›†ï¼‰</h3><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Garbage First</code> åˆè¢«ç§°ä¸º <strong>G1</strong> æ”¶é›†å™¨ï¼Œå®ƒçš„å‡ºç°æ„å‘³ç€åƒåœ¾æ”¶é›†å™¨èµ°è¿‡äº†ä¸€ä¸ªé‡Œç¨‹ç¢‘ï¼Œä¸ºä»€ä¹ˆè¯´å®ƒæ˜¯é‡Œç¨‹ç¢‘å‘¢ï¼Ÿ</p><pre class="line-numbers language-none"><code class="language-none">å› ä¸º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>G1</code> è¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ç§<strong>é¢å‘å±€éƒ¨</strong>çš„åƒåœ¾æ”¶é›†å™¨ï¼Œ<code>HotSpot</code> å›¢é˜Ÿå¼€å‘è¿™ä¸ªåƒåœ¾æ”¶é›†å™¨ä¸ºäº†è®©å®ƒ<strong>æ›¿æ¢æ‰ CMS æ”¶é›†å™¨</strong>ã€‚</p><pre class="line-numbers language-none"><code class="language-none">æ‰€ä»¥åˆ°åæ¥ï¼Œ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>JDK 9</strong> å‘å¸ƒåï¼Œâ˜‘ï¸<strong>G1</strong> å–ä»£ã€ <strong>Parallel Scavenge + Parallel Old</strong> ã€‘ç»„åˆï¼Œæˆä¸º<strong>æœåŠ¡ç«¯é»˜è®¤</strong>çš„åƒåœ¾æ”¶é›†å™¨ï¼Œè€Œ <strong>CMS åˆ™ä¸å†æ¨èä½¿ç”¨</strong>ã€‚</p><pre class="line-numbers language-none"><code class="language-none">ä¹‹å‰çš„åƒåœ¾æ”¶é›†å™¨å­˜åœ¨å›æ”¶åŒºåŸŸçš„å±€é™æ€§ï¼Œå› ä¸ºä¹‹å‰è¿™äº›åƒåœ¾æ”¶é›†å™¨çš„ç›®æ ‡èŒƒå›´è¦ä¹ˆæ˜¯æ•´ä¸ªæ–°ç”Ÿä»£ã€è¦ä¹ˆæ˜¯æ•´ä¸ªè€å¹´ä»£ï¼Œè¦ä¹ˆæ˜¯æ•´ä¸ª<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Java</code> å †ï¼ˆ<code>Full GC</code>ï¼‰ï¼Œè€Œ <code>G1</code> è·³å‡ºäº†è¿™ä¸ªæ¡†æ¶ï¼Œå®ƒå¯ä»¥é¢å‘å †å†…å­˜çš„ä»»ä½•éƒ¨åˆ†æ¥ç»„æˆ**å›æ”¶é›† (Collection Setï¼ŒCSet)**ï¼Œè¡¡é‡åƒåœ¾æ”¶é›†çš„ä¸å†æ˜¯å“ªä¸ªåˆ†ä»£ï¼Œè¿™å°±æ˜¯ <code>G1</code> çš„ <em><code>Mixed GC</code></em> æ¨¡å¼ã€‚</p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>G1</code> æ˜¯åŸºäº <code>Region</code> æ¥è¿›è¡Œå›æ”¶çš„ï¼Œ<code>Region</code> å°±æ˜¯<strong>å †å†…å­˜ä¸­ä»»æ„çš„å¸ƒå±€</strong>ï¼Œæ¯ä¸€å— <code>Region</code> éƒ½å¯ä»¥æ ¹æ®éœ€è¦<strong>æ‰®æ¼”</strong> ã€<code>Eden</code> ç©ºé—´ã€<code>Survivor</code> ç©ºé—´æˆ–è€…è€å¹´ä»£ç©ºé—´ã€‘ï¼Œæ”¶é›†å™¨èƒ½å¤Ÿå¯¹ä¸åŒçš„ <code>Region</code> è§’è‰²é‡‡ç”¨<strong>ä¸åŒçš„ç­–ç•¥</strong>æ¥è¿›è¡Œå¤„ç†ã€‚</p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>Region</code> ä¸­è¿˜æœ‰ä¸€å—<strong>ç‰¹æ®Šçš„åŒºåŸŸ</strong>ï¼Œè¿™å—åŒºåŸŸå°±æ˜¯ <em><code>Humongous</code></em> åŒºåŸŸï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥å­˜<strong>å‚¨å¤§å¯¹è±¡</strong>çš„ã€‚</p><ul><li>å <code>Region</code>å®¹é‡ä¸€åŠå¯¹è±¡ï¼š<code>G1</code> è®¤ä¸ºåªè¦å¤§å°è¶…è¿‡äº† <code>Region</code> <strong>å®¹é‡ä¸€åŠ</strong>çš„å¯¹è±¡å³å¯åˆ¤å®šä¸º<strong>å¤§å¯¹è±¡</strong>ã€‚</li><li>è¶…<code>Region</code>å®¹é‡å¯¹è±¡ï¼šå¦‚æœè¶…è¿‡äº† <code>Region</code> å®¹é‡çš„å¤§å¯¹è±¡ï¼Œå°†ä¼šå­˜å‚¨åœ¨è¿ç»­çš„ <code>Humongous Region</code> ä¸­ï¼Œ<code>G1</code> å¤§å¤šæ•°è¡Œä¸ºéƒ½ä¼šæŠŠÂ <code>Humongous</code> <code>Region</code> ä½œä¸º<strong>è€å¹´ä»£</strong>æ¥çœ‹å¾…ã€‚</li></ul><pre class="line-numbers language-none"><code class="language-none">G1 ä¿ç•™äº†<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ–°ç”Ÿä»£</strong>ï¼ˆ<code>Eden Suvivor</code>ï¼‰å’Œ<strong>è€å¹´ä»£</strong>çš„æ¦‚å¿µï¼Œä½†æ˜¯æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†æ˜¯å›ºå®šçš„äº†ã€‚å®ƒä»¬éƒ½æ˜¯ä¸€ç³»åˆ—åŒºåŸŸçš„åŠ¨æ€é›†åˆã€‚</p><pre class="line-numbers language-none"><code class="language-none">G1 æ”¶é›†å™¨çš„è¿ä½œè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å››æ­¥</strong>ï¼š</p><ol><li>åˆå§‹æ ‡è®°ï¼šè¿™ä¸ªæ­¥éª¤ä¹Ÿä»…ä»…æ˜¯æ ‡è®°ä¸€ä¸‹ <code>GC Roots</code> èƒ½å¤Ÿ<strong>ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡</strong>ï¼›å¹¶ä¿®æ”¹ <code>TAMS</code> æŒ‡é’ˆçš„å€¼ï¼ˆæ¯ä¸€ä¸ª <code>Region</code> éƒ½æœ‰ä¸¤ä¸ª <code>RAMS</code> æŒ‡é’ˆï¼‰ï¼Œä½¿å¾—ä¸‹ä¸€é˜¶æ®µç”¨æˆ·å¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½å¤Ÿåœ¨å¯ç”¨çš„ <code>Region</code> ä¸­åˆ†é…å¯¹è±¡ï¼Œè¿™ä¸ªé˜¶æ®µéœ€è¦<strong>æš‚åœç”¨æˆ·çº¿ç¨‹</strong>ï¼Œä½†æ˜¯æ—¶é—´å¾ˆçŸ­ã€‚è¿™ä¸ªåœé¡¿æ˜¯å€Ÿç”¨ <code>Minor</code> <code>GC</code> çš„æ—¶å€™å®Œæˆçš„ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li><li>å¹¶å‘æ ‡è®°ï¼šä» <code>GC Root</code> å¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œ<strong>å¯è¾¾æ€§åˆ†æ</strong>ï¼Œé€’å½’æ‰«ææ•´ä¸ªå †ä¸­çš„å¯¹è±¡å›¾ï¼Œæ‰¾å‡ºè¦å›æ”¶çš„å¯¹è±¡ã€‚å½“å¯¹è±¡å›¾æ‰«æå®Œæˆåï¼Œé‡æ–°å¤„ç† <code>SATB</code> è®°å½•ä¸‹çš„åœ¨å¹¶å‘æ—¶æœ‰å¼•ç”¨çš„å¯¹è±¡ï¼›</li><li>æœ€ç»ˆæ ‡è®°ï¼šå¯¹ç”¨æˆ·çº¿ç¨‹åšä¸€ä¸ª<strong>çŸ­æš‚çš„æš‚åœ</strong>ï¼Œç”¨äºå¤„ç†å¹¶å‘é˜¶æ®µç»“æŸåé—ç•™ä¸‹æ¥çš„å°‘é‡ <code>_SATB_</code> è®°å½•ï¼ˆä¸€ç§<strong>åŸå§‹å¿«ç…§</strong>ï¼Œç”¨æ¥è®°å½•å¹¶å‘æ ‡è®°ä¸­æŸäº›å¯¹è±¡ï¼‰</li><li>ç­›é€‰å›æ”¶ï¼šè´Ÿè´£æ›´æ–° <code>Region</code> çš„<strong>ç»Ÿè®¡æ•°æ®</strong>ï¼Œå¯¹å„ä¸ª <code>Region</code> çš„<strong>å›æ”¶ä»·å€¼</strong>å’Œ<strong>æˆæœ¬</strong>è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„åœé¡¿æ—¶é—´æ¥<strong>åˆ¶å®šå›æ”¶è®¡åˆ’</strong>ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©å¤šä¸ª <code>Region</code> æ„æˆå›æ”¶é›†ï¼Œç„¶åæŠŠå†³å®šè¦å›æ”¶çš„é‚£ä¸€éƒ¨åˆ† <code>Region</code> å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ç©ºçš„ <code>Region</code> ä¸­ï¼Œå†æ¸…ç†æ‰æ•´ä¸ªæ—§ <code>Region</code> çš„å…¨éƒ¨ç©ºé—´ã€‚è¿™é‡Œçš„æ“ä½œè®¾è®¡å¯¹è±¡çš„ç§»åŠ¨ï¼Œæ‰€ä»¥å¿…é¡»è¦<strong>æš‚åœç”¨æˆ·çº¿ç¨‹</strong>ï¼Œç”±å¤šæ¡æ”¶é›†å™¨çº¿ç¨‹<strong>å¹¶è¡Œæ”¶é›†</strong></li></ol><pre class="line-numbers language-none"><code class="language-none">ä»ä¸Šé¢è¿™å‡ ä¸ªæ­¥éª¤å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†å¹¶å‘æ ‡è®°å¤–ï¼Œå…¶ä½™ä¸‰ä¸ªé˜¶æ®µéƒ½éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ª G1 æ”¶é›†å™¨å¹¶éè¿½æ±‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä½å»¶è¿Ÿ</strong>ï¼Œå®˜æ–¹ç»™å‡ºçš„è®¾è®¡ç›®æ ‡æ˜¯<strong>åœ¨å»¶è¿Ÿå¯æ§çš„æƒ…å†µä¸‹å°½å¯èƒ½çš„æé«˜ååé‡</strong>ï¼Œæ‹…ä»»å…¨åŠŸèƒ½æ”¶é›†å™¨çš„é‡ä»»ã€‚</p><p>ä¸‹é¢æ˜¯ G1 å›æ”¶çš„ç¤ºæ„å›¾</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545455.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545455.jpeg"></a></p><p><code>G1</code> æ”¶é›†å™¨åŒæ ·ä¹Ÿæœ‰ç¼ºç‚¹å’Œé—®é¢˜ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ <code>Region</code> ä¸­å­˜åœ¨<strong>è·¨ä»£</strong>å¼•ç”¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰çŸ¥é“å¯ä»¥ç”¨è®°å¿†é›†æ¥è§£å†³è·¨ä»£å¼•ç”¨é—®é¢˜ï¼Œä¸è¿‡ <code>Region</code> ä¸­çš„è·¨ä»£å¼•ç”¨è¦å¤æ‚å¾ˆå¤šï¼›</li><li>ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•ä¿è¯<strong>æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹äº’ä¸å¹²æ‰°</strong>çš„è¿è¡Œï¼Ÿ<code>CMS</code> ä½¿ç”¨çš„æ˜¯å¢é‡æ›´æ–°ç®—æ³•ï¼Œ<code>G1</code> ä½¿ç”¨çš„æ˜¯åŸå§‹å¿«ç…§ï¼ˆ<code>SATB</code>ï¼‰ï¼Œ<code>G1</code> ä¸º <code>Region</code> åˆ†é…äº†ä¸¤å— <code>TAMS</code> æŒ‡é’ˆï¼ŒæŠŠ <code>Region</code> ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´åˆ’åˆ†å‡ºæ¥ç”¨äºå¹¶å‘å›æ”¶è¿‡ç¨‹ä¸­çš„æ–°å¯¹è±¡åˆ†é…ï¼Œå¹¶å‘å›æ”¶æ—¶æ–°åˆ†é…çš„å¯¹è±¡åœ°å€éƒ½å¿…é¡»åœ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆä½ç½®ä»¥ä¸Šã€‚å¦‚æœå†…å­˜å›æ”¶é€Ÿåº¦èµ¶ä¸ä¸Šå†…å­˜åˆ†é…é€Ÿåº¦ï¼Œ<code>G1</code> æ”¶é›†å™¨ä¹Ÿè¦å†»ç»“ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œï¼Œå¯¼è‡´ <code>Full</code> <code>GC</code> è€Œäº§ç”Ÿé•¿æ—¶é—´çš„ <code>STW</code>ã€‚</li><li>ç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯<strong>æ— æ³•å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ¨¡å‹ã€‚</strong></li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆå››ï¼‰| è™šæ‹ŸæœºJVM</title>
      <link href="/posts/10871.html"/>
      <url>/posts/10871.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="JVM-çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#JVM-çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="JVM çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>JVM çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><code>JVM</code> å°±æ˜¯ <code>Java Virtual Machine</code>ï¼ˆ<code>Java</code> è™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼Œ<code>JVM</code> å±è”½äº†ä¸å…·ä½“æ“ä½œç³»ç»Ÿå¹³å°ç›¸å…³çš„ä¿¡æ¯ï¼Œä½¿ <code>Java</code> ç¨‹åºåªéœ€ç”Ÿæˆåœ¨ <code>Java</code> è™šæ‹Ÿæœºä¸Šè¿è¡Œçš„ç›®æ ‡ä»£ç  ï¼ˆå­—èŠ‚ç ï¼‰ï¼Œå°±å¯ä»¥åœ¨ä¸åŒçš„å¹³å°ä¸Šè¿è¡Œã€‚</p><h4 id="æ®éªŒè¯"><a href="#æ®éªŒè¯" class="headerlink" title="æ®éªŒè¯"></a><strong>æ®éªŒè¯</strong></h4><h2 id="Java-çš„å†…å­˜åŒºåŸŸï¼Ÿ"><a href="#Java-çš„å†…å­˜åŒºåŸŸï¼Ÿ" class="headerlink" title="Java çš„å†…å­˜åŒºåŸŸï¼Ÿ"></a>Java çš„å†…å­˜åŒºåŸŸï¼Ÿ</h2><p><code>JVM</code> åœ¨æ‰§è¡Œ <code>Java</code> ç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒç®¡ç†çš„å†…å­˜åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„åŒºåŸŸï¼Œè¿™äº›ç»„æˆéƒ¨åˆ†æœ‰äº›æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæœ‰äº›åˆ™æ˜¯çº¿ç¨‹å…±äº«çš„ï¼ŒJava å†…å­˜åŒºåŸŸä¹Ÿå«åšè¿è¡Œæ—¶æ•°æ®åŒºï¼Œå®ƒçš„å…·ä½“åˆ’åˆ†å¦‚ä¸‹ï¼š</p><p><a href="https://s2.loli.net/2024/12/20/2pIKtBacCoWeHQg.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/2pIKtBacCoWeHQg.jpg"></a></p><ul><li><code>è™šæ‹Ÿæœºæ ˆ</code> : <code>Java</code> è™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„æ•°æ®åŒºï¼ŒJava è™šæ‹Ÿæœºæ ˆçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒï¼Œè™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯å±€éƒ¨å˜é‡çš„å­˜å‚¨ä½ç½®ã€‚æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨è™šæ‹Ÿæœºæ ˆä¸­åˆ›å»ºä¸€ä¸ª <code>æ ˆå¸§(stack frame)</code>ã€‚æ¯ä¸ªæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å°±å¯¹åº”äº†ä¸€ä¸ªå…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚</li></ul><p><a href="https://s2.loli.net/2024/12/20/ZRl8heHLdWGc4Cu.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ZRl8heHLdWGc4Cu.jpg"></a></p><ul><li><p><code>æœ¬åœ°æ–¹æ³•æ ˆ</code>: æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„æ•°æ®åŒºï¼Œæœ¬åœ°æ–¹æ³•æ ˆå­˜å‚¨çš„åŒºåŸŸä¸»è¦æ˜¯ Java ä¸­ä½¿ç”¨ <code>native</code> å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•æ‰€å­˜å‚¨çš„åŒºåŸŸã€‚</p></li><li><p><code>ç¨‹åºè®¡æ•°å™¨</code>ï¼šç¨‹åºè®¡æ•°å™¨ä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„æ•°æ®åŒºï¼Œè¿™éƒ¨åˆ†åŒºåŸŸç”¨äºå­˜å‚¨çº¿ç¨‹çš„æŒ‡ä»¤åœ°å€ï¼Œç”¨äºåˆ¤æ–­çº¿ç¨‹çš„åˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸ã€çº¿ç¨‹åˆ‡æ¢å’Œæ¢å¤ç­‰åŠŸèƒ½ï¼Œè¿™äº›éƒ½é€šè¿‡ç¨‹åºè®¡æ•°å™¨æ¥å®Œæˆã€‚</p></li><li><p><code>æ–¹æ³•åŒº</code>ï¼šæ–¹æ³•åŒºæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨è™šæ‹ŸæœºåŠ è½½çš„ ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</p></li><li><p><code>å †</code>ï¼šå †æ˜¯çº¿ç¨‹å…±äº«çš„æ•°æ®åŒºï¼Œå †æ˜¯ <code>JVM</code> ä¸­æœ€å¤§çš„ä¸€å—å­˜å‚¨åŒºåŸŸï¼Œæ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½ä¼šåˆ†é…åœ¨å †ä¸Šã€‚<code>JDK 1.7</code> åï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä»æ°¸ä¹…ä»£ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œå­˜æ”¾åœ¨å †ä¸­ã€‚</p><p>å †ç©ºé—´çš„å†…å­˜åˆ†é…ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ï¼š</p><p>å‘½ä»¤è¡Œä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼šæŸ¥çœ‹é»˜è®¤çš„ <code>JVM</code> å‚æ•°ã€‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">javaÂ -XX:+PrintFlagsFinalÂ -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºçš„å†…å®¹éå¸¸å¤šï¼Œä½†æ˜¯åªæœ‰ä¸¤è¡Œèƒ½å¤Ÿåæ˜ å‡ºä¸Šé¢çš„å†…å­˜åˆ†é…ç»“æœ</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031032217.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031032217.jpeg"></a><a href="https://s2.loli.net/2024/12/20/t8xhcwPgvC2RBzH.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/t8xhcwPgvC2RBzH.jpg"></a><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021542355.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021542355.jpeg"></a></p></li><li><p><code>eden</code> åŒºï¼š<strong>8/10</strong> çš„å¹´è½»ä»£ç©ºé—´</p></li><li><p><code>survivor</code> <strong>0 : 1/10</strong> çš„å¹´è½»ä»£ç©ºé—´</p></li><li><p><code>survivor</code> <strong>1 : 1/10</strong> çš„å¹´è½»ä»£ç©ºé—´</p></li><li><p>è€å¹´ä»£ ï¼š<strong>ä¸‰åˆ†ä¹‹äºŒ</strong>çš„å †ç©ºé—´</p></li><li><p>å¹´è½»ä»£ ï¼š<strong>ä¸‰åˆ†ä¹‹ä¸€</strong>çš„å †ç©ºé—´</p></li><li><p><code>è¿è¡Œæ—¶å¸¸é‡æ± </code>ï¼šè¿è¡Œæ—¶å¸¸é‡æ± åˆè¢«ç§°ä¸º <code>Runtime Constant Pool</code>ï¼Œè¿™å—åŒºåŸŸæ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„åå­—éå¸¸æœ‰æ„æ€ï¼Œé€šå¸¸è¢«ç§°ä¸º <code>éå †</code>ã€‚å®ƒå¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰åœ¨ç¼–è¯‘æœŸæ‰èƒ½äº§ç”Ÿï¼Œä¹Ÿå°±æ˜¯å¹¶éç¼–è¯‘æœŸé—´å°†å¸¸é‡æ”¾åœ¨å¸¸é‡æ± ä¸­ï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„å¸¸é‡æ”¾å…¥å¸¸é‡æ± ä¸­ï¼ŒString çš„ intern æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚</p></li></ul><h2 id="Java-ä¸­çš„ç±»åŠ è½½æœºåˆ¶ï¼Ÿ"><a href="#Java-ä¸­çš„ç±»åŠ è½½æœºåˆ¶ï¼Ÿ" class="headerlink" title="Java ä¸­çš„ç±»åŠ è½½æœºåˆ¶ï¼Ÿ"></a>Java ä¸­çš„ç±»åŠ è½½æœºåˆ¶ï¼Ÿ</h2><p><code>Java</code> è™šæ‹Ÿæœºè´Ÿè´£æŠŠæè¿°ç±»çš„æ•°æ®ä» <code>Class</code> æ–‡ä»¶åŠ è½½åˆ°ç³»ç»Ÿå†…å­˜ä¸­ï¼Œå¹¶å¯¹ç±»çš„æ•°æ®è¿›è¡Œ<strong>æ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–</strong>ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„ <code>Java</code> ç±»å‹ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¹‹ä¸º Java çš„<code>ç±»åŠ è½½æœºåˆ¶</code>ã€‚</p><p>ä¸€ä¸ªç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜å¼€å§‹ï¼Œåˆ°å¸è½½å‡ºå†…å­˜ä¸ºæ­¢ï¼Œä¸€å…±ä¼šç»å†ä¸‹é¢è¿™äº›è¿‡ç¨‹ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/9eKTE7mgdb1ZSVw.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/9eKTE7mgdb1ZSVw.jpg"></a></p><p>ç±»åŠ è½½æœºåˆ¶ä¸€å…±æœ‰äº”ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><p><strong>åŠ è½½ã€é“¾æ¥ã€åˆå§‹åŒ–ã€ä½¿ç”¨å’Œå¸è½½</strong>é˜¶æ®µï¼Œè¿™äº”ä¸ªé˜¶æ®µçš„é¡ºåºæ˜¯ç¡®å®šçš„ã€‚</p><p>å…¶ä¸­é“¾æ¥é˜¶æ®µä¼šç»†åˆ†æˆä¸‰ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯éªŒè¯ã€å‡†å¤‡ã€è§£æé˜¶æ®µï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µçš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µé€šå¸¸äº¤äº’è¿›è¡Œã€‚è§£æé˜¶æ®µé€šå¸¸ä¼šåœ¨åˆå§‹åŒ–ä¹‹åå†å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒ Java è¯­è¨€çš„è¿è¡Œæ—¶ç»‘å®šç‰¹æ€§ï¼ˆä¹Ÿè¢«ç§°ä¸º<code>åŠ¨æ€ç»‘å®š</code>ï¼‰ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥èŠä¸€ä¸‹è¿™å‡ ä¸ªè¿‡ç¨‹ã€‚</p><h3 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h3><p>å…³äºä»€ä¹ˆæ—¶å€™å¼€å§‹åŠ è½½è¿™ä¸ªè¿‡ç¨‹ï¼Œã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æ²¡æœ‰å¼ºåˆ¶çº¦æŸï¼Œæ‰€ä»¥è¿™ä¸€ç‚¹æˆ‘ä»¬å¯ä»¥è‡ªç”±å®ç°ã€‚åŠ è½½æ˜¯æ•´ä¸ªç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼ŒJava è™šæ‹Ÿæœºéœ€è¦å®Œæˆä¸‰ä»¶äº‹æƒ…ï¼š</p><ul><li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚</li><li>å°†è¿™ä¸ªå­—èŠ‚æµè¡¨ç¤ºçš„ä¸€ç§å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºè¿è¡Œæ—¶æ•°æ®åŒºä¸­æ–¹æ³•åŒºçš„æ•°æ®ç»“æ„ã€‚</li><li>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ª <code>Class</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±ä»£è¡¨äº†è¿™ä¸ªæ•°æ®ç»“æ„çš„è®¿é—®å…¥å£ã€‚</li></ul><p>ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æœªè§„å®šå…¨é™å®šåæ˜¯å¦‚ä½•è·å–çš„ï¼Œæ‰€ä»¥ç°åœ¨ä¸šç•Œæœ‰å¾ˆå¤šè·å–å…¨é™å®šåçš„æ–¹å¼ï¼š</p><ul><li><p>ä» <code>ZIP</code> åŒ…ä¸­è¯»å–ï¼Œæœ€ç»ˆä¼šæ”¹å˜ä¸º <code>JARã€EARã€WAR</code> æ ¼å¼ã€‚</p></li><li><p>ä»ç½‘ç»œä¸­è·å–ï¼Œæœ€å¸¸è§çš„åº”ç”¨å°±æ˜¯ <code>Web Applet</code>ã€‚</p></li><li><p>è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼Œä½¿ç”¨æœ€å¤šçš„å°±æ˜¯åŠ¨æ€ä»£ç†æŠ€æœ¯ã€‚</p></li><li><p>ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œæ¯”å¦‚ <code>JSP</code> åº”ç”¨åœºæ™¯ï¼Œç”± <code>JSP</code> æ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„ <code>Class</code> æ–‡ä»¶ã€‚</p></li><li><p>ä»æ•°æ®åº“ä¸­è¯»å–ï¼Œè¿™ç§åœºæ™¯å°±æ¯”è¾ƒå°äº†ã€‚</p></li><li><p>å¯ä»¥ä»åŠ å¯†æ–‡ä»¶ä¸­è·å–ï¼Œè¿™æ˜¯å…¸å‹çš„é˜²æ­¢ Class æ–‡ä»¶è¢«åç¼–è¯‘çš„ä¿æŠ¤æªæ–½ã€‚</p><p>åŠ è½½é˜¶æ®µæ—¢å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºå†…ç½®çš„å¼•å¯¼ç±»åŠ è½½å™¨æ¥å®Œæˆï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æ¥å®Œæˆã€‚ç¨‹åºå‘˜å¯ä»¥é€šè¿‡è‡ªå·±å®šä¹‰ç±»åŠ è½½å™¨æ¥æ§åˆ¶å­—èŠ‚æµçš„è®¿é—®æ–¹å¼ã€‚</p><p>æ•°ç»„çš„åŠ è½½ä¸éœ€è¦é€šè¿‡ç±»åŠ è½½å™¨æ¥åˆ›å»ºï¼Œå®ƒæ˜¯ç›´æ¥åœ¨å†…å­˜ä¸­åˆ†é…ï¼Œä½†æ˜¯æ•°ç»„çš„å…ƒç´ ç±»å‹ï¼ˆæ•°ç»„å»æ‰æ‰€æœ‰ç»´åº¦çš„ç±»å‹ï¼‰æœ€ç»ˆè¿˜æ˜¯è¦é ç±»åŠ è½½å™¨æ¥å®ŒæˆåŠ è½½ã€‚</p></li></ul><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p>åŠ è½½è¿‡åçš„ä¸‹ä¸€ä¸ªé˜¶æ®µå°±æ˜¯éªŒè¯ï¼Œå› ä¸ºæˆ‘ä»¬ä¸Šä¸€æ­¥è®²åˆ°åœ¨å†…å­˜ä¸­ç”Ÿæˆäº†ä¸€ä¸ª</p><p><code>Class</code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯è®¿é—®å…¶ä»£è¡¨æ•°æ®ç»“æ„çš„å…¥å£ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥éªŒè¯çš„å·¥ä½œå°±æ˜¯ç¡®ä¿ <code>Class</code> æ–‡ä»¶çš„å­—èŠ‚æµä¸­çš„å†…å®¹ç¬¦åˆã€Š<code>Java</code> è™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­çš„è¦æ±‚ï¼Œä¿è¯è¿™äº›ä¿¡æ¯è¢«å½“ä½œä»£ç è¿è¡Œåï¼Œå®ƒä¸ä¼šå¨èƒåˆ°è™šæ‹Ÿæœºçš„å®‰å…¨ã€‚</p><p>éªŒè¯é˜¶æ®µä¸»è¦åˆ†ä¸ºå››ä¸ªé˜¶æ®µçš„æ£€éªŒï¼š</p><ul><li>æ–‡ä»¶æ ¼å¼éªŒè¯ã€‚</li><li>å…ƒæ•°æ®éªŒè¯ã€‚</li><li>å­—èŠ‚ç éªŒè¯ã€‚</li><li>ç¬¦å·å¼•ç”¨éªŒè¯ã€‚</li></ul><h4 id="æ–‡ä»¶æ ¼å¼éªŒè¯"><a href="#æ–‡ä»¶æ ¼å¼éªŒè¯" class="headerlink" title="æ–‡ä»¶æ ¼å¼éªŒè¯"></a><strong>æ–‡ä»¶æ ¼å¼éªŒè¯</strong></h4><p>è¿™ä¸€é˜¶æ®µå¯èƒ½ä¼šåŒ…å«ä¸‹é¢è¿™äº›éªŒè¯ç‚¹ï¼š</p><ul><li>é­”æ•°æ˜¯å¦ä»¥ <code>0xCAFEBABE</code> å¼€å¤´ã€‚</li><li>ä¸»ã€æ¬¡ç‰ˆæœ¬å·æ˜¯å¦åœ¨å½“å‰ Java è™šæ‹Ÿæœºæ¥å—èŒƒå›´ä¹‹å†…ã€‚</li><li>å¸¸é‡æ± çš„å¸¸é‡ä¸­æ˜¯å¦æœ‰ä¸æ”¯æŒçš„å¸¸é‡ç±»å‹ã€‚</li><li>æŒ‡å‘å¸¸é‡çš„å„ç§ç´¢å¼•å€¼ä¸­æ˜¯å¦æœ‰æŒ‡å‘ä¸å­˜åœ¨çš„å¸¸é‡æˆ–ä¸ç¬¦åˆç±»å‹çš„å¸¸é‡ã€‚</li><li><code>CONSTANT_Utf8_info</code> å‹çš„å¸¸é‡ä¸­æ˜¯å¦æœ‰ä¸ç¬¦åˆ <code>UTF8</code> ç¼–ç çš„æ•°æ®ã€‚</li><li><code>Class</code> æ–‡ä»¶ä¸­å„ä¸ªéƒ¨åˆ†åŠæ–‡ä»¶æœ¬èº«æ˜¯å¦æœ‰è¢«åˆ é™¤çš„æˆ–é™„åŠ çš„å…¶ä»–ä¿¡æ¯ã€‚</li></ul><p>å®é™…ä¸ŠéªŒè¯ç‚¹è¿œè¿œä¸æ­¢æœ‰è¿™äº›ï¼Œä¸Šé¢è¿™äº›åªæ˜¯ä» <code>HotSpot</code> æºç ä¸­æ‘˜æŠ„çš„ä¸€å°æ®µå†…å®¹ã€‚</p><h4 id="å…ƒæ•°æ®éªŒè¯"><a href="#å…ƒæ•°æ®éªŒè¯" class="headerlink" title="å…ƒæ•°æ®éªŒè¯"></a><strong>å…ƒæ•°æ®éªŒè¯</strong></h4><p>è¿™ä¸€é˜¶æ®µä¸»è¦æ˜¯å¯¹å­—èŠ‚ç æè¿°çš„ä¿¡æ¯è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œä»¥ç¡®ä¿æè¿°çš„ä¿¡æ¯ç¬¦åˆã€Š<code>Java</code> è¯­è¨€è§„èŒƒã€‹ï¼ŒéªŒè¯ç‚¹åŒ…æ‹¬</p><ul><li><p>éªŒè¯çš„ç±»æ˜¯å¦æœ‰çˆ¶ç±»ï¼ˆé™¤äº† <code>Object</code> ç±»ä¹‹å¤–ï¼Œæ‰€æœ‰çš„ç±»éƒ½åº”è¯¥æœ‰çˆ¶ç±»ï¼‰ã€‚</p></li><li><p>è¦éªŒè¯ç±»çš„çˆ¶ç±»æ˜¯å¦ç»§æ‰¿äº†ä¸å…è®¸ç»§æ‰¿çš„ç±»ã€‚</p></li><li><p>å¦‚æœè¿™ä¸ªç±»ä¸æ˜¯æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»æ˜¯å¦å®ç°äº†çˆ¶ç±»æˆ–è€…æ¥å£ä¸­è¦æ±‚çš„æ‰€æœ‰æ–¹æ³•ã€‚</p></li><li><p>æ˜¯å¦è¦†ç›–äº† final å­—æ®µï¼Œæ˜¯å¦å‡ºç°äº†ä¸ç¬¦åˆè§„å®šçš„é‡è½½ç­‰ã€‚</p><p>éœ€è¦è®°ä½è¿™ä¸€é˜¶æ®µåªæ˜¯å¯¹ã€Š<code>Java</code> è¯­è¨€è§„èŒƒã€‹çš„éªŒè¯ã€‚</p></li></ul><h4 id="å­—èŠ‚ç éªŒè¯"><a href="#å­—èŠ‚ç éªŒè¯" class="headerlink" title="å­—èŠ‚ç éªŒè¯"></a><strong>å­—èŠ‚ç éªŒè¯</strong></h4><p>å­—èŠ‚ç éªŒè¯é˜¶æ®µæ˜¯æœ€å¤æ‚çš„ä¸€ä¸ªé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯ç¡®å®šç¨‹åºè¯­æ„æ˜¯å¦åˆæ³•ã€æ˜¯å¦æ˜¯ç¬¦åˆé€»è¾‘çš„ã€‚è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯å¯¹ç±»çš„æ–¹æ³•ä½“ï¼ˆ<code>Class</code> æ–‡ä»¶ä¸­çš„ <code>Code</code> å±æ€§ï¼‰è¿›è¡Œæ ¡éªŒåˆ†æã€‚è¿™éƒ¨åˆ†éªŒè¯åŒ…æ‹¬</p><ul><li><p>ç¡®ä¿æ“ä½œæ•°æ ˆçš„æ•°æ®ç±»å‹å’Œå®é™…æ‰§è¡Œæ—¶çš„æ•°æ®ç±»å‹æ˜¯å¦ä¸€è‡´ã€‚</p></li><li><p>ä¿è¯ä»»ä½•è·³è½¬æŒ‡ä»¤ä¸ä¼šè·³å‡ºåˆ°æ–¹æ³•ä½“å¤–çš„å­—èŠ‚ç æŒ‡ä»¤ä¸Šã€‚</p></li><li><p>ä¿è¯æ–¹æ³•ä½“ä¸­çš„ç±»å‹è½¬æ¢æ˜¯æœ‰æ•ˆçš„ï¼Œä¾‹å¦‚å¯ä»¥æŠŠä¸€ä¸ªå­ç±»å¯¹è±¡èµ‹å€¼ç»™çˆ¶ç±»æ•°æ®ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½æŠŠçˆ¶ç±»æ•°æ®ç±»å‹èµ‹å€¼ç»™å­ç±»ç­‰è¯¸å¦‚æ­¤ä¸å®‰å…¨çš„ç±»å‹è½¬æ¢ã€‚</p></li><li><p>å…¶ä»–éªŒè¯ã€‚</p><p>å¦‚æœæ²¡æœ‰é€šè¿‡å­—èŠ‚ç éªŒè¯ï¼Œå°±è¯´æ˜éªŒè¯å‡ºé—®é¢˜ã€‚ä½†æ˜¯ä¸ä¸€å®šé€šè¿‡äº†å­—èŠ‚ç éªŒè¯ï¼Œå°±èƒ½ä¿è¯ç¨‹åºæ˜¯å®‰å…¨çš„ã€‚</p></li></ul><h4 id="ç¬¦å·å¼•ç”¨éªŒè¯"><a href="#ç¬¦å·å¼•ç”¨éªŒè¯" class="headerlink" title="ç¬¦å·å¼•ç”¨éªŒè¯"></a><strong>ç¬¦å·å¼•ç”¨éªŒè¯</strong></h4><p>æœ€åä¸€ä¸ªé˜¶æ®µçš„æ ¡éªŒè¡Œä¸ºå‘ç”Ÿåœ¨è™šæ‹Ÿæœºå°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªè½¬åŒ–å°†åœ¨è¿æ¥çš„ç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œå³è§£æé˜¶æ®µä¸­å‘ç”Ÿã€‚ç¬¦å·å¼•ç”¨éªŒè¯å¯ä»¥çœ‹ä½œæ˜¯å¯¹ç±»è‡ªèº«ä»¥å¤–çš„å„ç±»ä¿¡æ¯è¿›è¡ŒåŒ¹é…æ€§æ ¡éªŒï¼Œè¿™ä¸ªéªŒè¯ä¸»è¦åŒ…æ‹¬</p><ul><li><p>ç¬¦å·å¼•ç”¨ä¸­çš„å­—ç¬¦ä¸²å…¨é™å®šåæ˜¯å¦èƒ½æ‰¾åˆ°å¯¹åº”çš„ç±»ã€‚</p></li><li><p>æŒ‡å®šç±»ä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆæ–¹æ³•çš„å­—æ®µæè¿°ç¬¦ä»¥åŠç®€å•åç§°æ‰€æè¿°çš„æ–¹æ³•å’Œå­—æ®µã€‚</p></li><li><p>ç¬¦å·å¼•ç”¨çš„ç±»ã€å­—æ®µæ–¹æ³•çš„å¯è®¿é—®æ€§æ˜¯å¦å¯è¢«å½“å‰ç±»æ‰€è®¿é—®ã€‚</p></li><li><p>å…¶ä»–éªŒè¯ã€‚</p><p>è¿™ä¸€é˜¶æ®µä¸»è¦æ˜¯ç¡®ä¿è§£æè¡Œä¸ºèƒ½å¦æ­£å¸¸æ‰§è¡Œï¼Œå¦‚æœæ— æ³•é€šè¿‡ç¬¦å·å¼•ç”¨éªŒè¯ï¼Œå°±ä¼šå‡ºç°ç±»ä¼¼ <code>IllegalAccessError</code>ã€<code>NoSuchFieldError</code>ã€<code>NoSuchMethodError</code> ç­‰é”™è¯¯ã€‚</p></li></ul><p>éªŒè¯é˜¶æ®µå¯¹äºè™šæ‹Ÿæœºæ¥è¯´éå¸¸é‡è¦ï¼Œå¦‚æœèƒ½é€šè¿‡éªŒè¯ï¼Œå°±è¯´æ˜ä½ çš„ç¨‹åºåœ¨è¿è¡Œæ—¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚</p><h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><p>å‡†å¤‡é˜¶æ®µæ˜¯ä¸ºç±»ä¸­çš„å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®å…¶åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½åº”å½“åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ï¼Œåœ¨</p><p><code>JDK</code> 7 ä¹‹å‰ï¼Œ<code>HotSpot</code> ä½¿ç”¨<strong>æ°¸ä¹…ä»£</strong>æ¥å®ç°æ–¹æ³•åŒºï¼Œæ˜¯ç¬¦åˆè¿™ç§é€»è¾‘æ¦‚å¿µçš„ã€‚è€Œåœ¨ <code>JDK</code> 8 ä¹‹åï¼Œå˜é‡åˆ™ä¼šéšç€ <code>Class</code> å¯¹è±¡ä¸€èµ·å­˜æ”¾åœ¨ <code>Java</code> å †ä¸­ã€‚</p><p>ä¸‹é¢é€šå¸¸æƒ…å†µä¸‹çš„åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åˆå§‹å€¼</p><p><a href="https://s2.loli.net/2024/12/20/P7jki9K8geEmOrM.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/P7jki9K8geEmOrM.jpg"></a></p><p>é™¤äº† â€œé€šå¸¸æƒ…å†µâ€ ä¸‹ï¼Œè¿˜æœ‰ä¸€äº› â€œä¾‹å¤–æƒ…å†µâ€ï¼Œå¦‚æœç±»å­—æ®µå±æ€§ä¸­å­˜åœ¨</p><p><code>ConstantValue</code> å±æ€§ï¼Œé‚£å°±è¿™ä¸ªå˜é‡å€¼åœ¨åˆå§‹é˜¶æ®µå°±ä¼šåˆå§‹åŒ–ä¸º ConstantValue å±æ€§æ‰€æŒ‡å®šçš„åˆå§‹å€¼ï¼Œæ¯”å¦‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token string">"666"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¯‘æ—¶å°±ä¼šæŠŠ value çš„å€¼è®¾ç½®ä¸º 666ã€‚</p><h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><p>è§£æé˜¶æ®µæ˜¯ Java è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚</p><ul><li><p><code>ç¬¦å·å¼•ç”¨</code>ï¼šç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ã€‚ç¬¦å·å¼•ç”¨å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œåªè¦ä½¿ç”¨æ—¶èƒ½æ— æ­§ä¹‰åœ°å®šä½åˆ°ç›®æ ‡å³å¯ï¼Œç¬¦å·å¼•ç”¨å’Œè™šæ‹Ÿæœºçš„å¸ƒå±€æ— å…³ã€‚</p></li><li><p><code>ç›´æ¥å¼•ç”¨</code>ï¼šç›´æ¥å¼•ç”¨å¯ä»¥ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹ä¾¿å®œé‡æˆ–è€…ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚ç›´æ¥å¼•ç”¨å’Œè™šæ‹Ÿæœºçš„å¸ƒå±€æ˜¯ç›¸å…³çš„ï¼Œä¸åŒçš„è™šæ‹Ÿæœºå¯¹äºç›¸åŒçš„ç¬¦å·å¼•ç”¨æ‰€ç¿»è¯‘å‡ºæ¥çš„ç›´æ¥å¼•ç”¨ä¸€èˆ¬æ˜¯ä¸åŒçš„ã€‚å¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£ä¹ˆç›´æ¥å¼•ç”¨çš„ç›®æ ‡ä¸€å®šè¢«åŠ è½½åˆ°äº†å†…å­˜ä¸­ã€‚</p><p>è¿™æ ·è¯´ä½ å¯èƒ½è¿˜æœ‰ç‚¹ä¸æ˜ç™½ï¼Œæˆ‘å†æ¢ä¸€ç§è¯´æ³•ï¼š</p></li></ul><blockquote><p>åœ¨ç¼–è¯‘çš„æ—¶å€™ä¸€ä¸ªæ¯ä¸ª Java ç±»éƒ½ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ª class æ–‡ä»¶ï¼Œä½†åœ¨ç¼–è¯‘çš„æ—¶å€™è™šæ‹Ÿæœºå¹¶ä¸çŸ¥é“æ‰€å¼•ç”¨ç±»çš„åœ°å€ï¼Œæ‰€ä»¥å°±ç”¨ç¬¦å·å¼•ç”¨æ¥ä»£æ›¿ï¼Œè€Œåœ¨è¿™ä¸ªè§£æé˜¶æ®µå°±æ˜¯ä¸ºäº†æŠŠè¿™ä¸ªç¬¦å·å¼•ç”¨è½¬åŒ–æˆä¸ºçœŸæ­£çš„åœ°å€çš„é˜¶æ®µã€‚</p></blockquote><p>ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æœªè§„å®šè§£æé˜¶æ®µå‘ç”Ÿçš„æ—¶é—´ï¼Œåªè¦æ±‚äº†åœ¨</p><p><code>anewarray</code>ã€<code>checkcast</code>ã€<code>getfield</code>ã€<code>getstatic</code>ã€<code>instanceof</code>ã€<code>invokedynamic</code>ã€<code>invokeinterface</code>ã€<code>invokespecial</code>ã€<code>invokestatic</code>ã€<code>invokevirtual</code>ã€<code>ldc</code>ã€<code>ldc_w</code>ã€<code>ldc2_w</code>ã€<code>multianewarray</code>ã€<code>new</code>ã€<code>putfield</code> å’Œ <code>putstatic</code> è¿™ 17 ä¸ªç”¨äºæ“ä½œç¬¦å·å¼•ç”¨çš„å­—èŠ‚ç æŒ‡ä»¤ä¹‹å‰ï¼Œå…ˆå¯¹æ‰€ä½¿ç”¨çš„ç¬¦å·å¼•ç”¨è¿›è¡Œè§£æã€‚</p><p>è§£æä¹Ÿåˆ†ä¸ºå››ä¸ªæ­¥éª¤</p><ul><li>ç±»æˆ–æ¥å£çš„è§£æ</li><li>å­—æ®µè§£æ</li><li>æ–¹æ³•è§£æ</li><li>æ¥å£æ–¹æ³•è§£æ</li></ul><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>åˆå§‹åŒ–æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„æœ€åä¸€ä¸ªæ­¥éª¤ï¼Œåœ¨ä¹‹å‰çš„é˜¶æ®µä¸­ï¼Œéƒ½æ˜¯ç”± Java è™šæ‹Ÿæœºå ä¸»å¯¼ä½œç”¨ï¼Œä½†æ˜¯åˆ°äº†è¿™ä¸€æ­¥ï¼Œå´æŠŠä¸»åŠ¨æƒç§»äº¤ç»™åº”ç”¨ç¨‹åºã€‚</p><p>å¯¹äºåˆå§‹åŒ–é˜¶æ®µï¼Œã€Š<code>Java</code> è™šæ‹Ÿæœºè§„èŒƒã€‹ä¸¥æ ¼è§„å®šäº†åªæœ‰ä¸‹é¢è¿™å…­ç§æƒ…å†µä¸‹æ‰ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ã€‚</p><ul><li><p>åœ¨é‡åˆ° <code>newã€getstaticã€putstatic</code> æˆ–è€… <code>invokestatic</code> è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œé‚£ä¹ˆé¦–å…ˆè§¦å‘åˆå§‹åŒ–ã€‚é€šè¿‡è¿™å››ä¸ªå­—èŠ‚ç çš„åç§°å¯ä»¥åˆ¤æ–­ï¼Œè¿™å››æ¡å­—èŠ‚ç å…¶å®å°±ä¸¤ä¸ªåœºæ™¯ï¼Œè°ƒç”¨ <code>new</code> å…³é”®å­—çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€è¯»å–æˆ–è€…è®¾ç½®ä¸€ä¸ªé™æ€å­—æ®µçš„æ—¶å€™ã€è°ƒç”¨é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚</p></li><li><p>åœ¨åˆå§‹åŒ–ç±»çš„æ—¶å€™ï¼Œå¦‚æœçˆ¶ç±»è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆå¯¹çˆ¶ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚</p></li><li><p>åœ¨ä½¿ç”¨ <code>java.lang.reflect</code> åŒ…çš„æ–¹æ³•è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ã€‚</p></li><li><p>å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šæ‰§è¡Œä¸»ç±»çš„æ—¶å€™ï¼Œè¯´ç™½äº†å°±æ˜¯è™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ– main æ–¹æ³•è¿™ä¸ªç±»ã€‚</p></li><li><p>åœ¨ä½¿ç”¨ <code>JDK</code> 7 æ–°åŠ å…¥çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª <code>jafva.lang.invoke.MethodHandle</code> å®ä¾‹æœ€åçš„è§£æç»“æœä¸º <code>REF_getstaticã€REF_putstaticã€REF_invokeStaticã€REF_newInvokeSpecial</code> å››ç§ç±»å‹çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œéœ€è¦å…ˆå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚</p></li><li><p>å½“ä¸€ä¸ªæ¥å£ä¸­å®šä¹‰äº† <code>JDK</code> 8 æ–°åŠ å…¥çš„é»˜è®¤æ–¹æ³•ï¼ˆè¢« default å…³é”®å­—ä¿®é¥°çš„æ¥å£æ–¹æ³•ï¼‰æ—¶ï¼Œå¦‚æœæœ‰è¿™ä¸ªæ¥å£çš„å®ç°ç±»å‘ç”Ÿäº†åˆå§‹åŒ–ï¼Œé‚£è¯¥æ¥å£è¦åœ¨å…¶ä¹‹å‰è¢«åˆå§‹åŒ–ã€‚</p><p>å…¶å®ä¸Šé¢åªæœ‰å‰å››ä¸ªå¤§å®¶éœ€è¦çŸ¥é“å°±å¥½äº†ï¼Œåé¢ä¸¤ä¸ªæ¯”è¾ƒå†·é—¨ã€‚</p></li></ul><blockquote><p>å¦‚æœè¯´è¦å›ç­”ç±»åŠ è½½çš„è¯ï¼Œå…¶å®èŠåˆ°è¿™é‡Œå·²ç»å¯ä»¥äº†ï¼Œä½†æ˜¯ä¸ºäº†å®Œæ•´æ€§ï¼Œæˆ‘ä»¬ç´¢æ€§æŠŠåé¢ä¸¤ä¸ªè¿‡ç¨‹ä¹Ÿæ¥èŠä¸€èŠã€‚</p></blockquote><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>è¿™ä¸ªé˜¶æ®µæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œå°±æ˜¯åˆå§‹åŒ–ä¹‹åçš„ä»£ç ç”± JVM æ¥åŠ¨æ€è°ƒç”¨æ‰§è¡Œã€‚</p><h3 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h3><p>å½“ä»£è¡¨ä¸€ä¸ªç±»çš„</p><p><code>Class</code> å¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œé‚£ä¹ˆ Class å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±ç»“æŸäº†ï¼Œå¯¹åº”çš„åœ¨æ–¹æ³•åŒºä¸­çš„æ•°æ®ä¹Ÿä¼šè¢«å¸è½½ã€‚</p><blockquote><p>âš ï¸ä½†æ˜¯éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šJVM è‡ªå¸¦çš„ç±»åŠ è½½å™¨è£…è½½çš„ç±»ï¼Œæ˜¯ä¸ä¼šå¸è½½çš„ï¼Œç”±ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æ˜¯å¯ä»¥å¸è½½çš„ã€‚</p></blockquote><h2 id="åœ¨-JVM-ä¸­ï¼Œå¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Ÿ"><a href="#åœ¨-JVM-ä¸­ï¼Œå¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Ÿ" class="headerlink" title="åœ¨ JVM ä¸­ï¼Œå¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Ÿ"></a>åœ¨ JVM ä¸­ï¼Œå¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Ÿ</h2><blockquote><p>å¦‚æœè¦å›ç­”å¯¹è±¡æ˜¯æ€ä¹ˆåˆ›å»ºçš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬æƒ³åˆ°çš„å›ç­”æ˜¯ç›´æ¥ <code>new</code> å‡ºæ¥å°±è¡Œäº†ï¼Œè¿™ä¸ªå›ç­”ä¸ä»…å±€é™äºç¼–ç¨‹ä¸­ï¼Œä¹Ÿèå…¥åœ¨æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ–¹æ–¹é¢é¢ã€‚</p><p>ä½†æ˜¯é‡åˆ°é¢è¯•çš„æ—¶å€™ä½ åªå›ç­”ä¸€ä¸ª <code>new</code> å‡ºæ¥å°±è¡Œäº†â€ æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºé¢è¯•æ›´è¶‹å‘äºè®©ä½ è§£é‡Šå½“ç¨‹åºæ‰§è¡Œåˆ° <code>new</code> è¿™æ¡æŒ‡ä»¤æ—¶ï¼Œå®ƒçš„èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p>æ‰€ä»¥ä½ éœ€è¦ä» <code>JVM</code> çš„è§’åº¦æ¥è§£é‡Šè¿™ä»¶äº‹æƒ…ã€‚</p></blockquote><p>å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ª</p><p><code>new</code> æŒ‡ä»¤æ—¶ï¼ˆå…¶å®å°±æ˜¯å­—èŠ‚ç ï¼‰ï¼Œé¦–å…ˆä¼šå»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨æ‰€ä»£è¡¨çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–ã€‚å› ä¸ºæ­¤æ—¶å¾ˆå¯èƒ½ä¸çŸ¥é“å…·ä½“çš„ç±»æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨çš„æ˜¯ç¬¦å·å¼•ç”¨ã€‚å¦‚æœå‘ç°è¿™ä¸ªç±»æ²¡æœ‰ç»è¿‡ä¸Šé¢ç±»åŠ è½½çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚ç±»æ£€æŸ¥å®Œæˆåï¼Œæ¥ä¸‹æ¥è™šæ‹Ÿæœºå°†ä¼šä¸ºæ–°ç”Ÿå¯¹è±¡<strong>åˆ†é…å†…å­˜</strong>ï¼Œå¯¹è±¡æ‰€éœ€çš„å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ç¡®å®šï¼ˆæˆ‘ä¼šåœ¨ä¸‹é¢çš„é¢è¯•é¢˜ä¸­ä»‹ç»ï¼‰ã€‚</p><p>åˆ†é…å†…å­˜ç›¸å½“äºæ˜¯æŠŠä¸€å—å›ºå®šçš„å†…å­˜å—ä»å †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚åˆ’åˆ†å‡ºæ¥ä¹‹åï¼Œè™šæ‹Ÿæœºä¼šå°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼Œå¦‚æœä½¿ç”¨äº†<code>TLAB</code>ï¼ˆæœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼‰ï¼Œè¿™ä¸€é¡¹åˆå§‹åŒ–å·¥ä½œå¯ä»¥æå‰åœ¨ <code>TLAB</code> åˆ†é…æ—¶è¿›è¡Œã€‚è¿™ä¸€æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡å®ä¾‹å­—æ®µåœ¨ <code>Java</code> ä»£ç ä¸­å¯ä»¥ä¸èµ‹å€¼å°±èƒ½ç›´æ¥ä½¿ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œ<code>Java</code> è™šæ‹Ÿæœºè¿˜ä¼šå¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œæ¯”å¦‚ç¡®å®šå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€å¯¹è±¡çš„ <code>hashcode</code>ã€å¯¹è±¡çš„ <code>gc</code> åˆ†ä»£å¹´é¾„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡çš„å¯¹è±¡å¤´ï¼ˆ<code>Object Header</code>ï¼‰ä¸­ã€‚</p><p>å¦‚æœä¸Šé¢çš„å·¥ä½œéƒ½åšå®Œåï¼Œä»è™šæ‹Ÿæœºçš„è§’åº¦æ¥è¯´ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å°±åˆ›å»ºå®Œæ¯•äº†ï¼›ä½†æ˜¯å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œå¯¹è±¡åˆ›å»ºæ‰åˆšåˆšå¼€å§‹ï¼Œå› ä¸ºæ„é€ å‡½æ•°ï¼Œå³ <code>Class</code> æ–‡ä»¶ä¸­çš„ <code>&lt;init&gt;()</code> æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰å­—æ®µéƒ½ä¸ºé»˜è®¤çš„é›¶å€¼ã€‚<code>new</code> æŒ‡ä»¤ä¹‹åæ‰ä¼šæ‰§è¡Œ <code>&lt;init&gt;()</code> æ–¹æ³•ï¼Œç„¶åæŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿å¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªå¯¹è±¡æ‰å¯èƒ½è¢«å®Œæ•´çš„æ„é€ å‡ºæ¥ã€‚</p><h2 id="å†…å­˜åˆ†é…æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ"><a href="#å†…å­˜åˆ†é…æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ" class="headerlink" title="å†…å­˜åˆ†é…æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ"></a>å†…å­˜åˆ†é…æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ</h2><p>åœ¨ç±»åŠ è½½å®Œæˆåï¼Œè™šæ‹Ÿæœºéœ€è¦ä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ï¼Œä¸º<strong>å¯¹è±¡åˆ†é…å†…å­˜</strong>ç›¸å½“äºæ˜¯<strong>æŠŠä¸€å—ç¡®å®šçš„åŒºåŸŸä»ã€å †ã€‘ä¸­åˆ’åˆ†</strong>å‡ºæ¥ã€‚è¿™å°±æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œ</p><p><strong>è¦åˆ’åˆ†çš„å †åŒºæ˜¯å¦è§„æ•´</strong>ã€‚</p><ul><li><p><strong>å‡è®¾è§„æ•´</strong>ï¼šæ‰€æœ‰ä½¿ç”¨è¿‡çš„å†…å­˜æ”¾åœ¨ä¸€è¾¹ï¼Œæœªä½¿ç”¨çš„å†…å­˜æ”¾åœ¨ä¸€è¾¹ï¼Œä¸­é—´æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆä¸ºåˆ†ç•ŒæŒ‡ç¤ºå™¨ã€‚é‚£ä¹ˆä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´å°±ç›¸å½“äºæ˜¯æŠŠæŒ‡é’ˆå‘ç©ºé—²çš„ç©ºé—´æŒªåŠ¨å¯¹è±¡å¤§å°ç›¸ç­‰çš„è·ç¦»ï¼Œè¿™ç§å†…å­˜åˆ†é…æ–¹å¼å«åšã€**æŒ‡é’ˆç¢°æ’(Bump The Pointer)**ã€‘ã€‚</p></li><li><p><strong>å‡è®¾ä¸è§„æ•´</strong>ï¼šå·²ç»è¢«ä½¿ç”¨çš„å†…å­˜å’Œæœªè¢«ä½¿ç”¨çš„å†…å­˜<strong>ç›¸äº’äº¤é”™</strong>åœ¨ä¸€èµ·ï¼Œè¿™ç§æƒ…å†µä¸‹å°±æ²¡æœ‰åŠæ³•ä½¿ç”¨æŒ‡é’ˆç¢°æ’ï¼Œè¿™é‡Œå°±è¦ä½¿ç”¨å¦å¤–ä¸€ç§è®°å½•å†…å­˜ä½¿ç”¨çš„æ–¹å¼ï¼šã€<strong>ç©ºé—²åˆ—è¡¨(Free List</strong>)ã€‘ã€‚ç©ºé—²åˆ—è¡¨ç»´æŠ¤äº†ä¸€ä¸ªåˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨è®°å½•äº†<strong>å“ªäº›å†…å­˜å—æ˜¯å¯ç”¨</strong>çš„ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ’åˆ†ç»™å¯¹è±¡å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ã€‚</p><p>æ‰€ä»¥ï¼Œä¸Šè¿°ä¸¤ç§åˆ†é…æ–¹å¼é€‰æ‹©å“ªä¸ªï¼Œå–å†³äº <code>Java</code> <strong>å †æ˜¯å¦è§„æ•´</strong>æ¥å†³å®šã€‚</p></li><li><p><strong>æŒ‡é’ˆç¢°æ’</strong>ï¼š<code>Serial</code>ã€<code>ParNew</code> ç­‰<strong>å¸¦å‹ç¼©æ•´ç†</strong>è¿‡ç¨‹çš„æ”¶é›†å™¨ï¼Œ</p></li><li><p><strong>ç©ºé—²åˆ—è¡¨</strong>ï¼š <code>CMS</code> è¿™ç§åŸºäº<strong>æ¸…é™¤ç®—æ³•</strong>çš„æ”¶é›†å™¨æ—¶ï¼Œ</p></li></ul><h2 id="å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼Ÿ"><a href="#å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼Ÿ" class="headerlink" title="å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼Ÿ"></a>å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼Ÿ</h2><p>åœ¨<code>hotspot</code> è™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€åˆ†ä¸ºä¸‰å—åŒºåŸŸï¼š</p><ul><li><code>å¯¹è±¡å¤´(Header)</code></li><li><code>å®ä¾‹æ•°æ®(Instance Data)</code></li><li><code>å¯¹é½å¡«å……(Padding)</code></li></ul><p>è¿™ä¸‰å—åŒºåŸŸçš„å†…å­˜åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><a href="https://s2.loli.net/2024/12/20/ipeYynBAKwrJ6UF.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/ipeYynBAKwrJ6UF.jpg"></a></p><p>æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹ä¸Šé¢å¯¹è±¡ä¸­çš„å†…å®¹ã€‚</p><h3 id="å¯¹è±¡å¤´-Header"><a href="#å¯¹è±¡å¤´-Header" class="headerlink" title="å¯¹è±¡å¤´ Header"></a>å¯¹è±¡å¤´ Header</h3><p>å¯¹è±¡å¤´ <code>Header</code> ä¸»è¦åŒ…å« <code>MarkWord</code> å’Œå¯¹è±¡æŒ‡é’ˆ <code>Klass Pointer</code>ï¼Œå¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œè¿˜è¦åŒ…å«æ•°ç»„çš„é•¿åº¦ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/aTL8273HxYWq1og.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/aTL8273HxYWq1og.jpg"></a></p><ul><li>32 ä½è™šæ‹Ÿæœºï¼š <code>MarkWord</code> ï¼Œ<code>Klass Pointer</code> å’Œæ•°ç»„é•¿åº¦åˆ†åˆ«å ç”¨ 32 ä½ï¼Œä¹Ÿå°±æ˜¯ 4 å­—èŠ‚ã€‚</li><li>64 ä½è™šæ‹Ÿæœºï¼š<code>MarkWord</code> ï¼Œ<code>Klass Pointer</code> å’Œæ•°ç»„é•¿åº¦åˆ†åˆ«å ç”¨ 64 ä½ï¼Œä¹Ÿå°±æ˜¯ 8 å­—èŠ‚ã€‚</li></ul><p>åœ¨ 32 ä½è™šæ‹Ÿæœºå’Œ 64 ä½è™šæ‹Ÿæœºçš„<code>MarkWord</code> æ‰€å ç”¨çš„å­—èŠ‚å¤§å°ä¸ä¸€æ ·ï¼Œ32 ä½è™šæ‹Ÿæœºçš„ <code>MarkWord</code> å’Œ <code>Klass Pointer</code> åˆ†åˆ«å ç”¨ 32 bits çš„å­—èŠ‚ï¼Œè€Œ 64 ä½è™šæ‹Ÿæœºçš„ <code>Mark Word</code> å’Œ <code>Klass Pointer</code> å ç”¨äº† 64 <code>bits</code> çš„å­—èŠ‚ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥ 32 ä½è™šæ‹Ÿæœºä¸ºä¾‹ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶ <code>Mark Word</code> çš„å­—èŠ‚å…·ä½“æ˜¯å¦‚ä½•åˆ†é…çš„ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/P1rXkYKMC8fDdhF.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/P1rXkYKMC8fDdhF.jpg"></a></p><p>ç”¨ä¸­æ–‡ç¿»è¯‘è¿‡æ¥å°±æ˜¯</p><p><a href="https://s2.loli.net/2024/12/20/2B6n3YTMagd4HLI.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/2B6n3YTMagd4HLI.jpg"></a></p><ul><li>æ— çŠ¶æ€ä¹Ÿå°±æ˜¯<code>æ— é”</code>çš„æ—¶å€™ï¼Œå¯¹è±¡å¤´å¼€è¾Ÿ 25 <code>bit</code> çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å¯¹è±¡çš„ <code>hashcode</code> ï¼Œ4 <code>bit</code> ç”¨äºå­˜æ”¾åˆ†ä»£å¹´é¾„ï¼Œ1 <code>bit</code> ç”¨æ¥å­˜æ”¾æ˜¯å¦åå‘é”çš„æ ‡è¯†ä½ï¼Œ2 <code>bit</code> ç”¨æ¥å­˜æ”¾é”æ ‡è¯†ä½ä¸º 01ã€‚</li><li><code>åå‘é”</code> ä¸­åˆ’åˆ†æ›´ç»†ï¼Œè¿˜æ˜¯å¼€è¾Ÿ 25 <code>bit</code> çš„ç©ºé—´ï¼Œå…¶ä¸­ 23 <code>bit</code> ç”¨æ¥å­˜æ”¾çº¿ç¨‹ IDï¼Œ<code>2bit</code> ç”¨æ¥å­˜æ”¾ <code>epoch</code>ï¼Œ<code>4bit</code> å­˜æ”¾åˆ†ä»£å¹´é¾„ï¼Œ1 <code>bit</code> å­˜æ”¾æ˜¯å¦åå‘é”æ ‡è¯†ï¼Œ 0 è¡¨ç¤ºæ— é”ï¼Œ1 è¡¨ç¤ºåå‘é”ï¼Œé”çš„æ ‡è¯†ä½è¿˜æ˜¯ 01ã€‚</li><li><code>è½»é‡çº§é”</code>ä¸­ç›´æ¥å¼€è¾Ÿ 30 <code>bit</code> çš„ç©ºé—´å­˜æ”¾æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆï¼Œ<code>2bit</code> å­˜æ”¾é”çš„æ ‡å¿—ä½ï¼Œå…¶æ ‡å¿—ä½ä¸º 00ã€‚</li><li><code>é‡é‡çº§é”</code>ä¸­å’Œè½»é‡çº§é”ä¸€æ ·ï¼Œ30 <code>bit</code> çš„ç©ºé—´ç”¨æ¥å­˜æ”¾æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆï¼Œ2 <code>bit</code> å­˜æ”¾é”çš„æ ‡è¯†ä½ï¼Œä¸º 11</li><li><code>GCæ ‡è®°</code>å¼€è¾Ÿ 30 <code>bit</code> çš„å†…å­˜ç©ºé—´å´æ²¡æœ‰å ç”¨ï¼Œ2 <code>bit</code> ç©ºé—´å­˜æ”¾é”æ ‡å¿—ä½ä¸º 11ã€‚</li></ul><p>å…¶ä¸­æ— é”å’Œåå‘é”çš„é”æ ‡å¿—ä½éƒ½æ˜¯ 01ï¼Œåªæ˜¯åœ¨å‰é¢çš„ 1 <code>bit</code> åŒºåˆ†äº†è¿™æ˜¯æ— é”çŠ¶æ€è¿˜æ˜¯åå‘é”çŠ¶æ€ã€‚</p><p>å…³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåˆ†é…çš„å†…å­˜ï¼Œæˆ‘ä»¬å¯ä»¥ä» <code>OpenJDK</code> ä¸­çš„ <code>markOop.hpp</code> ç±»ä¸­çš„æšä¸¾çª¥å‡ºç«¯å€ª</p><p><a href="https://s2.loli.net/2024/12/20/pTGKBxd1A6IEO2X.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/pTGKBxd1A6IEO2X.jpg"></a></p><p>æ¥è§£é‡Šä¸€ä¸‹</p><ul><li><code>age_bits</code> å°±æ˜¯æˆ‘ä»¬è¯´çš„åˆ†ä»£å›æ”¶çš„æ ‡è¯†ï¼Œå ç”¨ 4 å­—èŠ‚</li><li><code>lock_bits</code> æ˜¯é”çš„æ ‡å¿—ä½ï¼Œå ç”¨ 2 ä¸ªå­—èŠ‚</li><li><code>biased_lock_bits</code> æ˜¯æ˜¯å¦åå‘é”çš„æ ‡è¯†ï¼Œå ç”¨ 1 ä¸ªå­—èŠ‚ã€‚</li><li><code>max_hash_bits</code> æ˜¯é’ˆå¯¹æ— é”è®¡ç®—çš„ <code>hashcode</code> å ç”¨å­—èŠ‚æ•°é‡ï¼Œå¦‚æœæ˜¯ 32 ä½è™šæ‹Ÿæœºï¼Œå°±æ˜¯ 32 - 4 - 2 -1 = 25 <code>byte</code>ï¼Œå¦‚æœæ˜¯ 64 ä½è™šæ‹Ÿæœºï¼Œ64 - 4 - 2 - 1 = 57 <code>byte</code>ï¼Œä½†æ˜¯ä¼šæœ‰ 25 å­—èŠ‚æœªä½¿ç”¨ï¼Œæ‰€ä»¥ 64 ä½çš„ <code>hashcode</code> å ç”¨ 31 <code>byte</code>ã€‚</li><li><code>hash_bits</code> æ˜¯é’ˆå¯¹ 64 ä½è™šæ‹Ÿæœºæ¥è¯´ï¼Œå¦‚æœæœ€å¤§å­—èŠ‚æ•°å¤§äº 31ï¼Œåˆ™å– 31ï¼Œå¦åˆ™å–çœŸå®çš„å­—èŠ‚æ•°</li><li><code>cms_bits</code> æˆ‘è§‰å¾—åº”è¯¥æ˜¯ä¸æ˜¯ 64 ä½è™šæ‹Ÿæœºå°±å ç”¨ 0 <code>byte</code>ï¼Œæ˜¯ 64 ä½å°±å ç”¨ 1byte</li><li><code>epoch_bits</code> å°±æ˜¯ epoch æ‰€å ç”¨çš„å­—èŠ‚å¤§å°ï¼Œ2 å­—èŠ‚ã€‚</li></ul><p>åœ¨ä¸Šé¢çš„è™šæ‹Ÿæœºå¯¹è±¡å¤´åˆ†é…è¡¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å‡ ç§é”çš„çŠ¶æ€ï¼š<strong>æ— é”ï¼ˆæ— çŠ¶æ€ï¼‰</strong>ï¼Œ<strong>åå‘é”</strong>ï¼Œ<strong>è½»é‡çº§é”</strong>ï¼Œ<strong>é‡é‡çº§é”</strong>ï¼Œå…¶ä¸­è½»é‡çº§é”å’Œåå‘é”æ˜¯<code>JDK1.6</code> ä¸­å¯¹ <code>synchronized</code> é”è¿›è¡Œä¼˜åŒ–åæ–°å¢åŠ çš„ï¼Œå…¶ç›®çš„å°±æ˜¯ä¸ºäº†<strong>å¤§å¤§ä¼˜åŒ–é”çš„æ€§èƒ½</strong>ï¼Œæ‰€ä»¥åœ¨ <code>JDK</code> 1.6 ä¸­ï¼Œä½¿ç”¨ <code>synchronized</code> çš„å¼€é”€ä¹Ÿæ²¡é‚£ä¹ˆå¤§äº†ã€‚å…¶å®ä»é”æœ‰æ— é”å®šæ¥è®²ï¼Œè¿˜æ˜¯åªæœ‰<strong>æ— é”å’Œé‡é‡çº§é”</strong>ï¼Œåå‘é”å’Œè½»é‡çº§é”çš„å‡ºç°å°±æ˜¯å¢åŠ äº†é”çš„<strong>è·å–æ€§èƒ½</strong>è€Œå·²ï¼Œå¹¶æ²¡æœ‰å‡ºç°æ–°çš„é”ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬çš„é‡ç‚¹æ”¾åœ¨å¯¹<code>synchronized</code> é‡é‡çº§é”çš„ç ”ç©¶ä¸Šï¼Œå½“ <code>monitor</code> è¢«æŸä¸ªçº¿ç¨‹æŒæœ‰åï¼Œå®ƒå°±ä¼šå¤„äº<strong>é”å®šçŠ¶æ€</strong>ã€‚åœ¨ <code>HotSpot</code> è™šæ‹Ÿæœºä¸­ï¼Œ<code>monitor</code> çš„åº•å±‚ä»£ç æ˜¯ç”± <code>ObjectMonitor</code> å®ç°çš„ï¼Œå…¶ä¸»è¦æ•°æ®ç»“æ„å¦‚ä¸‹ï¼ˆä½äº <code>HotSpot</code> è™šæ‹Ÿæœºæºç  <code>ObjectMonitor.hpp</code> æ–‡ä»¶ï¼Œ<code>C++</code> å®ç°çš„ï¼‰</p><p><a href="https://s2.loli.net/2024/12/20/x6GIoZ4aWFPfQqO.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/x6GIoZ4aWFPfQqO.jpg"></a></p><p>è¿™æ®µ C++ ä¸­éœ€è¦æ³¨æ„å‡ ä¸ªå±æ€§ï¼š</p><p><code>_WaitSet</code> ã€ <code>_EntryList</code> å’Œ <code>_Owner</code>ï¼Œæ¯ä¸ªç­‰å¾…è·å–é”çš„çº¿ç¨‹éƒ½ä¼šè¢«å°è£…ç§°ä¸º <code>ObjectWaiter</code> å¯¹è±¡ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/yqtvzOug5KJ3nbc.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/yqtvzOug5KJ3nbc.jpg"></a></p><p><code>    _Owner</code> æ˜¯æŒ‡å‘äº† <code>ObjectMonitor</code> å¯¹è±¡çš„çº¿ç¨‹ï¼Œè€Œ <code>_WaitSet</code> å’Œ <code>_EntryList</code> å°±æ˜¯ç”¨æ¥ä¿å­˜æ¯ä¸ªçº¿ç¨‹çš„åˆ—è¡¨ã€‚</p><blockquote><p>é‚£ä¹ˆè¿™ä¸¤ä¸ªåˆ—è¡¨æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜æˆ‘å’Œä½ èŠä¸€ä¸‹é”çš„è·å–æµç¨‹ä½ å°±æ¸…æ¥šäº†ã€‚</p></blockquote><h3 id="é”çš„ä¸¤ä¸ªåˆ—è¡¨"><a href="#é”çš„ä¸¤ä¸ªåˆ—è¡¨" class="headerlink" title="é”çš„ä¸¤ä¸ªåˆ—è¡¨"></a><strong>é”çš„ä¸¤ä¸ªåˆ—è¡¨</strong></h3><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸæ®µåŒæ­¥ä»£ç æ—¶ï¼Œé¦–å…ˆä¼šè¿›å…¥</p><p><code>_EntryList</code> é›†åˆï¼Œå½“çº¿ç¨‹è·å–åˆ°å¯¹è±¡çš„ <code>monitor</code> ä¹‹åï¼Œå°±ä¼šè¿›å…¥ <code>_Owner</code> åŒºåŸŸï¼Œå¹¶æŠŠ <code>ObjectMonitor</code> å¯¹è±¡çš„ <code>_Owner</code> æŒ‡å‘ä¸ºå½“å‰çº¿ç¨‹ï¼Œå¹¶ä½¿ <code>_count + 1</code>ï¼Œå¦‚æœè°ƒç”¨äº†é‡Šæ”¾é”ï¼ˆæ¯”å¦‚ <code>wait</code>ï¼‰çš„æ“ä½œï¼Œå°±ä¼šé‡Šæ”¾å½“å‰æŒæœ‰çš„ <code>monitor</code> ï¼Œ<code>owner = null</code>ï¼Œ _count - 1ï¼ŒåŒæ—¶è¿™ä¸ªçº¿ç¨‹ä¼šè¿›å…¥åˆ° <code>_WaitSet</code> åˆ—è¡¨ä¸­ç­‰å¾…è¢«å”¤é†’ã€‚å¦‚æœå½“å‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åä¹Ÿä¼šé‡Šæ”¾ <code>monitor</code> é”ï¼Œåªä¸è¿‡æ­¤æ—¶ä¸ä¼šè¿›å…¥ <code>_WaitSet</code> åˆ—è¡¨äº†ï¼Œè€Œæ˜¯ç›´æ¥å¤ä½ <code>_count</code> çš„å€¼ã€‚</p><p><a href="https://s2.loli.net/2024/12/20/cpIQeDXZlzk3ovY.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/cpIQeDXZlzk3ovY.jpg"></a></p><p><code>Klass Pointer</code> è¡¨ç¤ºçš„æ˜¯ç±»å‹æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚</p><blockquote><p>ä½ å¯èƒ½ä¸æ˜¯å¾ˆç†è§£æŒ‡é’ˆæ˜¯ä¸ªä»€ä¹ˆæ¦‚å¿µï¼Œä½ å¯ä»¥ç®€å•ç†è§£ä¸ºæŒ‡é’ˆå°±æ˜¯æŒ‡å‘æŸä¸ªæ•°æ®çš„åœ°å€ã€‚</p></blockquote><p><a href="https://s2.loli.net/2024/12/20/qCTZx5cvsEUw2dP.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/qCTZx5cvsEUw2dP.jpg"></a></p><h3 id="å®ä¾‹æ•°æ®-Instance-Data"><a href="#å®ä¾‹æ•°æ®-Instance-Data" class="headerlink" title="å®ä¾‹æ•°æ® Instance Data"></a>å®ä¾‹æ•°æ® <code>Instance Data</code></h3><p>å®ä¾‹æ•°æ®éƒ¨åˆ†æ˜¯å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼Œä¹Ÿæ˜¯ä»£ç ä¸­å®šä¹‰çš„å„ä¸ªå­—æ®µçš„å­—èŠ‚å¤§å°ï¼Œæ¯”å¦‚ä¸€ä¸ª</p><p><code>byte</code> å  1 ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ª <code>int</code> å ç”¨ 4 ä¸ªå­—èŠ‚ã€‚</p><h3 id="å¯¹é½-Padding"><a href="#å¯¹é½-Padding" class="headerlink" title="å¯¹é½ Padding"></a>å¯¹é½ <code>Padding</code></h3><p>å¯¹é½ä¸æ˜¯å¿…é¡»å­˜åœ¨çš„ï¼Œå®ƒåªèµ·åˆ°äº†å ä½ç¬¦ (<code>%d, %c</code> ç­‰) çš„ä½œç”¨ã€‚è¿™å°±æ˜¯ JVM çš„è¦æ±‚äº†ï¼Œå› ä¸º <code>HotSpot</code> <code>JVM</code> è¦æ±‚å¯¹è±¡çš„èµ·å§‹åœ°å€å¿…é¡»æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹è±¡çš„å­—èŠ‚å¤§å°æ˜¯ 8 çš„æ•´æ•°å€ï¼Œä¸å¤Ÿçš„éœ€è¦ä½¿ç”¨ <code>Padding</code> è¡¥å…¨ã€‚</p><h2 id="å¯¹è±¡è®¿é—®å®šä½çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"><a href="#å¯¹è±¡è®¿é—®å®šä½çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="å¯¹è±¡è®¿é—®å®šä½çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"></a>å¯¹è±¡è®¿é—®å®šä½çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h2><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„ç›®çš„å½“ç„¶å°±æ˜¯ä¸ºäº†ä½¿ç”¨å®ƒï¼Œä½†æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºå‡ºæ¥ä¹‹åï¼Œåœ¨<code>JVM</code> ä¸­æ˜¯å¦‚ä½•è®¿é—®è¿™ä¸ªå¯¹è±¡çš„å‘¢ï¼Ÿä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š<strong>é€šè¿‡å¥æŸ„è®¿é—®</strong>å’Œ <strong>é€šè¿‡ç›´æ¥æŒ‡é’ˆè®¿é—®</strong>ã€‚</p><ul><li><p>å¦‚æœä½¿ç”¨å¥æŸ„è®¿é—®æ–¹å¼çš„è¯ï¼Œ<code>Java</code> å †ä¸­å¯èƒ½ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜ä½œä¸ºå¥æŸ„æ± ï¼Œå¼•ç”¨ï¼ˆ<code>reference</code>ï¼‰ä¸­å­˜å‚¨çš„æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡çš„å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªå…·ä½“çš„åœ°å€ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545142.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545142.jpeg"></a></p></li><li><p>å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®çš„è¯ï¼Œ<code>Java</code> å †ä¸­å¯¹è±¡çš„å†…å­˜å¸ƒå±€å°±ä¼šæœ‰æ‰€åŒºåˆ«ï¼Œæ ˆåŒºå¼•ç”¨æŒ‡ç¤ºçš„æ˜¯å †ä¸­çš„å®ä¾‹æ•°æ®çš„åœ°å€ï¼Œå¦‚æœåªæ˜¯è®¿é—®å¯¹è±¡æœ¬èº«çš„è¯ï¼Œå°±ä¸ä¼šå¤šä¸€æ¬¡ç›´æ¥è®¿é—®çš„å¼€é”€ï¼Œè€Œå¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆæ˜¯å­˜åœ¨äºæ–¹æ³•åŒºä¸­ï¼Œå¦‚æœå®šä½çš„è¯ï¼Œéœ€è¦å¤šä¸€æ¬¡ç›´æ¥å®šä½å¼€é”€ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545927.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545927.jpeg"></a></p><p>è¿™ä¸¤ç§å¯¹è±¡è®¿é—®æ–¹å¼å„æœ‰å„çš„ä¼˜åŠ¿ï¼Œä½¿ç”¨å¥æŸ„æœ€å¤§çš„å¥½å¤„å°±æ˜¯å¼•ç”¨ä¸­å­˜å‚¨çš„æ˜¯å¥æŸ„åœ°å€ï¼Œå¯¹è±¡ç§»åŠ¨æ—¶åªéœ€æ”¹å˜å¥æŸ„çš„åœ°å€å°±å¯ä»¥ï¼Œè€Œæ— éœ€æ”¹å˜å¯¹è±¡æœ¬èº«ã€‚</p></li></ul><p>ä½¿ç”¨ç›´æ¥æŒ‡é’ˆæ¥è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œç”±äºå¯¹è±¡è®¿é—®åœ¨ Java ä¸­éå¸¸é¢‘ç¹ï¼Œå› ä¸ºè¿™ç±»çš„å¼€é”€ä¹Ÿæ˜¯å€¼å¾—ä¼˜åŒ–çš„åœ°æ–¹ã€‚</p><p>ä¸Šé¢èŠåˆ°äº†å¯¹è±¡çš„ä¸¤ç§æ•°æ®ï¼Œä¸€ç§æ˜¯å¯¹è±¡çš„å®ä¾‹æ•°æ®ï¼Œè¿™æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯å¯¹è±¡å®ä¾‹å­—æ®µçš„æ•°æ®ï¼Œä¸€ç§æ˜¯å¯¹è±¡çš„ç±»å‹æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®è¯´çš„æ˜¯å¯¹è±¡çš„ç±»å‹ã€çˆ¶ç±»ã€å®ç°çš„æ¥å£å’Œæ–¹æ³•ç­‰ã€‚</p><h2 id="å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ</h2><blockquote><p>å¼•ç”¨è®¡æ•°ã€å¯è¾¾æ€§åˆ†æ</p></blockquote><p>æˆ‘ä»¬å¤§å®¶çŸ¥é“ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨å †ä¸­åˆ†å¸ƒï¼Œå½“æˆ‘ä»¬ä¸å†ä½¿ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œåƒåœ¾æ”¶é›†å™¨ä¼šå¯¹æ— ç”¨å¯¹è±¡è¿›è¡Œå›æ”¶â™»ï¸ï¼Œé‚£ä¹ˆ JVM æ˜¯å¦‚ä½•åˆ¤æ–­å“ªäº›å¯¹è±¡å·²ç»æ˜¯ â€œæ— ç”¨å¯¹è±¡â€ çš„å‘¢ï¼Ÿ</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ¥è¯´ç¬¬ä¸€ç§ï¼š</p><p><strong>å¼•ç”¨è®¡æ•°æ³•</strong>ã€‚</p><p>å¼•ç”¨è®¡æ•°æ³•çš„åˆ¤æ–­æ ‡å‡†æ˜¯è¿™æ ·çš„ï¼šåœ¨å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šåŠ ä¸€ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šå‡ä¸€ï¼›åªè¦ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨ä¸ºé›¶çš„å¯¹è±¡å°±æ˜¯ä¸ä¼šå†è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚è™½ç„¶è¿™ç§åˆ¤æ–­æ–¹å¼éå¸¸ç®€å•ç²—æš´ï¼Œä½†æ˜¯å¾€å¾€å¾ˆæœ‰ç”¨ï¼Œä¸è¿‡ï¼Œåœ¨ Java é¢†åŸŸï¼Œä¸»æµçš„ Hotspot è™šæ‹Ÿæœºå®ç°å¹¶æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºå¼•ç”¨è®¡æ•°æ³•ä¸èƒ½è§£å†³å¯¹è±¡ä¹‹é—´çš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p><p>å¾ªç¯å¼•ç”¨é—®é¢˜ç®€å•æ¥è®²å°±æ˜¯ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´äº’ç›¸ä¾èµ–ç€å¯¹æ–¹ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå†æ— å…¶ä»–å¼•ç”¨ï¼Œè¿™æ ·è™šæ‹Ÿæœºæ— æ³•åˆ¤æ–­å¼•ç”¨æ˜¯å¦ä¸ºé›¶ä»è€Œè¿›è¡Œåƒåœ¾å›æ”¶æ“ä½œã€‚</p><p>è¿˜æœ‰ä¸€ç§åˆ¤æ–­å¯¹è±¡æ— ç”¨ï¼š</p><p><strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong>ã€‚</p><p>å½“å‰ä¸»æµçš„ JVM éƒ½é‡‡ç”¨äº†å¯è¾¾æ€§åˆ†æç®—æ³•æ¥è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¸ªç®—æ³•çš„åŸºæœ¬æ€è·¯å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—è¢«ç§°ä¸º</p><p><code>GC Roots</code>çš„æ ¹å¯¹è±¡ä½œä¸ºèµ·å§‹èŠ‚ç‚¹é›†ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®å¼•ç”¨å…³ç³»å‘ä¸‹æœç´¢ï¼Œæœç´¢è¿‡ç¨‹èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸º<code>å¼•ç”¨é“¾</code>ï¼ˆ<code>Reference</code> <code>Chain</code>ï¼‰ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡åˆ° <code>GC</code> <code>Roots</code> ä¹‹é—´æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ¥ï¼Œæˆ–è€…è¯´ä» <code>GC</code> <code>Roots</code> åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾æ—¶ï¼Œåˆ™è¯æ˜æ­¤è¿™ä¸ªå¯¹è±¡æ˜¯æ— ç”¨å¯¹è±¡ï¼Œéœ€è¦è¢«åƒåœ¾å›æ”¶ã€‚</p><p>è¿™ç§å¼•ç”¨æ–¹å¼å¦‚ä¸‹</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545756.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203021545756.jpeg"></a></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä»æšä¸¾æ ¹èŠ‚ç‚¹ <code>GC</code> <code>Roots</code> å¼€å§‹è¿›è¡Œéå†ï¼Œ<code>object 1 ã€2ã€3ã€4</code> æ˜¯å­˜åœ¨å¼•ç”¨å…³ç³»çš„å¯¹è±¡ï¼Œè€Œ <code>object 5ã€6ã€7</code> ä¹‹é—´è™½ç„¶æœ‰å…³è”ï¼Œä½†æ˜¯å®ƒä»¬åˆ° GC <code>Roots</code> ä¹‹é—´æ˜¯ä¸å¯è¾¾çš„ï¼Œæ‰€ä»¥è¢«è®¤ä¸ºæ˜¯å¯ä»¥å›æ”¶çš„å¯¹è±¡ã€‚</p><p>åœ¨ <code>Java</code> æŠ€æœ¯ä½“ç³»ä¸­ï¼Œå¯ä»¥ä½œä¸º <code>GC Roots</code> è¿›è¡Œæ£€ç´¢çš„å¯¹è±¡ä¸»è¦æœ‰</p><ul><li>åœ¨è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œæ¯”å¦‚ <code>Java</code> ç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡ã€‚</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¼•ç”¨ã€‚</li><li>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ <code>JNI</code> å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li><code>JVM</code> å†…éƒ¨çš„å¼•ç”¨ï¼Œæ¯”å¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„ <code>Class</code> å¯¹è±¡ï¼Œä¸€äº›å¼‚å¸¸å¯¹è±¡æ¯”å¦‚ <code>NullPointerException</code>ã€<code>OutOfMemoryError</code> ç­‰ï¼Œè¿˜æœ‰ç³»ç»Ÿç±»åŠ è½½å™¨ã€‚</li><li>æ‰€æœ‰è¢« <code>synchronized</code> æŒæœ‰çš„å¯¹è±¡ã€‚</li><li>è¿˜æœ‰ä¸€äº› <code>JVM</code> å†…éƒ¨çš„æ¯”å¦‚ <code>JMXBean</code>ã€<code>JVMTI</code> ä¸­æ³¨å†Œçš„å›è°ƒï¼Œæœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚</li><li>æ ¹æ®ç”¨æˆ·æ‰€é€‰çš„åƒåœ¾æ”¶é›†å™¨ä»¥åŠå½“å‰å›æ”¶çš„å†…å­˜åŒºåŸŸçš„ä¸åŒï¼Œè¿˜å¯èƒ½ä¼šæœ‰ä¸€äº›å¯¹è±¡ä¸´æ—¶åŠ å…¥ï¼Œå…±åŒæ„æˆ <code>GC Roots</code> é›†åˆã€‚</li></ul><p>è™½ç„¶æˆ‘ä»¬ä¸Šé¢æåˆ°äº†ä¸¤ç§åˆ¤æ–­å¯¹è±¡å›æ”¶çš„æ–¹æ³•ï¼Œä½†æ— è®ºæ˜¯å¼•ç”¨è®¡æ•°æ³•è¿˜æ˜¯åˆ¤æ–­ <code>GC Roots</code> éƒ½ç¦»ä¸å¼€<code>å¼•ç”¨</code>è¿™ä¸€å±‚å…³ç³»ã€‚</p><blockquote><p>è¿™é‡Œæ¶‰åŠåˆ°åˆ°å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨çš„å¼•ç”¨å…³ç³»ï¼Œåç»­å†èŠ</p></blockquote><h2 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä¸å†ä½¿ç”¨çš„ç±»ï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä¸å†ä½¿ç”¨çš„ç±»ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä¸å†ä½¿ç”¨çš„ç±»ï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä¸å†ä½¿ç”¨çš„ç±»ï¼Ÿ</h2><p>åˆ¤æ–­ä¸€ä¸ªç±»å‹å±äº â€œä¸å†ä½¿ç”¨çš„ç±»â€ éœ€è¦æ»¡è¶³ä¸‹é¢è¿™ä¸‰ä¸ªæ¡ä»¶</p><ul><li>è¿™ä¸ªç±»æ‰€æœ‰çš„å®ä¾‹å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ <code>Java</code> å †ä¸­ä¸å­˜åœ¨è¯¥ç±»åŠå…¶ä»»ä½•è¿™ä¸ªç±»å­—ç±»çš„å®ä¾‹</li><li>åŠ è½½è¿™ä¸ªç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶ï¼Œä½†æ˜¯ç±»åŠ è½½å™¨ä¸€èˆ¬å¾ˆéš¾ä¼šè¢«å›æ”¶ï¼Œé™¤éè¿™ä¸ªç±»åŠ è½½å™¨æ˜¯ä¸ºäº†è¿™ä¸ªç›®çš„è®¾è®¡çš„ï¼Œæ¯”å¦‚ <code>OSGI</code>ã€<code>JSP</code> çš„é‡åŠ è½½ç­‰ï¼Œå¦åˆ™é€šå¸¸å¾ˆéš¾è¾¾æˆã€‚</li><li>è¿™ä¸ªç±»å¯¹åº”çš„ <code>Class</code> å¯¹è±¡æ²¡æœ‰ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•æ—¶åˆ»é€šè¿‡åå°„è®¿é—®è¿™ä¸ªç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚</li></ul><p>è™šæ‹Ÿæœºå…è®¸å¯¹æ»¡è¶³ä¸Šé¢è¿™ä¸‰ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶æ“ä½œã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆä¸‰ï¼‰| å¹‚ç­‰æ€§</title>
      <link href="/posts/16712.html"/>
      <url>/posts/16712.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å¹‚ç­‰æ€§"><a href="#å¹‚ç­‰æ€§" class="headerlink" title="å¹‚ç­‰æ€§"></a>å¹‚ç­‰æ€§</h1><p>â€‹    HTTP/1.1 ä¸­å¯¹å¹‚ç­‰æ€§çš„å®šä¹‰æ˜¯ï¼šä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æº<strong>å¯¹äºèµ„æºæœ¬èº«</strong>åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœï¼ˆç½‘ç»œè¶…æ—¶ç­‰é—®é¢˜é™¤å¤–ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œå¯¹èµ„æºæœ¬èº«æ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒ</strong>ã€‚</p><p>è¿™é‡Œéœ€è¦å…³æ³¨å‡ ä¸ªé‡ç‚¹ï¼š</p><ol><li><p> å¹‚ç­‰ä¸ä»…ä»…åªæ˜¯ä¸€æ¬¡ï¼ˆæˆ–å¤šæ¬¡ï¼‰è¯·æ±‚å¯¹èµ„æºæ²¡æœ‰å‰¯ä½œç”¨ï¼ˆæ¯”å¦‚æŸ¥è¯¢æ•°æ®åº“æ“ä½œï¼Œæ²¡æœ‰å¢åˆ æ”¹ï¼Œå› æ­¤æ²¡æœ‰å¯¹æ•°æ®åº“æœ‰ä»»ä½•å½±å“ï¼‰ã€‚</p></li><li><p> å¹‚ç­‰è¿˜åŒ…æ‹¬ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å¯¹èµ„æºäº§ç”Ÿäº†å‰¯ä½œç”¨ï¼Œä½†æ˜¯ä»¥åçš„å¤šæ¬¡è¯·æ±‚éƒ½ä¸ä¼šå†å¯¹èµ„æºäº§ç”Ÿå‰¯ä½œç”¨ã€‚</p></li><li><p> å¹‚ç­‰å…³æ³¨çš„æ˜¯ä»¥åçš„å¤šæ¬¡è¯·æ±‚æ˜¯å¦å¯¹èµ„æºäº§ç”Ÿçš„å‰¯ä½œç”¨ï¼Œè€Œä¸å…³æ³¨ç»“æœã€‚</p></li><li><p> ç½‘ç»œè¶…æ—¶ç­‰é—®é¢˜ï¼Œä¸æ˜¯å¹‚ç­‰çš„è®¨è®ºèŒƒå›´ã€‚</p></li></ol><p>å¹‚ç­‰æ€§æ˜¯ç³»ç»ŸæœåŠ¡å¯¹å¤–ä¸€ç§æ‰¿è¯ºï¼ˆè€Œä¸æ˜¯å®ç°ï¼‰ï¼Œæ‰¿è¯ºåªè¦è°ƒç”¨æ¥å£æˆåŠŸï¼Œå¤–éƒ¨å¤šæ¬¡è°ƒç”¨å¯¹ç³»ç»Ÿçš„å½±å“æ˜¯ä¸€è‡´çš„ã€‚å£°æ˜ä¸ºå¹‚ç­‰çš„æœåŠ¡ä¼šè®¤ä¸ºå¤–éƒ¨è°ƒç”¨å¤±è´¥æ˜¯å¸¸æ€ï¼Œå¹¶ä¸”å¤±è´¥ä¹‹åå¿…ç„¶ä¼šæœ‰é‡è¯•ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰"></a>ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰</h2><p>ä¸šåŠ¡å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°é‡å¤æäº¤çš„æƒ…å†µï¼Œæ— è®ºæ˜¯ç”±äºç½‘ç»œé—®é¢˜æ— æ³•æ”¶åˆ°è¯·æ±‚ç»“æœè€Œé‡æ–°å‘èµ·è¯·æ±‚ï¼Œæˆ–æ˜¯å‰ç«¯çš„æ“ä½œæŠ–åŠ¨è€Œé€ æˆé‡å¤æäº¤æƒ…å†µã€‚ åœ¨äº¤æ˜“ç³»ç»Ÿï¼Œæ”¯ä»˜ç³»ç»Ÿè¿™ç§é‡å¤æäº¤é€ æˆçš„é—®é¢˜æœ‰å°¤å…¶æ˜æ˜¾ï¼Œæ¯”å¦‚ï¼š</p><ol><li><p> ç”¨æˆ·åœ¨ APP ä¸Šè¿ç»­ç‚¹å‡»äº†å¤šæ¬¡æäº¤è®¢å•ï¼Œåå°åº”è¯¥åªäº§ç”Ÿä¸€ä¸ªè®¢å•ï¼›</p></li><li><p> å‘æ”¯ä»˜å®å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼Œç”±äºç½‘ç»œé—®é¢˜æˆ–ç³»ç»Ÿ BUG é‡å‘ï¼Œæ”¯ä»˜å®åº”è¯¥åªæ‰£ä¸€æ¬¡é’±ã€‚Â <strong>å¾ˆæ˜¾ç„¶ï¼Œå£°æ˜å¹‚ç­‰çš„æœåŠ¡è®¤ä¸ºï¼Œå¤–éƒ¨è°ƒç”¨è€…ä¼šå­˜åœ¨å¤šæ¬¡è°ƒç”¨çš„æƒ…å†µï¼Œä¸ºäº†é˜²æ­¢å¤–éƒ¨å¤šæ¬¡è°ƒç”¨å¯¹ç³»ç»Ÿæ•°æ®çŠ¶æ€çš„å‘ç”Ÿå¤šæ¬¡æ”¹å˜ï¼Œå°†æœåŠ¡è®¾è®¡æˆå¹‚ç­‰ã€‚</strong></p></li></ol><h2 id="å¹‚ç­‰-VS-é˜²é‡"><a href="#å¹‚ç­‰-VS-é˜²é‡" class="headerlink" title="å¹‚ç­‰ VS é˜²é‡"></a>å¹‚ç­‰ VS é˜²é‡</h2><p>ä¸Šé¢ä¾‹å­ä¸­å°æ˜é‡åˆ°çš„é—®é¢˜ï¼Œåªæ˜¯é‡å¤æäº¤çš„æƒ…å†µï¼Œå’ŒæœåŠ¡å¹‚ç­‰çš„åˆè¡·æ˜¯ä¸åŒçš„ã€‚é‡å¤æäº¤æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚å·²ç»æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œäººä¸ºçš„è¿›è¡Œå¤šæ¬¡æ“ä½œï¼Œå¯¼è‡´ä¸æ»¡è¶³å¹‚ç­‰è¦æ±‚çš„æœåŠ¡å¤šæ¬¡æ”¹å˜çŠ¶æ€ã€‚è€Œå¹‚ç­‰æ›´å¤šä½¿ç”¨çš„æƒ…å†µæ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸çŸ¥é“ç»“æœï¼ˆæ¯”å¦‚è¶…æ—¶ï¼‰æˆ–è€…å¤±è´¥çš„å¼‚å¸¸æƒ…å†µä¸‹ï¼Œå‘èµ·å¤šæ¬¡è¯·æ±‚ï¼Œç›®çš„æ˜¯å¤šæ¬¡ç¡®è®¤ç¬¬ä¸€æ¬¡è¯·æ±‚æˆåŠŸï¼Œå´ä¸ä¼šå› å¤šæ¬¡è¯·æ±‚è€Œå‡ºç°å¤šæ¬¡çš„çŠ¶æ€å˜åŒ–ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä¿è¯å¹‚ç­‰æ€§"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä¿è¯å¹‚ç­‰æ€§" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä¿è¯å¹‚ç­‰æ€§"></a>ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä¿è¯å¹‚ç­‰æ€§</h2><p>ä»¥ SQL ä¸ºä¾‹ï¼Œæœ‰ä¸‹é¢ä¸‰ç§åœºæ™¯ï¼Œåªæœ‰ç¬¬ä¸‰ç§åœºæ™¯éœ€è¦å¼€å‘äººå‘˜ä½¿ç”¨å…¶ä»–ç­–ç•¥ä¿è¯å¹‚ç­‰æ€§ï¼š</p><ol><li><p> <code>SELECT col1 FROM tab1 WHER col2=2</code>ï¼Œæ— è®ºæ‰§è¡Œå¤šå°‘æ¬¡éƒ½ä¸ä¼šæ”¹å˜çŠ¶æ€ï¼Œæ˜¯å¤©ç„¶çš„å¹‚ç­‰ã€‚</p></li><li><p> <code>UPDATE tab1 SET col1=1 WHERE col2=2</code>ï¼Œæ— è®ºæ‰§è¡Œ<strong>æˆåŠŸ</strong>å¤šå°‘æ¬¡<strong>çŠ¶æ€</strong>éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤ä¹Ÿæ˜¯å¹‚ç­‰æ“ä½œã€‚</p></li><li><p> <code>UPDATE tab1 SET col1=col1+1 WHERE col2=2</code>ï¼Œæ¯æ¬¡æ‰§è¡Œçš„ç»“æœéƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™ç§ä¸æ˜¯å¹‚ç­‰çš„ã€‚</p></li></ol><h2 id="ä¸ºä»€ä¹ˆè¦è®¾è®¡å¹‚ç­‰æ€§çš„æœåŠ¡"><a href="#ä¸ºä»€ä¹ˆè¦è®¾è®¡å¹‚ç­‰æ€§çš„æœåŠ¡" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è®¾è®¡å¹‚ç­‰æ€§çš„æœåŠ¡"></a>ä¸ºä»€ä¹ˆè¦è®¾è®¡å¹‚ç­‰æ€§çš„æœåŠ¡</h2><p>å¹‚ç­‰å¯ä»¥ä½¿å¾—å®¢æˆ·ç«¯é€»è¾‘å¤„ç†å˜å¾—ç®€å•ï¼Œä½†æ˜¯å´ä»¥æœåŠ¡é€»è¾‘å˜å¾—å¤æ‚ä¸ºä»£ä»·ã€‚æ»¡è¶³å¹‚ç­‰æœåŠ¡çš„éœ€è¦åœ¨é€»è¾‘ä¸­è‡³å°‘åŒ…å«ä¸¤ç‚¹ï¼š</p><ol><li><p> é¦–å…ˆå»æŸ¥è¯¢ä¸Šä¸€æ¬¡çš„æ‰§è¡ŒçŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®¤ä¸ºæ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚</p></li><li><p> åœ¨æœåŠ¡æ”¹å˜çŠ¶æ€çš„ä¸šåŠ¡é€»è¾‘å‰ï¼Œä¿è¯é˜²é‡å¤æäº¤çš„é€»è¾‘</p></li></ol><h2 id="å¹‚ç­‰çš„ä¸è¶³"><a href="#å¹‚ç­‰çš„ä¸è¶³" class="headerlink" title="å¹‚ç­‰çš„ä¸è¶³"></a>å¹‚ç­‰çš„ä¸è¶³</h2><p>å¹‚ç­‰æ˜¯ä¸ºäº†ç®€åŒ–å®¢æˆ·ç«¯é€»è¾‘å¤„ç†ï¼Œå´å¢åŠ äº†æœåŠ¡æä¾›è€…çš„é€»è¾‘å’Œæˆæœ¬ï¼Œæ˜¯å¦æœ‰å¿…è¦ï¼Œéœ€è¦æ ¹æ®å…·ä½“åœºæ™¯å…·ä½“åˆ†æï¼Œå› æ­¤é™¤äº†ä¸šåŠ¡ä¸Šçš„ç‰¹æ®Šè¦æ±‚å¤–ï¼Œå°½é‡ä¸æä¾›å¹‚ç­‰çš„æ¥å£ã€‚</p><ol><li><p> å¢åŠ äº†é¢å¤–æ§åˆ¶å¹‚ç­‰çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¤æ‚åŒ–äº†ä¸šåŠ¡åŠŸèƒ½ï¼›</p></li><li><p> æŠŠå¹¶è¡Œæ‰§è¡Œçš„åŠŸèƒ½æ”¹ä¸ºä¸²è¡Œæ‰§è¡Œï¼Œé™ä½äº†æ‰§è¡Œæ•ˆç‡ã€‚</p></li></ol><h2 id="ä¿è¯å¹‚ç­‰ç­–ç•¥"><a href="#ä¿è¯å¹‚ç­‰ç­–ç•¥" class="headerlink" title="ä¿è¯å¹‚ç­‰ç­–ç•¥"></a>ä¿è¯å¹‚ç­‰ç­–ç•¥</h2><p>å¹‚ç­‰éœ€è¦é€šè¿‡<strong>å”¯ä¸€çš„ä¸šåŠ¡å•å·</strong>æ¥ä¿è¯ã€‚ä¹Ÿå°±æ˜¯è¯´ç›¸åŒçš„ä¸šåŠ¡å•å·ï¼Œè®¤ä¸ºæ˜¯åŒä¸€ç¬”ä¸šåŠ¡ã€‚ä½¿ç”¨è¿™ä¸ªå”¯ä¸€çš„ä¸šåŠ¡å•å·æ¥ç¡®ä¿ï¼Œåé¢å¤šæ¬¡çš„ç›¸åŒçš„ä¸šåŠ¡å•å·çš„å¤„ç†é€»è¾‘å’Œæ‰§è¡Œæ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚ ä¸‹é¢ä»¥æ”¯ä»˜ä¸ºä¾‹ï¼Œåœ¨ä¸è€ƒè™‘å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå®ç°å¹‚ç­‰å¾ˆç®€å•ï¼š<br>    â‘ å…ˆæŸ¥è¯¢ä¸€ä¸‹è®¢å•æ˜¯å¦å·²ç»æ”¯ä»˜è¿‡ï¼Œ<br>    â‘¡å¦‚æœå·²ç»æ”¯ä»˜è¿‡ï¼Œåˆ™è¿”å›æ”¯ä»˜æˆåŠŸï¼›å¦‚æœæ²¡æœ‰æ”¯ä»˜ï¼Œè¿›è¡Œæ”¯ä»˜æµç¨‹ï¼Œä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºâ€˜å·²æ”¯ä»˜â€™ã€‚</p><h2 id="é˜²é‡å¤æäº¤ç­–ç•¥"><a href="#é˜²é‡å¤æäº¤ç­–ç•¥" class="headerlink" title="é˜²é‡å¤æäº¤ç­–ç•¥"></a>é˜²é‡å¤æäº¤ç­–ç•¥</h2><p>ä¸Šè¿°çš„ä¿è¯å¹‚ç­‰æ–¹æ¡ˆæ˜¯åˆ†æˆä¸¤æ­¥çš„ï¼Œç¬¬â‘¡æ­¥ä¾èµ–ç¬¬â‘ æ­¥çš„æŸ¥è¯¢ç»“æœï¼Œæ— æ³•ä¿è¯åŸå­æ€§çš„ã€‚åœ¨é«˜å¹¶å‘ä¸‹å°±ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼šç¬¬äºŒæ¬¡è¯·æ±‚åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ç¬¬â‘¡æ­¥è®¢å•çŠ¶æ€è¿˜æ²¡æœ‰ä¿®æ”¹ä¸ºâ€˜å·²æ”¯ä»˜çŠ¶æ€â€™çš„æƒ…å†µä¸‹åˆ°æ¥ã€‚æ—¢ç„¶å¾—å‡ºäº†è¿™ä¸ªç»“è®ºï¼Œä½™ä¸‹çš„é—®é¢˜ä¹Ÿå°±å˜å¾—ç®€å•ï¼šæŠŠæŸ¥è¯¢å’Œå˜æ›´çŠ¶æ€æ“ä½œåŠ é”ï¼Œå°†å¹¶è¡Œæ“ä½œæ”¹ä¸ºä¸²è¡Œæ“ä½œã€‚</p><h3 id="ä¹è§‚é”"><a href="#ä¹è§‚é”" class="headerlink" title="ä¹è§‚é”"></a>ä¹è§‚é”</h3><p>å¦‚æœåªæ˜¯æ›´æ–°<strong>å·²æœ‰</strong>çš„æ•°æ®ï¼Œæ²¡æœ‰å¿…è¦å¯¹ä¸šåŠ¡è¿›è¡ŒåŠ é”ï¼Œè®¾è®¡è¡¨ç»“æ„æ—¶ä½¿ç”¨ä¹è§‚é”ï¼Œä¸€èˆ¬é€šè¿‡ version æ¥åšä¹è§‚é”ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯æ‰§è¡Œæ•ˆç‡ï¼Œåˆèƒ½ä¿è¯å¹‚ç­‰ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> tab1 <span class="token keyword">SET</span> col1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>version<span class="token operator">=</span>version<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">WHERE</span> version<span class="token operator">=</span><span class="token comment">#version#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Â ä¸è¿‡ï¼Œä¹è§‚é”å­˜åœ¨å¤±æ•ˆçš„æƒ…å†µï¼Œå°±æ˜¯å¸¸è¯´çš„ <strong>ABA</strong> é—®é¢˜ï¼Œä¸è¿‡å¦‚æœ version ç‰ˆæœ¬ä¸€ç›´æ˜¯è‡ªå¢çš„å°±ä¸ä¼šå‡ºç° ABA çš„æƒ…å†µã€‚ï¼ˆä»ç½‘ä¸Šæ‰¾äº†ä¸€å¼ å›¾ç‰‡å¾ˆèƒ½è¯´æ˜ä¹è§‚é”ï¼Œå¼•ç”¨è¿‡æ¥ï¼Œå‡ºè‡ª Mybatis å¯¹ä¹è§‚é”çš„æ”¯æŒï¼‰</p><h3 id="é˜²é‡è¡¨"><a href="#é˜²é‡è¡¨" class="headerlink" title="é˜²é‡è¡¨"></a>é˜²é‡è¡¨</h3><p>ä½¿ç”¨è®¢å•å· orderNo åšä¸ºå»é‡è¡¨çš„å”¯ä¸€ç´¢å¼•ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½æ ¹æ®è®¢å•å·å‘å»é‡è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ã€‚ç¬¬ä¸€æ¬¡è¯·æ±‚æŸ¥è¯¢è®¢å•æ”¯ä»˜çŠ¶æ€ï¼Œå½“ç„¶è®¢å•æ²¡æœ‰æ”¯ä»˜ï¼Œè¿›è¡Œæ”¯ä»˜æ“ä½œï¼Œæ— è®ºæˆåŠŸä¸å¦ï¼Œæ‰§è¡Œå®Œåæ›´æ–°è®¢å•çŠ¶æ€ä¸ºæˆåŠŸæˆ–å¤±è´¥ï¼Œåˆ é™¤å»é‡è¡¨ä¸­çš„æ•°æ®ã€‚åç»­çš„è®¢å•å› ä¸ºè¡¨ä¸­å”¯ä¸€ç´¢å¼•è€Œæ’å…¥å¤±è´¥ï¼Œåˆ™è¿”å›æ“ä½œå¤±è´¥ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡çš„è¯·æ±‚å®Œæˆï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚<strong>å¯ä»¥çœ‹å‡ºé˜²é‡è¡¨ä½œç”¨æ˜¯åŠ é”çš„åŠŸèƒ½ã€‚</strong></p><h3 id="åˆ†å¸ƒå¼é”"><a href="#åˆ†å¸ƒå¼é”" class="headerlink" title="åˆ†å¸ƒå¼é”"></a>åˆ†å¸ƒå¼é”</h3><p>è¿™é‡Œä½¿ç”¨çš„é˜²é‡è¡¨å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼é”ä»£æ›¿ï¼Œæ¯”å¦‚ Redisã€‚è®¢å•å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼Œæ”¯ä»˜ç³»ç»Ÿä¼šå» Redis ç¼“å­˜ä¸­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨è¯¥è®¢å•å·çš„ Keyï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘ Redis å¢åŠ  Key ä¸ºè®¢å•å·ã€‚æŸ¥è¯¢è®¢å•æ”¯ä»˜å·²ç»æ”¯ä»˜ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿›è¡Œæ”¯ä»˜ï¼Œæ”¯ä»˜å®Œæˆååˆ é™¤è¯¥è®¢å•å·çš„ Keyã€‚é€šè¿‡ Redis åšåˆ°äº†åˆ†å¸ƒå¼é”ï¼Œåªæœ‰è¿™æ¬¡è®¢å•è®¢å•æ”¯ä»˜è¯·æ±‚å®Œæˆï¼Œä¸‹æ¬¡è¯·æ±‚æ‰èƒ½è¿›æ¥ã€‚ç›¸æ¯”å»é‡è¡¨ï¼Œå°†æ”¾å¹¶å‘åšåˆ°äº†ç¼“å­˜ä¸­ï¼Œè¾ƒä¸ºé«˜æ•ˆã€‚æ€è·¯ç›¸åŒï¼Œ<strong>åŒä¸€æ—¶é—´åªèƒ½å®Œæˆä¸€æ¬¡æ”¯ä»˜è¯·æ±‚</strong>ã€‚</p><h3 id="token-ä»¤ç‰Œ"><a href="#token-ä»¤ç‰Œ" class="headerlink" title="token ä»¤ç‰Œ"></a>token ä»¤ç‰Œ</h3><p>è¿™ç§æ–¹å¼åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼šç”³è¯· token é˜¶æ®µå’Œæ”¯ä»˜é˜¶æ®µã€‚ ç¬¬ä¸€é˜¶æ®µï¼Œåœ¨è¿›å…¥åˆ°æäº¤è®¢å•é¡µé¢ä¹‹å‰ï¼Œéœ€è¦è®¢å•ç³»ç»Ÿæ ¹æ®ç”¨æˆ·ä¿¡æ¯å‘æ”¯ä»˜ç³»ç»Ÿå‘èµ·ä¸€æ¬¡ç”³è¯· token çš„è¯·æ±‚ï¼Œæ”¯ä»˜ç³»ç»Ÿå°† token ä¿å­˜åˆ° Redis ç¼“å­˜ä¸­ï¼Œä¸ºç¬¬äºŒé˜¶æ®µæ”¯ä»˜ä½¿ç”¨ã€‚ ç¬¬äºŒé˜¶æ®µï¼Œè®¢å•ç³»ç»Ÿæ‹¿ç€ç”³è¯·åˆ°çš„ token å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼Œæ”¯ä»˜ç³»ç»Ÿä¼šæ£€æŸ¥ Redis ä¸­æ˜¯å¦å­˜åœ¨è¯¥ tokenï¼Œå¦‚æœå­˜åœ¨ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼Œåˆ é™¤ç¼“å­˜ä¸­ token åå¼€å§‹æ”¯ä»˜é€»è¾‘å¤„ç†ï¼›å¦‚æœç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œè¡¨ç¤ºéæ³•è¯·æ±‚ã€‚ å®é™…ä¸Šè¿™é‡Œçš„ token æ˜¯ä¸€ä¸ªä¿¡ç‰©ï¼Œæ”¯ä»˜ç³»ç»Ÿæ ¹æ® token ç¡®è®¤ï¼Œä½ æ˜¯ä½ å¦ˆçš„å­©å­ã€‚ä¸è¶³æ˜¯éœ€è¦ç³»ç»Ÿé—´äº¤äº’ä¸¤æ¬¡ï¼Œæµç¨‹è¾ƒä¸Šè¿°æ–¹æ³•å¤æ‚ã€‚</p><h3 id="æ”¯ä»˜ç¼“å†²åŒº"><a href="#æ”¯ä»˜ç¼“å†²åŒº" class="headerlink" title="æ”¯ä»˜ç¼“å†²åŒº"></a>æ”¯ä»˜ç¼“å†²åŒº</h3><p>æŠŠè®¢å•çš„æ”¯ä»˜è¯·æ±‚éƒ½å¿«é€Ÿåœ°æ¥ä¸‹æ¥ï¼Œä¸€ä¸ªå¿«é€Ÿæ¥å•çš„ç¼“å†²ç®¡é“ã€‚åç»­ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡å¤„ç†ç®¡é“ä¸­çš„æ•°æ®ï¼Œè¿‡æ»¤æ‰é‡å¤çš„å¾…æ”¯ä»˜è®¢å•ã€‚ä¼˜ç‚¹æ˜¯åŒæ­¥è½¬å¼‚æ­¥ï¼Œé«˜ååã€‚ä¸è¶³æ˜¯ä¸èƒ½åŠæ—¶åœ°è¿”å›æ”¯ä»˜ç»“æœï¼Œéœ€è¦åç»­ç›‘å¬æ”¯ä»˜ç»“æœçš„å¼‚æ­¥è¿”å›ã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> é¢è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹‚ç­‰æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆäºŒï¼‰| SpringCloud é¢è¯•é¢˜</title>
      <link href="/posts/19188.html"/>
      <url>/posts/19188.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å¾®æœåŠ¡åŸºç¡€"><a href="#å¾®æœåŠ¡åŸºç¡€" class="headerlink" title="å¾®æœåŠ¡åŸºç¡€"></a>å¾®æœåŠ¡åŸºç¡€</h1><h2 id="1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„"><a href="#1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„" class="headerlink" title="1.ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„"></a>1.ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„</h2><p>â€‹    å¾®æœåŠ¡æ¶æ„å°±æ˜¯å°†<strong>å•ä½“çš„åº”ç”¨ç¨‹åºåˆ†æˆå¤šä¸ªåº”ç”¨ç¨‹åº</strong>ï¼Œè¿™å¤šä¸ªåº”ç”¨ç¨‹åºå°±æˆä¸ºå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ è¿è¡Œåœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼Œå¹¶ä½¿ç”¨è½»é‡çº§çš„æœºåˆ¶é€šä¿¡ã€‚è¿™äº›æœåŠ¡å›´ç»•ä¸šåŠ¡èƒ½åŠ›æ¥åˆ’åˆ†ï¼Œå¹¶é€šè¿‡è‡ªåŠ¨åŒ–éƒ¨ ç½²æœºåˆ¶æ¥ç‹¬ç«‹éƒ¨ç½²ã€‚è¿™äº›æœåŠ¡å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸åŒæ•°æ®åº“ï¼Œä»¥ä¿è¯æœ€ä½é™åº¦çš„é›†ä¸­å¼ç®¡ç†ã€‚</p><h2 id="2-ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ Spring-Cloud"><a href="#2-ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ Spring-Cloud" class="headerlink" title="2.ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ Spring Cloud"></a>2.ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ Spring Cloud</h2><ul><li>é¦–å…ˆSpring CloudåŸºäºSpring Bootçš„ä¼˜é›…ç®€æ´ï¼Œå¯è¿˜è®°å¾—æˆ‘ä»¬è¢«æ— æ•°xmlæ”¯é…çš„ææƒ§ï¼Ÿå¯è¿˜è®°å¾— Spring MVC ï¼ŒMybatis é”™ç»¼å¤æ‚çš„é…ç½®ï¼Œæœ‰äº†Spring Bootï¼Œè¿™äº›ä¸œè¥¿éƒ½ä¸éœ€è¦äº†ï¼ŒSpring Bootå¥½å¤„ä¸å†èµ˜è¯‰ï¼ŒSpring Cloudå°±åŸºäºSpring BootæŠŠå¸‚åœºä¸Šä¼˜ç§€çš„æœåŠ¡æ¡†æ¶ç»„åˆèµ·æ¥ï¼Œé€šè¿‡Spring Booté£ æ ¼è¿›è¡Œå†å°è£…å±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç† </li><li>ä»€ä¹ˆå«åšå¼€ç®±å³ç”¨ï¼Ÿå³ä½¿æ˜¯å½“å¹´çš„é»„é‡‘æ­æ¡£ Dubbo + ZooKeeperä¸‹è½½é…ç½®èµ·æ¥ä¹Ÿæ˜¯é¢‡è´¹å¿ƒç¥çš„ï¼è€Œ Spring Cloudå®Œæˆè¿™äº›åªéœ€è¦ä¸€ä¸ªjarçš„ä¾èµ–å°±å¯ä»¥äº†ï¼ </li><li>Spring Cloudå¤§å¤šæ•°å­æ¨¡å—éƒ½æ˜¯ç›´å‡»ç—›ç‚¹ï¼Œåƒ Zuul è§£å†³çš„è·¨åŸŸï¼ŒFegin è§£å†³çš„è´Ÿè½½å‡è¡¡ï¼ŒHystrixçš„ç†” æ–­æœºåˆ¶ç­‰ç­‰ç­‰ç­‰</li></ul><h2 id="3-Spring-Cloud-æ˜¯ä»€ä¹ˆ"><a href="#3-Spring-Cloud-æ˜¯ä»€ä¹ˆ" class="headerlink" title="3. Spring Cloud æ˜¯ä»€ä¹ˆ"></a>3. Spring Cloud æ˜¯ä»€ä¹ˆ</h2><ul><li><p>Spring Cloudæ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆã€‚å®ƒåˆ©ç”¨Spring Bootçš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€å‘ï¼Œå¦‚ <strong>æœåŠ¡å‘ç°æ³¨å†Œ</strong>ã€<strong>é…ç½®ä¸­å¿ƒ</strong>ã€<strong>æ™ºèƒ½è·¯ç”±</strong>ã€<strong>æ¶ˆæ¯æ€»çº¿</strong>ã€<strong>è´Ÿè½½å‡è¡¡</strong>ã€<strong>æ–­è·¯å™¨</strong>ã€<strong>æ•°æ®ç›‘æ§</strong>ç­‰ï¼Œéƒ½å¯ä»¥ç”¨Spring Bootçš„å¼€å‘é£æ ¼åšåˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚</p></li><li><p> Spring Cloudå¹¶æ²¡æœ‰é‡å¤åˆ¶é€ è½®å­ï¼Œå®ƒåªæ˜¯å°†å„å®¶å…¬å¸å¼€å‘çš„æ¯”è¾ƒæˆç†Ÿã€ç»å¾—èµ·å®é™…è€ƒéªŒçš„æœåŠ¡æ¡† æ¶ç»„åˆèµ·æ¥ï¼Œé€šè¿‡Spring Booté£æ ¼è¿›è¡Œå†å°è£…å±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç†ï¼Œæœ€ç»ˆç»™å¼€å‘è€…ç•™ å‡ºäº†ä¸€å¥—ç®€å•æ˜“æ‡‚ã€æ˜“éƒ¨ç½²å’Œæ˜“ç»´æŠ¤çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å·¥å…·åŒ…</p></li></ul><h2 id="4-Spring-Cloudçš„ä¼˜ç¼ºç‚¹"><a href="#4-Spring-Cloudçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="4. Spring Cloudçš„ä¼˜ç¼ºç‚¹"></a>4. Spring Cloudçš„ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹</p><ol><li>è€¦åˆä½</li><li>é…ç½®ç®€å•</li><li>è·¨å¹³å°</li><li>å¯é…ç½®ç‹¬ç«‹çš„æ•°æ®åº“</li><li>å¯ä»¥ç»„ä»¶é—´ä¹‹é—´é€šè®¯</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>éƒ¨ç½²éº»çƒ¦</li><li>æ•°æ®ç®¡ç†éº»çƒ¦</li><li>ç³»ç»Ÿé›†æˆæµ‹è¯•</li><li>æ€§èƒ½ç›‘æ§å¤æ‚</li></ol><h2 id="5-Spring-Boot-å’Œ-Spring-Cloud-åŒºåˆ«ï¼Ÿ"><a href="#5-Spring-Boot-å’Œ-Spring-Cloud-åŒºåˆ«ï¼Ÿ" class="headerlink" title="5. Spring Boot å’Œ Spring Cloud åŒºåˆ«ï¼Ÿ"></a>5. Spring Boot å’Œ Spring Cloud åŒºåˆ«ï¼Ÿ</h2><ul><li><p>Spring Boot ä¸“æ³¨å•ä½“å¿«é€Ÿå¼€å‘</p></li><li><p>Spring Cloud å…³æ³¨å…¨å±€å¾®æœåŠ¡åè°ƒæ•´ç†æ²»ç†æ¡†æ¶ï¼Œå°†Spring Boot å•ä½“å¾®æœåŠ¡æ•´ä¸ªç®¡ç†</p></li><li><p>å„ä¸ªå¾®æœåŠ¡ä¹‹é—´æä¾›ï¼Œé…ç½®ç®¡ç†ï¼ŒæœåŠ¡å‘ç°ï¼Œæ–­è·¯å™¨ï¼Œè·¯ç”±ï¼Œå¾®ä»£ç†ï¼Œæ¶ˆæ¯æ€»çº¿ï¼Œå…¨å±€é”ï¼Œå†³ç­–ç«é€‰ï¼Œåˆ†å¸ƒå¼ä¼šè¯ç­‰</p></li></ul><h2 id="6-Spring-Cloud-å’Œ-Spring-Boot-ç‰ˆæœ¬å¯¹åº”å…³ç³»"><a href="#6-Spring-Cloud-å’Œ-Spring-Boot-ç‰ˆæœ¬å¯¹åº”å…³ç³»" class="headerlink" title="6.Spring Cloud å’Œ Spring Boot ç‰ˆæœ¬å¯¹åº”å…³ç³»?"></a>6.Spring Cloud å’Œ Spring Boot ç‰ˆæœ¬å¯¹åº”å…³ç³»?</h2><table><thead><tr><th align="left">Release Train</th><th align="left">Boot Version</th></tr></thead><tbody><tr><td align="left"><code>2020.0.x aka Ilford</code></td><td align="left">2.4.x, 2.5.x (Starting with 2020.0.3)</td></tr><tr><td align="left"><code>Hoxton</code></td><td align="left">2.2.x, 2.3.x (Starting with SR5)</td></tr><tr><td align="left"><code>Greenwich</code></td><td align="left">2.1.x</td></tr><tr><td align="left"><code>Finchley</code></td><td align="left">2.0.x</td></tr><tr><td align="left"><code>Edgware</code></td><td align="left">1.5.x</td></tr><tr><td align="left"><code>Dalston</code></td><td align="left">1.5.x</td></tr></tbody></table><h2 id="7-SpringCloudç”±ä»€ä¹ˆç»„æˆ"><a href="#7-SpringCloudç”±ä»€ä¹ˆç»„æˆ" class="headerlink" title="7.SpringCloudç”±ä»€ä¹ˆç»„æˆ"></a>7.SpringCloudç”±ä»€ä¹ˆç»„æˆ</h2><p>è¿™é‡Œåˆ—ä¸¾å‡ ä¸ªä¸»è¦çš„ç»„ä»¶</p><ul><li><code>Eureka</code> æœåŠ¡æ³¨å†Œå’Œå‘ç°</li><li><code>Zuul</code> ç½‘å…³</li><li><code>Ribbon</code> è´Ÿè½½å‡è¡¡</li><li><code>Feign</code> å£°æ˜å¼WebæœåŠ¡å®¢æˆ·ç«¯</li><li><code>Hystrix</code> æ–­è·¯å™¨</li><li><code>Config</code> åˆ†å¸ƒå¼ç»Ÿä¸€é…ç½®ç®¡ç†</li></ul><h1 id="Eureka-ç¯‡"><a href="#Eureka-ç¯‡" class="headerlink" title="Eureka ç¯‡"></a>Eureka ç¯‡</h1><h2 id="8-æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸSpring-Cloud-å¦‚ä½•å®ç°çš„"><a href="#8-æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸSpring-Cloud-å¦‚ä½•å®ç°çš„" class="headerlink" title="8.æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸSpring Cloud å¦‚ä½•å®ç°çš„?"></a>8.æœåŠ¡æ³¨å†Œå’Œå‘ç°æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸSpring Cloud å¦‚ä½•å®ç°çš„?</h2><p>â€‹    ä¸€èˆ¬Spring Cloud é¡¹ç›®ç”±å¤šä¸ªæ¨¡å—æœåŠ¡ç»„æˆï¼Œé€šå¸¸åœ¨å±æ€§æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œéšç€è¶Šæ¥è¶Šå¤šçš„æœåŠ¡å¼€å‘å’Œéƒ¨ç½²ï¼Œæ·»åŠ ä¿®æ”¹å±æ€§å˜å¾—å¤æ‚ã€‚ç”±äºæ‰€æœ‰æœåŠ¡éƒ½é€šè¿‡Eureka æœåŠ¡æ³¨å†Œç»Ÿä¸€ç”±EurekaæœåŠ¡ç®¡ç†å¹¶é€šè¿‡Eurekaå®ŒæˆæŸ¥æ‰¾ï¼Œè¿™æ ·å°±æ— éœ€çŸ¥é“æœåŠ¡çš„åœ°çš„ä»»ä½•ä¿®æ”¹äº†ã€‚</p><h2 id="9-ä»€ä¹ˆæ˜¯Eureka"><a href="#9-ä»€ä¹ˆæ˜¯Eureka" class="headerlink" title="9.ä»€ä¹ˆæ˜¯Eureka"></a>9.ä»€ä¹ˆæ˜¯Eureka</h2><p>â€‹    Eureka ä½œä¸º Spring Cloud æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç³»ç»Ÿä¸­çš„æœåŠ¡ä½¿ç”¨ Eureka å®¢æˆ·ç«¯å°†å…¶è¿æ¥ Eureka Service ä¸­å¹¶ä¿æŒå¿ƒè·³ï¼Œå¯ä»¥é€šè¿‡ Eureka æœåŠ¡æ¥ç›‘æ§å…¶ä»–å¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ</p><h2 id="10-Eureka-å¦‚ä½•å®ç°é«˜å¯ç”¨"><a href="#10-Eureka-å¦‚ä½•å®ç°é«˜å¯ç”¨" class="headerlink" title="10.Eureka å¦‚ä½•å®ç°é«˜å¯ç”¨"></a>10.Eureka å¦‚ä½•å®ç°é«˜å¯ç”¨</h2><p>â€‹    é€šè¿‡é›†ç¾¤æ³¨å†Œå¤šå° Eurekaï¼Œå°†å„ä¸ª å¾®æœåŠ¡ ç›¸äº’æ³¨å†Œ</p><h2 id="11-Eureka-çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶"><a href="#11-Eureka-çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" class="headerlink" title="11.Eureka çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶"></a>11.Eureka çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</h2><p>â€‹    é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ Eureka æœåŠ¡ä¸€å®šæ—¶é—´æ²¡æœ‰æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡çš„å¿ƒè·³ï¼Œé‚£ä¸ªEureka æœåŠ¡ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ Eureka æœåŠ¡ä¼šä¿æŠ¤æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸åˆ é™¤æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼Œå½“ç½‘è·¯æ¢å¤åï¼Œè‡ªåŠ¨é€€å‡ºä¿æŠ¤æ¨¡å¼ã€‚</p><h2 id="12-DiscoveryClient-ä½œç”¨"><a href="#12-DiscoveryClient-ä½œç”¨" class="headerlink" title="12.DiscoveryClient ä½œç”¨"></a>12.DiscoveryClient ä½œç”¨</h2><p>â€‹    å¯ä»¥ä»æ³¨å†Œä¸­å¿ƒä¸­çš„æœåŠ¡åˆ«åæ¥æ³¨å†ŒæœåŠ¡å™¨ä¿¡æ¯</p><h2 id="13-Eureka-å’ŒZooKeeper-çš„åŒºåˆ«"><a href="#13-Eureka-å’ŒZooKeeper-çš„åŒºåˆ«" class="headerlink" title="13.Eureka å’ŒZooKeeper çš„åŒºåˆ«"></a>13.Eureka å’ŒZooKeeper çš„åŒºåˆ«</h2><ol><li><p>ZooKeeper çš„èŠ‚ç‚¹æœåŠ¡æŒ‚äº†è¦é€‰ä¸¾ï¼Œé€‰ä¸¾æœŸé—´çš„æ³¨å†ŒæœåŠ¡ç˜«ç—ª</p></li><li><p>Eurekaçš„å„ä¸ªèŠ‚ç‚¹å¹³ç­‰ï¼ŒæœåŠ¡å™¨æŒ‚äº†æ²¡å…³ç³»ï¼Œåªè¦ç”±ä¸€å°å¯ä»¥ä¿è¯æœåŠ¡å³å¯ï¼Œå¦‚æœæ•°æ®ä¸æ˜¯æœ€æ–°çš„ï¼Œå¯èƒ½æ˜¯å¯åŠ¨äº†è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶å¯¼è‡´çš„ã€‚</p></li><li><p>Eureka æœ¬è´¨æ˜¯å·¥ç¨‹ï¼ŒZooKeeper æ˜¯è¿›ç¨‹</p></li><li><p>ZooKeeper ä¿è¯CPï¼ŒEureka ä¿è¯ AP</p></li></ol><blockquote><p>CAP: C:ä¸€è‡´æ€§ã€A:å¯ç”¨æ€§ã€P:åˆ†åŒºå®¹é”™æ€§</p></blockquote><h1 id="Zuul-ç¯‡"><a href="#Zuul-ç¯‡" class="headerlink" title="Zuul ç¯‡"></a>Zuul ç¯‡</h1><h2 id="14-ä»€ä¹ˆæ˜¯ç½‘å…³"><a href="#14-ä»€ä¹ˆæ˜¯ç½‘å…³" class="headerlink" title="14.ä»€ä¹ˆæ˜¯ç½‘å…³"></a>14.ä»€ä¹ˆæ˜¯ç½‘å…³</h2><ul><li>ç½‘å…³ç›¸å½“ä¸ç½‘ç»œæœåŠ¡æ¡†æ¶çš„å…¥å£ï¼Œæ‰€æœ‰ç½‘ç»œè¯·æ±‚éƒ½å¿…é¡»é€šè¿‡ç½‘å…³æ‰èƒ½è½¬å‘åˆ°å…·ä½“çš„æœåŠ¡</li></ul><h2 id="15-ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#15-ä½œç”¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="15.ä½œç”¨æ˜¯ä»€ä¹ˆ"></a>15.ä½œç”¨æ˜¯ä»€ä¹ˆ</h2><ul><li>ç»Ÿä¸€ç®¡ç†å¾®æœåŠ¡è¯·æ±‚ï¼Œæƒé™æ§åˆ¶ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±è½¬å‘ã€ç›‘æ§ã€å®‰å…¨æ§åˆ¶é»‘åå•å’Œç™½åå•</li></ul><h2 id="16-ä»€ä¹ˆæ˜¯Spring-Cloud-Zuul-æœåŠ¡ç½‘å…³"><a href="#16-ä»€ä¹ˆæ˜¯Spring-Cloud-Zuul-æœåŠ¡ç½‘å…³" class="headerlink" title="16.ä»€ä¹ˆæ˜¯Spring Cloud Zuul (æœåŠ¡ç½‘å…³)"></a>16.ä»€ä¹ˆæ˜¯Spring Cloud Zuul (æœåŠ¡ç½‘å…³)</h2><ul><li>Spring Cloud çš„ä¸€å¥—è·¯ç”±æ–¹æ¡ˆï¼Œä¼šæ ¹æ®è¯·æ±‚è·¯å¾„ä¸åŒï¼Œç½‘å…³ä¼šå®šä½åˆ°æŒ‡å®šçš„å¾®æœåŠ¡ï¼Œå¹¶ä»£ç†è¯·æ±‚åˆ°ä¸åŒçš„å¾®æœåŠ¡æ¥å£ï¼Œå¯¹å¤–éšè”½äº†å¾®æœåŠ¡çš„çœŸæ­£æ¥å£åœ°å€ï¼Œ<br>ä¸‰ä¸ªé‡è¦æ¦‚å¿µ<ul><li>åŠ¨æ€è·¯ç”±è¡¨ï¼šZuul æ”¯æŒ Eureka è·¯ç”±ï¼Œæ‰‹åŠ¨é…ç½®è·¯ç”±</li><li>è·¯ç”±å®šä½ï¼š æ ¹æ®è¯·æ±‚è·¯å¾„ï¼ŒZuul æœ‰è‡ªå·±ä¸€å¥—å®šä½æœåŠ¡è§„åˆ™ä»¥åŠè·¯ç”±è¡¨è¾¾å¼åŒ¹é…</li><li>åå‘ä»£ç†ï¼šå®¢æˆ·ç«¯è¯·æ±‚åˆ°è·¯ç”±ç½‘å…³ï¼Œç½‘å…³æ‰‹é‡Œåï¼Œç›®æ ‡å‘é€è¯·æ±‚ï¼Œæ‹¿åˆ°ç›¸åº”åç»™åˆ°å®¢æˆ·ç«¯</li></ul></li><li>åº”ç”¨åœºæ™¯ï¼š<ul><li>å¯¹å¤–æš´éœ²</li><li>æƒé™æ ¡éªŒ</li><li>æœåŠ¡èšåˆ</li><li>æ—¥å¿—å®¡è®¡</li></ul></li></ul><h2 id="17-ç½‘å…³å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#17-ç½‘å…³å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="17.ç½‘å…³å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«"></a>17.ç½‘å…³å’Œè¿‡æ»¤å™¨æœ‰ä»€ä¹ˆåŒºåˆ«</h2><ul><li>ç½‘å…³å¯¹æ‰€æœ‰çš„æœåŠ¡è¯·æ±‚è¿›è¡Œåˆ†æè¿‡æ»¤ï¼Œè¿‡æ»¤å™¨æ˜¯å¯¹äºå•ä¸ªæœåŠ¡è€Œè¨€çš„</li></ul><h2 id="18-å¸¸ç”¨çš„ç½‘å…³æ¡†æ¶"><a href="#18-å¸¸ç”¨çš„ç½‘å…³æ¡†æ¶" class="headerlink" title="18.å¸¸ç”¨çš„ç½‘å…³æ¡†æ¶"></a>18.å¸¸ç”¨çš„ç½‘å…³æ¡†æ¶</h2><ul><li>Nginxxã€Zuulã€Gateway</li></ul><h2 id="19-Zuul-å’Œ-NginxåŒºåˆ«"><a href="#19-Zuul-å’Œ-NginxåŒºåˆ«" class="headerlink" title="19.Zuul å’Œ NginxåŒºåˆ«"></a>19.Zuul å’Œ NginxåŒºåˆ«</h2><ul><li>Zuul java å®ç°ï¼Œä¸»è¦æ˜¯ç½‘å…³æœåŠ¡</li><li>Nginx C å®ç°ï¼Œæ€§èƒ½é«˜äºZuulï¼Œå¯ä»¥åšZuulé›†ç¾¤</li></ul><h2 id="20-å¦‚ä½•è®¾è®¡ä¸€å¥—APIæ¥å£"><a href="#20-å¦‚ä½•è®¾è®¡ä¸€å¥—APIæ¥å£" class="headerlink" title="20.å¦‚ä½•è®¾è®¡ä¸€å¥—APIæ¥å£"></a>20.å¦‚ä½•è®¾è®¡ä¸€å¥—APIæ¥å£</h2><ul><li>APIåˆ†ç±»ï¼šå¼€å‘APIæ¥å£ å’Œ å†…ç½‘APIæ¥å£<ul><li>å†…ç½‘ï¼šå±€åŸŸç½‘ï¼Œä¸ºå†…éƒ¨æœåŠ¡è€ƒè™‘</li><li>å¤–ç½‘ï¼šå¤–éƒ¨å•ä½æä¾›æ¥å£è°ƒç”¨ï¼Œéµå¾ªOauth2.0æƒé™</li></ul></li><li>è€ƒè™‘å®‰å…¨å’Œå¹‚ç­‰æ€§</li></ul><h2 id="21-ZuulFilter-å¸¸ç”¨é‚£äº›æ–¹æ³•"><a href="#21-ZuulFilter-å¸¸ç”¨é‚£äº›æ–¹æ³•" class="headerlink" title="21.ZuulFilter å¸¸ç”¨é‚£äº›æ–¹æ³•"></a>21.ZuulFilter å¸¸ç”¨é‚£äº›æ–¹æ³•</h2><ul><li>Run()ï¼šè¿‡æ»¤å™¨çš„å…·ä½“ä¸šåŠ¡é€»è¾‘ </li><li>shouldFilter()ï¼šåˆ¤æ–­è¿‡æ»¤å™¨æ˜¯å¦æœ‰æ•ˆ </li><li>filterOrder()ï¼šè¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº </li><li>filterType()ï¼šè¿‡æ»¤å™¨æ‹¦æˆªä½ç½®</li></ul><h2 id="22-å®ç°åŠ¨æ€Zuulç½‘å…³è·¯ç”±è½¬å‘"><a href="#22-å®ç°åŠ¨æ€Zuulç½‘å…³è·¯ç”±è½¬å‘" class="headerlink" title="22.å®ç°åŠ¨æ€Zuulç½‘å…³è·¯ç”±è½¬å‘"></a>22.å®ç°åŠ¨æ€Zuulç½‘å…³è·¯ç”±è½¬å‘</h2><ul><li>é€šè¿‡pathé…ç½®æ‹¦æˆªè¯·æ±‚ï¼Œé€šè¿‡ServicerIdé…ç½®ä¸­å¿ƒè½¬å‘é“æœåŠ¡åˆ—è¡¨ï¼Œå†…éƒ¨ä½¿ç”¨Ribbonå®ç°æœ¬åœ°è´Ÿè½½å‡è¡¡å’Œè½¬å‘</li></ul><h1 id="Ribbon"><a href="#Ribbon" class="headerlink" title="Ribbon"></a>Ribbon</h1><h2 id="23-Ribbonçš„ä½œç”¨"><a href="#23-Ribbonçš„ä½œç”¨" class="headerlink" title="23.Ribbonçš„ä½œç”¨"></a>23.Ribbonçš„ä½œç”¨</h2><ul><li>ä¸»è¦åŠŸèƒ½æ˜¯æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé»˜è®¤æ˜¯è½®è¯¢ç®—æ³•ã€‚</li></ul><h2 id="24-Ribbonçš„åŸç†"><a href="#24-Ribbonçš„åŸç†" class="headerlink" title="24.Ribbonçš„åŸç†"></a>24.Ribbonçš„åŸç†</h2><ul><li>Ribbonä¼šä»æ³¨å†Œä¸­å¿ƒè·å–åˆ°æœåŠ¡çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡è½®è¯¢ç®—æ³•ï¼Œä»ä¸­é€‰æ‹©ä¸€å°æœºå™¨ã€‚</li></ul><h2 id="25-Ribbonå’Œnginxçš„åŒºåˆ«"><a href="#25-Ribbonå’Œnginxçš„åŒºåˆ«" class="headerlink" title="25.Ribbonå’Œnginxçš„åŒºåˆ«"></a>25.Ribbonå’Œnginxçš„åŒºåˆ«</h2><ul><li><strong>nginxï¼š</strong> åå‘ä»£ç†å®ç°è´Ÿè½½å‡è¡¡ï¼Œç›¸å½“äºä»nginxæœåŠ¡å™¨è¿›è¡Œè¯·æ±‚è½¬å‘ã€‚</li><li><strong>Ribbonï¼š</strong> å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œå…¨ç¨‹éƒ½æ˜¯å®¢æˆ·ç«¯æ“ä½œã€‚</li></ul><h1 id="Feign"><a href="#Feign" class="headerlink" title="Feign"></a>Feign</h1><h2 id="26-ä½œç”¨"><a href="#26-ä½œç”¨" class="headerlink" title="26 ä½œç”¨"></a>26 ä½œç”¨</h2><p>Feigné›†æˆäº†Ribbonï¼ŒFeign æ˜¯ä¸€ä¸ªå£°æ˜webæœåŠ¡å®¢æˆ·ç«¯ï¼Œè¿™ä½¿å¾—ç¼–å†™webæœåŠ¡å®¢æˆ·ç«¯æ›´å®¹æ˜“ï¼Œè¿œç¨‹è°ƒç”¨æ›´åŠ ç®€å•ã€‚</p><h2 id="27-SpringCloudæœ‰å‡ ç§è°ƒç”¨æ¥å£æ–¹å¼"><a href="#27-SpringCloudæœ‰å‡ ç§è°ƒç”¨æ¥å£æ–¹å¼" class="headerlink" title="27.SpringCloudæœ‰å‡ ç§è°ƒç”¨æ¥å£æ–¹å¼"></a>27.SpringCloudæœ‰å‡ ç§è°ƒç”¨æ¥å£æ–¹å¼</h2><p>Feign<br>RestTemplate</p><h2 id="28-Ribbonå’ŒFeignè°ƒç”¨æœåŠ¡çš„åŒºåˆ«"><a href="#28-Ribbonå’ŒFeignè°ƒç”¨æœåŠ¡çš„åŒºåˆ«" class="headerlink" title="28.Ribbonå’ŒFeignè°ƒç”¨æœåŠ¡çš„åŒºåˆ«"></a>28.Ribbonå’ŒFeignè°ƒç”¨æœåŠ¡çš„åŒºåˆ«</h2><p><strong>Ribbonï¼š</strong> éœ€è¦æˆ‘ä»¬è‡ªå·±æ„å»ºhttpè¯·æ±‚ï¼Œç„¶åé€šè¿‡RestTemplateå»å‘ç»™å…¶ä»–æœåŠ¡ï¼Œæ¯”è¾ƒç¹çã€‚<br><strong>Feignï¼š</strong> ä¸éœ€è¦è‡ªå·±æ„å»ºHttpè¯·æ±‚ï¼Œç›´æ¥æ¥å£è°ƒç”¨å°±è¡Œã€‚</p><h1 id="Hystrix"><a href="#Hystrix" class="headerlink" title="Hystrix"></a>Hystrix</h1><h2 id="29-è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯æœåŠ¡é›ªå´©"><a href="#29-è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯æœåŠ¡é›ªå´©" class="headerlink" title="29.è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯æœåŠ¡é›ªå´©"></a>29.è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯æœåŠ¡é›ªå´©</h2><p>æœåŠ¡é›ªå´©ï¼šå¤šä¸ªæœåŠ¡ç›¸äº’è°ƒç”¨æ—¶ï¼ŒAè°ƒBï¼ŒBè°ƒCï¼ŒCè°ƒDç­‰ç­‰æ›´å¤šè°ƒç”¨ï¼Œé‚£ä¹ˆå¦‚æœä¸­é—´è°ƒç”¨éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œç„¶åå†å»è°ƒç”¨Aï¼Œé‚£ä¹ˆå ç”¨çš„èµ„æºå°±è¶Šæ¥è¶Šå¤šï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚</p><h2 id="30-Hystrixæ–­è·¯å™¨æ˜¯ä»€ä¹ˆ"><a href="#30-Hystrixæ–­è·¯å™¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="30.Hystrixæ–­è·¯å™¨æ˜¯ä»€ä¹ˆ"></a>30.Hystrixæ–­è·¯å™¨æ˜¯ä»€ä¹ˆ</h2><p>é˜²æ­¢æœåŠ¡é›ªå´©çš„ä¸€ä¸ªå·¥å…·ï¼Œå…·æœ‰æœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­(@HystrixCommand(fallbackMethod = â€œhystrixByIdâ€) //å¤±è´¥äº†è°ƒç”¨çš„æ–¹æ³•)ã€æœåŠ¡éš”ç¦»ã€ç›‘æ§ç­‰é˜²æ­¢é›ªå´©çš„æŠ€æœ¯ã€‚</p><h2 id="31-ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€æœåŠ¡éš”ç¦»"><a href="#31-ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€æœåŠ¡éš”ç¦»" class="headerlink" title="31.ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€æœåŠ¡éš”ç¦»"></a>31.ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€æœåŠ¡éš”ç¦»</h2><p><strong>æœåŠ¡é™çº§ï¼š</strong> å½“å‡ºç°è¯·æ±‚è¶…æ—¶ã€èµ„æºä¸è¶³æ—¶(çº¿ç¨‹æˆ–è€…ä¿¡å·é‡)ï¼Œä¼šè¿›è¡ŒæœåŠ¡é™çº§ï¼Œå°±æ˜¯å»è¿”å›fallbackæ–¹æ³•çš„ç»“æœã€‚<br><strong>æœåŠ¡ç†”æ–­ï¼š</strong> å½“å¤±è´¥ç‡(ç½‘ç»œæ•…éšœæˆ–è€…è¶…æ—¶é€ æˆ)è¾¾åˆ°é˜ˆå€¼è‡ªåŠ¨è§¦å‘é™çº§ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„é™çº§ã€‚<br><strong>æœåŠ¡éš”ç¦»ï¼š</strong> ä¸ºéš”ç¦»çš„æœåŠ¡å¼€å¯ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œè¿™æ ·åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šå½±å“è¯¥æœåŠ¡ã€‚ä¸€èˆ¬ä½¿ç”¨çº¿ç¨‹æ± å®ç°(è¿˜æœ‰ä¿¡å·é‡æ–¹å¼å®ç°)ã€‚</p><h2 id="32-æœåŠ¡é™çº§å’ŒæœåŠ¡ç†”æ–­çš„åŒºåˆ«"><a href="#32-æœåŠ¡é™çº§å’ŒæœåŠ¡ç†”æ–­çš„åŒºåˆ«" class="headerlink" title="32.æœåŠ¡é™çº§å’ŒæœåŠ¡ç†”æ–­çš„åŒºåˆ«"></a>32.æœåŠ¡é™çº§å’ŒæœåŠ¡ç†”æ–­çš„åŒºåˆ«</h2><p>åŒºåˆ«ï¼š é™çº§æ¯ä¸ªè¯·æ±‚éƒ½ä¼šå‘é€è¿‡å»ï¼Œè€Œç†”æ–­ä¸ä¸€å®šï¼Œè¾¾åˆ°å¤±è´¥ç‡ï¼Œè¯·æ±‚å°±ä¸ä¼šå†å»å‘é€äº†ã€‚è¯·æ±‚å‡ºé”™æ—¶ç†”æ–­è¿”å›çš„æ˜¯fallbackæ•°æ®ï¼Œè€Œç†”æ–­åˆ™æ˜¯ä¸€æ®µæ—¶é—´ä¸ä¼šå»è®¿é—®æœåŠ¡æä¾›è€…ã€‚<br>æ¯”å¦‚ï¼š<br>â‘ é™çº§ï¼šAè°ƒBï¼Œå‘é€10ä¸ªè¯·æ±‚ï¼Œå³ä½¿æ¯ä¸ªè¯·æ±‚éƒ½è¶…æ—¶ï¼Œä¹Ÿä¼šå»è¯·æ±‚Bã€‚<br>â‘¡ç†”æ–­ï¼šAè°ƒBï¼Œå‘é€10ä¸ªè¯·æ±‚ï¼Œå¤±è´¥ç‡è®¾ç½®ä¸º50%ï¼Œå¦‚æœ5ä¸ªè¯·æ±‚å¤±è´¥ï¼Œæ­¤æ—¶å¤±è´¥ç‡åˆ°äº†50%ï¼Œé‚£ä¹ˆåé¢çš„5ä¸ªè¯·æ±‚å°±ä¸ä¼šèµ°åˆ°Bã€‚</p><h1 id="ç½‘å…³-Zuul-å’Œ-Gateway"><a href="#ç½‘å…³-Zuul-å’Œ-Gateway" class="headerlink" title="ç½‘å…³ Zuul å’Œ Gateway"></a>ç½‘å…³ Zuul å’Œ Gateway</h1><h2 id="33-ä»€ä¹ˆæ˜¯Zuulå¾®æœåŠ¡ç½‘å…³"><a href="#33-ä»€ä¹ˆæ˜¯Zuulå¾®æœåŠ¡ç½‘å…³" class="headerlink" title="33.ä»€ä¹ˆæ˜¯Zuulå¾®æœåŠ¡ç½‘å…³"></a>33.ä»€ä¹ˆæ˜¯Zuulå¾®æœåŠ¡ç½‘å…³</h2><p>æ¥æ”¶æ‰€æœ‰çš„è¯·æ±‚ï¼Œå¹¶ä¸”å°†ä¸åŒçš„è¯·æ±‚è½¬å‘è‡³ä¸åŒçš„å¾®æœåŠ¡æ¨¡å—ã€‚</p><h2 id="34-Zuulçš„åº”ç”¨åœºæ™¯"><a href="#34-Zuulçš„åº”ç”¨åœºæ™¯" class="headerlink" title="34.Zuulçš„åº”ç”¨åœºæ™¯"></a>34.Zuulçš„åº”ç”¨åœºæ™¯</h2><p>â‘ è¿‡æ»¤å™¨<br>â‘¡æƒé™è®¤è¯<br>â‘¢é™çº§é™æµ<br>â‘£å®‰å…¨</p><h2 id="35-Gateway"><a href="#35-Gateway" class="headerlink" title="35.Gateway"></a>35.Gateway</h2><p>åŠŸèƒ½å¼ºå¤§ä¸°å¯Œï¼Œæ€§èƒ½å¥½ï¼Œç»´æŠ¤æ€§å¥½ï¼Œå®ç°å¼‚æ­¥ï¼Œå¯ä»¥æ›¿ä»£Zuulç½‘å…³ã€‚</p><h1 id="Spring-Cloud-Config"><a href="#Spring-Cloud-Config" class="headerlink" title="Spring Cloud Config"></a>Spring Cloud Config</h1><h2 id="36-ä»€ä¹ˆæ˜¯Spring-Cloud-Config"><a href="#36-ä»€ä¹ˆæ˜¯Spring-Cloud-Config" class="headerlink" title="36.ä»€ä¹ˆæ˜¯Spring Cloud Config"></a>36.ä»€ä¹ˆæ˜¯Spring Cloud Config</h2><p>é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶ï¼Œä¸éœ€è¦æ¯ä¸ªæœåŠ¡ç¼–å†™é…ç½®æ–‡ä»¶ï¼ŒæœåŠ¡ä¼šå‘é…ç½®ä¸­å¿ƒæ‹‰å–é…ç½®ã€‚<br>å®æ—¶åˆ·æ–°(éœ€è¦spring cloud bus)ã€‚</p><h1 id="Spring-Cloud-Alibaba-Nacos"><a href="#Spring-Cloud-Alibaba-Nacos" class="headerlink" title="Spring Cloud Alibaba Nacos"></a>Spring Cloud Alibaba Nacos</h1><h2 id="37-Nacoså¯ä»¥åšä»€ä¹ˆï¼Ÿ"><a href="#37-Nacoså¯ä»¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="37.Nacoså¯ä»¥åšä»€ä¹ˆï¼Ÿ"></a>37.Nacoså¯ä»¥åšä»€ä¹ˆï¼Ÿ</h2><p>æ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒã€‚</p><h2 id="38-Eurekaä¿è¯æ˜¯APï¼Œé‚£ä¹ˆNacosä¿è¯çš„æ˜¯ä»€ä¹ˆï¼Ÿé»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#38-Eurekaä¿è¯æ˜¯APï¼Œé‚£ä¹ˆNacosä¿è¯çš„æ˜¯ä»€ä¹ˆï¼Ÿé»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="38.Eurekaä¿è¯æ˜¯APï¼Œé‚£ä¹ˆNacosä¿è¯çš„æ˜¯ä»€ä¹ˆï¼Ÿé»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ"></a>38.Eurekaä¿è¯æ˜¯APï¼Œé‚£ä¹ˆNacosä¿è¯çš„æ˜¯ä»€ä¹ˆï¼Ÿé»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Nacoså¯ä»¥æ˜¯APä¹Ÿå¯ä»¥æ˜¯CPã€‚é»˜è®¤æ˜¯AP</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> SpringCloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringCloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•ç³»åˆ—ï¼ˆä¸€ï¼‰| SpringBoot é¢è¯•é¢˜</title>
      <link href="/posts/10749.html"/>
      <url>/posts/10749.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="1-ä»€ä¹ˆæ˜¯-SpringBoot"><a href="#1-ä»€ä¹ˆæ˜¯-SpringBoot" class="headerlink" title="1.ä»€ä¹ˆæ˜¯ SpringBoot"></a>1.ä»€ä¹ˆæ˜¯ SpringBoot</h2><p>Springç»„ä»¶ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦ç®€åŒ–äº† Spring éš¾åº¦ï¼Œç®€çœäº†ç¹é‡çš„é…ç½®ï¼Œæä¾›äº†å„ç§çš„å¯åŠ¨å™¨ï¼Œæ˜¯å¼€å‘ä¸Šæ‰‹å¿«</p><h2 id="2-Spring-Boot-ä¼˜ç‚¹"><a href="#2-Spring-Boot-ä¼˜ç‚¹" class="headerlink" title="2.Spring Boot ä¼˜ç‚¹"></a>2.Spring Boot ä¼˜ç‚¹</h2><ol><li>å¼€ç®±å³ç”¨ï¼ŒåŸç†ç¹çé…ç½®</li><li>å†…åµŒæœåŠ¡å™¨ã€å®‰å…¨ç®¡ç†ã€è¿è¡Œæ•°æ®ç›‘æ§ã€è¿è¡ŒçŠ¶æ€æ£€æŸ¥ã€å¤–éƒ¨åŒ–é…ç½®</li><li>æ˜“ä¸Šæ‰‹å¼€å‘æ•ˆç‡é«˜ï¼Œæœ‰å®Œå–„çš„ç¬¬ä¸‰æ–¹startåº“å’Œå®˜ç½‘ starter</li></ol><p>æ€»ç»“ï¼š<strong>ç¼–ç ã€é…ç½®ã€éƒ¨ç½²ã€ç›‘æ§</strong> ç®€å•</p><h2 id="2-SpringBoot-å¯åŠ¨ç±»æ³¨è§£ï¼Ÿå®ƒæ˜¯ç”±é‚£äº›æ³¨è§£ç»„æˆï¼Ÿ"><a href="#2-SpringBoot-å¯åŠ¨ç±»æ³¨è§£ï¼Ÿå®ƒæ˜¯ç”±é‚£äº›æ³¨è§£ç»„æˆï¼Ÿ" class="headerlink" title="2.SpringBoot å¯åŠ¨ç±»æ³¨è§£ï¼Ÿå®ƒæ˜¯ç”±é‚£äº›æ³¨è§£ç»„æˆï¼Ÿ"></a>2.SpringBoot å¯åŠ¨ç±»æ³¨è§£ï¼Ÿå®ƒæ˜¯ç”±é‚£äº›æ³¨è§£ç»„æˆï¼Ÿ</h2><p>@SpringBootApplication</p><ul><li>@SpringBootConfigurationï¼šç»„åˆäº†@Configurationæ³¨è§£ï¼Œå®ç°é…ç½®æ–‡ä»¶çš„åŠŸèƒ½ã€‚</li><li>@EnableAutoConfigurationï¼šæ‰“å¼€è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å…³é—­æŸä¸ªè‡ªåŠ¨é…ç½®çš„é€‰é¡¹</li><li>@SpringBootApplication(exclude={DataSourceAutoConfiguration.class})</li><li>@ComponentScanï¼šSpringç»„ä»¶æ‰«æ</li></ul><h2 id="3-yamlæ˜¯ä»€ä¹ˆ"><a href="#3-yamlæ˜¯ä»€ä¹ˆ" class="headerlink" title="3.yamlæ˜¯ä»€ä¹ˆ"></a>3.yamlæ˜¯ä»€ä¹ˆ</h2><p>ç”¨æ¥è¡¨è¾¾æ•°æ®åºåˆ—åŒ–çš„å‚æ•°</p><h2 id="4-SpringBootå¯åŠ¨æ–¹å¼"><a href="#4-SpringBootå¯åŠ¨æ–¹å¼" class="headerlink" title="4.SpringBootå¯åŠ¨æ–¹å¼"></a>4.SpringBootå¯åŠ¨æ–¹å¼</h2><ol><li>mainæ–¹æ³•</li><li>å‘½ä»¤è¡Œ java -jar</li><li>mvn/gradle</li></ol><h2 id="5-SpringBoot-éœ€è¦ç‹¬ç«‹çš„å®¹å™¨ç‹¬ç«‹ï¼Ÿ"><a href="#5-SpringBoot-éœ€è¦ç‹¬ç«‹çš„å®¹å™¨ç‹¬ç«‹ï¼Ÿ" class="headerlink" title="5.SpringBoot éœ€è¦ç‹¬ç«‹çš„å®¹å™¨ç‹¬ç«‹ï¼Ÿ"></a>5.SpringBoot éœ€è¦ç‹¬ç«‹çš„å®¹å™¨ç‹¬ç«‹ï¼Ÿ</h2><p>å†…ç½®äº†Tomcat/Jetty</p><h2 id="6-SpringBootè‡ªåŠ¨é…ç½®åŸç†"><a href="#6-SpringBootè‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="6.SpringBootè‡ªåŠ¨é…ç½®åŸç†"></a>6.SpringBootè‡ªåŠ¨é…ç½®åŸç†</h2><pre><code>åœ¨sprinBootå¯åŠ¨æ—¶ç”± @SpringBootApplication æ³¨è§£ä¼šè‡ªåŠ¨å»mavenä¸­è¯»å–æ¯ä¸ª starter ä¸­çš„ spring.factoriesæ–‡ä»¶,è¯¥æ–‡ä»¶é‡Œé…ç½®äº†æ‰€æœ‰éœ€è¦è¢«åˆ›å»ºspringå®¹å™¨ä¸­çš„beanï¼Œå¹¶ä¸”è¿›è¡Œè‡ªåŠ¨é…ç½®æŠŠ beanæ³¨å…¥SpringContextä¸­ //ï¼ˆSpringContextæ˜¯Springçš„é…ç½®æ–‡ä»¶ï¼‰</code></pre><h2 id="7-SpringBootç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•é…ç½®ç›‘æ§ï¼Ÿ"><a href="#7-SpringBootç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•é…ç½®ç›‘æ§ï¼Ÿ" class="headerlink" title="7.SpringBootç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•é…ç½®ç›‘æ§ï¼Ÿ"></a>7.SpringBootç›‘è§†å™¨æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•é…ç½®ç›‘æ§ï¼Ÿ</h2><pre><code>Spring boot actuator æ˜¯ spring å¯åŠ¨æ¡†æ¶ä¸­çš„é‡è¦åŠŸèƒ½ä¹‹ä¸€ã€‚Spring boot ç›‘è§†å™¨å¯å¸®åŠ©æ‚¨è®¿é—®ç”Ÿäº§ç¯å¢ƒä¸­ **æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„å½“å‰çŠ¶æ€** ã€‚æœ‰å‡ ä¸ªæŒ‡æ ‡å¿…é¡»åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæ£€æŸ¥å’Œç›‘æ§ã€‚å³ä½¿ä¸€ äº›å¤–éƒ¨åº”ç”¨ç¨‹åºå¯èƒ½æ­£åœ¨ä½¿ç”¨è¿™äº›æœåŠ¡æ¥å‘ç›¸å…³äººå‘˜è§¦å‘è­¦æŠ¥æ¶ˆæ¯ã€‚ç›‘è§†å™¨æ¨¡å—å…¬å¼€äº†ä¸€ç»„å¯ç›´æ¥ ä½œä¸º HTTP URL è®¿é—®çš„REST ç«¯ç‚¹æ¥æ£€æŸ¥çŠ¶æ€ã€‚</code></pre><p>pom.xml</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>yml</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">management</span><span class="token punctuation">:</span>    <span class="token key atrule">endpoint</span><span class="token punctuation">:</span>        <span class="token key atrule">health</span><span class="token punctuation">:</span> <span class="token comment">## å¼€å¯å¥åº·ç›‘æ§ç«¯ç‚¹</span>            <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>        <span class="token key atrule">beans</span><span class="token punctuation">:</span> <span class="token comment">## å¼€å¯Beanå®ä¾‹ç›‘æ§ç«¯ç‚¹</span>            <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¥åº·ç›‘æ§å¼€å¯æ ‡å¿—ï¼Œå¯åŠ¨äº†ä¸¤ä¸ªç«¯ç‚¹ï¼Œé»˜è®¤ä¹‹å¼€å¯ health å’Œ info ç«¯å£</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223093051031.png" title="image-20220223093051031" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223093051031.png" alt="image-20220223093051031"></a>  </p><p>yml</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span> <span class="token comment">## å¼€å¯æ‰€æœ‰ç«¯ç‚¹æš´éœ²</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-æŸ¥çœ‹å„ä¸ªç›‘æ§ä¿¡æ¯ï¼Ÿ"><a href="#8-æŸ¥çœ‹å„ä¸ªç›‘æ§ä¿¡æ¯ï¼Ÿ" class="headerlink" title="8.æŸ¥çœ‹å„ä¸ªç›‘æ§ä¿¡æ¯ï¼Ÿ"></a>8.æŸ¥çœ‹å„ä¸ªç›‘æ§ä¿¡æ¯ï¼Ÿ</h2><p>/actuator ç«¯ç‚¹ ï¼Œé»˜è®¤å¼€å¯äº†ä¸¤ä¸ªç«¯ç‚¹ï¼Œhealth å’Œ info</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"_links"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"self"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:9999/actuator"</span><span class="token punctuation">,</span>      <span class="token property">"templated"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"health"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:9999/actuator/health"</span><span class="token punctuation">,</span> æŸ¥çœ‹å½“å‰æœåŠ¡çš„æ˜¯å¦ä¸Šçº¿      <span class="token property">"templated"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"health-path"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:9999/actuator/health/&#123;*path&#125;"</span><span class="token punctuation">,</span>      <span class="token property">"templated"</span><span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"info"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:9999/actuator/info"</span><span class="token punctuation">,</span>      <span class="token property">"templated"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœå°†æ‰€æœ‰ç«¯ç‚¹æš´éœ²</p><p>è®¿é—®è·¯å¾„ï¼š ip:port/actuator/xx</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223094652254.png" title="image-20220223094652254" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223094652254.png" alt="image-20220223094652254"></a> </p><h3 id="loggers-ç«¯ç‚¹"><a href="#loggers-ç«¯ç‚¹" class="headerlink" title="loggers ç«¯ç‚¹"></a>loggers ç«¯ç‚¹</h3><p>è®¿é—® <code>http://localhost:8080/actuator/loggers</code> å¯ä»¥æŸ¥çœ‹å½“å‰åº”ç”¨çš„æ—¥å¿—çº§åˆ«ç­‰ä¿¡æ¯ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095239970.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095239970.png"></a> </p><p>è¿™é‡Œé¢æœ¬èº«å¹¶ä¸ç‰¹åˆ«ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªåŠŸèƒ½å´éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒæ—¥å¿—çº§åˆ«ä¸€èˆ¬éƒ½æ˜¯ infoï¼Œä½†æ˜¯ç°åœ¨æœ‰ä¸€ä¸ª bug é€šè¿‡ info çº§åˆ«æ— æ³•æ’æŸ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸´æ—¶ä¿®æ”¹ log çº§åˆ«ã€‚</p><p>æ¯”å¦‚ä¸Šå›¾ä¸­çš„ ROOT èŠ‚ç‚¹æ˜¯ info çº§åˆ«ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ postman ç­‰å·¥å…·æ¥å‘ä¸€ä¸ª post è¯·æ±‚ä¿®æ”¹æ—¥å¿—çº§åˆ«ã€‚ </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095330889.png" title="image-20220223095330889" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095330889.png" alt="image-20220223095330889"></a> </p><p>ä¿®æ”¹ä¹‹åå°±ä¼šå‘ç°ï¼Œæ—¥å¿—ç”±åŸæ¥çš„ info å˜æˆäº† debugï¼š </p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095351178.png" title="image-20220223095351178" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095351178.png" alt="image-20220223095351178"></a> </p><h3 id="metrics-ç«¯ç‚¹"><a href="#metrics-ç«¯ç‚¹" class="headerlink" title="metrics ç«¯ç‚¹"></a>metrics ç«¯ç‚¹</h3><p>éå¸¸é‡è¦çš„ç›‘æ§ç«¯ç‚¹ï¼Œç›‘æ§å†…å®¹åŒ…å« JVMå†…å­˜ã€å †ã€ç±»åŠ è½½ã€å¤„ç†å™¨å’Œ tomcat å®¹å™¨ç­‰é‡è¦çš„æŒ‡æ ‡</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095921378.png" title="image-20220223095921378" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2021/12/image-20220223095921378.png" alt="image-20220223095921378"></a> </p><h3 id="è‡ªå®šä¹‰ç›‘æ§ç«¯ç‚¹"><a href="#è‡ªå®šä¹‰ç›‘æ§ç«¯ç‚¹" class="headerlink" title="è‡ªå®šä¹‰ç›‘æ§ç«¯ç‚¹"></a>è‡ªå®šä¹‰ç›‘æ§ç«¯ç‚¹</h3><blockquote><p>è¿™ä¸€éƒ¨åˆ†ä¹‹åå†è¯¦ä»‹ç»</p></blockquote><h2 id="9-SpringBoot-ä¸­çš„starter"><a href="#9-SpringBoot-ä¸­çš„starter" class="headerlink" title="9.SpringBoot ä¸­çš„starter?"></a>9.SpringBoot ä¸­çš„starter?</h2><p>å¯ä»¥ç†è§£æˆå¯¹ä¾èµ–çš„ä¸€ç§åˆæˆï¼Œstarterä¼šæŠŠä¸€ä¸ªæˆ–è€…ä¸€å¥—åŠŸèƒ½ç›¸å…³çš„ä¾èµ–åŒ…å«è¿›æ¥ï¼Œé¿å…é€ è½®å­ã€‚</p><h2 id="10-ä»€ä¹ˆæ˜¯SpringProfiles"><a href="#10-ä»€ä¹ˆæ˜¯SpringProfiles" class="headerlink" title="10.ä»€ä¹ˆæ˜¯SpringProfiles"></a>10.ä»€ä¹ˆæ˜¯SpringProfiles</h2><p>å¼€å‘åˆ°ç”Ÿäº§ï¼Œç»è¿‡å¼€å‘ï¼ˆdevï¼‰ã€æµ‹è¯•ï¼ˆtestï¼‰ã€ä¸Šçº¿ï¼ˆprodï¼‰ï¼Œä¸»è¦é’ˆå¯¹ä¸åŒçš„çš„é…ç½®ã€‚Spring Profileså…è®¸ç”¨æˆ·æ ¹æ®é…ç½®æ–‡ä»¶ï¼ˆdev/test/prodï¼‰æ¥æ³¨å†Œbeanã€‚</p><h2 id="11-æ¿€æ´»ä¸åŒç¯å¢ƒé…ç½®"><a href="#11-æ¿€æ´»ä¸åŒç¯å¢ƒé…ç½®" class="headerlink" title="11.æ¿€æ´»ä¸åŒç¯å¢ƒé…ç½®"></a>11.æ¿€æ´»ä¸åŒç¯å¢ƒé…ç½®</h2><p>yml:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">profiles</span><span class="token punctuation">:</span><span class="token key atrule">active</span><span class="token punctuation">:</span> dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>   å‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">java -jar xx.jar --spring.profiles.active&#x3D;dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="12-SpringBootå¼‚å¸¸å¤„ç†ç›¸å…³æ³¨è§£ï¼Ÿ"><a href="#12-SpringBootå¼‚å¸¸å¤„ç†ç›¸å…³æ³¨è§£ï¼Ÿ" class="headerlink" title="12.SpringBootå¼‚å¸¸å¤„ç†ç›¸å…³æ³¨è§£ï¼Ÿ"></a>12.SpringBootå¼‚å¸¸å¤„ç†ç›¸å…³æ³¨è§£ï¼Ÿ</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ControllerAdvice</span><span class="token annotation punctuation">@ExceptinoHandler</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="13-SpringBoot1-1-å’Œ-2-xçš„åŒºåˆ«ï¼Ÿ"><a href="#13-SpringBoot1-1-å’Œ-2-xçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="13.SpringBoot1.1 å’Œ 2.xçš„åŒºåˆ«ï¼Ÿ"></a>13.SpringBoot1.1 å’Œ 2.xçš„åŒºåˆ«ï¼Ÿ</h2><ol><li>SpringBoot 2åŸºäºSpring5å’ŒJDK8ï¼ŒSpring 1.xç”¨çš„æœ€ä½ç‰ˆæœ¬</li><li>é…ç½®å˜æ›´ï¼Œå‚æ•°å</li><li>SpringBoot 2ç›¸å…³æ’ä»¶æœ€ä½ç‰ˆæœ¬å¾ˆå¤šéƒ½è¦æ¯”åŸæ¥é«˜</li><li>2.xé…ç½®ä¸­çš„ä¸­æ–‡å¯ä»¥ç›´æ¥è¯»å–</li></ol><h2 id="14-Spring-Boot-ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜"><a href="#14-Spring-Boot-ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜" class="headerlink" title="14. Spring Boot ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ ?"></a>14. Spring Boot ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ ?</h2><pre><code>åç«¯é€šè¿‡ ï¼ˆCORSï¼ŒCross origin resource sharingï¼‰ æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚è¿™ç§è§£å†³æ–¹æ¡ˆå¹¶é Spring Boot ç‰¹æœ‰çš„ï¼Œåœ¨ä¼ ç»Ÿçš„ SSM æ¡†æ¶ä¸­ï¼Œå°±å¯ä»¥é€šè¿‡ CORS æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œåªä¸è¿‡ä¹‹å‰æˆ‘ä»¬æ˜¯åœ¨ XML æ–‡ä»¶ä¸­é…ç½® CORS ï¼Œ ç°åœ¨å¯ä»¥é€šè¿‡å®ç° **WebMvcConfigurer** æ¥å£ç„¶åé‡å†™ **addCorsMappings** æ–¹æ³•è§£å†³è·¨åŸŸé—®é¢˜ã€‚</code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCorsMappings</span><span class="token punctuation">(</span><span class="token class-name">CorsRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allowedOrigins</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">,</span> <span class="token string">"PUT"</span><span class="token punctuation">,</span> <span class="token string">"DELETE"</span><span class="token punctuation">,</span> <span class="token string">"OPTIONS"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p><a href="https://mp.weixin.qq.com/s/kisvBJABJ27rb6JNZdCyqA">https://mp.weixin.qq.com/s/kisvBJABJ27rb6JNZdCyqA</a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆä¸ƒï¼‰| æ—¥å¿—å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/29669.html"/>
      <url>/posts/29669.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ—¥å¿—å’Œå¼‚å¸¸å¤„ç†ç»“åˆå¾—å½“çš„è¯ï¼Œä¼šç»™é¡¹ç›®ç»´æŠ¤å¸¦æ¥éå¸¸å¤§çš„ä»·å€¼ã€‚</p><ul><li>  <strong>æ—¥å¿—ï¼š</strong>å°±æ˜¯ä»‹ç»ä¸€ä¸ªè¿‡ç¨‹å’Œç»å†çš„è¯¦ç»†è®°å½•ã€‚</li><li>  <strong>é¡¹ç›®æ—¥å¿—ï¼š</strong>å°±æ˜¯é¡¹ç›®å¼€å‘è¿‡ç¨‹çš„è¯¦ç»†è®°å½•ï¼Œä¸€èˆ¬ç”±é¡¹ç›®ç»ç†è®°å½•ã€‚</li><li>  <strong>ä»£ç é‡Œçš„æ—¥å¿—ï¼š</strong>å°±æ˜¯ç¨‹åºå‘˜è®°å½•æŸä¸ªå¼€å‘è¿‡ç¨‹çš„è¯¦ç»†æƒ…å†µï¼Œè¿™æ˜¯é¡¹ç›®é‡Œæ¯ä¸ªç¨‹åºå‘˜éœ€è¦åšçš„å·¥ä½œã€‚</li></ul><p>ä»£ç é‡Œçš„æ—¥å¿—åœ¨é¡¹ç›®ä¸­æ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ï¼Œæ—¥å¿—è®°å½•çš„è¯¦ç»†ç¨‹åº¦å†³å®šç³»ç»Ÿæ˜¯å¦å®¹æ˜“ç»´æŠ¤ï¼ŒJava é¡¹ç›®ä¸­æ—¥å¿—è®°å½•çš„æ¡†æ¶æœ‰å¾ˆå¤šï¼Œåœ¨é¡¹ç›®ä¸­å¦‚ä½•é€‰å‹ä¹Ÿå¿…å°†å›°æƒ‘ã€‚</p><p>æˆ‘ä»¬è¿™åœº chat è®¨è®ºçš„ä¸»é¢˜å°±æ˜¯ï¼š<strong>Java ä»£ç é‡Œçš„æ—¥å¿—</strong>ï¼Œä¸»è¦æ˜¯å†™ç»™ Java ç¨‹åºå‘˜çœ‹çš„ï¼Œæœ¬ç¯‡ Chat ä»ä»¥ä¸‹å…­ä¸ªæ–¹é¢å¯¹ Java æ—¥å¿—è¿›è¡Œé˜è¿°ï¼š</p><ul><li>  ä¸€ã€æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨</li><li>  äºŒã€Java æ—¥å¿—ä½¿ç”¨çš„å›°æƒ‘</li><li>  ä¸‰ã€Java æ—¥å¿—æ¼”åŒ–å†å²</li><li>  å››ã€ä½¿ç”¨ä¸åŒæ¡†æ¶çš„ Java æ—¥å¿—ç¤ºä¾‹è¯´æ˜</li><li>  äº”ã€é¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™</li><li>  å…­ã€ä¸€ä¸ªæ¨èçš„é¡¹ç›® Java æ—¥å¿—å®ä¾‹</li></ul><p>ä»¥æœŸé€šè¿‡æœ¬åœº Chat çš„å­¦ä¹ ï¼Œèƒ½ä½¿å¤§å®¶åœ¨ç¼–ç è¿‡ç¨‹ä¸­ï¼Œå¯¹æ—¥å¿—çš„å¤„ç†è¿‡ç¨‹åŠ æ·±è®¤è¯†ã€ç»Ÿä¸€è§„èŒƒã€å¾—åˆ°æ”¶è·ï¼Œä»é›¶å¼€å§‹è½»æ¾æŒæ¡ Java æ—¥å¿—å¤„ç†ï¼Œå¹¶ä¸”å¯ä»¥è¿ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚</p><h2 id="ä¸€ã€æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨"><a href="#ä¸€ã€æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨" class="headerlink" title="ä¸€ã€æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨"></a>ä¸€ã€æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨</h2><p>Log æ—¥å¿—ï¼Œä¸»è¦ç”¨äºè®°å½•ç¨‹åºè¿è¡Œçš„æƒ…å†µï¼Œä»¥ä¾¿äºç¨‹åºåœ¨éƒ¨ç½²ä¹‹åçš„æ’é”™è°ƒè¯•ç­‰ï¼Œä¹Ÿæœ‰åˆ©äºå°†è¿™äº›ä¿¡æ¯è¿›è¡ŒæŒä¹…åŒ–ï¼ˆå¦‚æœä¸å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œåˆ™ä¿¡æ¯ä¾¿ä¼šä¸¢å¤±ï¼‰ã€‚</p><h3 id="1-æŸ¥çœ‹ç¨‹åºå½“å‰è¿è¡ŒçŠ¶æ€"><a href="#1-æŸ¥çœ‹ç¨‹åºå½“å‰è¿è¡ŒçŠ¶æ€" class="headerlink" title="1. æŸ¥çœ‹ç¨‹åºå½“å‰è¿è¡ŒçŠ¶æ€"></a>1. æŸ¥çœ‹ç¨‹åºå½“å‰è¿è¡ŒçŠ¶æ€</h3><p>å¦‚æœæƒ³äº†è§£ç¨‹åºå½“å‰çš„è¿è¡Œæƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—çš„è¾“å‡ºï¼Œå°±èƒ½è¿›è¡Œåˆ†æã€‚</p><p>æ¯”å¦‚ï¼Œä½ åœ¨æµè§ˆå™¨é‡Œè¾“å…¥ä¸€ä¸ª action åœ°å€ï¼Œè¯¥ url è´Ÿè´£æ‰§è¡Œä¸€äº›æ‰¹é‡å¤„ç†ï¼Œaction è¿è¡Œåï¼Œå‡è®¾å¤„ç†æ¯”è¾ƒè€—æ—¶ï¼Œä½ å†æµè§ˆå™¨é‡Œæ— æ³•ç›´æ¥çœ‹åˆ°ç¨‹åºçš„æ‰§è¡Œç»“æœï¼Œæ­¤æ—¶ï¼Œä½ å¯ä»¥æ‰“å¼€ç³»ç»Ÿæ—¥å¿—ï¼Œé€šè¿‡ä»æ—¥å¿—è¾“å‡ºä¿¡æ¯å°±èƒ½è½»æ¾åœ°åˆ†æè¯¥ url çš„æ‰§è¡Œæƒ…å†µã€‚</p><h3 id="2-æŸ¥çœ‹ç¨‹åºå†å²è¿è¡Œè½¨è¿¹"><a href="#2-æŸ¥çœ‹ç¨‹åºå†å²è¿è¡Œè½¨è¿¹" class="headerlink" title="2. æŸ¥çœ‹ç¨‹åºå†å²è¿è¡Œè½¨è¿¹"></a>2. æŸ¥çœ‹ç¨‹åºå†å²è¿è¡Œè½¨è¿¹</h3><p>å¦‚æœæƒ³äº†è§£å†æ—¶ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹åº”ç”¨å†æ—¶æ—¥å¿—çš„è¾“å‡ºï¼Œå°±èƒ½è¿›è¡Œåˆ†æã€‚</p><p>æ¯”å¦‚ï¼Œä½ æƒ³äº†è§£ä¸‹ä¸Šå‘¨å‘¨æœ«ç”¨æˆ·è®¿é—®é‡ï¼Œä½ å¯ä»¥æ‰“å¼€ç³»ç»Ÿä¸Šå‘¨å‘¨æœ«çš„æ—¥å¿—è®°å½•ï¼Œè¿›è¡Œåˆ†æã€‚ä½ æƒ³äº†è§£æ˜¨å¤©çš„æŸä¸ªå®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼Œä½ å¯ä»¥æ‰“å¼€æ˜¨å¤©çš„ç³»ç»Ÿæ—¥å¿—ï¼Œç²¾ç¡®æŸ¥æ‰¾è¯¥å®šæ—¶ä»»åŠ¡çš„è¾“å‡ºä¿¡æ¯ï¼Œä»è€Œåˆ¤æ–­å®šæ—¶ä»»åŠ¡æ˜¯å¦æ‰§è¡Œã€‚</p><h3 id="3-æ’æŸ¥ç³»ç»Ÿé—®é¢˜"><a href="#3-æ’æŸ¥ç³»ç»Ÿé—®é¢˜" class="headerlink" title="3. æ’æŸ¥ç³»ç»Ÿé—®é¢˜"></a>3. æ’æŸ¥ç³»ç»Ÿé—®é¢˜</h3><p>æ’æŸ¥ç³»ç»Ÿé—®é¢˜æ˜¯ç¨‹åºå‘˜æœ€ç†Ÿæ‚‰çš„å‘³é“äº†ï¼Œåœ¨é¡¹ç›®ç»´æŠ¤è¿‡ç¨‹ä¸­ï¼Œå‡ºäº†ä»»ä½•é—®é¢˜ï¼Œéƒ½éœ€è¦ç¨‹åºå‘˜å»è¿›è¡Œæ’æŸ¥ã€‚æ­¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ¸…æ¥šæ˜äº†çš„æ—¥å¿—è®°å½•ï¼Œæƒ³è¦æ ¸æŸ¥å‡ºé—®é¢˜çš„åŸå› ï¼Œéš¾äºä¸Šé’å¤©ã€‚</p><p>ä¸€ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜ä¸€å®šæ˜¯ä¸ªæ—¥å¿—è®°å½•é«˜æ‰‹ï¼Œå¦‚æœæ—¥å¿—è®°å½•çš„å¥½ï¼Œå¤„ç†å¾—å½“ï¼Œæ’æŸ¥é—®é¢˜åˆ™æ˜“å¦‚åæŒã€‚</p><p>å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°ä¸€ç§åœºæ™¯ï¼Œä¸€ä¸ªé—®é¢˜å‘ç”Ÿäº†ï¼Œæœ‰çš„äººèƒ½è¿…é€Ÿå®šä½é—®é¢˜å¹¶è§£å†³ï¼Œæœ‰çš„äººæäº†åŠå¤©ï¼Œè¿˜æ²¡å‘ç°é—®é¢˜çš„äº§ç”ŸåŸå› ã€‚</p><p>å…¶å®å¿«é€Ÿå®šä½é—®é¢˜çš„äººä¸€å®šè®°å½•äº†è¯¦ç»†çš„æ—¥å¿—ï¼Œå› æ­¤å½“é—®é¢˜å‘ç”Ÿçš„æ—¶å€™ï¼Œé€šè¿‡æ ¸æŸ¥é—®é¢˜å‘ç”Ÿæ—¶å€™çš„æ—¥å¿—ï¼Œå°±èƒ½å¿«é€Ÿçš„æ‰¾å‡ºé—®é¢˜äº§ç”Ÿçš„åŸå› ã€‚</p><h3 id="4-ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½"><a href="#4-ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½" class="headerlink" title="4. ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½"></a>4. ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½</h3><p>é€šè¿‡è®°å½•ç¨‹åºè¿è¡Œçš„æ—¶é—´ï¼Œå°±èƒ½åˆ¤æ–­ç¨‹åºä»æ‰§è¡Œå¼€å§‹åˆ°æ‰§è¡Œç»“æŸæ¶ˆè€—çš„æ—¶é—´ï¼Œä»è€Œåˆ¤æ–­ç³»ç»Ÿæ€§èƒ½æ˜¯å¦è¾¾æ ‡ï¼Œä¸ºç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–æä¾›åˆ¤æ–­ä¾æ®ã€‚</p><h3 id="5-å®‰å…¨å®¡è®¡çš„åŸºçŸ³"><a href="#5-å®‰å…¨å®¡è®¡çš„åŸºçŸ³" class="headerlink" title="5. å®‰å…¨å®¡è®¡çš„åŸºçŸ³"></a>5. å®‰å…¨å®¡è®¡çš„åŸºçŸ³</h3><p>ç½‘ç»œå®‰å…¨è¶Šæ¥è¶Šå—åˆ°å¤§å®¶çš„å…³æ³¨ï¼Œæ‰€ä»¥ç³»ç»Ÿå®‰å…¨ç›®å‰æ˜¯é¡¹ç›®è¿‡ç¨‹éå¸¸é‡è¦çš„ä¸€ä¸ªç¯èŠ‚ï¼Œå®‰å…¨å®¡è®¡ä¹Ÿæ˜¯ç³»ç»Ÿä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ã€‚</p><p>é€šè¿‡ç³»ç»Ÿæ—¥å¿—åˆ†æï¼Œå¯ä»¥åˆ¤æ–­ä¸€äº›éæ³•æ”»å‡»ï¼Œéæ³•è°ƒç”¨ï¼Œä»¥åŠç³»ç»Ÿå¤„ç†è¿‡ç¨‹ä¸­çš„å®‰å…¨éšæ‚£ã€‚</p><p>æ¯”å¦‚ï¼Œå¤§å®¶å¹³æ—¶éƒ½åœ¨åšè¿è¥ç³»ç»Ÿï¼Œå…¶ä¸­è¿è¥äººå‘˜åœ¨é€šè¿‡ç•Œé¢å¤„ç†ä¸€äº›æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰æ¸…æ¥šçš„æ—¥å¿—æ“ä½œè®°å½•ï¼Œä¸€æ¡æ•°æ®è¢«åˆ é™¤æˆ–è€…ä¿®æ”¹ï¼Œä½ æ˜¯æ— æ³•æ‰¾åˆ°æ˜¯è°æ“ä½œçš„ï¼Œä½†æ˜¯å¦‚æœä½ åšäº†ç›¸åº”çš„è®°å½•ï¼Œè¯¥æ•°æ®è¢«è°åˆ é™¤æˆ–è€…ä¿®æ”¹å°±ä¼šä¸€ç›®äº†ç„¶ã€‚</p><p><strong>é€šè¿‡ä»¥ä¸Š 5 ç‚¹è¯´æ˜äº†æ—¥å¿—åœ¨é¡¹ç›®ç»´æŠ¤è¿‡ç¨‹ä¸­çš„é‡è¦ä½œç”¨</strong></p><p>ä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å®¹æ˜“ç»´æŠ¤ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯åŸºäºç¨‹åºå‘˜åœ¨ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­çš„ä»£ç æ—¥å¿—æ˜¯æ€ä¹ˆè®°å½•çš„ã€‚</p><p>æ—¥å¿—è®°å½•çš„è¶Šæ¸…æ¥šï¼Œç»´æŠ¤èµ·æ¥å°±è¶Šå®¹æ˜“ï¼Œæœ‰çš„ç¨‹åºå‘˜æ²¡æœ‰æ—¥å¿—è®°å½•æ„è¯†ï¼Œæˆ–è€…å¯¹æ—¥å¿—è®°å½•è®¤è¯†ä¸æ¸…ï¼Œæˆ–è€…æ˜¯ä¸çŸ¥é“æ—¥å¿—è¯¥å¦‚ä½•è®°å½•ï¼Œè¿™åŠ¿å¿…ä¼šç»™é¡¹ç›®åæœŸçš„ç»´æŠ¤å¸¦æ¥ä¸€ä¸ªä¸ªå¤§å‘ã€‚</p><p>å½“é¡¹ç›®ç»ç†è®©ä½ è§£å†³ä¸€ä¸ªçº¿ä¸Šé—®é¢˜çš„æ—¶å€™ï¼Œæ­£å¥½é‡åˆ°äº†ä¸€ä¸ªæ²¡æœ‰æ—¥å¿—è®°å½•ä¹ æƒ¯çš„äººå†™çš„ä»£ç ï¼Œä½ å°±èƒ½ä½“ä¼šåˆ°é‚£ç§ç—›è‹¦ï¼Œä¸ç”±åœ°æƒ³è¦çˆ†ç²—å£ã€‚</p><p>å› æ­¤ï¼Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜æ¥è¯´ï¼ŒæŒæ¡ä»£ç æ—¥å¿—çš„è®°å½•æ–¹æ³•ï¼Œæ˜¯ç¨‹åºå‘˜ç”Ÿæ¶¯çš„ä¸€é¡¹åŸºæœ¬åŠŸã€‚å†™ä»£ç æ—¶åšå¥½æ—¥å¿—è®°å½•æ˜¯ â€œå³åˆ©äººåˆåˆ©å·±â€ çš„åšæ³•ï¼Œä¸å†™æ—¥å¿—è®°å½•å°±æ˜¯ â€œæŸäººä¸åˆ©å·±â€ çš„åšæ³•ã€‚</p><h2 id="äºŒã€Java-æ—¥å¿—ä½¿ç”¨çš„å›°æƒ‘"><a href="#äºŒã€Java-æ—¥å¿—ä½¿ç”¨çš„å›°æƒ‘" class="headerlink" title="äºŒã€Java æ—¥å¿—ä½¿ç”¨çš„å›°æƒ‘"></a>äºŒã€Java æ—¥å¿—ä½¿ç”¨çš„å›°æƒ‘</h2><p>å¤§å¤šæ•°çš„ç¨‹åºå‘˜éƒ½èƒ½è®¤è¯†åˆ°æ—¥å¿—åœ¨é¡¹ç›®ä¸­çš„é‡è¦æ€§ï¼Œå¯æ˜¯å¯¹æ—¥å¿—è®°å½•å…·ä½“è¦æ€ä¹ˆåšï¼Œåšåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œæ—¥å¿—è®°å½•ç”¨ä»€ä¹ˆå·¥å…·ï¼Œä¼šæœ‰å¾ˆå¤šå›°æƒ‘ã€‚</p><h3 id="1-å·¥å…·å›°æƒ‘"><a href="#1-å·¥å…·å›°æƒ‘" class="headerlink" title="1. å·¥å…·å›°æƒ‘"></a>1. å·¥å…·å›°æƒ‘</h3><p>ä½œä¸º Java ç¨‹åºå‘˜ï¼Œå¹¸è¿çš„æ˜¯ï¼ŒJava æ‹¥æœ‰åŠŸèƒ½å’Œæ€§èƒ½éƒ½éå¸¸å¼ºå¤§çš„æ—¥å¿—åº“ï¼›ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ ·çš„æ—¥å¿—åº“æœ‰ä¸æ­¢ä¸€ä¸ªï¼Œç›¸ä¿¡æ¯ä¸ªäººéƒ½ä¼šå¯¹ JUL(Java Util Log)ã€JCL(Commons Logging)ã€Log4jã€SLF4Jã€Logbackã€Log4j2 ç­‰ç­‰çš„æ—¥å¿—å·¥å…·ï¼Œåˆ°åº•ä½¿ç”¨ä»€ä¹ˆäº§ç”Ÿæ„Ÿåˆ°å›°æ‰°ã€‚</p><p>ä¸‹é¢çš„ç¬¬ä¸‰èŠ‚ï¼šâ€œJava æ—¥å¿—æ¼”åŒ–å†å²â€ï¼Œç¬¬å››èŠ‚ï¼šâ€œä½¿ç”¨ä¸åŒæ¡†æ¶çš„ Java æ—¥å¿—ç¤ºä¾‹è¯´æ˜â€ï¼Œä¸ºå¤§å®¶è§£æƒ‘ Java æ—¥å¿—æ¡†æ¶çš„ä½¿ç”¨é—®é¢˜ã€‚</p><h3 id="2-ä½¿ç”¨å›°æƒ‘"><a href="#2-ä½¿ç”¨å›°æƒ‘" class="headerlink" title="2. ä½¿ç”¨å›°æƒ‘"></a>2. ä½¿ç”¨å›°æƒ‘</h3><p>æœ‰çš„ç¨‹åºå‘˜å³ä½¿çŸ¥é“å†™ Java ç¨‹åºç”¨ä»€ä¹ˆæ—¥å¿—å·¥å…·ï¼Œå¯èƒ½å¯¹æ—¥å¿—è®°å½•å…·ä½“åº”è¯¥æ€ä¹ˆå†™ï¼Œå†™ä»€ä¹ˆä¸œè¥¿ï¼Œä»€ä¹ˆæƒ…å†µä¸‹è¦å†™ï¼Œè¿™äº›ä»è€…è§ä»æ™ºè€…è§æ™ºçš„ä¸œè¥¿ä¹Ÿä¼šäº§ç”Ÿå›°æ‰°ã€‚</p><p>ä¸‹é¢çš„ç¬¬äº”èŠ‚ï¼šâ€œé¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™â€ï¼Œä¸ºå¤§å®¶è§£æƒ‘æ—¥å¿—è®°å½•è¦éµå®ˆå“ªäº›åŸåˆ™ã€‚</p><p>æœ‰çš„ç¨‹åºå‘˜çŸ¥é“äº†è¯¥ç”¨å“ªä¸ª Java æ¡†æ¶ï¼Œä¹ŸçŸ¥é“äº†æ—¥å¿—è®°å½•çš„åŸåˆ™ï¼Œå¯èƒ½è¿˜ä¼šå¯¹å…·ä½“åœ¨é¡¹ç›®ä¸­åˆ°åº•è¯¥å¦‚ä½•æ“ä½œäº§ç”Ÿå›°æƒ‘ã€‚</p><h3 id="3-å®æˆ˜å›°æƒ‘"><a href="#3-å®æˆ˜å›°æƒ‘" class="headerlink" title="3. å®æˆ˜å›°æƒ‘"></a>3. å®æˆ˜å›°æƒ‘</h3><p>ä¸‹é¢çš„ç¬¬å…­èŠ‚ï¼šâ€œä¸€ä¸ªæ¨èçš„é¡¹ç›® Java æ—¥å¿—å®ä¾‹â€ï¼Œä¸ºå¤§å®¶å±•ç¤ºåœ¨å…·ä½“é¡¹ç›®è¿‡ç¨‹ä¸­çš„åº”ç”¨ç¤ºä¾‹ã€‚</p><h2 id="ä¸‰ã€Java-æ—¥å¿—æ¼”åŒ–å†å²"><a href="#ä¸‰ã€Java-æ—¥å¿—æ¼”åŒ–å†å²" class="headerlink" title="ä¸‰ã€Java æ—¥å¿—æ¼”åŒ–å†å²"></a>ä¸‰ã€Java æ—¥å¿—æ¼”åŒ–å†å²</h2><p>æœ€å…ˆå‡ºç°çš„æ˜¯ Apache å¼€æºç¤¾åŒºçš„ Log4jï¼Œè¿™ä¸ªæ—¥å¿—ç¡®å®æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„æ—¥å¿—å·¥å…·ï¼Œæˆä¸ºäº† Java æ—¥å¿—çš„äº‹å®ä¸Šçš„æ ‡å‡†ã€‚</p><p>ç„¶è€Œï¼Œå½“æ—¶ Java çš„å¼€å‘ä¸»ä½“ Sun å…¬å¸è®¤ä¸ºè‡ªå·±æ‰æ˜¯æ­£ç»Ÿï¼Œåœ¨ Jdk1.4 ä¸­å¢åŠ äº† JULï¼ˆåœ¨ java.util.logging åŒ…ä¸‹ï¼‰æ—¥å¿—å®ç°ï¼Œä¼å›¾å¯¹æŠ— Log4jï¼Œä½†æ˜¯å´é€ æˆäº† Java ç›®å‰å¼€å‘è€…è®°å½•æ—¥å¿—å±€é¢çš„æ··ä¹±ï¼Œè¿„ä»Šä¸ºæ­¢ä»é¥±å—è¯Ÿç—…ã€‚</p><p>å½“ç„¶ä¹Ÿæœ‰å…¶ä»–æ—¥å¿—å·¥å…·çš„å‡ºç°ï¼ŒåŸºæœ¬éƒ½æ˜¯å„è‡ªä¸ºæ”¿ï¼Œè¿™äº›æ—¥å¿—ç³»ç»Ÿäº’ç›¸æ²¡æœ‰å…³è”ã€‚</p><p><strong>ä¸ºä»€ä¹ˆ JUL çš„å‡ºç°ä¼šå¯¼è‡´å¼€å‘å±€é¢æ··ä¹±å‘¢ï¼Ÿ</strong></p><p>æƒ³è±¡ä¸‹ä½ çš„é¡¹ç›®åº”ç”¨ä½¿ç”¨ Log4jï¼Œç„¶åä½¿ç”¨äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œè€Œç¬¬ä¸‰æ–¹åº“ä½¿ç”¨äº† JULï¼Œé‚£ä¹ˆï¼Œä½ çš„åº”ç”¨å°±å¾—åŒæ—¶ä½¿ç”¨ Log4j å’Œ JUL ä¸¤ä¸ªæ—¥å¿—å·¥å…·äº†ï¼Œç„¶ååˆæœ‰éœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œä½†æ˜¯è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ä½¿ç”¨äº† Log4j å’Œ JUL ä¹‹å¤–çš„ simplelogã€‚è¿™ä¸ªæ—¶å€™ä½ çš„åº”ç”¨é‡Œå„ç§ log å·¥å…·æ»¡å¤©é£ï¼Œè¿™åŠ¿å¿…ä¼šä½¿ä½ çš„ç¨‹åºå‘˜æ„Ÿåˆ°å´©æºƒã€‚å› ä¸ºè¿™äº›æ—¥å¿—å·¥å…·äº’ç›¸æ²¡æœ‰å…³è”ï¼Œæ›¿æ¢å’Œç»Ÿä¸€æ—¥å¿—å·¥å…·ä¹Ÿå°±å˜æˆäº†æ¯”è¾ƒæ£˜æ‰‹çš„ä¸€ä»¶äº‹æƒ…ã€‚</p><blockquote><p>å¦‚æœä½ é‡åˆ°äº†è¿™ç§é—®é¢˜ï¼Œä½ è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°ä¸€ä¸ªè®¾è®¡æ¨¡å¼â€”â€”â€œé€‚é…å™¨æ¨¡å¼â€ï¼Œå³æŠŠè¿™ä¸ªé—®é¢˜è¿›è¡ŒæŠ½è±¡ï¼ŒæŠ½è±¡å‡ºä¸€ä¸ªæ¥å£å±‚ï¼Œå¯¹æ¯ä¸ªæ—¥å¿—å®ç°éƒ½è¿›è¡Œé€‚é…ï¼Œè¿™æ ·è¿™äº›æä¾›ç»™åˆ«äººçš„åº“éƒ½ç›´æ¥ä½¿ç”¨æŠ½è±¡çš„æ¥å£å±‚å³å¯ã€‚</p></blockquote><p>ä¸ºäº†æå®šè¿™ä¸ªæ—¥å¸¸å¼€å‘ä¸­æ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜ï¼ŒApache å¼€æºç¤¾åŒºæä¾›äº†ä¸€ä¸ªæ—¥å¿—æ¡†æ¶ä½œä¸ºæ—¥å¿—çš„æŠ½è±¡ï¼Œå« commons-loggingï¼Œä¹Ÿè¢«ç§°ä¸º JCL(java common logging)ï¼ŒJCL å¯¹å„ç§æ—¥å¿—æ¥å£è¿›è¡ŒæŠ½è±¡ï¼ŒæŠ½è±¡å‡ºä¸€ä¸ªæ¥å£å±‚ï¼Œå¯¹æ¯ä¸ªæ—¥å¿—å®ç°éƒ½è¿›è¡Œé€‚é…ï¼Œè¿™æ ·è¿™äº›æä¾›ç»™åˆ«äººçš„åº“éƒ½ç›´æ¥ä½¿ç”¨æŠ½è±¡å±‚å³å¯ï¼Œç¡®å®å‡ºè‰²åœ°å®Œæˆäº†å…¼å®¹ä¸»æµçš„æ—¥å¿—å®ç°ï¼ˆLog4jã€JULã€simplelog ç­‰ï¼‰ï¼Œè¾ƒå¥½çš„è§£å†³äº†ä¸Šè¿°é—®é¢˜ï¼ŒåŸºæœ¬ä¸€ç»Ÿæ±Ÿæ¹–ï¼Œå°±è¿é¡¶é¡¶å¤§åçš„ spring ä¹Ÿæ˜¯ä¾èµ–äº† JCLã€‚</p><p>ä½†æ˜¯ç¾å¥½çš„æ—¥å­å¹¶ä¸é•¿ï¼Œä½œä¸ºå…ƒè€çº§æ—¥å¿— Log4j çš„ä½œè€… (Ceki GÃ¼lcÃ¼)ï¼Œä»–è§‰å¾— JCL ä¸å¤Ÿä¼˜ç§€ï¼Œæ‰€ä»¥ä»–å†åº¦å‡ºå±±ï¼Œæå‡ºäº†ä¸€å¥—æ›´ä¼˜é›…çš„æ—¥å¿—æ¡†æ¶ SLF4Jï¼ˆè¿™ä¸ªä¹Ÿæ˜¯æŠ½è±¡å±‚ï¼‰ï¼Œå³ç®€å•æ—¥å¿—é—¨é¢ï¼ˆSimple Logging Facade for Javaï¼‰ï¼Œå¹¶ä¸º SLF4J å®ç°äº†ä¸€ä¸ªäº²å„¿å­â€”â€”logbackï¼Œç¡®å®æ›´åŠ ä¼˜é›…äº†ã€‚</p><p>æœ€åï¼ŒCeki GÃ¼lcÃ¼ è§‰å¾—è¿˜æ˜¯å¾—ç…§é¡¾ä¸‹è‡ªå·±çš„ â€œå¤§å„¿å­â€â€”â€”Log4jï¼ŒåˆæŠŠ Log4j è¿›è¡Œäº†æ”¹é€ ï¼Œå°±æ˜¯æ‰€è°“çš„ Log4j2ï¼ŒåŒæ—¶æ”¯æŒ JCL ä»¥åŠ SLF4Jã€‚</p><p>SLF4J çš„å‡ºç°ï¼Œåˆä½¿ Java æ—¥å¿—ä½“ç³»å˜å¾—æ··ä¹±èµ·æ¥ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€å¼ ç›®å‰ Java æ—¥å¿—ä½“ç³»çš„ç¤ºæ„å›¾ï¼š</p><p><a href="https://pic3.zhimg.com/v2-1d6add0536d2266211f2569a84a681ae_r.jpg" class="gallery-item"><img src="https://pic3.zhimg.com/v2-1d6add0536d2266211f2569a84a681ae_r.jpg"></a></p><p>æ—¥å¿—åº“ Log4jï¼ŒJULï¼Œlogback æ˜¯äº’ç›¸ä¸å…¼å®¹çš„ï¼Œæ²¡æœ‰å…±åŒçš„ Interfaceï¼Œæ‰€ä»¥ commons-loggingã€SLF4J é€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼ŒæŠ½è±¡å‡ºæ¥ä¸€ä¸ªå…±åŒçš„æ¥å£ï¼Œç„¶åæ ¹æ®ä½¿ç”¨çš„å…·ä½“æ—¥å¿—æ¡†æ¶æ¥å®ç°æ—¥å¿—ã€‚</p><p>java common logging å’Œ SLF4J éƒ½æ˜¯æ—¥å¿—çš„æ¥å£ï¼Œä¾›ç”¨æˆ·ä½¿ç”¨ï¼Œè€Œæ²¡æœ‰æä¾›å®ç°ï¼ŒLog4jï¼ŒJULï¼Œlogback ç­‰ç­‰æ‰æ˜¯æ—¥å¿—çš„çœŸæ­£å®ç°ã€‚</p><p>å½“æˆ‘ä»¬è°ƒç”¨æ—¥å¿—æ¥å£æ—¶ï¼Œæ¥å£ä¼šè‡ªåŠ¨å¯»æ‰¾æ°å½“çš„å®ç°ï¼Œè¿”å›ä¸€ä¸ªåˆé€‚çš„å®ä¾‹ç»™æˆ‘ä»¬æœåŠ¡ã€‚è¿™äº›è¿‡ç¨‹éƒ½æ˜¯é€æ˜åŒ–çš„ï¼Œç”¨æˆ·ä¸éœ€è¦è¿›è¡Œä»»ä½•æ“ä½œã€‚</p><p>å·¥å…·å®˜æ–¹ç½‘ç«™ Log4j<a href="http://logging.apache.org/log4j/1.2">http://logging.apache.org/log4j/1.2</a>JCL<a href="http://commons.apache.org/proper/commons-logging/">http://commons.apache.org/proper/commons-logging/</a>SLF4J<a href="http://www.slf4j.org/">http://www.slf4j.org</a>logback<a href="http://logback.qos.ch/">http://logback.qos.ch</a>Log4j2<a href="https://logging.apache.org/log4j/2.x/">https://logging.apache.org/log4j/2.x/</a></p><h2 id="å››ã€ä½¿ç”¨ä¸åŒæ¡†æ¶çš„-Java-æ—¥å¿—ç¤ºä¾‹è¯´æ˜"><a href="#å››ã€ä½¿ç”¨ä¸åŒæ¡†æ¶çš„-Java-æ—¥å¿—ç¤ºä¾‹è¯´æ˜" class="headerlink" title="å››ã€ä½¿ç”¨ä¸åŒæ¡†æ¶çš„ Java æ—¥å¿—ç¤ºä¾‹è¯´æ˜"></a>å››ã€ä½¿ç”¨ä¸åŒæ¡†æ¶çš„ Java æ—¥å¿—ç¤ºä¾‹è¯´æ˜</h2><h3 id="1-Log4j"><a href="#1-Log4j" class="headerlink" title="1. Log4j"></a>1. Log4j</h3><h3 id="Log4j-ä»‹ç»"><a href="#Log4j-ä»‹ç»" class="headerlink" title="Log4j ä»‹ç»"></a><strong>Log4j ä»‹ç»</strong></h3><p>Log4jï¼ˆlog for javaï¼‰æ˜¯ Apache çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œé€šè¿‡ä½¿ç”¨ Log4jï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ã€ä¹Ÿå¯ä»¥æ§åˆ¶æ¯ä¸€æ¡æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ï¼›é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚è¿™äº›å¯ä»¥é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºçš„ä»£ç ã€‚</p><h3 id="Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜"><a href="#Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜" class="headerlink" title="Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜"></a><strong>Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜</strong></h3><p><strong>ï¼ˆ1ï¼‰é€‰æ‹© jar åŒ…</strong></p><p>åŠ å…¥ log4j-1.2.17.jar åˆ° Libraries ä¸‹ï¼Œå¦‚æœä½¿ç”¨ maven é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©åœ¨ pom.xml ä¸­æ–°å¢ä¾èµ–å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰log4j.properties é…ç½®</strong></p><p>Log4j æœ‰ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼šè®°å½•å™¨ï¼Œ appender å’Œå¸ƒå±€ã€‚è¿™ä¸‰ç§ç±»å‹çš„ç»„ä»¶ååŒå·¥ä½œï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ ¹æ®æ¶ˆæ¯ç±»å‹å’Œçº§åˆ«è®°å½•æ¶ˆæ¯ï¼Œå¹¶åœ¨è¿è¡Œæ—¶æ§åˆ¶è¿™äº›æ¶ˆæ¯çš„æ ¼å¼å’ŒæŠ¥å‘Šä½ç½®ã€‚</p><p>Log4j å»ºè®®åªä½¿ç”¨å››ä¸ªçº§åˆ«ï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯ ERRORã€WARNã€INFOã€DEBUGã€‚</p><p>æ¯”å¦‚å®šä¹‰äº† INFO çº§åˆ«ï¼Œåªæœ‰ç­‰äºåŠé«˜äºè¿™ä¸ªçº§åˆ«çš„æ‰è¿›è¡Œå¤„ç†ï¼Œåˆ™åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰ DEBUG çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯å°†ä¸è¢«æ‰“å°å‡ºæ¥ã€‚ALLï¼Œæ‰“å°æ‰€æœ‰çš„æ—¥å¿—ï¼›OFFï¼Œå…³é—­æ‰€æœ‰çš„æ—¥å¿—è¾“å‡ºã€‚</p><p>appenderNameï¼Œå°±æ˜¯æŒ‡å®šæ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°å“ªä¸ªåœ°æ–¹ã€‚å¯åŒæ—¶æŒ‡å®šå¤šä¸ªè¾“å‡ºç›®çš„åœ°ã€‚</p><p>åœ¨ src æ ¹ç›®å½•ä¸‹å»ºç«‹ log4j.propertiesï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œç›¸åº”çš„ä¿®æ”¹å…¶ä¸­çš„é…ç½®ï¼Œå…¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#é…ç½®æ ¹Logger</span><span class="token comment">    #æ”¹ä»£ç è¡¨ç¤ºè¾“è¾“å‡ºinfoçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—ï¼Œæ–‡ä»¶åˆ†åˆ«è¾“å‡ºï¼Œä¸€ä¸ªæ˜¯fileï¼Œä¸€ä¸ªæ˜¯error</span><span class="token key attr-name">    log4j.rootLogger</span><span class="token punctuation">=</span><span class="token value attr-value">info,file,error</span><span class="token comment">    #é…ç½®fileæ—¥å¿—ä¿¡æ¯è¾“å‡ºç›®çš„åœ°Appender</span><span class="token comment">    #å®šä¹‰åä¸ºfileçš„è¾“å‡ºç«¯æ˜¯æ¯å¤©äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶</span><span class="token key attr-name">    log4j.appender.file</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.DailyRollingFileAppender</span><span class="token comment">    #æŒ‡å®šæ—¥å¿—ä¿¡æ¯çš„æœ€ä½è¾“å‡ºçº§åˆ«ä½INFOï¼Œé»˜è®¤ä¸ºDEBUGã€‚</span><span class="token key attr-name">    log4j.appender.file.Threshold</span><span class="token punctuation">=</span><span class="token value attr-value">INFO</span><span class="token comment">    #æŒ‡å®šå½“å‰æ¶ˆæ¯è¾“å‡ºåˆ°jpm/log4j/log.logæ–‡ä»¶ä¸­</span><span class="token key attr-name">    log4j.appender.file.File</span><span class="token punctuation">=</span><span class="token value attr-value">/jpm/log4j/log.log</span><span class="token comment">    #æŒ‡å®šæŒ‰å¤©æ¥æ»šåŠ¨æ—¥å¿—æ–‡ä»¶</span><span class="token key attr-name">    log4j.appender.file.DatePattern</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM-dd</span><span class="token comment">    #é…ç½®æ—¥å¿—ä¿¡æ¯çš„æ ¼å¼ï¼ˆå¸ƒå±€ï¼‰Layoutæ˜¯å¯ä»¥çµæ´»åœ°æŒ‡å®šå¸ƒå±€æ¨¡å¼</span><span class="token key attr-name">    log4j.appender.file.layout</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.PatternLayout</span><span class="token comment">    #æ ¼å¼åŒ–æ—¥å¿—ï¼ŒLog4jé‡‡ç”¨ç±»ä¼¼Cè¯­è¨€ä¸­çš„printfå‡½æ•°çš„æ‰“å°æ ¼å¼æ ¼å¼åŒ–æ—¥å¿—ä¿¡æ¯</span><span class="token key attr-name">    log4j.appender.file.layout.ConversionPattern</span><span class="token punctuation">=</span><span class="token value attr-value">[%d&#123;yyyy-MM-ddHH:mm:ss&#125;][%-5p][jpm-%c&#123;1&#125;-%M(%L)]-%m%n</span><span class="token comment">    #æŒ‡å®šè¾“å‡ºä¿¡æ¯çš„ç¼–ç </span><span class="token key attr-name">    log4j.appender.file.encoding</span><span class="token punctuation">=</span><span class="token value attr-value">UTF-8</span><span class="token comment">    #é…ç½®erroræ—¥å¿—ä¿¡æ¯è¾“å‡ºç›®çš„åœ°Appender</span><span class="token comment">    #å®šä¹‰åä¸ºerrorçš„è¾“å‡ºç«¯æ˜¯æ¯å¤©äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶</span><span class="token key attr-name">    log4j.appender.error</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.DailyRollingFileAppender</span><span class="token comment">    #æŒ‡å®šæ—¥å¿—ä¿¡æ¯çš„æœ€ä½è¾“å‡ºçº§åˆ«ä½ERRORï¼Œé»˜è®¤ä¸ºDEBUGã€‚</span><span class="token key attr-name">    log4j.appender.error.Threshold</span><span class="token punctuation">=</span><span class="token value attr-value">ERROR</span><span class="token comment">    #æŒ‡å®šå½“å‰æ¶ˆæ¯è¾“å‡ºåˆ°jpm/log4j/error.logæ–‡ä»¶ä¸­</span><span class="token key attr-name">    log4j.appender.error.File</span><span class="token punctuation">=</span><span class="token value attr-value">/jpm/log4j/error.log</span><span class="token comment">    #æŒ‡å®šæŒ‰æœˆæ¥æ»šåŠ¨æ—¥å¿—æ–‡ä»¶</span><span class="token key attr-name">    log4j.appender.error.DatePattern</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM</span><span class="token comment">    #é…ç½®æ—¥å¿—ä¿¡æ¯çš„æ ¼å¼ï¼ˆå¸ƒå±€ï¼‰Layoutæ˜¯å¯ä»¥çµæ´»åœ°æŒ‡å®šå¸ƒå±€æ¨¡å¼</span><span class="token key attr-name">    log4j.appender.error.layout</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.PatternLayout</span><span class="token comment">    #æ ¼å¼åŒ–æ—¥å¿—ï¼ŒLog4jé‡‡ç”¨ç±»ä¼¼Cè¯­è¨€ä¸­çš„printfå‡½æ•°çš„æ‰“å°æ ¼å¼æ ¼å¼åŒ–æ—¥å¿—ä¿¡æ¯</span><span class="token key attr-name">    log4j.appender.error.layout.ConversionPattern</span><span class="token punctuation">=</span><span class="token value attr-value">[%d&#123;yyyy-MM-ddHH:mm:ss&#125;][%-5p][jpm-%c&#123;1&#125;-%M(%L)]-%m%n</span><span class="token comment">    #æŒ‡å®šè¾“å‡ºä¿¡æ¯çš„ç¼–ç </span><span class="token key attr-name">    log4j.appender.error.encoding</span><span class="token punctuation">=</span><span class="token value attr-value">UTF-8</span><span class="token comment">    #ä½¿æŸä¸ªåŠŸèƒ½çš„æ—¥å¿—å•ç‹¬è¾“å‡ºåˆ°æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶</span><span class="token key attr-name">    log4j.logger.saveUserLog</span><span class="token punctuation">=</span><span class="token value attr-value">INFO,saveUserLog</span><span class="token comment">    #è¯¥é…ç½®å°±æ˜¯è®©jobçš„æ—¥å¿—åªè¾“å‡ºåˆ°è‡ªå·±æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶ä¸­,è¡¨ç¤ºLoggerä¸ä¼šåœ¨çˆ¶Loggerçš„appenderé‡Œè¾“å‡ºï¼Œé»˜è®¤ä¸ºtrueã€‚</span><span class="token key attr-name">    log4j.additivity.saveUserLog</span><span class="token punctuation">=</span><span class="token value attr-value">false</span><span class="token key attr-name">    log4j.appender.saveUserLog</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.DailyRollingFileAppender</span><span class="token key attr-name">    log4j.appender.saveUserLog.File</span><span class="token punctuation">=</span><span class="token value attr-value">/jpm/log4j/saveUserLog.log</span><span class="token key attr-name">    log4j.appender.saveUserLog.DatePattern</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM-dd</span><span class="token key attr-name">    log4j.appender.saveUserLog.Append</span><span class="token punctuation">=</span><span class="token value attr-value">true</span><span class="token key attr-name">    log4j.appender.saveUserLog.layout</span><span class="token punctuation">=</span><span class="token value attr-value">org.apache.log4j.PatternLayout</span><span class="token key attr-name">    log4j.appender.saveUserLog.layout.ConversionPattern</span><span class="token punctuation">=</span><span class="token value attr-value">%m%n</span><span class="token key attr-name">    log4j.appender.error.encoding</span><span class="token punctuation">=</span><span class="token value attr-value">UTF-8</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ3ï¼‰è¾“å‡ºæ—¥å¿—çš„ä»£ç ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">jpm</span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLog4j</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">TestLog4j</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">final</span> <span class="token class-name">Logger</span> saveUserLog <span class="token operator">=</span> <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">"saveUserLog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            saveUserLog<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰,ç”·,26å²,åŒ—äº¬å¤§å­¦,2018-05-19,å­¦éœ¸"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ4ï¼‰ä»¥ä¸Šä»£ç ç¤ºä¾‹ç”Ÿæˆçš„æ—¥å¿—æ–‡ä»¶åŠæ—¥å¿—è¯¦æƒ…</strong></p><p><a href="https://pic1.zhimg.com/v2-a8903ca4a3d5f97a1d696998fc00e150_b.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-a8903ca4a3d5f97a1d696998fc00e150_b.jpg"></a><a href="https://pic1.zhimg.com/v2-28c0f94b7a08b1d3526714e7f53f83c4_r.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-28c0f94b7a08b1d3526714e7f53f83c4_r.jpg"></a></p><h3 id="2-JULï¼ˆåœ¨-java-util-logging-åŒ…ä¸‹ï¼‰ä½¿ç”¨ç¤ºä¾‹"><a href="#2-JULï¼ˆåœ¨-java-util-logging-åŒ…ä¸‹ï¼‰ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="2. JULï¼ˆåœ¨ java.util.logging åŒ…ä¸‹ï¼‰ä½¿ç”¨ç¤ºä¾‹"></a>2. JULï¼ˆåœ¨ java.util.logging åŒ…ä¸‹ï¼‰ä½¿ç”¨ç¤ºä¾‹</h3><h3 id="JUL-ä»‹ç»"><a href="#JUL-ä»‹ç»" class="headerlink" title="JUL ä»‹ç»"></a><strong>JUL ä»‹ç»</strong></h3><p>Java Logging API æ˜¯ Sun å…¬å¸äº 2002 å¹´ 5 æœˆæ­£å¼å‘å¸ƒçš„ã€‚å®ƒæ˜¯è‡ª J2SE 1.4 ç‰ˆæœ¬å¼€å§‹æä¾›çš„ä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åºæ¥å£ï¼Œéœ€ JDK1.4 ç‰ˆæœ¬ä»¥ä¸Šæ‰èƒ½æ”¯æŒï¼Œjava.util.logging.* åŒ…æ˜¯ JDK çš„æ—¥å¿—è®°å½• APIã€‚</p><p><a href="https://pic2.zhimg.com/v2-66266d98c49b4d310d53694cfdc74b01_r.jpg" class="gallery-item"><img src="https://pic2.zhimg.com/v2-66266d98c49b4d310d53694cfdc74b01_r.jpg"></a></p><p><strong>å¼ºçƒˆä¸æ¨èä½¿ç”¨ java.util.logging è®°å½•æ—¥å¿—ï¼Œå› æ­¤è¿™é‡Œä¸æä¾›å¯¹åº”ç¤ºä¾‹ç»™å¤§å®¶ã€‚</strong></p><h3 id="3-java-common-logging-ä»‹ç»"><a href="#3-java-common-logging-ä»‹ç»" class="headerlink" title="3. java common logging ä»‹ç»"></a>3. java common logging ä»‹ç»</h3><p>commons-logging æä¾›çš„æ˜¯ä¸€ä¸ªæ—¥å¿—æ¥å£ï¼Œæ˜¯ä¸ºé‚£äº›éœ€è¦å»ºç«‹åœ¨ä¸åŒç¯å¢ƒä¸‹ä½¿ç”¨ä¸åŒæ—¥å¿—æ¶æ„çš„ç»„ä»¶æˆ–åº“çš„å¼€å‘è€…åˆ›å»ºçš„ï¼Œå…¶ä¸­åŒ…æ‹¬ log4j ä»¥åŠ Java log çš„æ—¥å¿—æ¶æ„ã€‚commons-logging æœ‰ä¸¤ä¸ªåŸºæœ¬çš„æŠ½è±¡ç±»ï¼šLog(åŸºæœ¬è®°å½•å™¨) å’Œ <code>LogFactory</code>(è´Ÿè´£åˆ›å»º Log å®ä¾‹)ã€‚æŠŠæ—¥å¿—ä¿¡æ¯æŠ½è±¡æˆ commons-logging çš„ Log æ¥å£ï¼Œå¹¶ç”± commons-logging åœ¨è¿è¡Œæ—¶å†³å®šä½¿ç”¨å“ªç§æ—¥å¿—æ¶æ„ã€‚å› ä¸º Log4j çš„å¼ºå¤§åŠŸèƒ½ï¼Œcommons-logging ä¸€èˆ¬ä¼šå’Œ Log4j ä¸€èµ·ä½¿ç”¨ï¼Œè¿™å‡ ä¹æˆä¸ºäº† Java æ—¥å¿—çš„æ ‡å‡†å·¥å…·ã€‚</p><h3 id="4-SLF4J-ä»‹ç»"><a href="#4-SLF4J-ä»‹ç»" class="headerlink" title="4. SLF4J ä»‹ç»"></a>4. SLF4J ä»‹ç»</h3><p>SLF4J å…¨ç§°ä¸º Simple Logging Facade for JAVAï¼Œå³ java ç®€å•æ—¥å¿—é—¨é¢ã€‚ å’Œ commons-loging ä¸€æ ·ä¹Ÿæ˜¯å¯¹ä¸åŒæ—¥å¿—æ¡†æ¶æä¾›çš„ä¸€ä¸ªé—¨é¢å°è£…ï¼Œå¯ä»¥åœ¨éƒ¨ç½²çš„æ—¶å€™ä¸ä¿®æ”¹ä»»ä½•é…ç½®å³å¯æ¥å…¥ä¸€ç§æ—¥å¿—å®ç°æ–¹æ¡ˆï¼Œèƒ½æ”¯æŒå¤šä¸ªå‚æ•°ï¼Œå¹¶é€šè¿‡ {} å ä½ç¬¦è¿›è¡Œæ›¿æ¢ã€‚</p><p><strong>çœ‹è¿™ä¸ª Log4J ç¤ºä¾‹ï¼š</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”±äºå­—ç¬¦ä¸²æ‹¼æ¥çš„é—®é¢˜ï¼ˆæ³¨ï¼šä¸Šè¿°è¯­å¥ä¼šå…ˆæ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå†æ ¹æ®å½“å‰çº§åˆ«æ˜¯å¦ä½äº debug å†³å®šæ˜¯å¦è¾“å‡ºæœ¬æ¡æ—¥å¿—ï¼Œå³ä½¿ä¸è¾“å‡ºæ—¥å¿—ï¼Œå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œä¹Ÿä¼šæ‰§è¡Œï¼‰ï¼Œå› æ­¤è®¸å¤šå…¬å¸ä¸€èˆ¬å¼ºåˆ¶ä½¿ç”¨ä¸‹é¢çš„è¯­å¥ï¼Œè¿™æ ·åªæœ‰å½“å‰å¤„äº DEBUG çº§åˆ«æ—¶æ‰ä¼šæ‰§è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>â€œ<span class="token class-name">Hello</span> â€ <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å®ƒé¿å…äº†å­—ç¬¦ä¸²æ‹¼æ¥é—®é¢˜ï¼Œå¯æ˜¯æœ‰ç‚¹å¤ªç¹çäº†ã€‚è€Œ SLF4J æä¾›ä¸‹é¢è¿™æ ·ç®€å•çš„è¯­æ³•:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Hello &#123;&#125;"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®ƒçš„å½¢å¼ç±»ä¼¼ç¬¬ä¸€æ¡ç¤ºä¾‹ï¼Œä½†æ˜¯åˆæ²¡æœ‰å­—ç¬¦ä¸²æ‹¼æ¥é—®é¢˜ï¼Œä¹Ÿä¸åƒç¬¬äºŒæ¡é‚£æ ·ç¹çã€‚</p><p>æ­£æ˜¯å› ä¸º SLF4J çš„è¿™ä¸ªå ä½ç¬¦åŠŸèƒ½ï¼Œä½¿å¾—äººä»¬è¶Šæ¥è¶Šå¤šçš„ä½¿ç”¨ SLF4J è¿™ä¸ªæ¥å£ç”¨åˆ°å®é™…å¼€å‘é¡¹ç›®ä¸­ã€‚</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ—¥å¿—æ¥å£ï¼Œç›´æ¥ä½¿ç”¨å…·ä½“çš„å®ç°ä¸å°±è¡Œäº†å—ï¼Ÿ</strong></p><p>æ¥å£ç”¨äºå®šåˆ¶è§„èŒƒï¼Œå¯ä»¥æœ‰å¤šä¸ªå®ç°ï¼Œä½¿ç”¨æ—¶æ˜¯é¢å‘æ¥å£çš„ï¼ˆå¯¼å…¥çš„åŒ…éƒ½æ˜¯ SLF4J çš„åŒ…æˆ–è€…æ˜¯ JCL çš„åŒ…ï¼Œè€Œä¸æ˜¯å…·ä½“æŸä¸ªæ—¥å¿—æ¡†æ¶ä¸­çš„åŒ…ï¼‰ï¼Œå³ç›´æ¥å’Œæ¥å£äº¤äº’ï¼Œä¸ç›´æ¥ä½¿ç”¨å®ç°ï¼Œæ‰€ä»¥å½“éœ€è¦æ›´æ¢å®ç°çš„æ—¶å€™ï¼Œç›´æ¥æ›´æ¢å®å°±å¯ä»¥äº†ï¼Œè€Œä¸ç”¨æ›´æ”¹ä»£ç ä¸­çš„æ—¥å¿—ç›¸å…³ä»£ç ã€‚</p><p>æ¯”å¦‚ï¼šSLF4J å®šä¹‰äº†ä¸€å¥—æ—¥å¿—æ¥å£ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„æ—¥å¿—æ¡†æ¶æ˜¯ log4jï¼Œå¼€å‘ä¸­è°ƒç”¨çš„æ‰€æœ‰æ¥å£éƒ½æ˜¯ SLF4J çš„ï¼Œä¸ç›´æ¥ä½¿ç”¨ log4jï¼Œé¡¹ç›®åº”ç”¨è°ƒç”¨ SLF4J çš„æ¥å£ï¼ŒSLF4J çš„æ¥å£å»è°ƒç”¨ log4j çš„å®ç°ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºå¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ log4jï¼Œå½“é¡¹ç›®éœ€è¦æ›´æ¢æ›´åŠ ä¼˜ç§€çš„æ—¥å¿—æ¡†æ¶æ—¶ï¼ˆå¦‚ logbackï¼‰åªéœ€è¦å¼•å…¥ logback çš„ jar å’Œ logback å¯¹åº”çš„é…ç½®æ–‡ä»¶å³å¯ï¼Œå®Œå…¨ä¸ç”¨æ›´æ”¹ Java ä»£ç ä¸­çš„æ—¥å¿—ç›¸å…³çš„ä»£ç  <a href="http://logger.info/">http://logger.info</a>(â€œhello worldâ€)ï¼Œä¹Ÿä¸ç”¨ä¿®æ”¹æ—¥å¿—ç›¸å…³çš„ç±»çš„å¯¼å…¥çš„åŒ…ï¼ˆimport org.slf4j.Logger; import org.slf4j.LoggerFactory;ï¼‰ã€‚</p><p>å› æ­¤æ—¥å¿—é—¨é¢çš„ä½¿ç”¨ï¼Œä¸ºåç»­å…·ä½“æ—¥å¿—ç³»ç»Ÿçš„å®ç°æ›´æ¢å¸¦æ¥äº†æ–¹ä¾¿ã€‚</p><h3 id="5-logback-ä½¿ç”¨ç¤ºä¾‹"><a href="#5-logback-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="5. logback ä½¿ç”¨ç¤ºä¾‹"></a>5. logback ä½¿ç”¨ç¤ºä¾‹</h3><h3 id="LogBack-ä»‹ç»"><a href="#LogBack-ä»‹ç»" class="headerlink" title="LogBack ä»‹ç»"></a><strong>LogBack ä»‹ç»</strong></h3><p><code>LogBack</code> å’Œ Log4j éƒ½æ˜¯å¼€æºæ—¥è®°å·¥å…·åº“ï¼Œ<code>LogBack</code> æ˜¯ Log4j çš„æ”¹è‰¯ç‰ˆæœ¬ï¼Œæ¯” Log4j æ‹¥æœ‰æ›´å¤šçš„ç‰¹æ€§ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥å¾ˆå¤§æ€§èƒ½æå‡ã€‚<code>LogBack</code> å®˜æ–¹å»ºè®®é…åˆ Slf4j ä½¿ç”¨ï¼Œè¿™æ ·å¯ä»¥çµæ´»åœ°æ›¿æ¢åº•å±‚æ—¥å¿—æ¡†æ¶ã€‚</p><p><code>Logback</code> ä¸»è¦ç”±ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼š</p><ul><li>  logback-core</li><li>  logback-classic</li><li>  logback-access</li></ul><p>å…¶ä¸­ logback-core æä¾›äº† LogBack çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯å¦å¤–ä¸¤ä¸ªç»„ä»¶çš„åŸºç¡€ã€‚logback-classic çš„åœ°ä½å’Œä½œç”¨ç­‰åŒäº Log4Jï¼Œå®ƒä¹Ÿè¢«è®¤ä¸ºæ˜¯ Log4J çš„ä¸€ä¸ªæ”¹è¿›ç‰ˆï¼Œå¹¶ä¸”å®ƒå®ç°äº†ç®€å•æ—¥å¿—é—¨é¢ SLF4Jï¼Œæ‰€ä»¥å½“æƒ³é…åˆ SLF4J ä½¿ç”¨æ—¶ï¼Œéœ€è¦å°† logback-classic åŠ å…¥ classpathï¼›è€Œ logback-access ä¸»è¦ä½œä¸ºä¸€ä¸ªä¸ Servlet å®¹å™¨äº¤äº’çš„æ¨¡å—ï¼Œæ¯”å¦‚è¯´ tomcat æˆ–è€… jettyï¼Œæä¾›ä¸€äº›ä¸ HTTP è®¿é—®ç›¸å…³çš„åŠŸèƒ½ã€‚</p><h3 id="logback-ä½¿ç”¨æ­¥éª¤è¯´æ˜"><a href="#logback-ä½¿ç”¨æ­¥éª¤è¯´æ˜" class="headerlink" title="logback ä½¿ç”¨æ­¥éª¤è¯´æ˜"></a><strong>logback ä½¿ç”¨æ­¥éª¤è¯´æ˜</strong></h3><p><strong>ï¼ˆ1ï¼‰é€‰æ‹© jar åŒ…</strong></p><p>æƒ³åœ¨ Java ç¨‹åºä¸­ä½¿ç”¨ Logbackï¼Œéœ€è¦ä¾èµ–ä¸‰ä¸ª jar åŒ…ï¼Œåˆ†åˆ«æ˜¯ slf4j-apiï¼Œlogback-coreï¼Œlogback-classicã€‚å…¶ä¸­ slf4j-api å¹¶ä¸æ˜¯ Logback çš„ä¸€éƒ¨åˆ†ï¼Œå»ºè®®å°† SLF4J ä¸ Logback ç»“åˆä½¿ç”¨ã€‚</p><p><strong>pom.xml</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>logback-access<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰logback.xml</strong></p><p>åœ¨ src æ ¹ç›®å½•ä¸‹å»ºç«‹ logback.xmlï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œç›¸åº”çš„ä¿®æ”¹å…¶ä¸­çš„é…ç½®ï¼Œå…¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>    <span class="token comment">&lt;!--æ—¥å¿—çº§åˆ«ä»¥åŠä¼˜å…ˆçº§æ’åº: OFF > FATAL > ERROR > WARN > INFO > DEBUG > TRACE > ALL --></span>    <span class="token comment">&lt;!-- statusç”¨æ¥æŒ‡å®šlog4jæœ¬èº«çš„æ‰“å°æ—¥å¿—çš„çº§åˆ« --></span>    <span class="token comment">&lt;!--monitorIntervalï¼šLog4jèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ä¿®æ”¹é…ç½®æ–‡ä»¶å’Œé‡æ–°é…ç½®æœ¬èº«ï¼Œè®¾ç½®é—´éš”ç§’æ•° --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>WARN<span class="token punctuation">"</span></span> <span class="token attr-name">monitorInterval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--å…ˆå®šä¹‰æ‰€æœ‰çš„appender --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appenders</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿™ä¸ªè¾“å‡ºæ§åˆ¶å°çš„é…ç½® --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>console</span> <span class="token punctuation">></span></span>                <span class="token comment">&lt;!--è¾“å‡ºæ—¥å¿—çš„æ ¼å¼ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>console</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--å®šä¹‰è¾“å‡ºåˆ°æŒ‡å®šä½ç½®çš„æ–‡ä»¶ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span> <span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- è¿™ä¸ªä¼šæ‰“å°å‡ºæ‰€æœ‰çš„infoåŠä»¥ä¸‹çº§åˆ«çš„ä¿¡æ¯ï¼Œæ¯æ¬¡å¤§å°è¶…è¿‡sizeï¼Œåˆ™è¿™sizeå¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰å¹´ä»½-æœˆä»½å»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©ï¼Œä½œä¸ºå­˜æ¡£ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span>                 <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/jpm/log4j2/logs/$$&#123;date:yyyy-MM&#125;/info-%d&#123;yyyy-MM-dd&#125;-%i.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!--æ§åˆ¶å°åªè¾“å‡ºlevelåŠä»¥ä¸Šçº§åˆ«çš„ä¿¡æ¯ï¼ˆonMatchï¼‰ï¼Œå…¶ä»–çš„ç›´æ¥æ‹’ç»ï¼ˆonMismatchï¼‰ --></span>                <span class="token comment">&lt;!-- DENYï¼Œæ—¥å¿—å°†ç«‹å³è¢«æŠ›å¼ƒä¸å†ç»è¿‡å…¶ä»–è¿‡æ»¤å™¨ï¼› NEUTRALï¼Œæœ‰åºåˆ—è¡¨é‡Œçš„ä¸‹ä¸ªè¿‡æ»¤å™¨è¿‡æ¥ç€å¤„ç†æ—¥å¿—ï¼› ACCEPTï¼Œæ—¥å¿—ä¼šè¢«ç«‹å³å¤„ç†ï¼Œä¸å†ç»è¿‡å‰©ä½™è¿‡æ»¤å™¨ã€‚ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DENY<span class="token punctuation">"</span></span>                    <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACCEPT<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token punctuation">/></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100 MB<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹7ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®äº†30 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span>                 <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/jpm/log4j2/logs/$$&#123;date:yyyy-MM&#125;/error-%d&#123;yyyy-MM-dd&#125;-%i.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ERROR<span class="token punctuation">"</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACCEPT<span class="token punctuation">"</span></span>                    <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DENY<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token punctuation">/></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100 MB<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appenders</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--åªæœ‰å®šä¹‰äº†loggerå¹¶å¼•å…¥çš„appenderï¼Œappenderæ‰ä¼šç”Ÿæ•ˆ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>loggers</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤æ‰springå’Œmybatisçš„ä¸€äº›æ— ç”¨çš„DEBUGä¿¡æ¯ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFileInfo<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFileError<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>loggers</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ3ï¼‰è¾“å‡ºæ—¥å¿—çš„ä»£ç ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">jpm<span class="token punctuation">.</span>logback</span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLogback</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">TestLogback</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"print debug log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"print info log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"print error log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ4ï¼‰æ‰“å°æ—¥å¿—ç»“æœ</strong></p><p><a href="https://pic3.zhimg.com/v2-e5cf7e342e2821235428d3f1c33a7cd2_b.jpg" class="gallery-item"><img src="https://pic3.zhimg.com/v2-e5cf7e342e2821235428d3f1c33a7cd2_b.jpg"></a><a href="https://pic3.zhimg.com/v2-9c2ceb4f73b1771b0fde829117e9d33a_r.jpg" class="gallery-item"><img src="https://pic3.zhimg.com/v2-9c2ceb4f73b1771b0fde829117e9d33a_r.jpg"></a></p><p><strong>ä¸Šä¾‹ä½¿ç”¨ SLF4J åšæ—¥å¿—æ¥å£ï¼Œ logback åšæ—¥å¿—å®ç°çš„æ—¥å¿—ç¤ºä¾‹</strong></p><h3 id="6-Log4j2-ä½¿ç”¨ç¤ºä¾‹"><a href="#6-Log4j2-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="6. Log4j2 ä½¿ç”¨ç¤ºä¾‹"></a>6. Log4j2 ä½¿ç”¨ç¤ºä¾‹</h3><h3 id="Log4j2-ä»‹ç»"><a href="#Log4j2-ä»‹ç»" class="headerlink" title="Log4j2 ä»‹ç»"></a><strong>Log4j2 ä»‹ç»</strong></h3><p>Apache Log4j 2 æ˜¯å¯¹ Log4j çš„å‡çº§ï¼Œä¸å…¶å‰èº« Log4j 1.x ç›¸æ¯”æœ‰äº†æ˜¾ç€çš„æ”¹è¿›ï¼Œå¹¶æä¾›äº†è®¸å¤š Logback å¯ç”¨çš„æ”¹è¿›ï¼ŒåŒæ—¶æ”¯æŒ JCL ä»¥åŠ SLF4Jã€‚</p><h3 id="Log4j2-ä½¿ç”¨æ­¥éª¤è¯´æ˜"><a href="#Log4j2-ä½¿ç”¨æ­¥éª¤è¯´æ˜" class="headerlink" title="Log4j2 ä½¿ç”¨æ­¥éª¤è¯´æ˜"></a><strong>Log4j2 ä½¿ç”¨æ­¥éª¤è¯´æ˜</strong></h3><p><strong>ï¼ˆ1ï¼‰é€‰æ‹© jar åŒ…</strong></p><p>å¼•å…¥ Log4j2 å¿…è¦çš„åŒ…ï¼šlog4j-apiã€log4j-coreã€‚</p><p><strong>pom.xml é…ç½®</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰log2j é…ç½®æ–‡ä»¶ï¼šlog4j2.xml</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>    <span class="token comment">&lt;!--æ—¥å¿—çº§åˆ«ä»¥åŠä¼˜å…ˆçº§æ’åº: OFF > FATAL > ERROR > WARN > INFO > DEBUG > TRACE > ALL --></span>    <span class="token comment">&lt;!-- statusç”¨æ¥æŒ‡å®šLog4jæœ¬èº«çš„æ‰“å°æ—¥å¿—çš„çº§åˆ« --></span>    <span class="token comment">&lt;!--monitorIntervalï¼šLog4jèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ä¿®æ”¹é…ç½®æ–‡ä»¶å’Œé‡æ–°é…ç½®æœ¬èº«ï¼Œè®¾ç½®é—´éš”ç§’æ•° --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>WARN<span class="token punctuation">"</span></span> <span class="token attr-name">monitorInterval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--å…ˆå®šä¹‰æ‰€æœ‰çš„appender --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appenders</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿™ä¸ªè¾“å‡ºæ§åˆ¶å°çš„é…ç½® --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>console</span> <span class="token punctuation">></span></span>                <span class="token comment">&lt;!--è¾“å‡ºæ—¥å¿—çš„æ ¼å¼ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>console</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--å®šä¹‰è¾“å‡ºåˆ°æŒ‡å®šä½ç½®çš„æ–‡ä»¶ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span> <span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- è¿™ä¸ªä¼šæ‰“å°å‡ºæ‰€æœ‰çš„infoåŠä»¥ä¸‹çº§åˆ«çš„ä¿¡æ¯ï¼Œæ¯æ¬¡å¤§å°è¶…è¿‡sizeï¼Œåˆ™è¿™sizeå¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰å¹´ä»½-æœˆä»½å»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©ï¼Œä½œä¸ºå­˜æ¡£ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span>                 <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/jpm/log4j2/logs/$$&#123;date:yyyy-MM&#125;/info-%d&#123;yyyy-MM-dd&#125;-%i.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!--æ§åˆ¶å°åªè¾“å‡ºlevelåŠä»¥ä¸Šçº§åˆ«çš„ä¿¡æ¯ï¼ˆonMatchï¼‰ï¼Œå…¶ä»–çš„ç›´æ¥æ‹’ç»ï¼ˆonMismatchï¼‰ --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACCEPT<span class="token punctuation">"</span></span>                    <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DENY<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token punctuation">/></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100 MB<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹7ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®äº†30 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span>                 <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/jpm/log4j2/logs/$$&#123;date:yyyy-MM&#125;/error-%d&#123;yyyy-MM-dd&#125;-%i.log<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACCEPT<span class="token punctuation">"</span></span>                    <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DENY<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span>                    <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l %logger&#123;36&#125; - %msg%n<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token punctuation">/></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100 MB<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appenders</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--åªæœ‰å®šä¹‰äº†loggerå¹¶å¼•å…¥çš„appenderï¼Œappenderæ‰ä¼šç”Ÿæ•ˆ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>loggers</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--è¿‡æ»¤æ‰springå’Œmybatisçš„ä¸€äº›æ— ç”¨çš„DEBUGä¿¡æ¯ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFileInfo<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFileError<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>loggers</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ3ï¼‰è¾“å‡ºæ—¥å¿—çš„ä»£ç ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">jpm<span class="token punctuation">.</span>log4j2</span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">LogManager</span></span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLog4j2</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LogManager</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">LogManager</span><span class="token punctuation">.</span><span class="token constant">ROOT_LOGGER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"TestLog4j2 debug log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"TestLog4j2 info log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestLog4j2 error log."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ4ï¼‰æ‰“å°æ—¥å¿—ç»“æœ</strong></p><p><a href="https://pic1.zhimg.com/v2-be11d8203d8c529c9a9020a05967bdf8_b.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-be11d8203d8c529c9a9020a05967bdf8_b.jpg"></a><a href="https://pic1.zhimg.com/v2-2f11d92ede4c1418d88ca05e481cf044_r.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-2f11d92ede4c1418d88ca05e481cf044_r.jpg"></a></p><p><strong>ï¼ˆ5ï¼‰å…³äºæ—¥å¿— level</strong></p><p>å…±æœ‰ 8 ä¸ªçº§åˆ«ï¼ŒæŒ‰ç…§ä»ä½åˆ°é«˜ä¸ºï¼šAll &lt; Trace &lt; Debug &lt; Info &lt; Warn &lt; Error &lt; Fatal &lt; OFFã€‚</p><ul><li>  <strong>Allï¼š</strong>æœ€ä½ç­‰çº§çš„ï¼Œç”¨äºæ‰“å¼€æ‰€æœ‰æ—¥å¿—è®°å½•</li><li>  <strong>Traceï¼š</strong>æ˜¯è¿½è¸ªï¼Œå°±æ˜¯ç¨‹åºæ¨è¿›ä»¥ä¸‹ï¼Œä½ å°±å¯ä»¥å†™ä¸ª trace è¾“å‡ºï¼Œæ‰€ä»¥ trace åº”è¯¥ä¼šç‰¹åˆ«å¤šï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æœ€ä½æ—¥å¿—çº§åˆ«ä¸è®©ä»–è¾“å‡º</li><li>  <strong>Debugï¼š</strong>æŒ‡å‡ºç»†ç²’åº¦ä¿¡æ¯äº‹ä»¶å¯¹è°ƒè¯•åº”ç”¨ç¨‹åºæ˜¯éå¸¸æœ‰å¸®åŠ©çš„</li><li>  <strong>Infoï¼š</strong>æ¶ˆæ¯åœ¨ç²—ç²’åº¦çº§åˆ«ä¸Šçªå‡ºå¼ºè°ƒåº”ç”¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹</li><li>  <strong>Warnï¼š</strong>è¾“å‡ºè­¦å‘ŠåŠ warn ä»¥ä¸‹çº§åˆ«çš„æ—¥å¿—</li><li>  <strong>Errorï¼š</strong>è¾“å‡ºé”™è¯¯ä¿¡æ¯æ—¥å¿—</li><li>  <strong>Fatalï¼š</strong>è¾“å‡ºæ¯ä¸ªä¸¥é‡çš„é”™è¯¯äº‹ä»¶å°†ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„é€€å‡ºçš„æ—¥å¿—</li><li>  <strong>OFFï¼š</strong>æœ€é«˜ç­‰çº§çš„ï¼Œç”¨äºå…³é—­æ‰€æœ‰æ—¥å¿—è®°å½•</li></ul><p>ç¨‹åºä¼šæ‰“å°é«˜äºæˆ–ç­‰äºæ‰€è®¾ç½®çº§åˆ«çš„æ—¥å¿—ï¼Œè®¾ç½®çš„æ—¥å¿—ç­‰çº§è¶Šé«˜ï¼Œæ‰“å°å‡ºæ¥çš„æ—¥å¿—å°±è¶Šå°‘ã€‚</p><h3 id="7-JCL-java-common-logging-Log4j-ä½¿ç”¨ç¤ºä¾‹"><a href="#7-JCL-java-common-logging-Log4j-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="7. JCL(java common logging) + Log4j ä½¿ç”¨ç¤ºä¾‹"></a>7. JCL(java common logging) + Log4j ä½¿ç”¨ç¤ºä¾‹</h3><h3 id="JCL-java-common-logging-Log4j-ä»‹ç»"><a href="#JCL-java-common-logging-Log4j-ä»‹ç»" class="headerlink" title="JCL(java common logging) + Log4j ä»‹ç»"></a><strong>JCL(java common logging) + Log4j ä»‹ç»</strong></h3><p>ä½¿ç”¨ commons-logging çš„ Log æ¥å£ï¼Œå¹¶ç”± commons-logging åœ¨è¿è¡Œæ—¶å†³å®šä½¿ç”¨å“ªç§æ—¥å¿—æ¶æ„ï¼ˆå¦‚ Log4jï¼‰ã€‚ç°åœ¨ï¼ŒApache é€šç”¨æ—¥å¿—å·¥å…· commons-logging å’Œ Log4j å·²ç»æˆä¸º Java æ—¥å¿—çš„æ ‡å‡†å·¥å…·ï¼Œè¿™ä¸ªç»„åˆæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªæ—¥å¿—æ¡†æ¶ç»„åˆã€‚</p><h3 id="JCL-java-common-logging-Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜"><a href="#JCL-java-common-logging-Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜" class="headerlink" title="JCL(java common logging) + Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜"></a><strong>JCL(java common logging) + Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜</strong></h3><p><strong>ï¼ˆ1ï¼‰é€‰æ‹© jar åŒ…</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">commons-logging-1.2 + log4j1.2.17<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>pom.xml</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰é…ç½® common-logging.properties æ–‡ä»¶</strong></p><p>åªéœ€è¦ä¸€è¡Œå³å¯ï¼Œæ”¾åœ¨ classpath ä¸‹ï¼Œå¦‚æœæ˜¯ Maven ä¸­å°±åœ¨ src/resources ä¸‹ï¼Œä¸è¿‡å¦‚æœæ²¡æœ‰ common-logging.properties æ–‡ä»¶ï¼Œä½†æ˜¯ src ä¸‹æœ‰ log4j.properties é…ç½®ä¹Ÿå¯ä»¥æ­£å¸¸çš„è¾“å‡º Log4j è®¾ç½®çš„æ—¥å¿—ã€‚</p><pre class="line-numbers language-none"><code class="language-none">org.apache.commons.logging.Log&#x3D;org.apache.commons.logging.impl.Log4JLogger<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ï¼ˆ3ï¼‰log4j.properties é…ç½®</strong></p><p>å‚è€ƒã€ŠLog4j ä½¿ç”¨æ­¥éª¤è¯´æ˜ã€‹</p><p><strong>ï¼ˆ4ï¼‰è¾“å‡ºæ—¥å¿—çš„ä»£ç ç¤ºä¾‹</strong></p><pre class="line-numbers language-none"><code class="language-none">package jpm.jcllog4j;    import org.apache.commons.logging.Log;    import org.apache.commons.logging.LogFactory;    public class TestJclAndLog4j &#123;        public static void main(String[] args) &#123;            final Log LOGGER &#x3D; LogFactory.getLog(TestJclAndLog4j.class);            LOGGER.debug(&quot;TestJclAndLog4j debug log.&quot;);            LOGGER.info(&quot;TestJclAndLog4j info log.&quot;);            LOGGER.error(&quot;TestJclAndLog4j error log.&quot;);        &#125;    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ5ï¼‰æ‰“å°æ—¥å¿—ç»“æœ</strong></p><p><a href="https://pic2.zhimg.com/v2-953e2376a2fac3d9af730ceb2ca40a81_b.jpg" class="gallery-item"><img src="https://pic2.zhimg.com/v2-953e2376a2fac3d9af730ceb2ca40a81_b.jpg"></a><a href="https://pic1.zhimg.com/v2-f3927da8d2998d641730acb45ca0cf0c_r.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-f3927da8d2998d641730acb45ca0cf0c_r.jpg"></a></p><h3 id="8-SLF4J-Log4j-ä½¿ç”¨ç¤ºä¾‹"><a href="#8-SLF4J-Log4j-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="8. SLF4J + Log4j ä½¿ç”¨ç¤ºä¾‹"></a>8. SLF4J + Log4j ä½¿ç”¨ç¤ºä¾‹</h3><h3 id="SLF4J-Log4j-ä»‹ç»"><a href="#SLF4J-Log4j-ä»‹ç»" class="headerlink" title="SLF4J + Log4j ä»‹ç»"></a><strong>SLF4J + Log4j ä»‹ç»</strong></h3><p>SLF4j+Log4j ä¸ JCL+Log4J çš„ä½¿ç”¨æ–¹å¼å·®ä¸å¤šï¼Œä¸»è¦å·®å¼‚å°±åœ¨ SLF4J ç”¨ ç”¨ç»‘å®šåŒ…ï¼ˆslf4j-Log4j12.jarï¼‰æ¥å‘ŠçŸ¥ç”¨å“ªç§æ—¥å¿—å®ç°ï¼Œè€Œ JCL æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ¥è·å¾—è¯¥é€‰æ‹©å“ªä¸ªæ—¥å¿—å®ç°ã€‚</p><h3 id="SLF4J-Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜"><a href="#SLF4J-Log4j-ä½¿ç”¨æ­¥éª¤è¯´æ˜" class="headerlink" title="SLF4J + Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜"></a><strong>SLF4J + Log4j ä½¿ç”¨æ­¥éª¤è¯´æ˜</strong></h3><p><strong>ï¼ˆ1ï¼‰é€‰æ‹© jar åŒ…</strong></p><pre class="line-numbers language-none"><code class="language-none">slf4j-api.jar + slf4j-log4j12.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>pom.xml</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>slf4j-log4j12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.7.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰log4j.properties é…ç½®æ–‡ä»¶</strong></p><p>å‚è€ƒã€ŠLog4j ä½¿ç”¨æ­¥éª¤è¯´æ˜ã€‹</p><p><strong>ï¼ˆ3ï¼‰è¾“å‡ºæ—¥å¿—çš„ä»£ç ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">jpm<span class="token punctuation">.</span>slf4jlog4j</span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>    <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSlf4jAndLog4j</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">TestSlf4jAndLog4j</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"TestSlf4jAndLog4j debug logï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token string">"debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"TestSlf4jAndLog4j info logï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token string">"info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestSlf4jAndLog4j error logï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ4ï¼‰æ‰“å°æ—¥å¿—ç»“æœ</strong></p><p><a href="https://pic1.zhimg.com/v2-990aca0df5ebd71d0a29ebad5a5d6858_b.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-990aca0df5ebd71d0a29ebad5a5d6858_b.jpg"></a><a href="https://pic1.zhimg.com/v2-25cbbac94a5b4ad99c08b6ebc3cc12f0_r.jpg" class="gallery-item"><img src="https://pic1.zhimg.com/v2-25cbbac94a5b4ad99c08b6ebc3cc12f0_r.jpg"></a></p><h2 id="äº”ã€é¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™"><a href="#äº”ã€é¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™" class="headerlink" title="äº”ã€é¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™"></a>äº”ã€é¡¹ç›®ä¸­æ—¥å¿—è®°å½•éµå®ˆå“ªäº›åŸåˆ™</h2><h3 id="1-é˜¿é‡Œå·´å·´-Java-å¼€å‘æ‰‹å†Œçš„æ—¥å¿—è§„çº¦"><a href="#1-é˜¿é‡Œå·´å·´-Java-å¼€å‘æ‰‹å†Œçš„æ—¥å¿—è§„çº¦" class="headerlink" title="1. é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œçš„æ—¥å¿—è§„çº¦"></a>1. é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œçš„æ—¥å¿—è§„çº¦</h3><p>å¤§å®¶å¯ä»¥å‚è€ƒå»å¹´ 10 æœˆä»½é˜¿é‡Œæ¨å‡ºçš„ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œï¼ˆç»ˆæç‰ˆï¼‰.pdfã€‹é‡Œçš„ç¬¬äºŒç« ç¬¬äºŒèŠ‚ â€œæ—¥å¿—è§„çº¦â€ éƒ¨åˆ†çš„å†…å®¹ã€‚</p><h3 id="2-ä¸ªäººç»éªŒæ€»ç»“"><a href="#2-ä¸ªäººç»éªŒæ€»ç»“" class="headerlink" title="2. ä¸ªäººç»éªŒæ€»ç»“"></a>2. ä¸ªäººç»éªŒæ€»ç»“</h3><p>è®°å½•é¡¹ç›®æ—¥å¿—è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li> æ³¨æ„æ—¥å¿—çº§åˆ«ï¼Œå°¤å…¶æ˜¯ info å’Œ error ä¸èƒ½ç”¨æ··ã€‚</li><li> æ³¨æ„è®°å½•ä¿¡æ¯çš„å‡†ç¡®æ€§ï¼Œåˆ‡è®°æ—¥å¿—è¡¨è¾¾ä¸æ¸…æ¥šã€‚</li><li> æ³¨æ„ä¸åŒçš„ä»£ç æ®µæ—¥å¿—è¯´æ˜ä¸èƒ½é‡å¤ã€‚</li><li> æ•è·å¼‚å¸¸åï¼Œè¦åŠæ—¶è®°å½•å¼‚å¸¸è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æŠŠå¼‚å¸¸ä¼ é€’åˆ°å¤–éƒ¨ã€‚</li><li> æ—¶åˆ»é“­è®°ï¼Œæ—¥å¿—çš„è®°å½•æ˜¯ä¸ºäº†åæœŸæŸ¥è¯¢é—®é¢˜å¸¦æ¥æ–¹ä¾¿ï¼Œå› æ­¤é‡è¦çš„ä»£ç åŠ¡å¿…è¦è®°å½•æ—¥å¿—ã€‚</li></ol><h2 id="å…­ã€ä¸€ä¸ªæ¨èçš„é¡¹ç›®-Java-æ—¥å¿—å®ä¾‹"><a href="#å…­ã€ä¸€ä¸ªæ¨èçš„é¡¹ç›®-Java-æ—¥å¿—å®ä¾‹" class="headerlink" title="å…­ã€ä¸€ä¸ªæ¨èçš„é¡¹ç›® Java æ—¥å¿—å®ä¾‹"></a>å…­ã€ä¸€ä¸ªæ¨èçš„é¡¹ç›® Java æ—¥å¿—å®ä¾‹</h2><p>ç»è¿‡ä»¥ä¸Šä»£ç çš„åˆ†æï¼Œæˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨çš„æ—¥å¿—ä¸€èˆ¬ä¼šé€‰ç”¨ä¸€ä¸ªæ—¥å¿—æ¥å£å’Œä¸€ä¸ªå…·ä½“çš„æ—¥å¿—å®ç°ã€‚</p><p>é‚£ä¹ˆæ—¥å¿—æ¥å£æ˜¯é€‰ JCL å‘¢ï¼Œè¿˜æ˜¯é€‰ SLF4J å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æŠŠä»–ä¿©åšä¸ªå¯¹æ¯”ï¼Œå…·ä½“æ—¥å¿—å®ç°ä¸º Log4jï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><a href="https://pic3.zhimg.com/v2-d80377fa8f2af3220eb3574ec4bbe8b2_r.jpg" class="gallery-item"><img src="https://pic3.zhimg.com/v2-d80377fa8f2af3220eb3574ec4bbe8b2_r.jpg"></a></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œç”¨ slf4j ä½œä¸ºæ—¥å¿—æ¥å£ï¼Œå¯¹é¡¹ç›®æ¥è¯´æ›´å¥½ä¸€äº›ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä¸€èˆ¬å»ºè®®ä½¿ç”¨ SLF4J+Log4j æˆ–è€… slf4j+logbackã€‚</p><p><strong>é…ç½®æ–‡ä»¶å‚è§ç¬¬å››èŠ‚</strong></p><p><strong>æ¨èç¨‹åºç‰‡æ®µå¦‚ä¸‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯-å¼€å§‹ï¼ŒuserIdï¼š&#123;&#125;"</span> <span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯-ç»“æŸï¼ŒuserIdï¼š&#123;&#125;"</span> <span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CustomException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯-è‡ªå®šä¹‰å¼‚å¸¸:&#123;&#125;"</span> <span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomException</span><span class="token punctuation">(</span><span class="token string">"æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯-è‡ªå®šä¹‰å¼‚å¸¸&#123;&#125;"</span> <span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯-æ•è·å¼‚å¸¸:&#123;&#125;"</span> <span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span>æ ¹æ®ç”¨æˆ·ç¼–ç æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯<span class="token operator">-</span>æ•è·å¼‚å¸¸<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>" <span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ°æ­¤ï¼ŒJava æ—¥å¿—ä»å…¥é—¨åˆ°å®æˆ˜ å°±ç»“æŸäº†ï¼Œå’±ä»¬ä¸‹æ¬¡å†è§ï¼Œè°¢è°¢ã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¿—ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯ç³»åˆ—ï¼ˆä¸€ï¼‰| Vue å¿«é€Ÿå…¥é—¨</title>
      <link href="/posts/4425.html"/>
      <url>/posts/4425.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Vue-å¿«é€Ÿå…¥é—¨"><a href="#Vue-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Vue å¿«é€Ÿå…¥é—¨"></a>Vue å¿«é€Ÿå…¥é—¨</h1><h2 id="1-Vue-å…¥é—¨"><a href="#1-Vue-å…¥é—¨" class="headerlink" title="1.Vue å…¥é—¨"></a>1.Vue å…¥é—¨</h2><h3 id="1-1-ä¸‹è½½-Vuejs"><a href="#1-1-ä¸‹è½½-Vuejs" class="headerlink" title="1.1 ä¸‹è½½ Vuejs"></a>1.1 ä¸‹è½½ <code>Vuejs</code></h3><pre class="line-numbers language-html" data-language="html"><code class="language-html">//å¼€å‘ç‰ˆæœ¬<span class="token comment">&lt;!-- å¼€å‘ç¯å¢ƒç‰ˆæœ¬ï¼ŒåŒ…å«äº†æœ‰å¸®åŠ©çš„å‘½ä»¤è¡Œè­¦å‘Š --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>//ç”Ÿäº§ç‰ˆæœ¬<span class="token comment">&lt;!-- ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬ï¼Œä¼˜åŒ–äº†å°ºå¯¸å’Œé€Ÿåº¦ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-2-Vueç¬¬ä¸€ä¸ªåº”ç”¨"><a href="#1-2-Vueç¬¬ä¸€ä¸ªåº”ç”¨" class="headerlink" title="1.2 Vueç¬¬ä¸€ä¸ªåº”ç”¨"></a>1.2 <code>Vue</code>ç¬¬ä¸€ä¸ªåº”ç”¨</h3><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;div id&#x3D;&quot;app&quot;&gt;    &#123;&#123;msg&#125;&#125;  &#123;&#123;username&#125;&#125; &#123;&#123;pwd&#125;&#125;&lt;&#x2F;div&gt;&lt;!--å»ºè®®æ”¾åˆ°ä¸´è¿‘çš„jsä½ç½®--&gt;&lt;!--1.å¼•å…¥vue.js--&gt;&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;&lt;!--2.åˆ›å»ºvueå®ä¾‹--&gt;&lt;script&gt;    const app &#x3D; new Vue(&#123;        el: &#39;#app&#39;,         &#x2F;&#x2F;ç”¨æ¥ç»™vueå®ä¾‹å®šä¹‰ä¸€ä¸ªä½œç”¨èŒƒå›´        data: &#123;         &#x2F;&#x2F;ç”¨æ¥ç»™vueå®ä¾‹å®šä¹‰ä¸€äº›ç›¸å…³æ•°æ®            msg:&quot;ä½ å¥½ï¼Œæ¬¢è¿è¿™ä¸ªä¸–ç•Œï¼&quot;,            username:&quot;hello vue&quot;,            pwd: &quot;1234&quot;        &#125;,    &#125;);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">æ€»ç»“ï¼š1.vueå®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ä¸­elå±æ€§ï¼šä»£è¡¨Vueçš„ä½œç”¨èŒƒå›´    æ—¥ååœ¨Vueçš„ä½œç”¨èŒƒå›´å†…éƒ½å¯ä»¥ä½¿ç”¨Vueè¯­æ³•2.vueå®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ä¸­çš„dataï¼šç»‘å®šä¸€äº›ç›¸å…³çš„æ•°æ®å˜é‡ï¼Œç»‘å®šçš„æ•°æ®é€šè¿‡&#123;&#123;å˜é‡å&#125;&#125;åœ¨Vueçš„ä½œç”¨èŒƒå›´å†…å–å‡º3.åœ¨ä½¿ç”¨&#123;&#123;&#125;&#125;è¿›è¡Œè·å–dataä¸­æ•°æ®æ—¶ï¼Œå¯åœ¨&#123;&#123;&#125;&#125;å†™è¡¨è¾¾å¼ï¼Œè¿ç®—ç¬¦ï¼Œè°ƒç”¨ç›¸å…³æ–¹æ³•ï¼Œä»¥åŠé€»è¾‘è¿ç®—ç­‰4.elå±æ€§ä¸­å¯ä»¥ä¹¦å†™ä»»æ„cssé€‰æ‹©å™¨ï¼ˆjqé€‰æ‹©å™¨ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨Vueå¼€å‘æ˜¯æ¨èä½¿ç”¨ï¼Œidé€‰æ‹©å™¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2-vue-textå’Œv-html"><a href="#2-vue-textå’Œv-html" class="headerlink" title="2.vue-textå’Œv-html"></a>2.vue-textå’Œv-html</h2><h3 id="2-1-v-text"><a href="#2-1-v-text" class="headerlink" title="2.1 v-text"></a>2.1 v-text</h3><blockquote><p>v-text : ç”¨æ¥è·å–dataä¸­æ•°æ®å°†æ•°æ®ä»¥æ–‡æœ¬çš„å½¢å¼æ¸²æŸ“åˆ°æŒ‡å®šçš„æ ‡ç­¾å†…éƒ¨ ç±»ä¼¼ jsä¸­çš„ innerText</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--å·®å€¼è¡¨è¾¾å™¨--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;msg&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>    const app = new Vue(&#123;        el: '.aa',        data: &#123;            msg: "hello world"        &#125;    &#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">æ€»ç»“1.&#123;&#123;&#125;&#125;ï¼ˆæ’å€¼è¡¨è¾¾ï¼‰å’Œv-textè·å–æ•°æ®çš„åŒºåˆ«  a.ä½¿ç”¨v-textå–å€¼ä¼šå°†æ ‡ç­¾ä¸­åŸæœ‰çš„æ•°æ®è¦†ç›–  æ’å€¼è¡¨è¾¾å…¶ä¸ä¼šb.ä½¿ç”¨v-textå¯ä»¥é¿å…åœ¨ç½‘ç»œç¯å¢ƒè¾ƒå·®çš„æƒ…å†µå‡ºç°æ’å€¼é—ªçƒ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-v-html"><a href="#2-2-v-html" class="headerlink" title="2.2 v-html"></a>2.2 v-html</h3><blockquote><p>v-html: ç”¨æ¥è·å–dataä¸­æ•°æ®å°†æ•°æ®ä¸­å«æœ‰çš„htmlæ ‡ç­¾å…ˆè§£æåœ¨æ¸²æŸ“åˆ°æŒ‡å®šæ ‡ç­¾çš„å†…éƒ¨  ç±»ä¼¼ js ä¸­ innerHTML</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;msg&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>    const app = new Vue(&#123;        el: '#app',        data: &#123;            msg: "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token punctuation">'</span></span><span class="token punctuation">></span></span> æ¬¢è¿ä½ !<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>"        &#125;    &#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="3-vueä¸­æ—¶é—´ç»‘å®šï¼ˆv-onï¼‰"><a href="#3-vueä¸­æ—¶é—´ç»‘å®šï¼ˆv-onï¼‰" class="headerlink" title="3.vueä¸­æ—¶é—´ç»‘å®šï¼ˆv-onï¼‰"></a>3.vueä¸­æ—¶é—´ç»‘å®šï¼ˆv-onï¼‰</h2><h3 id="3-1-ç»‘å®šäº‹ä»¶è¯­æ³•"><a href="#3-1-ç»‘å®šäº‹ä»¶è¯­æ³•" class="headerlink" title="3.1 ç»‘å®šäº‹ä»¶è¯­æ³•"></a>3.1 ç»‘å®šäº‹ä»¶è¯­æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123;msg&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>å¹´é¾„ï¼š&#123;&#123;age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç‚¹å‡»æ”¹å˜å¹´é¾„<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeAge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">"hello world"</span><span class="token punctuation">,</span>            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">"23"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">&#123;</span> <span class="token comment">//å®šä¹‰vueäº‹ä»¶</span>            <span class="token function-variable function">changeAge</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å‡ºå‘"</span><span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“ï¼š</span>äº‹ä»¶   äº‹ä»¶æº:å‘é€äº‹ä»¶demoå…ƒç´    äº‹ä»¶ï¼šå‘ç”Ÿç‰¹å®šçš„åŠ¨ä½œ click...   ç›‘å¬å™¨  å‘ç”Ÿç‰¹å®šåŠ¨ä½œä¹‹åçš„äº‹ä»¶å¤„ç†ç¨‹åºé€šå¸¸æ—¶jsä¸­çš„å‡½æ•°1.åœ¨vueä¸­ç»‘å®šäº‹ä»¶æ—¶é€šè¿‡v-onæŒ‡ä»¤å®Œæˆçš„  v-on:äº‹ä»¶å  å¦‚ v-on:click2.åœ¨v-on:äº‹ä»¶åçš„èµ‹å€¼è¯­å¥ä¸­çš„å½“å‰äº‹ä»¶è§¦å‘çš„å‡½æ•°å3.åœ¨vueä¸­äº‹ä»¶çš„å‡½æ•°ç»Ÿä¸€å®šä¹‰åœ¨Vueå®ä¾‹çš„methodså±æ€§ä¸­4.åœ¨vueå®šä¹‰äº‹ä»¶ä¸­thiså€¼çš„å°±æ˜¯å½“å‰Vueå®ä¾‹ï¼Œæ—¥åå¯ä»¥åœ¨äº‹ä»¶ä¸­é€šè¿‡ä½¿ç”¨thisè·å–Vueä¸­ç›¸å…³æ•°æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-Vueäº‹ä»¶ç®€åŒ–å†™æ³•"><a href="#3-2-Vueäº‹ä»¶ç®€åŒ–å†™æ³•" class="headerlink" title="3.2 Vueäº‹ä»¶ç®€åŒ–å†™æ³•"></a>3.2 Vueäº‹ä»¶ç®€åŒ–å†™æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123;age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€šè¿‡v-onäº‹ä»¶ä¿®æ”¹å¹´é¾„ +1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€šè¿‡@äº‹ä»¶ä¿®æ”¹å¹´é¾„ -1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token function-variable function">changeage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function-variable function">editage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“ 1. vueäº‹ä»¶ç®€åŒ–é€šè¿‡ @ç¬¦å· ç®€åŒ– v-on</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-3-Vueä¼˜åŒ–å†™æ³•"><a href="#3-3-Vueä¼˜åŒ–å†™æ³•" class="headerlink" title="3.3 Vueä¼˜åŒ–å†™æ³•"></a>3.3 Vueä¼˜åŒ–å†™æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123;age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€šè¿‡@äº‹ä»¶ä¿®æ”¹å¹´é¾„ -1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">20</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// changeage: function () &#123;</span>            <span class="token comment">//     this.age++;</span>            <span class="token comment">// &#125;,</span>            <span class="token function">editage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span> 1.äº‹ä»¶å®šä¹‰å­˜åœ¨ä¸¤ç§å†™æ³• 1.å‡½æ•°å:function()&#123;&#125; 2.å‡½æ•°å()&#123;&#125;æ¨è<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-4-Vueäº‹ä»¶ä¼ é€’"><a href="#3-4-Vueäº‹ä»¶ä¼ é€’" class="headerlink" title="3.4 Vueäº‹ä»¶ä¼ é€’"></a>3.4 Vueäº‹ä»¶ä¼ é€’</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123;age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>äº‹ä»¶ä¼ å€¼<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeage(23,'xiaochen')<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">20</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">changeage</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“1.ä½¿ç”¨äº‹ä»¶æ—¶ï¼Œé€šå¸¸è°ƒç”¨å‚æ•°ï¼Œé€šè¿‡å‡½æ•°æ¥æ”¶å‚æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="4-v-show-v-if-v-bind"><a href="#4-v-show-v-if-v-bind" class="headerlink" title="4.v-show v-if v-bind"></a>4.v-show v-if v-bind</h2><h3 id="4-1-v-show"><a href="#4-1-v-show" class="headerlink" title="4.1 v-show"></a>4.1 v-show</h3><blockquote><p>v-show ç”¨æ¥æ§åˆ¶é¡µé¢ä¸­æŸä¸ªå…ƒç´ æ˜¯å¦å±•ç¤º  åº•å±‚æ§åˆ¶æ˜¯æ ‡ç­¾ display å±æ€§</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        v-show    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-v-if"><a href="#4-2-v-if" class="headerlink" title="4.2.v-if"></a>4.2.v-if</h3><blockquote><p>æ§åˆ¶é¡µé¢ä¸­çš„æ ‡ç­¾å…ƒç´ æ˜¯å¦å±•ç¤ºåº•å±‚é€šè¿‡å¯¹domæ ‘èŠ‚ç‚¹è¿›è¡Œæ·»åŠ å’Œåˆ é™¤æ¥æ§åˆ¶å±•ç¤ºå’Œéšè—ç”¨</p></blockquote><h3 id="4-3-v-bind"><a href="#4-3-v-bind" class="headerlink" title="4.3.v-bind"></a>4.3.v-bind</h3><blockquote><p>ç”¨æ¥ç»™é¡µé¢ä¸­æ ‡ç­¾å…ƒç´ ç»‘å®šç›¸åº”çš„å±æ€§ç®€åŒ–å†™æ³•v-bin:å±æ€§å ==ã€‹:å±æ€§å</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        v-show    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        v-show hello    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        è¢è€ä¸€è·¯èµ°å¥½    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        å´è€ä¸€è·¯èµ°å¥½    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        æµªè´¹ç²®é£Ÿ    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isShow<span class="token punctuation">"</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>src<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç‚¹å‡»æˆ‘æ”¹å˜title<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeTitle('è¿™æ˜¯ä¿®æ”¹åçš„title')<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç‚¹å‡»æˆ‘æ”¹å˜src<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeSrc('https://gitee.com/lingzhexi/blogImage/raw/master/img2021/05/shiro/20210523165516.png')<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç‚¹æˆ‘æ˜¾ç¤ºéšè—<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showHide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">isShow</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'é™ˆå°ä½³'</span><span class="token punctuation">,</span>            <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">'https://www.baidu.com/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">showHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isShow<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">changeTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">changeSrc</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="5-v-forä½¿ç”¨"><a href="#5-v-forä½¿ç”¨" class="headerlink" title="5.v-forä½¿ç”¨"></a>5.v-forä½¿ç”¨</h2><blockquote><p>å¯¹è±¡éå†</p></blockquote><p>åˆ›å»ºvueæ¨¡æ¿</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>        $&#123;NAME&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    &#123;&#123;user.name&#125;&#125;&#123;&#123;user.age&#125;&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>u in user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123;u&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(value,key,index) in user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123;key&#125;&#125;:&#123;&#123;value&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a,index in arr<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            &#123;&#123;index&#125;&#125;:&#123;&#123;a&#125;&#125;        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>u in users<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>u.id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            &#123;&#123;u.id&#125;&#125;=&#123;&#123;u.name&#125;&#125;===&#123;&#123;u.age&#125;&#125;==&#123;&#123;u.state&#125;&#125;        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"å°å²‘"</span><span class="token punctuation">,</span>                <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">24</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token literal-property property">arr</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"åœŸè±†"</span><span class="token punctuation">,</span> <span class="token string">"ç‰ç±³"</span><span class="token punctuation">,</span> <span class="token string">"å°éº¦"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>                <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"zhangs"</span><span class="token punctuation">,</span>                <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>                <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"good"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token punctuation">&#123;</span>                    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>                    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"lis"</span><span class="token punctuation">,</span>                    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>                    <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"bad"</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“åœ¨ä½¿ç”¨-forçš„æ—¶å€™ä¸€å®šè¦æ³¨æ„åŠ å…¥:keyç”¨æ¥ç»™vueå†…éƒ¨æä¾›é‡ç”¨å’Œæ’åºçš„å”¯â€”key</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="6-v-model-åŒå‘ç»‘å®š"><a href="#6-v-model-åŒå‘ç»‘å®š" class="headerlink" title="6.v-model åŒå‘ç»‘å®š"></a>6.v-model åŒå‘ç»‘å®š</h2><blockquote><p><code>v-model</code>:ä½œç”¨ç”¨æ¥ç»‘å®šæ ‡ç­¾å…ƒç´ çš„å€¼ä¸wueå®ä¾‹å¯¹è±¡ä¸­dataæ•°æ®ä¿æŒä¸€è‡´,ä»è€Œå®ç°åŒå‘çš„æ•°æ®ç»‘å®šæœºåˆ¶</p></blockquote><pre class="line-numbers language-HTML" data-language="HTML"><code class="language-HTML"> &lt;div id&#x3D;&quot;app&quot;&gt;    &lt;input type&#x3D;&quot;text&quot; v-model&#x3D;&quot;message&quot;&gt;    &lt;div&gt;        &#123;&#123;message&#125;&#125;    &lt;&#x2F;div&gt;    &lt;input type&#x3D;&quot;button&quot; value&#x3D;&quot;æ”¹å˜è¾“å…¥æ¡†çš„å€¼&quot; @click&#x3D;&quot;changeMsg(&#39;å‡Œå“²ç†™&#39;)&quot;&gt;&lt;&#x2F;div&gt;&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;&lt;script&gt;    const app &#x3D; new Vue(&#123;        el: &#39;#app&#39;,        data: &#123;            message: &quot;&quot;        &#125;,        methods: &#123;            changeMsg(msg) &#123;                this.message &#x3D; msg;            &#125;        &#125;,        components: &#123;&#125;    &#125;);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.ä½¿ç”¨v- modelæŒ‡ä»¤å¯ä»¥å®ç°æ•°æ®çš„åŒå‘ç»‘å®š2.æ‰€è°“åŒå‘ç»‘å®šè¡¨å•ä¸­æ•°æ®å˜åŒ–å¯¼è‡´vueå®ä¾‹dataæ•°æ®å˜åŒ–vueå®ä¾‹ä¸­dataæ•°æ®çš„å˜åŒ–å¯¼è‡´è¡¨å•ä¸­æ•°æ®å˜åŒ–ç§°ä¹‹ä¸ºåŒå‘ç»‘å®š<span class="token title important"><span class="token punctuation">#</span> MVWMæ¶æ„  åŒå‘ç»‘å®šæœºåˆ¶</span>Model:æ•°æ®vue   å®ä¾‹ä¸­ç»‘å®šæ•°æ®VM: ViewMode1   ç›‘å¬å™¨View:é¡µé¢  é¡µé¢å±•ç¤ºçš„æ•°æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»ƒä¹ ï¼šè®°äº‹æœ¬æ¡ˆä¾‹"><a href="#ç»ƒä¹ ï¼šè®°äº‹æœ¬æ¡ˆä¾‹" class="headerlink" title="ç»ƒä¹ ï¼šè®°äº‹æœ¬æ¡ˆä¾‹"></a>ç»ƒä¹ ï¼šè®°äº‹æœ¬æ¡ˆä¾‹</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ·»åŠ åˆ°è®°äº‹æœ¬<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>save()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item,index in lists<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            &#123;&#123;index+1&#125;&#125;: &#123;&#123;item&#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delItem(index)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>åˆ é™¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>æ€»æ•°é‡ï¼š&#123;&#123;lists.length&#125;&#125; æ¡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>lists.length!=0<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>åˆ é™¤æ‰€æœ‰<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delAll()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">lists</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'ä»Šå¤©ä¸‹äº†ä¸€åœºæš´é›¨'</span><span class="token punctuation">,</span><span class="token string">'æ™šä¸Šå›å®¶åƒå°é¾™è™¾'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">""</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">''</span><span class="token operator">!=</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">this</span><span class="token punctuation">.</span>lists<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">delItem</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>lists<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">delAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>lists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="7-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#7-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="7.äº‹ä»¶ä¿®é¥°ç¬¦"></a>7.äº‹ä»¶ä¿®é¥°ç¬¦</h2><blockquote><p><code>ä¿®é¥°ç¬¦</code>: ä½œç”¨ç”¨æ¥å’Œäº‹ä»¶è¿ç”¨,ç”¨æ¥å†³å®šäº‹ä»¶è§¦å‘æ¡ä»¶æˆ–è€…æ˜¯é˜»æ­¢äº‹ä»¶çš„è§¦å‘æœºåˆ¶</p></blockquote><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.å¸¸ç”¨çš„äº‹ä»¶ä¿®é¥°ç¬¦  </span>    .stop    .prevent    .capture    .self    .once    .passive<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-1-stopäº‹ä»¶ä¿®é¥°ç¬¦"><a href="#7-1-stopäº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="7.1 stopäº‹ä»¶ä¿®é¥°ç¬¦"></a>7.1 stopäº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--é˜»æ­¢äº‹ä»¶å†’æ³¡--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">divClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"div is clicked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">btnClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'button is clicked'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-2-preventäº‹ä»¶ä¿®é¥°ç¬¦"><a href="#7-2-preventäº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="7.2 preventäº‹ä»¶ä¿®é¥°ç¬¦"></a>7.2 preventäº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é˜»æ­¢æ ‡ç­¾çš„é»˜è®¤è¡Œä¸º</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.bilibili.com<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>bç«™<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="7-3-selfäº‹ä»¶ä¿®é¥°ç¬¦"><a href="#7-3-selfäº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="7.3 selfäº‹ä»¶ä¿®é¥°ç¬¦"></a>7.3 selfäº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é’ˆå¯¹äºå½“å‰æ ‡ç­¾çš„äº‹ä»¶è§¦å‘=&gt;åªè§¦å‘è‡ªå·±æ ‡ç­¾çš„ä¸Šç‰¹å®šåŠ¨ä½œçš„äº‹ä»¶</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--åªè§¦å‘æ ‡ç­¾è‡ªèº«çš„äº‹ä»¶--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token attr-name">@click.self</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--é˜»æ­¢äº‹ä»¶å†’æ³¡--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-4-once-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#7-4-once-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="7.4 once äº‹ä»¶ä¿®é¥°ç¬¦"></a>7.4 once äº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>once ä¸€æ¬¡ ä½œç”¨ï¼šå°±æ˜¯è®©æŒ‡å®šäº‹ä»¶åªè§¦å‘ä¸€æ¬¡</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--.prevent ï¼šç”¨æ¥é˜»æ­¢äº‹ä»¶é»˜è®¤çš„è¡Œä¸º.once ï¼šç”¨æ¥åªæ‰§è¡Œä¸€æ¬¡ç‰¹å®šçš„äº‹ä»¶--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.baidu.com<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent.once</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    ç™¾åº¦<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="8-æŒ‰é”®ä¿®é¥°ç¬¦"><a href="#8-æŒ‰é”®ä¿®é¥°ç¬¦" class="headerlink" title="8.æŒ‰é”®ä¿®é¥°ç¬¦"></a>8.æŒ‰é”®ä¿®é¥°ç¬¦</h2><blockquote><p>ä½œç”¨:ç”¨æ¥ä¸é”®ç›˜ä¸­æŒ‰é”®äº‹ä»¶ç»‘å®šåœ¨ä¸€èµ·,ç”¨æ¥ä¿®é¥°ç‰¹å®šçš„æŒ‰é”®äº‹ä»¶çš„ä¿®é¥°ç¬¦</p></blockquote><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æŒ‰é”®ä¿®é¥°ç¬¦</span>    .enter    .tab    .delete (æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®)    .esc    .space    .up    .down    .left    .right<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8-1-enter-å›è½¦é”®"><a href="#8-1-enter-å›è½¦é”®" class="headerlink" title="8.1 enter å›è½¦é”®"></a>8.1 enter å›è½¦é”®</h3><blockquote><p>ç”¨æ¥åœ¨è§¦å‘å›è½¦æŒ‰é”®ä¹‹åè§¦å‘çš„äº‹ä»¶</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.enter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>keyups<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="8-2-tab"><a href="#8-2-tab" class="headerlink" title="8.2 tab"></a>8.2 tab</h3><blockquote><p>ç”¨æ¥æ•è·åˆ°tabé”®æ‰§è¡Œåˆ°å½“å‰æ ‡ç­¾æ˜¯æ‰ä¼šè§¦å‘</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--å…¶ä»–å…‰æ ‡tabåˆ°è¯¥æ–‡æœ¬æ¡†çš„æ—¶å€™è§¦å‘--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.tab</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tabkey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="8-3-å…¶ä»–"><a href="#8-3-å…¶ä»–" class="headerlink" title="8.3 å…¶ä»–"></a>8.3 å…¶ä»–</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.delete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deleteKey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.esc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>esckey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ç©ºæ ¼--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.space</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>spacekey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.left</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>leftkey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.right</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rigthkey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="9-AxiosåŸºæœ¬ä½¿ç”¨"><a href="#9-AxiosåŸºæœ¬ä½¿ç”¨" class="headerlink" title="9.AxiosåŸºæœ¬ä½¿ç”¨"></a>9.AxiosåŸºæœ¬ä½¿ç”¨</h2><h3 id="9-1å¼•è¨€"><a href="#9-1å¼•è¨€" class="headerlink" title="9.1å¼•è¨€"></a>9.1å¼•è¨€</h3><blockquote><p><code>Axios</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚æŠ€æœ¯æ ¸å¿ƒä½œç”¨å°±æ˜¯ç”¨æ¥åœ¨é¡µé¢ä¸­å‘é€å¼‚æ­¥è¯·æ±‚å¹¶è·å–å¯¹åº”æ•°æ®åœ¨é¡µé¢ä¸­æ¸²æŸ“é¡µé¢å±€éƒ¨æ›´æ–°æŠ€æœ¯Aax</p></blockquote><h3 id="9-2-Axiosç¬¬ä¸€ä¸ªç¨‹åº"><a href="#9-2-Axiosç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="9.2 Axiosç¬¬ä¸€ä¸ªç¨‹åº"></a>9.2 <code>Axios</code>ç¬¬ä¸€ä¸ªç¨‹åº</h3><blockquote><p>ä¸­æ–‡ç½‘ç«™ï¼š<a href="https://www.kancloud.cn/yunye/axios/234845">https://www.kancloud.cn/yunye/axios/234845</a><br>å®‰è£…ï¼š<a href="https://unpkg.com/axios/dist/axios.min.js">https://unpkg.com/axios/dist/axios.min.js</a></p></blockquote><h4 id="9-2-1-GETè¯·æ±‚"><a href="#9-2-1-GETè¯·æ±‚" class="headerlink" title="9.2.1 GETè¯·æ±‚"></a>9.2.1 GETè¯·æ±‚</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å‘é€Getè¯·æ±‚</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/findAll?name=xiaochen"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-2-2-POSTè¯·æ±‚æ–¹å¼"><a href="#9-2-2-POSTè¯·æ±‚æ–¹å¼" class="headerlink" title="9.2.2 POSTè¯·æ±‚æ–¹å¼"></a>9.2.2 POSTè¯·æ±‚æ–¹å¼</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//POSTè¯·æ±‚</span>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/save'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'xiaochen'</span><span class="token punctuation">,</span>    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>    <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'5234@qq.com'</span><span class="token punctuation">,</span>    <span class="token literal-property property">phone</span><span class="token operator">:</span> <span class="token string">'15352252514'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-2-3-axioså¹¶å‘è¯·æ±‚"><a href="#9-2-3-axioså¹¶å‘è¯·æ±‚" class="headerlink" title="9.2.3 axioså¹¶å‘è¯·æ±‚"></a>9.2.3 <code>axios</code>å¹¶å‘è¯·æ±‚</h4><blockquote><p><code>å¹¶å‘è¯·æ±‚</code>ï¼šå°†å¤šä¸ªè¯·æ±‚åœ¨åŒä¸€æ—¶åˆ»å‘é€åˆ°åç«¯æœåŠ¡æ¥å£,æœ€ååœ¨é›†ä¸­å¤„ç†æ¯ä¸ªè¯·æ±‚çš„å“åº”ç»“æœ</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js"> <span class="token comment">//1.åˆ›å»ºæŸ¥è¯¢æ‰€æœ‰è¯·æ±‚  </span><span class="token keyword">function</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/findAll?name=xiaochen'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//2.åˆ›å»ºä¿å­˜è¯·æ±‚  </span><span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/save'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'xiaochen'</span><span class="token punctuation">,</span>        <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'5234@qq.com'</span><span class="token punctuation">,</span>        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>        <span class="token literal-property property">phone</span><span class="token operator">:</span> <span class="token string">'15352252514'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¹¶å‘æ“ä½œ  </span>axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res1<span class="token punctuation">,</span> res2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”¨æ¥å‘é€ä¸€ç»„å¹¶å‘è¯·æ±‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-2-vue-ç»“åˆ-axios-æŸ¥è¯¢å¤©æ°”"><a href="#9-2-vue-ç»“åˆ-axios-æŸ¥è¯¢å¤©æ°”" class="headerlink" title="9.2  vue ç»“åˆ axios æŸ¥è¯¢å¤©æ°”"></a>9.2  <code>vue</code> ç»“åˆ <code>axios</code> æŸ¥è¯¢å¤©æ°”</h3><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt; div id&#x3D;&quot;app&quot;&gt;&lt;div&gt;    &lt;input type&#x3D;&quot;text&quot; v - model&#x3D;&quot;name&quot; @keyup.delete&#x3D;&quot;show&quot; @keyup.enter&#x3D;&quot;searchCity&quot;&gt;    &lt;input type&#x3D;&quot;button&quot; value&#x3D;&quot;æœç´¢&quot; @click&#x3D;&quot;searchCity&quot;&gt;&lt;&#x2F;div&gt;&lt;span v-for&#x3D;&quot;city in citys&quot;&gt;&lt;a href&#x3D;&quot;&quot; @click.prevent&#x3D;&quot;searchCitys(city)&quot;&gt;&#123;&#123;city&#125;&#125; &amp;nbsp&lt;&#x2F;a&gt;&lt;&#x2F;span&gt;&lt;hr&gt;&lt;span v-show&#x3D;&quot;isShow&quot;&gt;&#123;&#123;name&#125;&#125;ï¼šä»Šå¤©å¤©æ°”æ˜¯ &#123;&#123;weather&#125;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;div&gt;&lt;script src&#x3D;&quot;https:&#x2F; &#x2F; cdn.jsdelivr.net &#x2F; npm &#x2F; vue &#x2F; dist &#x2F; vue.js &quot;&gt;&lt;&#x2F;script&gt;&lt;!--å¼•å…¥axios--&gt;&lt;script src&#x3D;&quot;https: &#x2F;&#x2F;unpkg.com&#x2F;axios&#x2F;dist&#x2F;axios.min.js&quot;&gt;&lt;&#x2F;script&gt;&lt;script&gt;    const app &#x3D; new Vue(&#123;        el: &#39;#app&#39;,        data: &#123;            name: &#39;&#39;,            citys: [&#39;åŒ—äº¬&#39;, &#39;ä¸Šæµ·&#39;, &#39;å¤©æ´¥&#39;, &#39;æ·±åœ³&#39;],            weather: &#39;&#39;,            isShow: false        &#125;,        methods: &#123;            searchCity() &#123;                let _this &#x3D; this axios.get(&quot;http:&#x2F;&#x2F;localhost:8080&#x2F;city&#x2F;find?name&#x3D;&quot; + this.name).then(function(response) &#123;                    console.log(response.data);                    _this.weather &#x3D; response.data.message;                    _this.isShow &#x3D; true;                &#125;).                catch(function(error) &#123;                    console.log(error);                &#125;);            &#125;,            show() &#123;                this.isShow &#x3D; false;            &#125;,            searchCitys(name) &#123;                this.name &#x3D; name;                this.searchCity();            &#125;        &#125;,        components: &#123;&#125;    &#125;);&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="10-Vueç”Ÿå‘½å‘¨æœŸ"><a href="#10-Vueç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="10. Vueç”Ÿå‘½å‘¨æœŸ"></a>10. Vueç”Ÿå‘½å‘¨æœŸ</h2><blockquote><p><code>ç”Ÿå‘½å‘¨æœŸé’©å­</code>   ===ã€‹ <code>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</code></p></blockquote><p><a href="https://cn.vuejs.org/assets/lifecycle_zh-CN.W0MNXI0C.png" title="Vue å®ä¾‹ç”Ÿå‘½å‘¨æœŸ" class="gallery-item"><img src="https://cn.vuejs.org/assets/lifecycle_zh-CN.W0MNXI0C.png" alt="Vue å®ä¾‹ç”Ÿå‘½å‘¨æœŸ"></a></p><p>Vueç”Ÿå‘½å‘¨æœŸæ€»ç»“</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 1.åˆå§‹åŒ–é˜¶æ®µ  </span><span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//1.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬ä¸€ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶vueå®ä¾‹ä»…ä»…å®Œæˆäº†è‡ªèº«äº‹ä»¶çš„ç»‘å®šå’Œç”Ÿå‘½å‘¨æœŸå‡½çš„åˆå§‹åŒ–å·¥ä½œ,Vueå®ä¾‹ä¸­è¿˜æ²¡æœ‰ Data el methodsç›¸å…³å±æ€§        </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"beforeCreate:"</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//2.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬äºŒä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶vueå®ä¾‹å·²ç»åˆå§‹åŒ–äº†dataå±æ€§å’Œ methodsä¸­ç›¸å…³æ–¹æ³•   </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"created:"</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function">beforeMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//3.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬ä¸‰ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶vueå°†E1ä¸­æŒ‡å®šä½œç”¨èŒƒå›´ä½œä¸ºæ¨¡æ¿ç¼–è¯‘        </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">" beforeMount:"</span> <span class="token operator">+</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"sp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//4.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬å››ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­,å·²ç»å°†æ•°æ®æ¸²æŸ“åˆ°ç•Œé¢ä¸­å¹¶ä¸”å·²ç»æ›´æ–°é¡µé¢       </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Mounted: "</span> <span class="token operator">+</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"sp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2.è¿è¡Œé˜¶æ®µ</span><span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//5.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬äº”ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ˜¯dataä¸­æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œè¿™ä¸ªäº‹ä»¶æ‰§è¡Œæ—¶ä»…ä»…æ˜¯vueå®ä¾‹ä¸­dataæ•°æ®å˜åŒ–é¡µé¢æ˜¾ç¤ºçš„ä¾ç„¶æ˜¯åŸå§‹æ•°æ®       </span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"beforeUpdate: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"beforeUpdate: "</span> <span class="token operator">+</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"sp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//6.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬å…­ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶dataä¸­æ•°æ®å‘ç”Ÿå˜åŒ–,é¡µé¢ä¸­æ•°æ®ä¹Ÿå‘ç”Ÿäº†å˜åŒ–é¡µé¢ä¸­æ•°æ®å·²ç»å’Œdataä¸­æ•°æ®ä¸€è‡´        </span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"updated: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"updated: "</span> <span class="token operator">+</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"sp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token comment">//3.é”€æ¯é˜¶æ®µ</span><span class="token function">beforeDestory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//7.ç”Ÿå‘½å‘¨æœŸç¬¬ä¸ƒä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶,vueä¸­æ‰€æœ‰æ•°æ® methods componetéƒ½æ²¡é”€åˆ°   </span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token function">destoryed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//8.ç”Ÿå‘½å‘¨æœŸçš„ç¬¬å…«ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶,Wueå®ä¾‹å½»åº•é”€æ¯    </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-Vueä¸­çš„ç»„ä»¶-Component"><a href="#11-Vueä¸­çš„ç»„ä»¶-Component" class="headerlink" title="11.Vueä¸­çš„ç»„ä»¶( Component)"></a>11.Vueä¸­çš„ç»„ä»¶( Component)</h2><h3 id="11-1ç»„ä»¶ä½œç”¨"><a href="#11-1ç»„ä»¶ä½œç”¨" class="headerlink" title="11.1ç»„ä»¶ä½œç”¨"></a>11.1ç»„ä»¶ä½œç”¨</h3><pre class="line-numbers language-none"><code class="language-none">ç»„ä»¶ä½œç”¨:ç”¨æ¥å‡å°‘wueå®ä¾‹å¯¹è±¡ä¸­ä»£ç é‡,æ—¥ååœ¨ä½¿ç”¨wueå¼€å‘è¿‡ç¨‹ä¸­,å¯ä»¥æ ¹æ®ä¸èƒ½ä¸šåŠ¡åŠŸèƒ½å°†é¡µé¢ä¸­åˆ’åˆ†ä¸åŒçš„å¤šä¸ªç»„ä»¶ç„¶åç”±å¤šä¸ªç»„ä»¶å»å®Œæˆæ•´ä¸ªé¡µé¢çš„å¸ƒå±€ä¾¿äºæ—¥åä½¿ç”¨Vueè¿›è¡Œå¼€å‘æ—¶é¡µé¢ç®¡ç†,æ–¹ä¾¿å¼€å‘äººå‘˜ç»´æŠ¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="11-2-ç»„ä»¶ä½¿ç”¨"><a href="#11-2-ç»„ä»¶ä½¿ç”¨" class="headerlink" title="11.2 ç»„ä»¶ä½¿ç”¨"></a>11.2 ç»„ä»¶ä½¿ç”¨</h3><h4 id="11-2-1-å…¨å±€ç»„ä»¶æ³¨å†Œ"><a href="#11-2-1-å…¨å±€ç»„ä»¶æ³¨å†Œ" class="headerlink" title="11.2.1 å…¨å±€ç»„ä»¶æ³¨å†Œ"></a>11.2.1 å…¨å±€ç»„ä»¶æ³¨å†Œ</h4><p>è¯´æ˜:å…¨å±€ç»„ä»¶æ³¨å†Œç»™vueå®ä¾‹,æ—¥åå¯ä»¥åœ¨ä»»æ„ueå®ä¾‹çš„èŒƒå›´å†…ä½¿ç”¨è¯¥ç»„ä»¶</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å¼€å‘å…¨å±€ç»„ä»¶  </span>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;h1>ç”¨æˆ·ç™»å½•&lt;/h1>&lt;/div>'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2.ä½¿ç”¨å…¨å±€ç»„ä»¶åœ¨Vueå®ä¾‹èŒƒå›´å†…  </span><span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ³¨æ„</span>1.Vue.componentç”¨æ¥å¼€å‘å…¨å±€ç»„ä»¶  å‚æ•°1:ç»„ä»¶çš„åç§°  å‚æ•°2: ç»„ä»¶é…ç½®&#123;&#125; template:'' ç”¨æ¥ä¹¦å†™ç»„ä»¶çš„htm1ä»£ç  templateä¸­å¿…é¡»æœ‰ä¸”åªæœ‰ä¸€ä¸ªrootå…ƒç´   2.ä½¿ç”¨æ—¶éœ€è¦åœ¨vueçš„ä½œç”¨èŒƒå›´å†…æ ¹æ®ç»„ä»¶åä½¿ç”¨å…¨å±€ç»„ä»¶  3.å¦‚æœåœ¨æ³¨å†Œç»„ä»¶è¿‡ç¨‹ä¸­ä½¿ç”¨é©¼å³°å‘½åç»„ä»¶çš„æ–¹å¼åœ¨ä½¿ç”¨ç»„ä»¶æ—¶å¿…é¡»å°†é©¼å³°çš„æ‰€æœ‰å•è¯å°å†™åŠ å…¥-çº¿è¿›è¡Œä½¿ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="11-2-2-å±€éƒ¨ç»„ä»¶æ³¨å†Œ"><a href="#11-2-2-å±€éƒ¨ç»„ä»¶æ³¨å†Œ" class="headerlink" title="11.2.2 å±€éƒ¨ç»„ä»¶æ³¨å†Œ"></a>11.2.2 å±€éƒ¨ç»„ä»¶æ³¨å†Œ</h4><blockquote><p>è¯´æ˜:é€šè¿‡å°†ç»„ä»¶æ³¨å†Œç»™å¯¹åº”<code>vue</code>å®ä¾‹ä¸­ä¸€ä¸ª <code>components</code>å±æ€§æ¥å®Œæˆç»„ä»¶æ³¨å†Œ,è¿™ç§æ–¹å¼ä¸ä¼šå¯¹<code>vue</code>å®ä¾‹é€ æˆç´¯åŠ </p></blockquote><ul><li>ç¬¬ä¸€ç§å¼€å‘</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å±€éƒ¨ç»„ä»¶ç™»å½•æ¨¡æ¿</span><span class="token keyword">let</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div>&lt;h1>ç”¨æˆ·ç®¡ç†&lt;/h1>&lt;/div>'</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">login</span><span class="token operator">:</span> login    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½¿ç”¨å±€éƒ¨ç»„ä»¶</span><span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ç¬¬äºŒç§å¼€å‘</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜å±€éƒ¨ç»„ä»¶æ¨¡æ¿ template æ ‡ç­¾ æ³¨æ„ï¼šåœ¨Vueå®ä¾‹ä½œç”¨èŒƒå›´å¤–å£°æ˜</span><span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"loginTemplate"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>h1<span class="token operator">></span>ç”¨æˆ·ç®¡ç†<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token comment">//2.å®šä¹‰å˜é‡ç”¨æ¥ä¿å­˜æ¨¡æ¿é…ç½®å¯¹è±¡  </span><span class="token keyword">let</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>     <span class="token comment">//å…·ä½“ç»„ä»¶æ¨¡æ¿    </span>    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'#loginTemplate'</span>     <span class="token comment">//ä½¿ç”¨è‡ªå®šä¹‰template æ ‡ç­¾é€‰æ‹©å™¨å³å¯  </span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//3.æ³¨å†Œç»„ä»¶  </span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//ç”¨æ¥æ³¨å†Œå±€éƒ¨ç»„ä»¶        </span>        <span class="token literal-property property">login</span><span class="token operator">:</span> login         <span class="token comment">//æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4ä½¿ç”¨å±€éƒ¨ç»„ä»¶</span><span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="11-3-Propçš„ä½¿ç”¨"><a href="#11-3-Propçš„ä½¿ç”¨" class="headerlink" title="11.3 Propçš„ä½¿ç”¨"></a>11.3 Propçš„ä½¿ç”¨</h3><blockquote><p>ä½œç”¨: <code>props</code>ç”¨æ¥ç»™ç»„ä»¶ä¼ é€’ç›¸åº”é™æ€æ•°æ®æˆ–è€…æ˜¯åŠ¨æ€æ•°æ®çš„</p></blockquote><h4 id="11-3-1-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"><a href="#11-3-1-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨" class="headerlink" title="11.3.1 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"></a>11.3.1 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶æ¨¡æ¿é…ç½®å¯¹è±¡  </span><span class="token keyword">let</span> login<span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div>&lt;h1>æ¬¢è¿ï¼š&#123;&#123;username&#125;&#125;å¹´é¾„ï¼š&#123;&#123;age&#125;&#125;&lt;h1>&lt;/div>'</span><span class="token punctuation">,</span>        <span class="token literal-property property">props</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'userName'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token comment">// propsä½œç”¨ç”¨æ¥æ¥æ”¶ä½¿ç”¨ç»„ä»¶æ—¶é€šè¿‡ç»„ä»¶æ ‡ç­¾ä¼ é€’çš„æ•°  </span><span class="token punctuation">&#125;</span><span class="token comment">//2.æ³¨å†Œç»„ä»¶</span><span class="token keyword">const</span> app <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            login          <span class="token comment">//ç»„ä»¶æ³¨å†Œ</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.é€šè¿‡ç»„ä»¶å®Œæˆæ•°æ®ä¼ é€’</span><span class="token operator">&lt;</span>login user<span class="token operator">-</span>name<span class="token operator">=</span><span class="token string">"å°é™ˆ"</span> age<span class="token operator">=</span><span class="token string">"23"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>1ogin<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“  </span>1.ä½¿ç”¨ç»„ä»¶æ—¶å¯ä»¥åœ¨ç»„ä»¶ä¸Šå®šä¹‰å¤šä¸ªå±æ€§ä»¥åŠå¯¹åº”æ•°æ®  2.åœ¨ç»„ä»¶å†…éƒ¨å¯ä»¥ä½¿ç”¨ propsæ•°ç»„ç”Ÿå‘½å¤šä¸ªå®šä¹‰åœ¨ç»„ä»¶ä¸Šçš„å±æ€§åæ—¥åå¯ä»¥åœ¨ç»„ä»¶ä¸­é€šè¿‡&#123;å±æ€§å&#125;&#125;æ–¹å¼è·å–ç»„ä»¶ä¸­å±æ€§å€¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="11-3-2-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"><a href="#11-3-2-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨" class="headerlink" title="11.3.2 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"></a>11.3.2 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶æ¨¡æ¿å¯¹è±¡ </span><span class="token keyword">const</span> logins <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">"&lt;div>&lt;h1>welcome &#123;&#123;userName&#125;&#125; ,age &#123;&#123;age&#125;&#125;, email: &#123;&#123;email&#125;&#125;,salary &#123;&#123;salary&#125;&#125; !&lt;/h1>&lt;/div>"</span><span class="token punctuation">,</span>            <span class="token literal-property property">props</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"userName"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"email"</span><span class="token punctuation">,</span><span class="token string">"salary"</span><span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span> <span class="token comment">//2.æ³¨å†Œå±€éƒ¨ç»„ä»¶ </span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span><span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token literal-property property">email</span><span class="token operator">:</span><span class="token string">'333@qq.com'</span><span class="token punctuation">,</span>            <span class="token literal-property property">salary</span><span class="token operator">:</span><span class="token string">'200'</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>            login              <span class="token comment">//æ³¨å†Œç»„ä»¶</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.ä½¿ç”¨ç»„ä»¶ </span><span class="token operator">&lt;</span>login <span class="token operator">:</span>email<span class="token operator">=</span><span class="token string">"email"</span> <span class="token operator">:</span>salary<span class="token operator">=</span><span class="token string">"salary"</span> user<span class="token operator">-</span>name<span class="token operator">=</span><span class="token string">"å°é™ˆ"</span> age<span class="token operator">=</span><span class="token string">"24"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="11-3-2-propçš„å•é¡¹æ•°æ®æµ"><a href="#11-3-2-propçš„å•é¡¹æ•°æ®æµ" class="headerlink" title="11.3.2 propçš„å•é¡¹æ•°æ®æµ"></a>11.3.2 propçš„å•é¡¹æ•°æ®æµ</h4><blockquote><p>å•å‘æ•°æ®æµ:æ‰€æœ‰çš„ prop éƒ½ä½¿å¾—å…¶çˆ¶å­propä¹‹é—´å½¢æˆäº†ä¸€ä¸ªå•å‘ä¸‹è¡Œç»‘å®š:çˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­,ä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œ</p><p>æ‰€æœ‰çš„propéƒ½ä½¿å¾—å…¶çˆ¶å­propä¹‹é—´å½¢æˆäº†ä¸€ä¸ªå•å‘ä¸‹è¡Œç»‘å®š:çˆ¶çº§propçš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­,ä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œã€‚è¿™æ ·ä¼šé˜²æ­¢ä»å­ç»„ä»¶æ„å¤–æ”¹å˜çˆ¶çº§ç»„ä»¶çš„çŠ¶<br>æ€,ä»è€Œå¯¼è‡´ä½ çš„åº”ç”¨çš„æ•°æ®æµå‘éš¾ä»¥ç†è§£<br>é¢å¤–çš„,æ¯æ¬¡çˆ¶çº§ç»„ä»¶å‘ç”Ÿæ›´æ–°æ—¶,å­ç»„ä»¶ä¸­æ‰€æœ‰çš„propéƒ½å°†ä¼šåˆ·æ–°ä¸ºæœ€æ–°çš„å€¼ã€‚è¿™æ„å‘³ç€ä½ ä¸åº”è¯¥åœ¨ä¸€ä¸ªå­ç»„ä»¶å†…éƒ¨æ”¹å˜propã€‚å¦‚æœä½ è¿™æ ·åšäº†,Wueä¼šåœ¨æµè§ˆå™¨çš„æ§<br>åˆ¶å°ä¸­å‘å‡ºè­¦å‘Šã€‚ä¸€æ‘˜è‡ªå®˜ç½‘</p></blockquote><h3 id="11-4-ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨"><a href="#11-4-ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨" class="headerlink" title="11.4 ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨"></a>11.4 ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨</h3><p>1.ç»„ä»¶ä¸­å®šä¹‰å±äºç»„ä»¶çš„æ•°æ®</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//ç»„ä»¶å£°æ˜çš„é…ç½®å¯¹è±¡ </span><span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">"&lt;div>&lt;h1>&#123;&#123;name&#125;&#125; Vue&lt;ul>&lt;li v-for='item,index in lists'>&#123;&#123;index+1&#125;&#125;==&#123;&#123;item&#125;&#125;&lt;/li>&lt;/ul>&lt;/h1>&lt;/div>"</span><span class="token punctuation">,</span>    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'learning'</span><span class="token punctuation">,</span>            <span class="token literal-property property">lists</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'java'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'python'</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.ç»„ä»¶å®šä¹‰äº‹ä»¶</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> login <span class="token operator">=</span><span class="token punctuation">&#123;</span>      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">"&lt;div>&lt;h1>&#123;&#123;name&#125;&#125;&lt;/h1>&lt;input type='button' value='ç‚¹å‡»æˆ‘ä¿®æ”¹åç§°' @click='change'>&lt;/div>"</span><span class="token punctuation">,</span>      <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"john"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>        <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"micheal"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.ç»„ä»¶ä¸­å®šä¹‰äº‹ä»¶å’Œç›´æ¥åœ¨vueä¸­å®šä¹‰äº‹ä»¶åŸºæœ¬ä¸€è‡´ç›´æ¥åœ¨ç»„ä»¶å†…éƒ¨å¯¹åº”çš„htm1ä»£ç ä¸ŠåŠ å…¥@äº‹ä»¶å=å‡½æ•°åæ–¹å¼å³å¯2.åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨ methodså±æ€§ç”¨æ¥å®šä¹‰å¯¹åº”çš„äº‹ä»¶å‡½æ•°å³å¯,äº‹ä»¶å‡½æ•°ä¸­thisæŒ‡å‘çš„æ˜¯å½“å‰ç»„ä»¶çš„å®ä¾‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="11-5-å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶"><a href="#11-5-å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶" class="headerlink" title="11.5 å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶"></a>11.5 å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶</h3><p><code>åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨ä¼ é€’è¿‡æ¥çš„ç›¸å…³äº‹ä»¶å¿…é¡»ä½¿ç”¨this.$emit(å‡½æ•°å)æ–¹å¼è°ƒç”¨</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶</span><span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"login"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1<span class="token operator">></span>Vue <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>uname<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">'button'</span> value<span class="token operator">=</span><span class="token string">'ç‚¹æˆ‘'</span> @click<span class="token operator">=</span><span class="token string">'change'</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">"#login"</span><span class="token punctuation">,</span>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>                <span class="token literal-property property">uname</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>uname <span class="token operator">=</span> <span class="token string">'ç‚¹å‡»åè§¦å‘Vueäº‹ä»¶'</span>                <span class="token comment">//è°ƒç”¨Vueä¸­å®ä¾‹çš„äº‹ä»¶</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'fun'</span><span class="token punctuation">)</span><span class="token comment">//è°ƒç”¨ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å…¶ä»–å‡½æ•°æ—¶éœ€è¦ä½¿ç”¨this.$emit('å‡½æ•°åè°ƒç”¨)</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>    <span class="token comment">//2.æ³¨å†Œç»„ä»¶</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'xiaochen'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//ä¸€ä¸ªäº‹ä»¶å‡½æ•°  å°†è¿™ä¸ªäº‹ä»¶å‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶       </span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vueå®ä¾‹çš„äº‹ä»¶'</span><span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            login<span class="token punctuation">,</span>  <span class="token comment">//ç»„ä»¶çš„æ³¨å†Œ  </span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.ä½¿ç”¨ç»„ä»¶</span><span class="token operator">&lt;</span>login <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"username"</span> @fun<span class="token operator">=</span>fun<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span>   <span class="token comment">// ===>åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨this.$emit("fun")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://s2.loli.net/2024/12/20/lksY83NuQHj6bz2.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/lksY83NuQHj6bz2.png"></a></p><h2 id="12-Vueè·¯ç”±"><a href="#12-Vueè·¯ç”±" class="headerlink" title="12.Vueè·¯ç”±"></a>12.Vueè·¯ç”±</h2><p><code>æ³¨æ„äº‹é¡¹</code></p><p><a href="https://s2.loli.net/2024/12/20/Ht3s6BWoJGSvQAp.png" title="image-20241220010637764" class="gallery-item"><img src="https://s2.loli.net/2024/12/20/Ht3s6BWoJGSvQAp.png" alt="image-20241220010637764"></a></p><h3 id="12-1-è·¯ç”±"><a href="#12-1-è·¯ç”±" class="headerlink" title="12.1 è·¯ç”±"></a>12.1 è·¯ç”±</h3><p><code>è·¯ç”±ï¼šæ ¹æ®è¯·æ±‚çš„è·¯å¾„æŒ‰ç…§ä¸€å®šçš„è·¯ç”±è§„åˆ™è¿›è¡Œè¯·æ±‚çš„è½¬å‘ä»è€Œå¸®åŠ©æˆ‘ä»¬å®ç°ç»Ÿä¸€çš„è¯·æ±‚ç®¡ç†</code></p><h3 id="12-2-ä½œç”¨"><a href="#12-2-ä½œç”¨" class="headerlink" title="12.2 ä½œç”¨"></a>12.2 ä½œç”¨</h3><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>ç”¨æ¥åœ¨vueä¸­å®ç°ç»„ä»¶é—´çš„åŠ¨æ€åˆ‡æ¢</code></p><h3 id="12-3-ä½¿ç”¨"><a href="#12-3-ä½¿ç”¨" class="headerlink" title="12.3 ä½¿ç”¨"></a>12.3 ä½¿ç”¨</h3><p>1.å¼•å…¥è·¯ç”±</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://unpkg.com/vue-router/dist/vue-router.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span> <span class="token comment">//Vue è·¯ç”±js</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.åˆ›å»ºç»„ä»¶å¯¹è±¡</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* åˆ›å»ºæ¨¡æ¿ */</span>  <span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"login"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>h1<span class="token operator">></span>ç™»å½•é¡µé¢<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span>  <span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"reg"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>h1<span class="token operator">></span>æ³¨å†Œé¡µé¢<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span>  <span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'#login'</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">const</span> register <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'#reg'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3.å®šä¹‰è·¯ç”±å¯¹è±¡çš„è§„åˆ™</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* å®šä¹‰è·¯ç”± */</span>  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">routes</span><span class="token operator">:</span><span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/login"</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>login<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token comment">//path:è·¯ç”±çš„è·¯å¾„  componentï¼šè·¯ç”±çš„ç›¸åº”ç»„ä»¶</span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/reg"</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>register<span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4.å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//è·¯ç”±æ³¨å†Œåˆ°Vueå®ä¾‹</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token literal-property property">router</span><span class="token operator">:</span>router  <span class="token comment">//è®¾ç½®è·¯ç”±å¯¹è±¡</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5.åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- æ˜¾ç¤ºè·¯ç”±ç»„ä»¶ --&gt;    &lt;router-view&gt;&lt;&#x2F;router-view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>6.æ ¹æ®é“¾æ¥åˆ‡æ¢è·¯ç”±</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#/login<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#/reg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ³¨å†Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="12-4-router-linkä½¿ç”¨"><a href="#12-4-router-linkä½¿ç”¨" class="headerlink" title="12.4  router-linkä½¿ç”¨"></a>12.4  router-linkä½¿ç”¨</h3><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>ä½œç”¨ï¼šç”¨æ¥æ›¿æ¢æˆ‘ä»¬åœ¨åˆ‡æ¢è·¯ç”±æ—¶ä½¿ç”¨aæ ‡ç­¾åˆ‡æ¢è·¯ç”±</code></p><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>å¥½å¤„ï¼šå°±æ˜¯å¯ä»¥è‡ªåŠ¨ç»™è·¯ç”±è·¯å¾„åŠ å…¥#ä¸éœ€è¦æ‰‹åŠ¨åŠ å…¥</code></p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;router-link to&#x3D;&quot;&#x2F;login&quot; tag&#x3D;&quot;button&quot;&gt;ç™»å½•&lt;&#x2F;router-link&gt;&lt;router-link to&#x3D;&quot;&#x2F;reg&quot; tag&#x3D;&quot;span&quot;&gt;æ³¨å†Œ&lt;&#x2F;router-link&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span><span class="token list punctuation">1.</span> router-linkç”¨æ¥æ›¿æ¢ä½¿ç”¨aæ ‡ç­¾å®ç°è·¯ç”±åˆ‡æ¢å¥½å¤„æ˜¯ä¸éœ€è¦ä¹¦å†™#å·ç›´æ¥ä¹¦å†™è·¯ç”±è·¯å¾„<span class="token list punctuation">2.</span> router-1 ink toå±æ€§ç”¨æ¥ä¹¦å†™è·¯ç”±è·¯å¾„tagå±æ€§:ç”¨æ¥å°† router-1inkæ¸²æŸ“æˆæŒ‡å®šçš„æ ‡ç­¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="12-5-é»˜è®¤è·¯ç”±"><a href="#12-5-é»˜è®¤è·¯ç”±" class="headerlink" title="12.5 é»˜è®¤è·¯ç”±"></a>12.5 é»˜è®¤è·¯ç”±</h3><pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>ä½œç”¨:ç”¨æ¥åœ¨ç¬¬ä¸€æ¬¡è¿›å…¥ç•Œé¢æ˜¯æ˜¾ç¤ºä¸€ä¸ªé»˜è®¤çš„ç»„ä»¶</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* å®šä¹‰è·¯ç”± */</span>  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        <span class="token literal-property property">routes</span><span class="token operator">:</span><span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token literal-property property">redirect</span><span class="token operator">:</span><span class="token string">'/login'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// redirect:ç”¨æ¥å½“è®¿é—®çš„æ˜¯é»˜è®¤è·¯ç”±"/"æ—¶è·³è½¬åˆ°æŒ‡å®šçš„è·¯ç”±å±•ç¤ºæ¨èä½¿ç”¨        </span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/login"</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>login<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/reg"</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>register<span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="12-6-è·¯ç”±ä¸­å‚æ•°ä¼ é€’"><a href="#12-6-è·¯ç”±ä¸­å‚æ•°ä¼ é€’" class="headerlink" title="12.6 è·¯ç”±ä¸­å‚æ•°ä¼ é€’"></a>12.6 è·¯ç”±ä¸­å‚æ•°ä¼ é€’</h3><ul><li>ç¬¬ä¸€ç§æ–¹å¼ä¼ é€’å‚æ•° ä¼ ç»Ÿæ–¹å¼</li></ul><ol><li><p>é€šè¿‡?å·å½¢å¼æ‹¼æ¥å‚æ•°</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;router-link to&#x3D;&quot;&#x2F;login?id&#x3D;1&amp;name&#x3D;å¼ ä¸‰&quot; tag&#x3D;&quot;button&quot;&gt;i need login&lt;&#x2F;router-link&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ç»„ä»¶ä¸­è·å–å‚æ•°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'#login'</span><span class="token punctuation">,</span>    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"id: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"  ==> name:"</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ul><li>ç¬¬äºŒç§æ–¹å¼ä¼ é€’å‚æ•° <code>restful</code></li></ul><ol><li><p>é€šè¿‡ä½¿ç”¨è·¯å¾„æ–¹å¼ä¼ é€’</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">"/reg/2/æå››"</span> tag<span class="token operator">=</span><span class="token string">"button"</span><span class="token operator">></span>i need register<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/reg/:id/:name'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> reg<span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç»„ä»¶ä¸­è·å–å‚æ•°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token punctuation">&#123;</span>      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'#reg'</span><span class="token punctuation">,</span>    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'id: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'  ===>name:'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆå…­ï¼‰| JDK1.8 æ–°ç‰¹æ€§</title>
      <link href="/posts/33246.html"/>
      <url>/posts/33246.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><blockquote><p><code>JDK</code> å·²ç»å‡ºåˆ° <code>17</code> äº†ï¼Œä½†æ˜¯ä½ è¿­ä»£ä½ çš„ç‰ˆæœ¬ï¼Œæˆ‘ç”¨æˆ‘çš„ 8ã€‚<code>JDK1.8</code> çš„ä¸€äº›æ–°ç‰¹æ€§ï¼Œå½“ç„¶ç°åœ¨ä¹Ÿä¸æ–°äº†ï¼Œå…¶å®åœ¨å·¥ä½œä¸­å·²ç»å¾ˆå¸¸ç”¨äº†ã€‚</p></blockquote><h2 id="JDK1-8-éƒ½æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ"><a href="#JDK1-8-éƒ½æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ" class="headerlink" title="JDK1.8 éƒ½æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ"></a>JDK1.8 éƒ½æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ</h2><p><code>JDK1.8</code> æœ‰ä¸å°‘æ–°ç‰¹æ€§ï¼Œæˆ‘ä»¬ç»å¸¸æ¥è§¦åˆ°çš„æ–°ç‰¹æ€§å¦‚ä¸‹ï¼š</p><p><a href="https://s2.loli.net/2024/12/19/lJHMBZpq5NW61si.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/lJHMBZpq5NW61si.png"></a> </p><ul><li><p>æ¥å£é»˜è®¤æ–¹æ³•ï¼š<code>Java</code> 8 å…è®¸æˆ‘ä»¬ç»™æ¥å£æ·»åŠ ä¸€ä¸ªéæŠ½è±¡çš„æ–¹æ³•å®ç°ï¼Œåªéœ€è¦ä½¿ç”¨ default å…³é”®å­—ä¿®é¥°å³å¯</p></li><li><p><code>Lambda</code> è¡¨è¾¾å¼å’Œå‡½æ•°å¼æ¥å£ï¼š<code>Lambda</code> è¡¨è¾¾å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µåŒ¿åå†…éƒ¨ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ã€‚<code>Lambda</code> å…è®¸æŠŠå‡½æ•°ä½œä¸ºä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ï¼ˆå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°æ–¹æ³•ä¸­ï¼‰ï¼Œä½¿ç”¨ <code>Lambda</code> è¡¨è¾¾å¼ä½¿ä»£ç æ›´åŠ ç®€æ´ï¼Œä½†æ˜¯ä¹Ÿä¸è¦æ»¥ç”¨ï¼Œå¦åˆ™ä¼šæœ‰å¯è¯»æ€§ç­‰é—®é¢˜ï¼Œã€Š<code>Effective</code> Javaã€‹ä½œè€… <code>Josh Bloch</code> å»ºè®®ä½¿ç”¨ <code>Lambda</code> è¡¨è¾¾å¼æœ€å¥½ä¸è¦è¶…è¿‡ 3 è¡Œã€‚</p></li><li><p><code>Stream API</code>ï¼šç”¨å‡½æ•°å¼ç¼–ç¨‹æ–¹å¼åœ¨é›†åˆç±»ä¸Šè¿›è¡Œå¤æ‚æ“ä½œçš„å·¥å…·ï¼Œé…åˆ <code>Lambda</code> è¡¨è¾¾å¼å¯ä»¥æ–¹ä¾¿çš„å¯¹é›†åˆè¿›è¡Œå¤„ç†ã€‚</p><p>Java8 ä¸­å¤„ç†é›†åˆçš„å…³é”®æŠ½è±¡æ¦‚å¿µï¼Œå®ƒå¯ä»¥æŒ‡å®šä½ å¸Œæœ›å¯¹é›†åˆè¿›è¡Œçš„æ“ä½œï¼Œå¯ä»¥æ‰§è¡Œéå¸¸å¤æ‚çš„æŸ¥æ‰¾ã€è¿‡æ»¤å’Œæ˜ å°„æ•°æ®ç­‰æ“ä½œã€‚ä½¿ç”¨ <code>Stream API</code> å¯¹é›†åˆæ•°æ®è¿›è¡Œæ“ä½œï¼Œå°±ç±»ä¼¼äºä½¿ç”¨ <code>SQL</code> æ‰§è¡Œçš„æ•°æ®åº“æŸ¥è¯¢ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Stream API</code> æ¥å¹¶è¡Œæ‰§è¡Œæ“ä½œã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>Stream API</code> æä¾›äº†ä¸€ç§é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„å¤„ç†æ•°æ®çš„æ–¹å¼ã€‚</p></li><li><p>æ—¥æœŸæ—¶é—´ <code>API</code>ï¼š<code>Java 8</code> å¼•å…¥äº†æ–°çš„æ—¥æœŸæ—¶é—´ API æ”¹è¿›äº†æ—¥æœŸæ—¶é—´çš„ç®¡ç†ã€‚</p></li><li><p><code>Optional</code> ç±»ï¼šç”¨æ¥è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ã€‚å¾ˆä¹…ä»¥å‰ <code>Google Guava</code> é¡¹ç›®å¼•å…¥äº† <code>Optional</code> ä½œä¸ºè§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸çš„ä¸€ç§æ–¹å¼ï¼Œä¸èµæˆä»£ç è¢« <code>null</code> æ£€æŸ¥çš„ä»£ç æ±¡æŸ“ï¼ŒæœŸæœ›ç¨‹åºå‘˜å†™æ•´æ´çš„ä»£ç ã€‚å— <code>Google Guava</code> çš„é¼“åŠ±ï¼Œ<code>Optional</code> ç°åœ¨æ˜¯ <code>Java 8</code> åº“çš„ä¸€éƒ¨åˆ†ã€‚</p></li></ul><h2 id="Lambda-è¡¨è¾¾å¼äº†è§£å¤šå°‘ï¼Ÿ"><a href="#Lambda-è¡¨è¾¾å¼äº†è§£å¤šå°‘ï¼Ÿ" class="headerlink" title="Lambda è¡¨è¾¾å¼äº†è§£å¤šå°‘ï¼Ÿ"></a>Lambda è¡¨è¾¾å¼äº†è§£å¤šå°‘ï¼Ÿ</h2><p><code>Lambda</code> è¡¨è¾¾å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µåŒ¿åå†…éƒ¨ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬ä»¥å‰ä½¿ç”¨ <code>Runnable</code> åˆ›å»ºå¹¶è¿è¡Œçº¿ç¨‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Thread is running before Java8!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯é€šè¿‡å†…éƒ¨ç±»çš„æ–¹å¼æ¥é‡å†™ run æ–¹æ³•ï¼Œä½¿ç”¨ Lambda è¡¨è¾¾å¼ï¼Œè¿˜å¯ä»¥æ›´åŠ ç®€æ´ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Thread is running since Java8!"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç„¶ä¸æ˜¯æ¯ä¸ªæ¥å£éƒ½å¯ä»¥ç¼©å†™æˆ <code>Lambda</code> è¡¨è¾¾å¼ã€‚åªæœ‰é‚£äº›å‡½æ•°å¼æ¥å£ï¼ˆ<code>Functional</code> <code>Interface</code>ï¼‰æ‰èƒ½ç¼©å†™æˆ <code>Lambda</code> è¡¨ç¤ºå¼ã€‚</p><p>æ‰€è°“å‡½æ•°å¼æ¥å£ï¼ˆ<code>Functional</code> <code>Interface</code>ï¼‰å°±æ˜¯åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å£°æ˜ã€‚é’ˆå¯¹è¯¥æ¥å£ç±»å‹çš„æ‰€æœ‰ Lambda è¡¨è¾¾å¼éƒ½ä¼šä¸è¿™ä¸ªæŠ½è±¡æ–¹æ³•åŒ¹é…ã€‚</p><blockquote><p>Java8 æœ‰å“ªäº›å†…ç½®å‡½æ•°å¼æ¥å£ï¼Ÿ</p></blockquote><p><code>JDK 1.8 API</code> åŒ…å«äº†å¾ˆå¤šå†…ç½®çš„å‡½æ•°å¼æ¥å£ã€‚å…¶ä¸­å°±åŒ…æ‹¬æˆ‘ä»¬åœ¨è€ç‰ˆæœ¬ä¸­ç»å¸¸è§åˆ°çš„ <strong>Comparator</strong> å’Œ **<code>Runnable</code>**ï¼Œ<code>Java 8</code> ä¸ºä»–ä»¬éƒ½æ·»åŠ äº† <code>@FunctionalInterface</code> æ³¨è§£ï¼Œä»¥ç”¨æ¥æ”¯æŒ Lambda è¡¨è¾¾å¼ã€‚</p><p>é™¤äº†è¿™ä¸¤ä¸ªä¹‹å¤–ï¼Œè¿˜æœ‰ <code>Callableã€Predicateã€Functionã€Supplierã€Consumer</code> ç­‰ç­‰ã€‚</p><h2 id="Optional-äº†è§£å—ï¼Ÿ"><a href="#Optional-äº†è§£å—ï¼Ÿ" class="headerlink" title="Optional äº†è§£å—ï¼Ÿ"></a>Optional äº†è§£å—ï¼Ÿ</h2><p><code>Optional</code>æ˜¯ç”¨äºé˜²èŒƒ <code>NullPointerException</code>ã€‚</p><p>å¯ä»¥å°† <code>Optional</code> çœ‹åšæ˜¯åŒ…è£…å¯¹è±¡ï¼ˆå¯èƒ½æ˜¯ <code>null</code>, ä¹Ÿæœ‰å¯èƒ½é <code>null</code>ï¼‰çš„å®¹å™¨ã€‚å½“æˆ‘ä»¬å®šä¹‰äº† ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„å¯¹è±¡å¯èƒ½æ˜¯ç©ºï¼Œä¹Ÿæœ‰å¯èƒ½éç©ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨ <code>Optional</code> æ¥åŒ…è£…å®ƒï¼Œè¿™ä¹Ÿæ˜¯åœ¨ Java 8 è¢«æ¨èä½¿ç”¨çš„åšæ³•ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"bam"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// true</span>optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// "bam"</span>optional<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">"fallback"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// "bam"</span>optional<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// "b"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Stream-æµç”¨è¿‡å—ï¼Ÿ"><a href="#Stream-æµç”¨è¿‡å—ï¼Ÿ" class="headerlink" title="Stream æµç”¨è¿‡å—ï¼Ÿ"></a>Stream æµç”¨è¿‡å—ï¼Ÿ</h2><p><code>Stream</code> æµï¼Œç®€å•æ¥è¯´ï¼Œä½¿ç”¨ <code>java.util.Stream</code> å¯¹ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„é›†åˆåšå„ç§æ“ä½œã€‚è¿™äº›æ“ä½œå¯èƒ½æ˜¯ <em>ä¸­é—´æ“ä½œ</em> äº¦æˆ–æ˜¯ _ç»ˆç«¯æ“ä½œ_ã€‚ç»ˆç«¯æ“ä½œä¼šè¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œä¸­é—´æ“ä½œä¼šè¿”å›ä¸€ä¸ª <code>Stream</code> æµã€‚</p><p><code>Stream</code> æµä¸€èˆ¬ç”¨äºé›†åˆï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªé›†åˆåšå‡ ä¸ªå¸¸è§æ“ä½œï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> stringCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ddd2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"aaa2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"aaa1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ccc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ddd1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Filter è¿‡æ»¤</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa2", "aaa1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Sorted æ’åº</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa1", "aaa2"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Map è½¬æ¢</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">toUpperCase</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "DDD2", "DDD1", "CCC", "BBB3", "BBB2", "AAA2", "AAA1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Match åŒ¹é…</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦æœ‰ä»¥ a å¼€å¤´çš„, åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªï¼Œå³è¿”å› true</span><span class="token keyword">boolean</span> anyStartsWithA <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>anyStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦éƒ½æ˜¯ä»¥ a å¼€å¤´çš„</span><span class="token keyword">boolean</span> allStartsWithA <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>allStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// false</span><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦éƒ½ä¸æ˜¯ä»¥ z å¼€å¤´çš„,</span><span class="token keyword">boolean</span> noneStartsWithZ <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>noneStartsWithZ<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Count è®¡æ•°</strong></li></ul><p><code>count</code> æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå®ƒèƒ½å¤Ÿç»Ÿè®¡ <code>stream</code> æµä¸­çš„å…ƒç´ æ€»æ•°ï¼Œè¿”å›å€¼æ˜¯ <code>long</code> ç±»å‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å…ˆå¯¹ list ä¸­å­—ç¬¦ä¸²å¼€å¤´ä¸º b è¿›è¡Œè¿‡æ»¤ï¼Œè®©åç»Ÿè®¡æ•°é‡</span><span class="token keyword">long</span> startsWithB <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>startsWithB<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>Reduce</strong></li></ul><p><code>Reduce</code> ä¸­æ–‡ç¿»è¯‘ä¸ºï¼š_å‡å°‘ã€ç¼©å°_ã€‚é€šè¿‡å…¥å‚çš„ <code>Function</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°† <code>list</code> å½’çº¦æˆä¸€ä¸ªå€¼ã€‚å®ƒçš„è¿”å›ç±»å‹æ˜¯ <code>Optional</code> ç±»å‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> reduced <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-></span> s1 <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>reduced<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa1#aaa2#bbb1#bbb2#bbb3#ccc#ddd1#ddd2"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šæ˜¯å¸¸è§çš„å‡ ç§æµå¼æ“ä½œï¼Œè¿˜æœ‰å…¶å®ƒçš„ä¸€äº›æµå¼æ“ä½œï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´ä¾¿æ·åœ°å¤„ç†é›†åˆæ•°æ®ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/fby849IB5uW7stp.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/fby849IB5uW7stp.png"></a> </p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆäº”ï¼‰| åºåˆ—åŒ–ã€æ³›å‹ã€æ³¨è§£ã€åå°„</title>
      <link href="/posts/10468.html"/>
      <url>/posts/10468.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h1><h2 id="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ</h2><p>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Œåºåˆ—åŒ–å°±æ˜¯<strong>æŠŠ Java å¯¹è±¡è½¬ä¸ºäºŒè¿›åˆ¶æµ</strong>ï¼Œæ–¹ä¾¿å­˜å‚¨å’Œä¼ è¾“ã€‚</p><p>æ‰€ä»¥<strong>ååºåˆ—åŒ–å°±æ˜¯æŠŠäºŒè¿›åˆ¶æµæ¢å¤æˆå¯¹è±¡</strong>ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/QygVTwWMIBsfpXr.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/QygVTwWMIBsfpXr.png"></a>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><p>ç±»æ¯”æˆ‘ä»¬ç”Ÿæ´»ä¸­ä¸€äº›å¤§ä»¶ç‰©å“çš„è¿è¾“ï¼Œè¿è¾“çš„æ—¶å€™æŠŠå®ƒæ‹†äº†æ‰“åŒ…ï¼Œç”¨çš„æ—¶å€™å†æ‹†åŒ…ç»„è£…ã€‚</p><blockquote><p><code>Serializable</code> æ¥å£æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p></blockquote><p>è¿™ä¸ªæ¥å£åªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæ²¡æœ‰å…·ä½“çš„ä½œç”¨ï¼Œä½†æ˜¯å¦‚æœä¸å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨æœ‰äº›åºåˆ—åŒ–åœºæ™¯ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥ä¸€èˆ¬å»ºè®®ï¼Œåˆ›å»ºçš„ <code>JavaBean</code> ç±»éƒ½å®ç° <code>Serializable</code>ã€‚</p><blockquote><p><code>serialVersionUID</code> åˆæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p></blockquote><p><code>serialVersionUID</code> å°±æ˜¯èµ·éªŒè¯ä½œç”¨ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°è¿™æ ·çš„ä»£ç ï¼Œè¿™ä¸ª <code>ID</code> å…¶å®å°±æ˜¯ç”¨æ¥éªŒè¯åºåˆ—åŒ–çš„å¯¹è±¡å’Œååºåˆ—åŒ–å¯¹åº”çš„å¯¹è±¡ ID æ˜¯å¦ä¸€è‡´ã€‚</p><p>è¿™ä¸ª <code>ID</code> çš„æ•°å­—å…¶å®ä¸é‡è¦ï¼Œæ— è®ºæ˜¯ 1L è¿˜æ˜¯ <code>IDE</code> è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œåªè¦åºåˆ—åŒ–æ—¶å€™å¯¹è±¡çš„ <code>serialVersionUID</code> å’Œååºåˆ—åŒ–æ—¶å€™å¯¹è±¡çš„ <code>serialVersionUID</code> ä¸€è‡´çš„è¯å°±è¡Œã€‚</p><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®š <code>serialVersionUID</code> ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»çš„ç›¸å…³ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡çº¹ã€‚</p><p>æ‰€ä»¥å¦‚æœä½ æ²¡æœ‰å®šä¹‰ä¸€ä¸ª <code>serialVersionUID</code>ï¼Œ ç»“æœåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ä¹‹åï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰æŠŠå¯¹è±¡çš„ç±»çš„ç»“æ„æ”¹äº†ï¼Œæ¯”å¦‚å¢åŠ äº†ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œåˆ™æ­¤æ—¶çš„ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚</p><p>å› ä¸ºç±»çš„ç»“æ„å˜äº†ï¼Œæ‰€ä»¥ <code>serialVersionUID</code> å°±ä¸ä¸€è‡´ã€‚</p><blockquote><p>Java åºåˆ—åŒ–ä¸åŒ…å«é™æ€å˜é‡ï¼Ÿ</p></blockquote><p>åºåˆ—åŒ–çš„æ—¶å€™æ˜¯ä¸åŒ…å«é™æ€å˜é‡çš„ã€‚</p><blockquote><p>å¦‚æœæœ‰äº›å˜é‡ä¸æƒ³åºåˆ—åŒ–ï¼Œæ€ä¹ˆåŠï¼Ÿ</p></blockquote><p>å¯¹äºä¸æƒ³è¿›è¡Œåºåˆ—åŒ–çš„å˜é‡ï¼Œä½¿ç”¨ <code>transient</code>å…³é”®å­—ä¿®é¥°ã€‚</p><p><code>transient</code> å…³é”®å­—çš„ä½œç”¨æ˜¯ï¼šé˜»æ­¢å®ä¾‹ä¸­é‚£äº›ç”¨æ­¤å…³é”®å­—ä¿®é¥°çš„çš„å˜é‡åºåˆ—åŒ–ï¼›å½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œè¢« <code>transient</code> ä¿®é¥°çš„å˜é‡å€¼ä¸ä¼šè¢«æŒä¹…åŒ–å’Œæ¢å¤ã€‚<code>transient</code> åªèƒ½ä¿®é¥°å˜é‡ï¼Œä¸èƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•ã€‚</p><h2 id="è¯´è¯´æœ‰å‡ ç§åºåˆ—åŒ–æ–¹å¼ï¼Ÿ"><a href="#è¯´è¯´æœ‰å‡ ç§åºåˆ—åŒ–æ–¹å¼ï¼Ÿ" class="headerlink" title="è¯´è¯´æœ‰å‡ ç§åºåˆ—åŒ–æ–¹å¼ï¼Ÿ"></a>è¯´è¯´æœ‰å‡ ç§åºåˆ—åŒ–æ–¹å¼ï¼Ÿ</h2><p>Java åºåˆ—åŒ–æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¸¸è§çš„æœ‰ä¸‰ç§ï¼š</p><p><a href="https://s2.loli.net/2024/12/19/JeFED1Gwp9lugfx.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/JeFED1Gwp9lugfx.png"></a> </p><ul><li><code>Java</code> å¯¹è±¡æµåˆ—åŒ– ï¼š<code>Java</code> åŸç”Ÿåºåˆ—åŒ–æ–¹æ³•å³é€šè¿‡ Java åŸç”Ÿæµ (<code>InputStream</code> å’Œ <code>OutputStream</code> ä¹‹é—´çš„è½¬åŒ–) çš„æ–¹å¼è¿›è¡Œè½¬åŒ–ï¼Œä¸€èˆ¬æ˜¯å¯¹è±¡è¾“å‡ºæµ <code>ObjectOutputStream</code>å’Œå¯¹è±¡è¾“å…¥æµ <code>ObjectIå©utStream</code>ã€‚</li><li><code>Json</code> åºåˆ—åŒ–ï¼šè¿™ä¸ªå¯èƒ½æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„åºåˆ—åŒ–æ–¹å¼ï¼Œ<code>Json</code> åºåˆ—åŒ–çš„é€‰æ‹©å¾ˆå¤šï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ <code>jackson</code> åŒ…ï¼Œé€šè¿‡ <code>ObjectMapper</code> ç±»æ¥è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚å°†å¯¹è±¡è½¬åŒ–ä¸º <code>byte</code> æ•°ç»„æˆ–è€…å°† <code>json</code> ä¸²è½¬åŒ–ä¸ºå¯¹è±¡ã€‚</li><li><code>ProtoBuff</code> åºåˆ—åŒ–ï¼š<code>ProtocolBuffer</code> æ˜¯ä¸€ç§è½»ä¾¿é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œ<code>ProtoBuff</code> åºåˆ—åŒ–å¯¹è±¡å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šå°†å…¶å‹ç¼©ï¼Œå¯ä»¥å¤§å¤§å‡å°‘æ•°æ®ä¼ è¾“å¤§å°ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li></ul><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><h2 id="Java-æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„é€šé…ç¬¦ï¼Ÿ"><a href="#Java-æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„é€šé…ç¬¦ï¼Ÿ" class="headerlink" title="Java æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„é€šé…ç¬¦ï¼Ÿ"></a>Java æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„é€šé…ç¬¦ï¼Ÿ</h2><blockquote><p>ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ</p></blockquote><p>Java æ³›å‹ï¼ˆgenericsï¼‰æ˜¯ JDK 5 ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§, æ³›å‹æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å…è®¸ç¨‹åºå‘˜åœ¨ç¼–è¯‘æ—¶æ£€æµ‹åˆ°éæ³•çš„ç±»å‹ã€‚æ³›å‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œç›´æ¥æ·»åŠ ä¼šæŠ¥é”™</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">List</span><span class="token punctuation">></span></span> clazz <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Method</span> add <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½†æ˜¯é€šè¿‡åå°„æ·»åŠ ï¼Œæ˜¯å¯ä»¥çš„</span>add<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token string">"kl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³›å‹ä¸€èˆ¬æœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼: <strong>æ³›å‹ç±»</strong>ã€<strong>æ³›å‹æ¥å£</strong>ã€<strong>æ³›å‹æ–¹æ³•</strong>ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/82sAnUaqEl9jKtk.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/82sAnUaqEl9jKtk.png"></a> </p><p><strong>1. æ³›å‹ç±»</strong>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æ­¤å¤„Tå¯ä»¥éšä¾¿å†™ä¸ºä»»æ„æ ‡è¯†ï¼Œå¸¸è§çš„å¦‚Tã€Eã€Kã€Vç­‰å½¢å¼çš„å‚æ•°å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹</span><span class="token comment">//åœ¨å®ä¾‹åŒ–æ³›å‹ç±»æ—¶ï¼Œå¿…é¡»æŒ‡å®šTçš„å…·ä½“ç±»å‹</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">T</span> key<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Generic</span><span class="token punctuation">(</span><span class="token class-name">T</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> key<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä½•å®ä¾‹åŒ–æ³›å‹ç±»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> genericInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">123456</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2. æ³›å‹æ¥å£</strong> ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">GeneratorImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Generator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°æ³›å‹æ¥å£ï¼ŒæŒ‡å®šç±»å‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">GeneratorImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Generator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>3. æ³›å‹æ–¹æ³•</strong> ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span> <span class="token class-name">E</span> <span class="token punctuation">></span></span> <span class="token keyword">void</span> <span class="token function">printArray</span><span class="token punctuation">(</span> <span class="token class-name">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inputArray <span class="token punctuation">)</span>   <span class="token punctuation">&#123;</span>         <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token class-name">E</span> element <span class="token operator">:</span> inputArray <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span> <span class="token string">"%s "</span><span class="token punctuation">,</span> element <span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åˆ›å»ºä¸åŒç±»å‹æ•°ç»„ï¼šInteger, Double å’Œ Character</span><span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> intArray <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> stringArray <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"World"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">printArray</span><span class="token punctuation">(</span> intArray  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printArray</span><span class="token punctuation">(</span> stringArray  <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³›å‹å¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ï¼Ÿ</p></blockquote><p><strong>å¸¸ç”¨çš„é€šé…ç¬¦ä¸ºï¼šTï¼ŒEï¼ŒKï¼ŒVï¼Œï¼Ÿ</strong></p><ul><li>ï¼Ÿè¡¨ç¤ºä¸ç¡®å®šçš„ java ç±»å‹</li><li>T (type) è¡¨ç¤ºå…·ä½“çš„ä¸€ä¸ª java ç±»å‹</li><li>K V (key value) åˆ†åˆ«ä»£è¡¨ java é”®å€¼ä¸­çš„ Key Value</li><li>E (element) ä»£è¡¨ Element</li></ul><blockquote><p>ä»€ä¹ˆæ˜¯æ³›å‹æ“¦é™¤ï¼Ÿ</p></blockquote><p>æ‰€è°“çš„æ³›å‹æ“¦é™¤ï¼Œå®˜æ–¹åå« â€œç±»å‹æ“¦é™¤â€ã€‚</p><p>Java çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Œè¿™æ˜¯å› ä¸º Java åœ¨ç¼–è¯‘æœŸé—´ï¼Œæ‰€æœ‰çš„ç±»å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦æ‰ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™æ˜¯æ²¡æœ‰æ³›å‹çš„ã€‚</p><p>ä¾‹å¦‚è¿™æ®µä»£ç ï¼Œå¾€ä¸€ç¾¤çŒ«é‡Œæ”¾æ¡ç‹—ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Cat</span><span class="token punctuation">></span></span> cats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Cat</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LinkedList</span> list <span class="token operator">=</span> cats<span class="token punctuation">;</span>  <span class="token comment">// æ³¨æ„æˆ‘åœ¨è¿™é‡ŒæŠŠèŒƒå‹å»æ‰äº†ï¼Œä½†æ˜¯listå’Œcatsæ˜¯åŒä¸€ä¸ªé“¾è¡¨ï¼</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å®Œå…¨æ²¡é—®é¢˜ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å› ä¸º Java çš„èŒƒå‹åªå­˜åœ¨äºæºç é‡Œï¼Œç¼–è¯‘çš„æ—¶å€™ç»™ä½ é™æ€åœ°æ£€æŸ¥ä¸€ä¸‹èŒƒå‹ç±»å‹æ˜¯å¦æ­£ç¡®ï¼Œè€Œåˆ°äº†è¿è¡Œæ—¶å°±ä¸æ£€æŸ¥äº†ã€‚ä¸Šé¢è¿™æ®µä»£ç åœ¨ JREï¼ˆJava <strong>è¿è¡Œ</strong>ç¯å¢ƒï¼‰çœ‹æ¥å’Œä¸‹é¢è¿™æ®µæ²¡åŒºåˆ«ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LinkedList</span> cats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ³¨æ„ï¼šæ²¡æœ‰èŒƒå‹ï¼</span><span class="token class-name">LinkedList</span> list <span class="token operator">=</span> cats<span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸ºä»€ä¹ˆè¦ç±»å‹æ“¦é™¤å‘¢ï¼Ÿ</p><p>ä¸»è¦æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œå› ä¸º JDK5 ä¹‹å‰æ˜¯æ²¡æœ‰æ³›å‹çš„ï¼Œä¸ºäº†è®© JVM ä¿æŒå‘ä¸‹å…¼å®¹ï¼Œå°±å‡ºäº†ç±»å‹æ“¦é™¤è¿™ä¸ªç­–ç•¥ã€‚</p><h1 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h1><h2 id="è¯´ä¸€ä¸‹ä½ å¯¹æ³¨è§£çš„ç†è§£ï¼Ÿ"><a href="#è¯´ä¸€ä¸‹ä½ å¯¹æ³¨è§£çš„ç†è§£ï¼Ÿ" class="headerlink" title="è¯´ä¸€ä¸‹ä½ å¯¹æ³¨è§£çš„ç†è§£ï¼Ÿ"></a>è¯´ä¸€ä¸‹ä½ å¯¹æ³¨è§£çš„ç†è§£ï¼Ÿ</h2><p><strong>Java æ³¨è§£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‡è®°</strong>ï¼Œå¯ä»¥ç†è§£æˆç”Ÿæ´»ä¸­çš„ä¸€ä¸ªäººçš„ä¸€äº›å°è£…æ‰®ï¼Œæ¯”å¦‚æˆ´ä»€ä¹ˆä»€ä¹ˆå¸½å­ï¼Œæˆ´ä»€ä¹ˆçœ¼é•œã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644374.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644374.png"></a> </p><p>æ³¨è§£å¯ä»¥æ ‡è®°åœ¨ç±»ä¸Šã€æ–¹æ³•ä¸Šã€å±æ€§ä¸Šç­‰ï¼Œæ ‡è®°è‡ªèº«ä¹Ÿå¯ä»¥è®¾ç½®ä¸€äº›å€¼ï¼Œæ¯”å¦‚å¸½å­é¢œè‰²æ˜¯ç»¿è‰²ã€‚</p><p>æœ‰äº†æ ‡è®°ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç¼–è¯‘æˆ–è€…è¿è¡Œé˜¶æ®µå»è¯†åˆ«è¿™äº›æ ‡è®°ï¼Œç„¶åæä¸€äº›äº‹æƒ…ï¼Œè¿™å°±æ˜¯æ³¨è§£çš„ç”¨å¤„ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬å¸¸è§çš„ <code>AOP</code>ï¼Œä½¿ç”¨æ³¨è§£ä½œä¸ºåˆ‡ç‚¹å°±æ˜¯è¿è¡ŒæœŸæ³¨è§£çš„åº”ç”¨ï¼›æ¯”å¦‚ <code>lombok</code>ï¼Œå°±æ˜¯æ³¨è§£åœ¨ç¼–è¯‘æœŸçš„è¿è¡Œã€‚</p><p>æ³¨è§£ç”Ÿå‘½å‘¨æœŸæœ‰ä¸‰å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>RetentionPolicy.SOURCE</code>ï¼šç»™ç¼–è¯‘å™¨ç”¨çš„ï¼Œä¸ä¼šå†™å…¥ <code>class</code> æ–‡ä»¶</li><li><code>RetentionPolicy.CLASS</code>ï¼šä¼šå†™å…¥ <code>class</code> æ–‡ä»¶ï¼Œåœ¨ç±»åŠ è½½é˜¶æ®µä¸¢å¼ƒï¼Œä¹Ÿå°±æ˜¯è¿è¡Œçš„æ—¶å€™å°±æ²¡è¿™ä¸ªä¿¡æ¯äº†</li><li><code>RetentionPolicy.RUNTIME</code>ï¼šä¼šå†™å…¥ <code>class</code> æ–‡ä»¶ï¼Œæ°¸ä¹…ä¿å­˜ï¼Œå¯ä»¥é€šè¿‡åå°„è·å–æ³¨è§£ä¿¡æ¯</li></ul><p>æ‰€ä»¥æˆ‘ä¸Šæ–‡å†™çš„æ˜¯è§£æçš„æ—¶å€™ï¼Œæ²¡å†™å…·ä½“æ˜¯è§£æå•¥ï¼Œå› ä¸ºä¸åŒçš„ç”Ÿå‘½å‘¨æœŸçš„è§£æåŠ¨ä½œæ˜¯ä¸åŒçš„ã€‚</p><p>åƒå¸¸è§çš„ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641804.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641804.png"></a> </p><p>å°±æ˜¯ç»™ç¼–è¯‘å™¨ç”¨çš„ï¼Œç¼–è¯‘å™¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥æ²¡é—®é¢˜å°± <code>over</code> äº†ï¼Œ<code>class</code> æ–‡ä»¶é‡Œé¢ä¸ä¼šæœ‰ <code>Override</code> è¿™ä¸ªæ ‡è®°ã€‚</p><p>å†æ¯”å¦‚ <code>Spring</code> å¸¸è§çš„ <code>Autowired</code> ï¼Œå°±æ˜¯ <code>RUNTIME</code> çš„ï¼Œæ‰€ä»¥<strong>åœ¨è¿è¡Œçš„æ—¶å€™å¯ä»¥é€šè¿‡åå°„å¾—åˆ°æ³¨è§£çš„ä¿¡æ¯</strong>ï¼Œè¿˜èƒ½æ‹¿åˆ°æ ‡è®°çš„å€¼ <code>required</code> ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644704.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644704.png"></a></p><h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><h2 id="ä»€ä¹ˆæ˜¯åå°„ï¼Ÿåº”ç”¨ï¼ŸåŸç†ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åå°„ï¼Ÿåº”ç”¨ï¼ŸåŸç†ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åå°„ï¼Ÿåº”ç”¨ï¼ŸåŸç†ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åå°„ï¼Ÿåº”ç”¨ï¼ŸåŸç†ï¼Ÿ</h2><blockquote><p>ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</p></blockquote><p>æˆ‘ä»¬é€šå¸¸éƒ½æ˜¯åˆ©ç”¨ <code>new</code>æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œè¿™å¯ä»¥è¯´å°±æ˜¯ä¸€ç§ â€œæ­£å°„â€ï¼Œè¿™ç§æ–¹å¼åœ¨ç¼–è¯‘æ—¶å€™å°±ç¡®å®šäº†ç±»å‹ä¿¡æ¯ã€‚</p><p>è€Œå¦‚æœï¼Œæˆ‘ä»¬æƒ³åœ¨æ—¶å€™åŠ¨æ€åœ°è·å–ç±»ä¿¡æ¯ã€åˆ›å»ºç±»å®ä¾‹ã€è°ƒç”¨ç±»æ–¹æ³•è¿™æ—¶å€™å°±è¦ç”¨åˆ°<strong>åå°„</strong>ã€‚</p><p>é€šè¿‡åå°„ä½ å¯ä»¥è·å–ä»»æ„ä¸€ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä½ è¿˜å¯ä»¥è°ƒç”¨è¿™äº›æ–¹æ³•å’Œå±æ€§ã€‚</p><p>åå°„æœ€æ ¸å¿ƒçš„å››ä¸ªç±»ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641099.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641099.png"></a>Java åå°„ç›¸å…³ç±»</p><blockquote><p>åå°„çš„åº”ç”¨åœºæ™¯ï¼Ÿ</p></blockquote><p>ä¸€èˆ¬æˆ‘ä»¬å¹³æ—¶éƒ½æ˜¯åœ¨åœ¨å†™ä¸šåŠ¡ä»£ç ï¼Œå¾ˆå°‘ä¼šæ¥è§¦åˆ°ç›´æ¥ä½¿ç”¨åå°„æœºåˆ¶çš„åœºæ™¯ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å¹¶ä¸ä»£è¡¨åå°„æ²¡æœ‰ç”¨ã€‚ç›¸åï¼Œæ­£æ˜¯å› ä¸ºåå°„ï¼Œä½ æ‰èƒ½è¿™ä¹ˆè½»æ¾åœ°ä½¿ç”¨å„ç§æ¡†æ¶ã€‚åƒ Spring/Spring Bootã€MyBatis ç­‰ç­‰æ¡†æ¶ä¸­éƒ½å¤§é‡ä½¿ç”¨äº†åå°„æœºåˆ¶ã€‚</p><p>åƒ <code>Spring</code> é‡Œçš„å¾ˆå¤š <strong>æ³¨è§£</strong> ï¼Œå®ƒçœŸæ­£çš„åŠŸèƒ½å®ç°å°±æ˜¯åˆ©ç”¨åå°„ã€‚</p><p>å°±åƒä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ Spring çš„æ—¶å€™ ï¼Œä¸€ä¸ª <code>@Component</code>æ³¨è§£å°±å£°æ˜äº†ä¸€ä¸ªç±»ä¸º Spring Bean å‘¢ï¼Ÿä¸ºä»€ä¹ˆé€šè¿‡ä¸€ä¸ª <code>@Value</code>æ³¨è§£å°±è¯»å–åˆ°é…ç½®æ–‡ä»¶ä¸­çš„å€¼å‘¢ï¼Ÿç©¶ç«Ÿæ˜¯æ€ä¹ˆèµ·ä½œç”¨çš„å‘¢ï¼Ÿ</p><p>è¿™äº›éƒ½æ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥åŸºäºåå°„æ“ä½œç±»ï¼Œç„¶åè·å–åˆ°ç±» / å±æ€§ / æ–¹æ³• / æ–¹æ³•çš„å‚æ•°ä¸Šçš„æ³¨è§£ï¼Œæ³¨è§£è¿™é‡Œå°±æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯æ ‡è®°ï¼Œæˆ‘ä»¬å¯¹æ³¨è§£æ ‡è®°çš„ç±» / å±æ€§ / æ–¹æ³•è¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼›äºŒæ˜¯æ³¨è§£æœ¬èº«æœ‰ä¸€äº›ä¿¡æ¯ï¼Œå¯ä»¥å‚ä¸åˆ°å¤„ç†çš„é€»è¾‘ä¸­ã€‚</p><blockquote><p>åå°„çš„åŸç†ï¼Ÿ</p></blockquote><p>æˆ‘ä»¬éƒ½çŸ¥é“ <code>Java</code> ç¨‹åºçš„æ‰§è¡Œåˆ†ä¸ºç¼–è¯‘å’Œè¿è¡Œä¸¤æ­¥ï¼Œç¼–è¯‘ä¹‹åä¼šç”Ÿæˆå­—èŠ‚ç  (.class) æ–‡ä»¶ï¼ŒJVM è¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ï¼Œä¼šåŠ è½½å­—èŠ‚ç æ–‡ä»¶ï¼Œå°†ç±»å‹ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯åŠ è½½è¿›æ–¹æ³•åŒºï¼Œåå°„å°±æ˜¯å»è·å–è¿™äº›ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œå„ç§æ“ä½œã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaåŸºç¡€æ ¸å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆå››ï¼‰| å¼‚å¸¸å¤„ç†åŠIO</title>
      <link href="/posts/55137.html"/>
      <url>/posts/55137.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="Java-ä¸­å¼‚å¸¸å¤„ç†ä½“ç³»"><a href="#Java-ä¸­å¼‚å¸¸å¤„ç†ä½“ç³»" class="headerlink" title="Java ä¸­å¼‚å¸¸å¤„ç†ä½“ç³»?"></a>Java ä¸­å¼‚å¸¸å¤„ç†ä½“ç³»?</h2><p>Java çš„å¼‚å¸¸ä½“ç³»æ˜¯åˆ†ä¸ºå¤šå±‚çš„ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644491.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644491.png"></a>Java å¼‚å¸¸ä½“ç³»</p><p><code>Throwable</code>æ˜¯ <code>Java</code> è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯æˆ–å¼‚å¸¸çš„åŸºç±»ã€‚</p><p><code>Throwable</code> </p><ul><li><code>Error</code>ï¼šç³»ç»Ÿå†…éƒ¨é”™è¯¯æ¯”å¦‚è™šæ‹Ÿæœºå¼‚å¸¸ï¼Œæ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„ã€‚</li><li> <code>Exception</code>ï¼šç¨‹åºé—®é¢˜å¯¼è‡´çš„å¼‚å¸¸</li><li><code>CheckedException</code> å—æ£€å¼‚å¸¸ï¼šç¼–è¯‘å™¨ä¼šå¼ºåˆ¶æ£€æŸ¥å¹¶è¦æ±‚å¤„ç†çš„å¼‚å¸¸ã€‚</li><li><code>RuntimeException</code> è¿è¡Œæ—¶å¼‚å¸¸ï¼šç¨‹åºè¿è¡Œä¸­å‡ºç°å¼‚å¸¸ï¼Œæ¯”å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„ç©ºæŒ‡é’ˆã€æ•°ç»„ä¸‹æ ‡è¶Šç•Œç­‰ç­‰</li></ul><h2 id="å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Ÿ"><a href="#å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Ÿ" class="headerlink" title="å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Ÿ"></a>å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Ÿ</h2><p>é’ˆå¯¹å¼‚å¸¸çš„å¤„ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p><a href="sp7qab7o2.hd-bkt.clouddn.com/images/20250107215110181.png" class="gallery-item"><img src="sp7qab7o2.hd-bkt.clouddn.com/images/20250107215110181.png"></a></p><ul><li><strong>é‡åˆ°å¼‚å¸¸ä¸è¿›è¡Œå…·ä½“å¤„ç†ï¼Œè€Œæ˜¯ç»§ç»­æŠ›ç»™è°ƒç”¨è€… ï¼ˆthrowï¼Œthrowsï¼‰</strong></li></ul><p>æŠ›å‡ºå¼‚å¸¸æœ‰ä¸‰ç§å½¢å¼ï¼Œä¸€æ˜¯ <code>throw</code>, ä¸€ä¸ª <code>throws</code>ï¼Œè¿˜æœ‰ä¸€ç§ç³»ç»Ÿè‡ªåŠ¨æŠ›å¼‚å¸¸ã€‚</p><p><code>throws</code> ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œåé¢è·Ÿçš„æ˜¯å¼‚å¸¸ç±»ï¼Œå¯ä»¥è·Ÿå¤šä¸ªï¼›è€Œ <code>throw</code> ç”¨åœ¨æ–¹æ³•å†…ï¼Œåé¢è·Ÿçš„æ˜¯å¼‚å¸¸å¯¹è±¡ã€‚</p><ul><li><strong>try catch æ•è·å¼‚å¸¸</strong></li></ul><p>åœ¨ <code>catch</code> è¯­å¥å—ä¸­è¡¥è´§å‘ç”Ÿçš„å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//åŒ…å«å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸çš„ä»£ç ä»¥åŠå£°æ˜å¼‚å¸¸çš„æ–¹æ³•</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æ•è·å¼‚å¸¸å¹¶è¿›è¡Œå¤„ç†</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>                                                       <span class="token punctuation">&#125;</span><span class="token comment">//å¯é€‰ï¼Œå¿…æ‰§è¡Œçš„ä»£ç </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>try-catch</code> æ•è·å¼‚å¸¸çš„æ—¶å€™è¿˜å¯ä»¥é€‰æ‹©åŠ ä¸Š <code>finally</code> è¯­å¥å—ï¼Œ<code>finally</code> è¯­å¥å—ä¸ç®¡ç¨‹åºæ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼Œæœ€ç»ˆå®ƒéƒ½ä¼šå¿…ç„¶æ‰§è¡Œã€‚</p><h2 id="ä¸‰é“ç»å…¸å¼‚å¸¸å¤„ç†ä»£ç é¢˜"><a href="#ä¸‰é“ç»å…¸å¼‚å¸¸å¤„ç†ä»£ç é¢˜" class="headerlink" title="ä¸‰é“ç»å…¸å¼‚å¸¸å¤„ç†ä»£ç é¢˜"></a>ä¸‰é“ç»å…¸å¼‚å¸¸å¤„ç†ä»£ç é¢˜</h2><blockquote><p>é¢˜ç›® 1</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TryDemo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœï¼š31ã€‚</p><p><code>tryã€catchã€‚finally</code> çš„åŸºç¡€ç”¨æ³•ï¼Œåœ¨ <code>return</code> å‰ä¼šå…ˆæ‰§è¡Œ <code>finally</code> è¯­å¥å—ï¼Œæ‰€ä»¥æ˜¯å…ˆè¾“å‡º <code>finally</code> é‡Œçš„ 3ï¼Œå†è¾“å‡º <code>return</code> çš„ 1ã€‚</p><blockquote><p>é¢˜ç›® 2</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TryDemo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœï¼š3ã€‚</p><p><code>try</code> è¿”å›å‰å…ˆæ‰§è¡Œ <code>finally</code>ï¼Œç»“æœ <code>finally</code> é‡Œä¸æŒ‰å¥—è·¯å‡ºç‰Œï¼Œç›´æ¥ <code>return</code> äº†ï¼Œè‡ªç„¶ä¹Ÿå°±èµ°ä¸åˆ° <code>try</code> é‡Œé¢çš„ <code>return</code> äº†ã€‚</p><p><code>finally</code> é‡Œé¢ä½¿ç”¨ <code>return</code> ä»…å­˜åœ¨äºé¢è¯•é¢˜ä¸­ï¼Œå®é™…å¼€å‘è¿™ä¹ˆå†™è¦æŒ¨åŠçš„ã€‚</p><blockquote><p>é¢˜ç›® 3</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TryDemo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœï¼š2ã€‚</p><p>å¤§å®¶å¯èƒ½ä¼šä»¥ä¸ºç»“æœåº”è¯¥æ˜¯ 3ï¼Œå› ä¸ºåœ¨ <code>return</code> å‰ä¼šæ‰§è¡Œ <code>finally</code>ï¼Œè€Œ i åœ¨ <code>finally</code> ä¸­è¢«ä¿®æ”¹ä¸º 3 äº†ï¼Œé‚£æœ€ç»ˆè¿”å› i ä¸æ˜¯åº”è¯¥ä¸º 3 å—ï¼Ÿ</p><p>ä½†å…¶å®ï¼Œåœ¨æ‰§è¡Œ <code>finally</code> ä¹‹å‰ï¼Œ<code>JVM</code> ä¼šå…ˆå°† i çš„ç»“æœæš‚å­˜èµ·æ¥ï¼Œç„¶å <code>finally</code> æ‰§è¡Œå®Œæ¯•åï¼Œä¼šè¿”å›ä¹‹å‰æš‚å­˜çš„ç»“æœï¼Œè€Œä¸æ˜¯è¿”å› iï¼Œæ‰€ä»¥å³ä½¿ i å·²ç»è¢«ä¿®æ”¹ä¸º 3ï¼Œæœ€ç»ˆè¿”å›çš„è¿˜æ˜¯ä¹‹å‰æš‚å­˜èµ·æ¥çš„ç»“æœ 2ã€‚</p><h1 id="I-O"><a href="#I-O" class="headerlink" title="I/O"></a>I/O</h1><h2 id="Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§"><a href="#Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§" class="headerlink" title="Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?"></a>Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?</h2><p>æµæŒ‰ç…§ä¸åŒçš„ç‰¹ç‚¹ï¼Œæœ‰å¾ˆå¤šç§åˆ’åˆ†æ–¹å¼ã€‚</p><ul><li>æŒ‰ç…§æµçš„æµå‘åˆ†ï¼Œå¯ä»¥åˆ†ä¸º<strong>è¾“å…¥æµ</strong>å’Œ<strong>è¾“å‡ºæµ</strong>ï¼›</li><li>æŒ‰ç…§æ“ä½œå•å…ƒåˆ’åˆ†ï¼Œå¯ä»¥åˆ’åˆ†ä¸º<strong>å­—èŠ‚æµ</strong>å’Œ<strong>å­—ç¬¦æµ</strong>ï¼›</li><li>æŒ‰ç…§æµçš„è§’è‰²åˆ’åˆ†ä¸º<strong>èŠ‚ç‚¹æµ</strong>å’Œ<strong>å¤„ç†æµ</strong></li></ul><p><code>Java Io</code> æµå…±æ¶‰åŠ 40 å¤šä¸ªç±»ï¼Œçœ‹ä¸Šå»æ‚ä¹±ï¼Œå…¶å®éƒ½å­˜åœ¨ä¸€å®šçš„å…³è”ï¼Œ <code>Java I0</code> æµçš„ 40 å¤šä¸ªç±»éƒ½æ˜¯ä»å¦‚ä¸‹ 4 ä¸ªæŠ½è±¡ç±»åŸºç±»ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ã€‚</p><ul><li><strong>InputStream</strong>/<strong>Reader</strong>: æ‰€æœ‰çš„è¾“å…¥æµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å…¥æµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å…¥æµã€‚</li><li><strong>OutputStream</strong>/<strong>Writer</strong>: æ‰€æœ‰è¾“å‡ºæµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å‡ºæµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å‡ºæµã€‚</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644073.jpeg" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644073.jpeg"></a> </p><blockquote><p>IO æµç”¨åˆ°äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿ</p></blockquote><p>å…¶å®ï¼Œ<code>Java çš„ IO</code> æµä½“ç³»è¿˜ç”¨åˆ°äº†ä¸€ä¸ªè®¾è®¡æ¨¡å¼â€”â€”<strong>è£…é¥°å™¨æ¨¡å¼</strong>ã€‚</p><p><code>InputStream</code> ç›¸å…³çš„éƒ¨åˆ†ç±»å›¾å¦‚ä¸‹ï¼Œç¯‡å¹…æœ‰é™ï¼Œè£…é¥°å™¨æ¨¡å¼å°±ä¸å±•å¼€è¯´äº†ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644242.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644242.png"></a></p><h2 id="æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ"><a href="#æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ" class="headerlink" title="æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ, ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?"></a>æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ, ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?</h2><p>å…¶å®å­—ç¬¦æµæ˜¯ç”± <code>Java</code> è™šæ‹Ÿæœºå°†å­—èŠ‚è½¬æ¢å¾—åˆ°çš„ï¼Œé—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªè¿‡ç¨‹è¿˜æ¯”è¾ƒè€—æ—¶ï¼Œå¹¶ä¸”ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“ç¼–ç ç±»å‹å°±å¾ˆå®¹æ˜“å‡ºç°ä¹±ç é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œ I/<code>O</code>  æµå°±å¹²è„†æä¾›äº†ä¸€ä¸ªç›´æ¥æ“ä½œå­—ç¬¦çš„æ¥å£ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¹³æ—¶å¯¹å­—ç¬¦è¿›è¡Œæµæ“ä½œã€‚å¦‚æœéŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ç­‰åª’ä½“æ–‡ä»¶ç”¨å­—èŠ‚æµæ¯”è¾ƒå¥½ï¼Œå¦‚æœæ¶‰åŠåˆ°å­—ç¬¦çš„è¯ä½¿ç”¨å­—ç¬¦æµæ¯”è¾ƒå¥½ã€‚</p><h2 id="BIOã€NIOã€AIOï¼Ÿ"><a href="#BIOã€NIOã€AIOï¼Ÿ" class="headerlink" title="BIOã€NIOã€AIOï¼Ÿ"></a>BIOã€NIOã€AIOï¼Ÿ</h2><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644132.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644132.png"></a>BIOã€NIOã€AIO</p><p><strong>BIO</strong><code>(blocking I/O)</code> ï¼šå°±æ˜¯ä¼ ç»Ÿçš„ <code>IO</code>ï¼ŒåŒæ­¥é˜»å¡ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ï¼Œå³<strong>å®¢æˆ·ç«¯æœ‰è¿æ¥è¯·æ±‚æ—¶æœåŠ¡å™¨ç«¯å°±éœ€è¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†</strong>ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥ä¸åšä»»ä½•äº‹æƒ…ä¼šé€ æˆä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€ï¼Œå¯ä»¥é€šè¿‡è¿æ¥æ± æœºåˆ¶æ”¹å–„ (å®ç°å¤šä¸ªå®¢æˆ·è¿æ¥æœåŠ¡å™¨)ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644898.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644898.png"></a> </p><p>BIO æ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®æ¯”è¾ƒå°ä¸”å›ºå®šçš„æ¶æ„ï¼Œè¿™ç§æ–¹å¼å¯¹æœåŠ¡å™¨èµ„æºè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼ŒJDK1.4 ä»¥å‰çš„å”¯ä¸€é€‰æ‹©ï¼Œç¨‹åºç®€å•æ˜“ç†è§£ã€‚</p><p><strong>NIO</strong> ï¼šå…¨ç§° <code>java non-blocking IOï¼Œ</code>æ˜¯æŒ‡ JDK æä¾›çš„æ–° APIã€‚ä» JDK1.4 å¼€å§‹ï¼Œ<code>Java</code> æä¾›äº†ä¸€ç³»åˆ—æ”¹è¿›çš„è¾“å…¥ / è¾“å‡ºçš„æ–°ç‰¹æ€§ï¼Œè¢«ç»Ÿç§°ä¸º <code>NIO(å³ New IO)ã€‚</code></p><p>NIO æ˜¯<strong>åŒæ­¥éé˜»å¡</strong>çš„ï¼ŒæœåŠ¡å™¨ç«¯ç”¨ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªè¿æ¥ï¼Œå®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚ä¼šæ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šï¼Œå¤šè·¯å¤ç”¨å™¨è½®è¯¢åˆ°è¿æ¥æœ‰ <code>IO</code> è¯·æ±‚å°±è¿›è¡Œå¤„ç†ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644133.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644133.png"></a> </p><p><code>NIO</code> çš„æ•°æ®æ˜¯é¢å‘<strong>ç¼“å†²åŒº Buffer</strong> çš„ï¼Œå¿…é¡»ä» <code>Buffer</code> ä¸­è¯»å–æˆ–å†™å…¥ã€‚</p><p>æ‰€ä»¥å®Œæ•´çš„ <code>NIO</code> ç¤ºæ„å›¾ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644272.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644272.png"></a><code>NIO</code> å®Œæ•´ç¤ºæ„å›¾</p><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>NIO</code> çš„è¿è¡Œæœºåˆ¶ï¼š</p><ul><li>æ¯ä¸ª <code>Channel</code> å¯¹åº”ä¸€ä¸ª <code>Buffer</code>ã€‚</li><li>Selector å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹åº”å¤šä¸ª sã€‚</li><li>Selector ä¼šæ ¹æ®ä¸åŒçš„äº‹ä»¶ï¼Œåœ¨å„ä¸ªé€šé“ä¸Šåˆ‡æ¢ã€‚</li><li>Buffer æ˜¯å†…å­˜å—ï¼Œåº•å±‚æ˜¯æ•°æ®ã€‚</li></ul><p><code>AIO</code>ï¼š<code>JDK 7</code> å¼•å…¥äº† <code>Asynchronous I/Oï¼Œ</code>æ˜¯<strong>å¼‚æ­¥ä¸é˜»å¡</strong>çš„ IOã€‚åœ¨è¿›è¡Œ I/O ç¼–ç¨‹ä¸­ï¼Œå¸¸ç”¨åˆ°ä¸¤ç§æ¨¡å¼ï¼š<code>Reactor</code> å’Œ <code>Proactor</code>ã€‚Java çš„ NIO å°±æ˜¯ Reactorï¼Œå½“æœ‰äº‹ä»¶è§¦å‘æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å¾—åˆ°é€šçŸ¥ï¼Œè¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œå®Œæˆåæ‰é€šçŸ¥æœåŠ¡ç«¯ç¨‹åºå¯åŠ¨çº¿ç¨‹å»å¤„ç†ï¼Œä¸€èˆ¬é€‚ç”¨äºè¿æ¥æ•°è¾ƒå¤šä¸”è¿æ¥æ—¶é—´è¾ƒé•¿çš„åº”ç”¨ã€‚</p><p>PSï¼šå…³äºåŒæ­¥é˜»å¡ IOã€åŒæ­¥ä¸é˜»å¡ IOã€å¼‚æ­¥ä¸é˜»å¡ IO çš„ç›¸å…³æ¦‚å¿µå¯ä»¥æŸ¥çœ‹ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzkwODE5ODM0Ng==&mid=2247488406&idx=1&sn=93e2435b319c42497a4efa966ddc9237&scene=21#wechat_redirect">é¢è¯•å­—èŠ‚ï¼Œè¢«æ“ä½œç³»ç»Ÿé—®æŒ‚äº†</a></p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaåŸºç¡€æ ¸å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆä¸‰ï¼‰| å¸¸ç”¨ç±»</title>
      <link href="/posts/49988.html"/>
      <url>/posts/49988.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><h3 id="String-æ˜¯-Java-åŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿå¯ä»¥è¢«ç»§æ‰¿å—ï¼Ÿ"><a href="#String-æ˜¯-Java-åŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿå¯ä»¥è¢«ç»§æ‰¿å—ï¼Ÿ" class="headerlink" title="String æ˜¯ Java åŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿå¯ä»¥è¢«ç»§æ‰¿å—ï¼Ÿ"></a>String æ˜¯ Java åŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿå¯ä»¥è¢«ç»§æ‰¿å—ï¼Ÿ</h3><blockquote><p>String æ˜¯ Java åŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿ</p></blockquote><p>ä¸æ˜¯ã€‚Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹åªæœ‰ 8 ä¸ªï¼š<code>byteã€shortã€intã€longã€floatã€doubleã€charã€boolean</code>ï¼›é™¤äº†åŸºæœ¬ç±»å‹ï¼ˆ<code>primitive type</code>ï¼‰ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼ˆ<code>reference type</code>ï¼‰ã€‚</p><p><code>String</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å¼•ç”¨æ•°æ®ç±»å‹ã€‚</p><blockquote><p><code>String</code> ç±»å¯ä»¥ç»§æ‰¿å—ï¼Ÿ</p></blockquote><p>ä¸è¡Œã€‚<code>String</code> ç±»ä½¿ç”¨ <code>final</code> ä¿®é¥°ï¼Œæ˜¯æ‰€è°“çš„ä¸å¯å˜ç±»ï¼Œæ— æ³•è¢«ç»§æ‰¿ã€‚</p><h3 id="String-å’Œ-StringBuilderã€StringBuffer-çš„åŒºåˆ«ï¼Ÿ"><a href="#String-å’Œ-StringBuilderã€StringBuffer-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="String å’Œ StringBuilderã€StringBuffer çš„åŒºåˆ«ï¼Ÿ"></a>String å’Œ StringBuilderã€StringBuffer çš„åŒºåˆ«ï¼Ÿ</h3><ul><li><code>String</code>ï¼š<code>String</code> çš„å€¼è¢«åˆ›å»ºåä¸èƒ½ä¿®æ”¹ï¼Œä»»ä½•å¯¹ <code>String</code> çš„ä¿®æ”¹éƒ½ä¼šå¼•å‘æ–°çš„ <code>String</code> å¯¹è±¡çš„ç”Ÿæˆã€‚</li><li><code>StringBuffer</code>ï¼šè·Ÿ <code>String</code> ç±»ä¼¼ï¼Œä½†æ˜¯å€¼å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½¿ç”¨ <code>synchronized</code> æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li><li><code>StringBuilder</code>ï¼š<code>StringBuffer</code> çš„éçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ï¼Œæ€§èƒ½ä¸Šæ›´é«˜ä¸€äº›ã€‚</li></ul><h3 id="String-str1-new-String-â€œabcâ€-å’Œ-String-str2-â€œabcâ€-å’Œ-åŒºåˆ«ï¼Ÿ"><a href="#String-str1-new-String-â€œabcâ€-å’Œ-String-str2-â€œabcâ€-å’Œ-åŒºåˆ«ï¼Ÿ" class="headerlink" title="String str1 = new String(â€œabcâ€) å’Œ String str2 = â€œabcâ€ å’Œ  åŒºåˆ«ï¼Ÿ"></a>String str1 = new String(â€œabcâ€) å’Œ String str2 = â€œabcâ€ å’Œ  åŒºåˆ«ï¼Ÿ</h3><p>ä¸¤ä¸ªè¯­å¥éƒ½ä¼šå»å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ â€œ<code>abc</code>â€ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šåœ¨å¸¸é‡æ± ä¸­åˆ›å»º â€œ<code>abc</code>â€ å¯¹è±¡ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643815.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643815.png"></a> </p><p>ä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œ<code>String str1 = new String(&quot;abc&quot;)</code> è¿˜ä¼šé€šè¿‡ <code>new String()</code> åœ¨å †é‡Œåˆ›å»ºä¸€ä¸ª â€œ<code>abc</code>â€œ å­—ç¬¦ä¸²å¯¹è±¡å®ä¾‹ã€‚æ‰€ä»¥åè€…å¯ä»¥ç†è§£ä¸ºè¢«å‰è€…åŒ…å«ã€‚</p><blockquote><p>String s = new String(â€œabcâ€) åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿ</p></blockquote><p>å¾ˆæ˜æ˜¾ï¼Œä¸€ä¸ªæˆ–ä¸¤ä¸ªã€‚å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± å·²ç»æœ‰ â€œ<code>abc</code>â€ï¼Œåˆ™æ˜¯ä¸€ä¸ªï¼›å¦åˆ™ï¼Œä¸¤ä¸ªã€‚</p><p>å½“å­—ç¬¦åˆ›å¸¸é‡æ± æ²¡æœ‰ â€œ<code>abc</code>â€ï¼Œæ­¤æ—¶ä¼šåˆ›å»ºå¦‚ä¸‹ä¸¤ä¸ªå¯¹è±¡ï¼š</p><ul><li>ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²å­—é¢é‡ â€œ<code>abc</code>â€œ æ‰€å¯¹åº”çš„ã€å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å®ä¾‹</li><li>å¦ä¸€ä¸ªæ˜¯é€šè¿‡ <code>new String()</code> åˆ›å»ºå¹¶åˆå§‹åŒ–çš„ï¼Œå†…å®¹ä¸ â€œ<code>abc</code>â€œ ç›¸åŒçš„å®ä¾‹ï¼Œåœ¨å †ä¸­ã€‚</li></ul><h3 id="String-ä¸æ˜¯ä¸å¯å˜ç±»å—ï¼Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"><a href="#String-ä¸æ˜¯ä¸å¯å˜ç±»å—ï¼Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ" class="headerlink" title="String ä¸æ˜¯ä¸å¯å˜ç±»å—ï¼Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"></a>String ä¸æ˜¯ä¸å¯å˜ç±»å—ï¼Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h3><p><code>String</code> çš„ç¡®æ˜¯ä¸å¯å˜çš„ï¼Œâ€œ**+**â€ çš„æ‹¼æ¥æ“ä½œï¼Œå…¶å®æ˜¯ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">"hello "</span><span class="token punctuation">;</span><span class="token class-name">String</span> b <span class="token operator">=</span> <span class="token string">"world!"</span><span class="token punctuation">;</span><span class="token class-name">String</span> ab <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨ <strong>jdk1.8 ä¹‹å‰</strong>ï¼Œ<code>a å’Œ b</code> åˆå§‹åŒ–æ—¶ä½äºå­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œab æ‹¼æ¥åçš„å¯¹è±¡ä½äºå †ä¸­ã€‚ç»è¿‡æ‹¼æ¥æ–°ç”Ÿæˆäº† String å¯¹è±¡ã€‚å¦‚æœæ‹¼æ¥å¤šæ¬¡ï¼Œé‚£ä¹ˆä¼šç”Ÿæˆå¤šä¸ªä¸­é—´å¯¹è±¡ã€‚</p><p>å†…å­˜å¦‚ä¸‹ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643474.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643474.png"></a> </p><p>åœ¨ <strong>Java8 æ—¶</strong> <code>JDK</code> å¯¹ <code>â€œ+â€</code> å·æ‹¼æ¥è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¸Šé¢æ‰€å†™çš„æ‹¼æ¥æ–¹å¼ä¼šè¢«ä¼˜åŒ–ä¸ºåŸºäº <code>StringBuilder</code> çš„ append æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚<code>Java</code> ä¼šåœ¨ç¼–è¯‘æœŸå¯¹ <code>â€œ+â€</code> å·è¿›è¡Œå¤„ç†ã€‚</p><p>ä¸‹é¢æ˜¯é€šè¿‡ <code>javap -verbose</code> å‘½ä»¤åç¼–è¯‘å­—èŠ‚ç çš„ç»“æœï¼Œå¾ˆæ˜¾ç„¶å¯ä»¥çœ‹åˆ° <code>StringBuilder</code> çš„åˆ›å»ºå’Œ <code>append</code> æ–¹æ³•çš„è°ƒç”¨ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>     <span class="token number">0</span><span class="token operator">:</span> ldc           #<span class="token number">2</span>                  <span class="token comment">// String hello</span>     <span class="token number">2</span><span class="token operator">:</span> astore_1     <span class="token number">3</span><span class="token operator">:</span> ldc           #<span class="token number">3</span>                  <span class="token comment">// String world!</span>     <span class="token number">5</span><span class="token operator">:</span> astore_2     <span class="token number">6</span><span class="token operator">:</span> <span class="token keyword">new</span>           #<span class="token number">4</span>                  <span class="token comment">// class java/lang/StringBuilder</span>     <span class="token number">9</span><span class="token operator">:</span> dup    <span class="token number">10</span><span class="token operator">:</span> invokespecial #<span class="token number">5</span>                  <span class="token comment">// Method java/lang/StringBuilder."&lt;init>":()V</span>    <span class="token number">13</span><span class="token operator">:</span> aload_1    <span class="token number">14</span><span class="token operator">:</span> invokevirtual #<span class="token number">6</span>                  <span class="token comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>    <span class="token number">17</span><span class="token operator">:</span> aload_2    <span class="token number">18</span><span class="token operator">:</span> invokevirtual #<span class="token number">6</span>                  <span class="token comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>    <span class="token number">21</span><span class="token operator">:</span> invokevirtual #<span class="token number">7</span>                  <span class="token comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span>    <span class="token number">24</span><span class="token operator">:</span> astore_3    <span class="token number">25</span><span class="token operator">:</span> <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´å…¶å®ä¸Šé¢çš„ä»£ç å…¶å®ç›¸å½“äºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">"hello "</span><span class="token punctuation">;</span><span class="token class-name">String</span> b <span class="token operator">=</span> <span class="token string">"world!"</span><span class="token punctuation">;</span><span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> ab <span class="token operator">=</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶ï¼Œå¦‚æœå†ç¬¼ç»Ÿçš„å›ç­”ï¼šé€šè¿‡åŠ å·æ‹¼æ¥å­—ç¬¦ä¸²ä¼šåˆ›å»ºå¤šä¸ª <code>String</code> å¯¹è±¡ï¼Œå› æ­¤æ€§èƒ½æ¯” <code>StringBuilder</code> å·®ï¼Œå°±æ˜¯é”™è¯¯çš„äº†ã€‚å› ä¸ºæœ¬è´¨ä¸ŠåŠ å·æ‹¼æ¥çš„æ•ˆæœæœ€ç»ˆç»è¿‡ç¼–è¯‘å™¨å¤„ç†ä¹‹åå’Œ <code>StringBuilder</code> æ˜¯ä¸€è‡´çš„ã€‚</p><p>å½“ç„¶ï¼Œå¾ªç¯é‡Œæ‹¼æ¥è¿˜æ˜¯å»ºè®®ç”¨ <code>StringBuilder</code>ï¼Œä¸ºä»€ä¹ˆï¼Œå› ä¸ºå¾ªç¯ä¸€æ¬¡å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>StringBuilder</code> å¯¹è±¡ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå®éªŒã€‚</p><h3 id="intern-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#intern-æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="intern æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>intern æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>JDK æºç é‡Œå·²ç»å¯¹è¿™ä¸ªæ–¹æ³•è¿›è¡Œäº†è¯´æ˜ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">*</span> <span class="token generics"><span class="token punctuation">&lt;</span>p<span class="token punctuation">></span></span><span class="token operator">*</span> <span class="token class-name">When</span> the intern method is invoked<span class="token punctuation">,</span> <span class="token keyword">if</span> the pool already contains a<span class="token operator">*</span> string equal <span class="token keyword">to</span> <span class="token keyword">this</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@code</span> <span class="token class-name">String</span><span class="token punctuation">&#125;</span> object as determined by<span class="token operator">*</span> the <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@link</span> #<span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> method<span class="token punctuation">,</span> then the string from the pool is<span class="token operator">*</span> <span class="token class-name"><span class="token namespace">returned<span class="token punctuation">.</span></span> Otherwise</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@code</span> <span class="token class-name">String</span><span class="token punctuation">&#125;</span> object is added <span class="token keyword">to</span> <span class="token namespace">the</span><span class="token operator">*</span> pool and a reference <span class="token keyword">to</span> <span class="token keyword">this</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@code</span> <span class="token class-name">String</span><span class="token punctuation">&#125;</span> object is returned<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token generics"><span class="token punctuation">&lt;</span>p<span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„æ€ä¹Ÿå¾ˆå¥½æ‡‚ï¼š</p><ul><li>å¦‚æœå½“å‰å­—ç¬¦ä¸²å†…å®¹å­˜åœ¨äºå­—ç¬¦ä¸²å¸¸é‡æ± ï¼ˆå³ <code>equals()</code> æ–¹æ³•ä¸º <code>true</code>ï¼Œä¹Ÿå°±æ˜¯å†…å®¹ä¸€æ ·ï¼‰ï¼Œç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²</li><li>å¦åˆ™ï¼Œå°†æ­¤ <code>String</code> å¯¹è±¡æ·»åŠ åˆ°æ± ä¸­ï¼Œå¹¶è¿”å› <code>String</code> å¯¹è±¡çš„å¼•ç”¨</li></ul><h2 id="Integer"><a href="#Integer" class="headerlink" title="Integer"></a>Integer</h2><h3 id="Integer-a-127ï¼ŒInteger-b-127ï¼›Integer-c-128ï¼ŒInteger-d-128ï¼›ï¼Œç›¸ç­‰å—"><a href="#Integer-a-127ï¼ŒInteger-b-127ï¼›Integer-c-128ï¼ŒInteger-d-128ï¼›ï¼Œç›¸ç­‰å—" class="headerlink" title="Integer a= 127ï¼ŒInteger b = 127ï¼›Integer c= 128ï¼ŒInteger d = 128ï¼›ï¼Œç›¸ç­‰å—?"></a>Integer a= 127ï¼ŒInteger b = 127ï¼›Integer c= 128ï¼ŒInteger d = 128ï¼›ï¼Œç›¸ç­‰å—?</h3><p>ç­”æ¡ˆæ˜¯ <code>a å’Œ b</code> ç›¸ç­‰ï¼Œ<code>c å’Œ d</code> ä¸ç›¸ç­‰ã€‚</p><ul><li>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„å€¼</li><li>å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹ == æ¯”è¾ƒçš„æ˜¯åœ°å€</li></ul><p><code>Integer a= 127</code> è¿™ç§èµ‹å€¼ï¼Œæ˜¯ç”¨åˆ°äº† <code>Integer</code> è‡ªåŠ¨è£…ç®±çš„æœºåˆ¶ã€‚è‡ªåŠ¨è£…ç®±çš„æ—¶å€™ä¼šå»ç¼“å­˜æ± é‡Œå– <code>Integer</code> å¯¹è±¡ï¼Œæ²¡æœ‰å–åˆ°æ‰ä¼šåˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><p>å¦‚æœæ•´å‹å­—é¢é‡çš„å€¼åœ¨ - 128 åˆ° 127 ä¹‹é—´ï¼Œé‚£ä¹ˆè‡ªåŠ¨è£…ç®±æ—¶ä¸ä¼š <code>new</code> æ–°çš„ <code>Integer</code> å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨ç¼“å­˜æ± ä¸­çš„ <code>Integer</code> å¯¹è±¡ï¼Œè¶…è¿‡èŒƒå›´ <code>a1==b1</code> çš„ç»“æœæ˜¯ <code>false</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Integer</span> a <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>        <span class="token class-name">Integer</span> b <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>        <span class="token class-name">Integer</span> b1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token operator">==</span>b1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>        <span class="token class-name">Integer</span> c <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span>        <span class="token class-name">Integer</span> d <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c <span class="token operator">==</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//false</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä»€ä¹ˆæ˜¯ Integer ç¼“å­˜ï¼Ÿ</p></blockquote><p>å› ä¸ºæ ¹æ®å®è·µå‘ç°å¤§éƒ¨åˆ†çš„æ•°æ®æ“ä½œéƒ½é›†ä¸­åœ¨å€¼æ¯”è¾ƒå°çš„èŒƒå›´ï¼Œå› æ­¤ <code>Integer</code> æäº†ä¸ªç¼“å­˜æ± ï¼Œé»˜è®¤èŒƒå›´æ˜¯ -128 åˆ° 127ï¼Œå¯ä»¥æ ¹æ®é€šè¿‡è®¾ç½®<code>JVM-XX:AutoBoxCacheMax=</code>æ¥ä¿®æ”¹ç¼“å­˜çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼æ”¹ä¸äº†ã€‚</p><p>å®ç°çš„åŸç†æ˜¯ <code>int</code> åœ¨è‡ªåŠ¨è£…ç®±çš„æ—¶å€™ä¼šè°ƒç”¨ <code>Integer.valueOf</code>ï¼Œè¿›è€Œç”¨åˆ°äº† <code>IntegerCache</code>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643743.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643743.png"></a>   </p><p>å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ¤æ–­ä¸‹å€¼æ˜¯å¦åœ¨ç¼“å­˜èŒƒå›´ä¹‹å†…ï¼Œå¦‚æœæ˜¯çš„è¯å» <code>IntegerCache</code> ä¸­å–ï¼Œä¸æ˜¯çš„è¯å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Integer</code> å¯¹è±¡ã€‚</p><p><code>IntegerCache</code> æ˜¯ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œ åœ¨é™æ€å—ä¸­ä¼šåˆå§‹åŒ–å¥½ç¼“å­˜å€¼ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IntegerCache</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//åˆ›å»ºIntegerå¯¹è±¡å­˜å‚¨</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cache<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>                cache<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="String-æ€ä¹ˆè½¬æˆ-Integer-çš„ï¼ŸåŸç†ï¼Ÿ"><a href="#String-æ€ä¹ˆè½¬æˆ-Integer-çš„ï¼ŸåŸç†ï¼Ÿ" class="headerlink" title="String æ€ä¹ˆè½¬æˆ Integer çš„ï¼ŸåŸç†ï¼Ÿ"></a>String æ€ä¹ˆè½¬æˆ Integer çš„ï¼ŸåŸç†ï¼Ÿ</h3><p>PS: è¿™é“é¢˜å°è±¡ä¸­åœ¨ä¸€äº›é¢ç»ä¸­å‡ºåœºè¿‡å‡ æ¬¡ã€‚</p><p><code>String</code> è½¬æˆ <code>Integer</code>ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>Integer.parseInt(String s)</code></li><li><code>Integer.valueOf(String s)</code></li></ul><p>ä¸ç®¡å“ªä¸€ç§ï¼Œæœ€ç»ˆè¿˜æ˜¯ä¼šè°ƒç”¨ <code>Integer</code> ç±»å†…ä¸­çš„<code>parseInt(String s, int radix)</code>æ–¹æ³•ã€‚</p><p>æŠ›å»ä¸€äº›è¾¹ç•Œä¹‹ç±»çš„çœ‹çœ‹æ ¸å¿ƒä»£ç ï¼š</p><pre class="line-numbers language-JAVA" data-language="JAVA"><code class="language-JAVA">public static int parseInt(String s, int radix) throws NumberFormatException    &#123;        int result &#x3D; 0;        &#x2F;&#x2F;æ˜¯å¦æ˜¯è´Ÿæ•°        boolean negative &#x3D; false;        &#x2F;&#x2F;charå­—ç¬¦æ•°ç»„ä¸‹æ ‡å’Œé•¿åº¦        int i &#x3D; 0, len &#x3D; s.length();        int digit;        &#x2F;&#x2F;åˆ¤æ–­å­—ç¬¦é•¿åº¦æ˜¯å¦å¤§äº0ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸        if (len &gt; 0) &#123;            while (i &lt; len) &#123;                &#x2F;&#x2F; Accumulating negatively avoids surprises near MAX_VALUE                &#x2F;&#x2F;è¿”å›æŒ‡å®šåŸºæ•°ä¸­å­—ç¬¦è¡¨ç¤ºçš„æ•°å€¼ã€‚ï¼ˆæ­¤å¤„æ˜¯åè¿›åˆ¶æ•°å€¼ï¼‰                digit &#x3D; Character.digit(s.charAt(i++),radix);                &#x2F;&#x2F;è¿›åˆ¶ä½ä¹˜ä»¥æ•°å€¼                result *&#x3D; radix;                  result -&#x3D; digit;            &#125;        &#125;         &#x2F;&#x2F;æ ¹æ®ä¸Šé¢å¾—åˆ°çš„æ˜¯å¦è´Ÿæ•°ï¼Œè¿”å›ç›¸åº”çš„å€¼        return negative ? result : -result;    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å»æ‰ææè”“è”“ï¼ˆå½“ç„¶è¿™äº›ææè”“è”“å¯ä»¥å»çœ‹çœ‹ï¼Œæºç  <code>cover</code> äº†å¾ˆå¤šæƒ…å†µï¼‰ï¼Œå…¶å®å‰©ä¸‹çš„å°±æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²éå†è®¡ç®—ï¼Œä¸è¿‡è®¡ç®—æ–¹å¼æœ‰ç‚¹åå¸¸è§„ï¼Œæ˜¯ç”¨è´Ÿçš„å€¼ç´¯å‡ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644037.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644037.png"></a> </p><h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><h3 id="Object-ç±»çš„å¸¸è§æ–¹æ³•"><a href="#Object-ç±»çš„å¸¸è§æ–¹æ³•" class="headerlink" title="Object ç±»çš„å¸¸è§æ–¹æ³•?"></a>Object ç±»çš„å¸¸è§æ–¹æ³•?</h3><p>Object ç±»æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰ç±»éƒ½å¯ä»¥è°ƒç”¨å®ƒçš„æ–¹æ³•ã€‚å®ƒä¸»è¦æä¾›äº†ä»¥ä¸‹ 11 ä¸ªæ–¹æ³•ï¼Œå¤§æ¦‚å¯ä»¥åˆ†ä¸ºå…­ç±»ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644047.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031644047.png"></a></p><h3 id="å¯¹è±¡æ¯”è¾ƒï¼š"><a href="#å¯¹è±¡æ¯”è¾ƒï¼š" class="headerlink" title="å¯¹è±¡æ¯”è¾ƒï¼š"></a><strong>å¯¹è±¡æ¯”è¾ƒ</strong>ï¼š</h3><ul><li><code>public native int hashCode() ï¼šnative</code> æ–¹æ³•ï¼Œç”¨äºè¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œä¸»è¦ä½¿ç”¨åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ¯”å¦‚ <code>JDK ä¸­çš„ HashMapã€‚</code></li><li><code>public boolean equals(Object obj)</code>ï¼šç”¨äºæ¯”è¾ƒ 2 ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ï¼Œ<code>String</code> ç±»å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†é‡å†™ç”¨æˆ·æ¯”è¾ƒå­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚</li></ul><h3 id="å¯¹è±¡æ‹·è´ï¼š"><a href="#å¯¹è±¡æ‹·è´ï¼š" class="headerlink" title="å¯¹è±¡æ‹·è´ï¼š"></a><strong>å¯¹è±¡æ‹·è´</strong>ï¼š</h3><ul><li><code>protected native Object clone() throws CloneNotSupportedException</code>ï¼š<code>naitive</code> æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå¹¶è¿”å›å½“å‰å¯¹è±¡çš„ä¸€ä»½æ‹·è´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹äºä»»ä½•å¯¹è±¡ xï¼Œè¡¨è¾¾å¼ <code>x.clone() != x ä¸º true</code>ï¼Œ<code>x.clone().getClass() == x.getClass() ä¸º true</code>ã€‚<code>Object</code> æœ¬èº«æ²¡æœ‰å®ç° <code>Cloneable</code> æ¥å£ï¼Œæ‰€ä»¥ä¸é‡å†™ <code>clone</code> æ–¹æ³•å¹¶ä¸”è¿›è¡Œè°ƒç”¨çš„è¯ä¼šå‘ç”Ÿ <code>CloneNotSupportedException</code> å¼‚å¸¸ã€‚</li></ul><h3 id="å¯¹è±¡è½¬å­—ç¬¦ä¸²ï¼š"><a href="#å¯¹è±¡è½¬å­—ç¬¦ä¸²ï¼š" class="headerlink" title="å¯¹è±¡è½¬å­—ç¬¦ä¸²ï¼š"></a><strong>å¯¹è±¡è½¬å­—ç¬¦ä¸²ï¼š</strong></h3><ul><li><code>public String toString()</code>ï¼šè¿”å›ç±»çš„åå­— @å®ä¾‹çš„å“ˆå¸Œç çš„ 16 è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚å»ºè®® Object æ‰€æœ‰çš„å­ç±»éƒ½é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚</li></ul><h3 id="å¤šçº¿ç¨‹è°ƒåº¦ï¼š"><a href="#å¤šçº¿ç¨‹è°ƒåº¦ï¼š" class="headerlink" title="å¤šçº¿ç¨‹è°ƒåº¦ï¼š"></a><strong>å¤šçº¿ç¨‹è°ƒåº¦ï¼š</strong></h3><ul><li><code>public final native void notify()</code>ï¼š<code>native</code> æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚å”¤é†’ä¸€ä¸ªåœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„çº¿ç¨‹ (ç›‘è§†å™¨ç›¸å½“äºå°±æ˜¯é”çš„æ¦‚å¿µ)ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åªä¼šä»»æ„å”¤é†’ä¸€ä¸ªã€‚</li><li><code>public final native void notifyAll()</code>ï¼š<code>native</code> æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚è·Ÿ <code>notify</code> ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚</li><li><code>public final native void wait(long timeout) throws InterruptedException</code>ï¼š<code>native</code> æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚æ³¨æ„ï¼š<code>sleep</code> æ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œ wait æ–¹æ³•é‡Šæ”¾äº†é” ã€‚timeout æ˜¯ç­‰å¾…æ—¶é—´ã€‚</li><li><code>public final void wait(long timeout, int nanos) throws InterruptedException</code>ï¼šå¤šäº† <code>nanos</code> å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºé¢å¤–æ—¶é—´ï¼ˆä»¥æ¯«å¾®ç§’ä¸ºå•ä½ï¼ŒèŒƒå›´æ˜¯ 0-999999ï¼‰ã€‚æ‰€ä»¥è¶…æ—¶çš„æ—¶é—´è¿˜éœ€è¦åŠ ä¸Š nanos æ¯«ç§’ã€‚</li><li><code>public final void wait() throws InterruptedException</code>ï¼šè·Ÿä¹‹å‰çš„ 2 ä¸ª <code>wait</code> æ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡è¯¥æ–¹æ³•ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰è¶…æ—¶æ—¶é—´è¿™ä¸ªæ¦‚å¿µ</li></ul><h3 id="åå°„ï¼š"><a href="#åå°„ï¼š" class="headerlink" title="åå°„ï¼š"></a><strong>åå°„ï¼š</strong></h3><ul><li><code>public final native Class&lt;?&gt; getClass()</code>ï¼š<code>native</code> æ–¹æ³•ï¼Œç”¨äºè¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„ <code>Class</code> å¯¹è±¡ï¼Œä½¿ç”¨äº† <code>final</code> å…³é”®å­—ä¿®é¥°ï¼Œæ•…ä¸å…è®¸å­ç±»é‡å†™ã€‚</li></ul><h3 id="åƒåœ¾å›æ”¶ï¼š"><a href="#åƒåœ¾å›æ”¶ï¼š" class="headerlink" title="åƒåœ¾å›æ”¶ï¼š"></a><strong>åƒåœ¾å›æ”¶ï¼š</strong></h3><ul><li><code>protected void finalize() throws Throwable</code> ï¼šé€šçŸ¥åƒåœ¾æ”¶é›†å™¨å›æ”¶å¯¹è±¡ã€‚</li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaåŸºç¡€æ ¸å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆäºŒï¼‰| é¢å‘å¯¹è±¡</title>
      <link href="/posts/56665.html"/>
      <url>/posts/56665.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"><a href="#é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«" class="headerlink" title="é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«?"></a>é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«?</h2><ul><li><strong>é¢å‘è¿‡ç¨‹</strong> ï¼šé¢å‘è¿‡ç¨‹å°±æ˜¯åˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä½¿ç”¨çš„æ—¶å€™å†ä¸€ä¸ªä¸€ä¸ªçš„ä¸€æ¬¡è°ƒç”¨å°±å¯ä»¥ã€‚</li><li><strong>é¢å‘å¯¹è±¡</strong> ï¼šé¢å‘å¯¹è±¡ï¼ŒæŠŠæ„æˆé—®é¢˜çš„äº‹åŠ¡åˆ†è§£æˆå„ä¸ªå¯¹è±¡ï¼Œè€Œå»ºç«‹å¯¹è±¡çš„ç›®çš„ä¹Ÿä¸æ˜¯ä¸ºäº†å®Œæˆä¸€ä¸ªä¸ªæ­¥éª¤ï¼Œè€Œæ˜¯ä¸ºäº†æè¿°æŸä¸ªäº‹ä»¶åœ¨è§£å†³æ•´ä¸ªé—®é¢˜çš„è¿‡ç¨‹æ‰€å‘ç”Ÿçš„è¡Œä¸ºã€‚ç›®çš„æ˜¯ä¸ºäº†å†™å‡ºé€šç”¨çš„ä»£ç ï¼ŒåŠ å¼ºä»£ç çš„é‡ç”¨ï¼Œå±è”½å·®å¼‚æ€§ã€‚</li></ul><p>ç”¨ä¸€ä¸ªæ¯”å–»ï¼šé¢å‘è¿‡ç¨‹æ˜¯ç¼–å¹´ä½“ï¼›é¢å‘å¯¹è±¡æ˜¯çºªä¼ ä½“ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/MgZTzAKowWvndHE.png" title="é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/MgZTzAKowWvndHE.png" alt="é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"></a> </p><h2 id="é¢å‘å¯¹è±¡æœ‰å“ªäº›ç‰¹æ€§"><a href="#é¢å‘å¯¹è±¡æœ‰å“ªäº›ç‰¹æ€§" class="headerlink" title="é¢å‘å¯¹è±¡æœ‰å“ªäº›ç‰¹æ€§"></a>é¢å‘å¯¹è±¡æœ‰å“ªäº›ç‰¹æ€§</h2><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642081.png" title="é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642081.png" alt="é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾"></a> </p><ul><li><p><strong>å°è£…</strong></p><p>å°è£…æŠŠâ¼€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›â¼€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„â½…æ³•ã€‚</p></li><li><p><strong>ç»§æ‰¿</strong></p><p>ç»§æ‰¿æ˜¯ä½¿â½¤å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€åˆ›å»ºæ–°çš„ç±»ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„å±æ€§æˆ–æ–°çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚é€šè¿‡ç»§æ‰¿å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œä»£ç å¤ç”¨ã€‚</p></li></ul><blockquote><p>å…³äºç»§æ‰¿æœ‰ä»¥ä¸‹ä¸‰ä¸ªè¦ç‚¹ï¼š</p></blockquote><ol><li>â¼¦ç±»æ‹¥æœ‰â½—ç±»å¯¹è±¡æ‰€æœ‰çš„å±æ€§å’Œâ½…æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰å±æ€§å’Œç§æœ‰â½…æ³•ï¼‰ï¼Œä½†æ˜¯â½—ç±»ä¸­çš„ç§æœ‰å±æ€§å’Œâ½…æ³•â¼¦ç±»æ˜¯â½†æ³•è®¿é—®ï¼Œåªæ˜¯æ‹¥æœ‰ã€‚</li><li>â¼¦ç±»å¯ä»¥æ‹¥æœ‰â¾ƒâ¼°å±æ€§å’Œâ½…æ³•ï¼Œå³â¼¦ç±»å¯ä»¥å¯¹â½—ç±»è¿›â¾æ‰©å±•ã€‚</li><li>â¼¦ç±»å¯ä»¥â½¤â¾ƒâ¼°çš„â½…å¼å®ç°â½—ç±»çš„â½…æ³•ã€‚</li></ol><ul><li><p><strong>å¤šæ€</strong></p><p>æ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•â½¤å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•â½¤å˜é‡å‘å‡ºçš„â½…æ³•è°ƒâ½¤åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œâ½½æ˜¯åœ¨ç¨‹åºè¿â¾æœŸé—´æ‰ç¡®å®šï¼Œå³â¼€ä¸ªå¼•â½¤å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•â½¤å˜é‡å‘å‡ºçš„â½…æ³•è°ƒâ½¤åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„â½…æ³•ï¼Œå¿…é¡»åœ¨ç”±ç¨‹åºè¿â¾æœŸé—´æ‰èƒ½å†³å®šã€‚</p><p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªâ¼¦ç±»å¯¹åŒâ¼€â½…æ³•çš„é‡å†™ï¼‰å’Œæ¥â¼ï¼ˆå®ç°æ¥â¼å¹¶è¦†ç›–æ¥â¼ä¸­åŒâ¼€â½…æ³•ï¼‰ã€‚</p></li></ul><h2 id="é‡è½½ï¼ˆoverloadï¼‰å’Œé‡å†™ï¼ˆoverrideï¼‰çš„åŒºåˆ«ï¼Ÿ"><a href="#é‡è½½ï¼ˆoverloadï¼‰å’Œé‡å†™ï¼ˆoverrideï¼‰çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="é‡è½½ï¼ˆoverloadï¼‰å’Œé‡å†™ï¼ˆoverrideï¼‰çš„åŒºåˆ«ï¼Ÿ"></a>é‡è½½ï¼ˆoverloadï¼‰å’Œé‡å†™ï¼ˆoverrideï¼‰çš„åŒºåˆ«ï¼Ÿ</h2><p>æ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼ŒåŒºåˆ«åœ¨äºå‰è€…å®ç°çš„æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼Œè€Œåè€…å®ç°çš„æ˜¯è¿è¡Œæ—¶çš„å¤šæ€æ€§ã€‚</p><ul><li>é‡è½½å‘ç”Ÿåœ¨ä¸€ä¸ªç±»ä¸­ï¼ŒåŒåçš„æ–¹æ³•å¦‚æœæœ‰ä¸åŒçš„å‚æ•°åˆ—è¡¨ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€å‚æ•°ä¸ªæ•°ä¸åŒæˆ–è€…äºŒè€…éƒ½ä¸åŒï¼‰åˆ™è§†ä¸ºé‡è½½ï¼›</li><li>é‡å†™å‘ç”Ÿåœ¨å­ç±»ä¸çˆ¶ç±»ä¹‹é—´ï¼Œé‡å†™è¦æ±‚å­ç±»è¢«é‡å†™æ–¹æ³•ä¸çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æœ‰ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œæ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æ›´å¥½è®¿é—®ï¼Œä¸èƒ½æ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•å£°æ˜æ›´å¤šçš„å¼‚å¸¸ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰ã€‚</li></ul><p>æ–¹æ³•é‡è½½çš„è§„åˆ™ï¼š</p><ol><li>æ–¹æ³•åä¸€è‡´ï¼Œå‚æ•°åˆ—è¡¨ä¸­å‚æ•°çš„é¡ºåºï¼Œç±»å‹ï¼Œä¸ªæ•°ä¸åŒã€‚</li><li>é‡è½½ä¸æ–¹æ³•çš„è¿”å›å€¼æ— å…³ï¼Œå­˜åœ¨äºçˆ¶ç±»å’Œå­ç±»ï¼ŒåŒç±»ä¸­ã€‚</li><li>å¯ä»¥æŠ›å‡ºä¸åŒçš„å¼‚å¸¸ï¼Œå¯ä»¥æœ‰ä¸åŒä¿®é¥°ç¬¦ã€‚</li></ol><h2 id="è®¿é—®ä¿®é¥°ç¬¦-publicã€privateã€protectedã€ä»¥åŠä¸å†™ï¼ˆé»˜è®¤ï¼‰æ—¶çš„åŒºåˆ«ï¼Ÿ"><a href="#è®¿é—®ä¿®é¥°ç¬¦-publicã€privateã€protectedã€ä»¥åŠä¸å†™ï¼ˆé»˜è®¤ï¼‰æ—¶çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="è®¿é—®ä¿®é¥°ç¬¦ publicã€privateã€protectedã€ä»¥åŠä¸å†™ï¼ˆé»˜è®¤ï¼‰æ—¶çš„åŒºåˆ«ï¼Ÿ"></a>è®¿é—®ä¿®é¥°ç¬¦ publicã€privateã€protectedã€ä»¥åŠä¸å†™ï¼ˆé»˜è®¤ï¼‰æ—¶çš„åŒºåˆ«ï¼Ÿ</h2><p><code>Java</code> ä¸­ï¼Œå¯ä»¥ä½¿ç”¨è®¿é—®æ§åˆ¶ç¬¦æ¥ä¿æŠ¤å¯¹ç±»ã€å˜é‡ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•çš„è®¿é—®ã€‚<code>Java</code> æ”¯æŒ 4 ç§ä¸åŒçš„è®¿é—®æƒé™ã€‚</p><ul><li><strong>default</strong> (å³é»˜è®¤ï¼Œä»€ä¹ˆä¹Ÿä¸å†™ï¼‰: åœ¨åŒä¸€åŒ…å†…å¯è§ï¼Œä¸ä½¿ç”¨ä»»ä½•ä¿®é¥°ç¬¦ã€‚å¯ä»¥ä¿®é¥°åœ¨ç±»ã€æ¥å£ã€å˜é‡ã€æ–¹æ³•ã€‚</li><li><strong>private</strong> : åœ¨åŒä¸€ç±»å†…å¯è§ã€‚å¯ä»¥ä¿®é¥°å˜é‡ã€æ–¹æ³•ã€‚<strong>æ³¨æ„ï¼šä¸èƒ½ä¿®é¥°ç±»ï¼ˆå¤–éƒ¨ç±»ï¼‰</strong></li><li><strong>public</strong> : å¯¹æ‰€æœ‰ç±»å¯è§ã€‚å¯ä»¥ä¿®é¥°ç±»ã€æ¥å£ã€å˜é‡ã€æ–¹æ³•</li><li><strong>protected</strong> : å¯¹åŒä¸€åŒ…å†…çš„ç±»å’Œæ‰€æœ‰å­ç±»å¯è§ã€‚å¯ä»¥ä¿®é¥°å˜é‡ã€æ–¹æ³•ã€‚<strong>æ³¨æ„ï¼šä¸èƒ½ä¿®é¥°ç±»ï¼ˆå¤–éƒ¨ç±»ï¼‰</strong>ã€‚</li></ul><p><a href="https://s2.loli.net/2024/12/19/zyC4SpkMo2ndbwQ.png" title="è®¿é—®ä¿®é¥°ç¬¦å’Œå¯è§æ€§" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/zyC4SpkMo2ndbwQ.png" alt="è®¿é—®ä¿®é¥°ç¬¦å’Œå¯è§æ€§"></a> </p><h2 id="this-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#this-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="this å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>this å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h2><p><code>this</code> æ˜¯è‡ªèº«çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨å¯¹è±¡æœ¬èº«ï¼Œå¯ä»¥ç†è§£ä¸ºï¼š<strong>æŒ‡å‘å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæŒ‡é’ˆ</strong>ã€‚</p><p><code>this</code> çš„ç”¨æ³•åœ¨ <code>Java</code> ä¸­å¤§ä½“å¯ä»¥åˆ†ä¸º 3 ç§ï¼š</p><ol><li>æ™®é€šçš„ç›´æ¥å¼•ç”¨ï¼Œthis ç›¸å½“äºæ˜¯æŒ‡å‘å½“å‰å¯¹è±¡æœ¬èº«</li><li>å½¢å‚ä¸æˆå‘˜å˜é‡åå­—é‡åï¼Œç”¨ this æ¥åŒºåˆ†ï¼š</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>å¼•ç”¨æœ¬ç±»çš„æ„é€ å‡½æ•°</li></ol><h2 id="æŠ½è±¡ç±»-abstract-class-å’Œæ¥å£-interface-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#æŠ½è±¡ç±»-abstract-class-å’Œæ¥å£-interface-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="æŠ½è±¡ç±» (abstract class) å’Œæ¥å£ (interface) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>æŠ½è±¡ç±» (<code>abstract class</code>) å’Œæ¥å£ (<code>interface</code>) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><ol><li>æ¥â¼çš„â½…æ³•é»˜è®¤æ˜¯ <code>public</code> ï¼Œæ‰€æœ‰â½…æ³•åœ¨æ¥â¼ä¸­ä¸èƒ½æœ‰å®ç° (<code>Java 8</code> å¼€å§‹æ¥â¼â½…æ³•å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼‰ï¼Œâ½½æŠ½è±¡ç±»å¯ä»¥æœ‰â¾®æŠ½è±¡çš„â½…æ³•ã€‚</li><li>æ¥â¼ä¸­é™¤äº† <code>static</code> ã€ <code>final</code> å˜é‡ï¼Œä¸èƒ½æœ‰å…¶ä»–å˜é‡ï¼Œâ½½æŠ½è±¡ç±»ä¸­åˆ™ä¸â¼€å®šã€‚</li><li>â¼€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥â¼ï¼Œä½†åªèƒ½å®ç°â¼€ä¸ªæŠ½è±¡ç±»ã€‚æ¥â¼â¾ƒâ¼°æœ¬èº«å¯ä»¥é€šè¿‡ <code>extends</code> å…³é”®å­—æ‰©å±•å¤šä¸ªæ¥â¼ã€‚</li><li>æ¥â¼â½…æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯ <code>public</code> ï¼ŒæŠ½è±¡â½…æ³•å¯ä»¥æœ‰ <code>public</code> ã€ <code>protected</code> å’Œ <code>default</code> è¿™äº›ä¿®é¥°ç¬¦ï¼ˆæŠ½è±¡â½…æ³•å°±æ˜¯ä¸ºäº†è¢«é‡å†™æ‰€ä»¥ä¸èƒ½ä½¿â½¤ private å…³é”®å­—ä¿®é¥°ï¼ï¼‰ã€‚</li><li>ä»è®¾è®¡å±‚â¾¯æ¥è¯´ï¼ŒæŠ½è±¡æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œæ˜¯â¼€ç§æ¨¡æ¿è®¾è®¡ï¼Œâ½½æ¥â¼æ˜¯å¯¹â¾ä¸ºçš„æŠ½è±¡ï¼Œæ˜¯â¼€ç§â¾ä¸ºçš„è§„èŒƒã€‚</li></ol><blockquote><ol><li>åœ¨ JDK8 ä¸­ï¼Œæ¥â¼ä¹Ÿå¯ä»¥å®šä¹‰é™æ€â½…æ³•ï¼Œå¯ä»¥ç›´æ¥â½¤æ¥â¼åè°ƒâ½¤ã€‚å®ç°ç±»å’Œå®ç°æ˜¯ä¸å¯ä»¥è°ƒâ½¤çš„ã€‚å¦‚æœåŒæ—¶å®ç°ä¸¤ä¸ªæ¥â¼ï¼Œæ¥â¼ä¸­å®šä¹‰äº†â¼€æ ·çš„é»˜è®¤â½…æ³•ï¼Œåˆ™å¿…é¡»é‡å†™ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</li><li>jdk9 çš„æ¥â¼è¢«å…è®¸å®šä¹‰ç§æœ‰â½…æ³• ã€‚</li></ol></blockquote><p>æ€»ç»“â¼€ä¸‹ <code>jdk7~jdk9 Java</code> ä¸­æ¥â¼çš„å˜åŒ–ï¼š</p><ol><li>åœ¨ <code>jdk 7</code> æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œæ¥â¼â¾¥â¾¯åªèƒ½æœ‰å¸¸é‡å˜é‡å’ŒæŠ½è±¡â½…æ³•ã€‚è¿™äº›æ¥â¼â½…æ³•å¿…é¡»ç”±é€‰æ‹©å®ç°æ¥â¼çš„ç±»å®ç°ã€‚</li><li><code>jdk 8</code> çš„æ—¶å€™æ¥â¼å¯ä»¥æœ‰é»˜è®¤â½…æ³•å’Œé™æ€â½…æ³•åŠŸèƒ½ã€‚</li><li><code>jdk 9</code> åœ¨æ¥â¼ä¸­å¼•â¼Šäº†ç§æœ‰â½…æ³•å’Œç§æœ‰é™æ€â½…æ³•ã€‚</li></ol><h2 id="æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"><a href="#æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"></a>æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h2><ol><li><strong>ä»è¯­æ³•å½¢å¼ä¸Šçœ‹</strong>ï¼šæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œâ½½å±€éƒ¨å˜é‡æ˜¯åœ¨â½…æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯â½…æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢« public , private , static ç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œâ½½å±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠ static æ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢« final æ‰€ä¿®é¥°ã€‚</li><li><strong>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨â½…å¼æ¥çœ‹</strong>ï¼šå¦‚æœæˆå‘˜å˜é‡æ˜¯ä½¿â½¤ static ä¿®é¥°çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œå¦‚æœæ²¡æœ‰ä½¿â½¤ static ä¿®é¥°ï¼Œè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºå®ä¾‹çš„ã€‚å¯¹è±¡å­˜äºå †å†…å­˜ï¼Œå¦‚æœå±€éƒ¨å˜é‡ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå­˜å‚¨åœ¨æ ˆå†…å­˜ï¼Œå¦‚æœä¸ºå¼•â½¤æ•°æ®ç±»å‹ï¼Œé‚£å­˜æ”¾çš„æ˜¯æŒ‡å‘å †å†…å­˜å¯¹è±¡çš„å¼•â½¤æˆ–è€…æ˜¯æŒ‡å‘å¸¸é‡æ± ä¸­çš„åœ°å€ã€‚</li><li><strong>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„â½£å­˜æ—¶é—´ä¸Šçœ‹</strong>ï¼šæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„â¼€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºâ½½å­˜åœ¨ï¼Œâ½½å±€éƒ¨å˜é‡éšç€â½…æ³•çš„è°ƒâ½¤â½½â¾ƒåŠ¨æ¶ˆå¤±ã€‚</li><li><strong>æˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆå€¼</strong>ï¼šåˆ™ä¼šâ¾ƒåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼â½½èµ‹å€¼ï¼ˆâ¼€ç§æƒ…å†µä¾‹å¤–: è¢« final ä¿®é¥°çš„æˆå‘˜å˜é‡ä¹Ÿå¿…é¡»æ˜¾å¼åœ°èµ‹å€¼ï¼‰ï¼Œâ½½å±€éƒ¨å˜é‡åˆ™ä¸ä¼šâ¾ƒåŠ¨èµ‹å€¼ã€‚</li></ol><h2 id="é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿé™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•å‘¢ï¼Ÿ"><a href="#é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿé™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•å‘¢ï¼Ÿ" class="headerlink" title="é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿé™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•å‘¢ï¼Ÿ"></a>é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿé™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•å‘¢ï¼Ÿ</h2><blockquote><p>é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿ</p></blockquote><p><strong>é™æ€å˜é‡:</strong> æ˜¯è¢« <code>static</code> ä¿®é¥°ç¬¦ä¿®é¥°çš„å˜é‡ï¼Œä¹Ÿç§°ä¸ºç±»å˜é‡ï¼Œå®ƒå±äºç±»ï¼Œä¸å±äºç±»çš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªç±»ä¸ç®¡åˆ›å»ºå¤šå°‘ä¸ªå¯¹è±¡ï¼Œé™æ€å˜é‡åœ¨å†…å­˜ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚</p><p><strong>å®ä¾‹å˜é‡:</strong> å¿…é¡»ä¾å­˜äºæŸä¸€å®ä¾‹ï¼Œéœ€è¦å…ˆåˆ›å»ºå¯¹è±¡ç„¶åé€šè¿‡å¯¹è±¡æ‰èƒ½è®¿é—®åˆ°å®ƒã€‚é™æ€å˜é‡å¯ä»¥å®ç°è®©å¤šä¸ªå¯¹è±¡å…±äº«å†…å­˜ã€‚</p><blockquote><p>é™æ€â½…æ³•å’Œå®ä¾‹â½…æ³•æœ‰ä½•ä¸åŒ?</p></blockquote><p>ç±»ä¼¼åœ°ã€‚</p><p><strong>é™æ€æ–¹æ³•</strong>ï¼š<code>static</code> ä¿®é¥°çš„æ–¹æ³•ï¼Œä¹Ÿè¢«ç§°ä¸ºç±»æ–¹æ³•ã€‚åœ¨å¤–éƒ¨è°ƒâ½¤é™æ€â½…æ³•æ—¶ï¼Œå¯ä»¥ä½¿â½¤ â€œ <strong>ç±»å. â½…æ³•å</strong> â€œçš„â½…å¼ï¼Œä¹Ÿå¯ä»¥ä½¿â½¤â€ <strong>å¯¹è±¡å. â½…æ³•å</strong> â€œ çš„â½…å¼ã€‚é™æ€æ–¹æ³•é‡Œä¸èƒ½è®¿é—®ç±»çš„éé™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚</p><p><strong>å®ä¾‹â½…æ³•</strong>ï¼šä¾å­˜äºç±»çš„å®ä¾‹ï¼Œéœ€è¦ä½¿ç”¨ â€œ <strong>å¯¹è±¡å. â½…æ³•å</strong> â€œ çš„â½…å¼è°ƒç”¨ï¼›å¯ä»¥è®¿é—®ç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚</p><h2 id="final-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#final-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="final å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>final å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h2><p><code>final</code> è¡¨ç¤ºä¸å¯å˜çš„æ„æ€ï¼Œå¯ç”¨äºä¿®é¥°ç±»ã€å±æ€§å’Œæ–¹æ³•ï¼š</p><ul><li><p>è¢« final ä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿</p></li><li><p>è¢« final ä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™</p></li><li><p>è¢« final ä¿®é¥°çš„å˜é‡ä¸å¯å˜ï¼Œè¢« final ä¿®é¥°çš„å˜é‡å¿…é¡»è¢«æ˜¾å¼ç¬¬æŒ‡å®šåˆå§‹å€¼ï¼Œè¿˜å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ä¸å¯å˜æŒ‡çš„æ˜¯å˜é‡çš„å¼•ç”¨ä¸å¯å˜ï¼Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹çš„ä¸å¯å˜ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//abcd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸€å¼ å›¾è¯´æ˜ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643611.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031643611.png"></a> </p></li></ul><h2 id="finalã€finallyã€finalize-çš„åŒºåˆ«ï¼Ÿ"><a href="#finalã€finallyã€finalize-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="finalã€finallyã€finalize çš„åŒºåˆ«ï¼Ÿ"></a>finalã€finallyã€finalize çš„åŒºåˆ«ï¼Ÿ</h2><ul><li><p><code>final</code> ç”¨äºä¿®é¥°å˜é‡ã€æ–¹æ³•å’Œç±»ï¼šfinal ä¿®é¥°çš„ç±»ä¸å¯è¢«ç»§æ‰¿ï¼›ä¿®é¥°çš„æ–¹æ³•ä¸å¯è¢«é‡å†™ï¼›ä¿®é¥°çš„å˜é‡ä¸å¯å˜ã€‚</p></li><li><p><code>finally</code> ä½œä¸ºå¼‚å¸¸å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåªèƒ½åœ¨ <code>try/catch</code> è¯­å¥ä¸­ï¼Œå¹¶ä¸”é™„å¸¦ä¸€ä¸ªè¯­å¥å—è¡¨ç¤ºè¿™æ®µè¯­å¥æœ€ç»ˆä¸€å®šè¢«æ‰§è¡Œï¼ˆæ— è®ºæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œç»å¸¸è¢«ç”¨åœ¨éœ€è¦é‡Šæ”¾èµ„æºçš„æƒ…å†µä¸‹ï¼Œ<code>System.exit (0)</code> å¯ä»¥é˜»æ–­ finally æ‰§è¡Œã€‚</p></li><li><p><code>finalize</code> æ˜¯åœ¨ <code>java.lang.Object</code> é‡Œå®šä¹‰çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰è¿™ä¹ˆä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ <code>gc</code> å¯åŠ¨ï¼Œè¯¥å¯¹è±¡è¢«å›æ”¶çš„æ—¶å€™è¢«è°ƒç”¨ã€‚</p><p>ä¸€ä¸ªå¯¹è±¡çš„ <code>finalize</code> æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œfinalize è¢«è°ƒç”¨ä¸ä¸€å®šä¼šç«‹å³å›æ”¶è¯¥å¯¹è±¡ï¼Œæ‰€ä»¥æœ‰å¯èƒ½è°ƒç”¨ finalize åï¼Œè¯¥å¯¹è±¡åˆä¸éœ€è¦è¢«å›æ”¶äº†ï¼Œç„¶ååˆ°äº†çœŸæ­£è¦è¢«å›æ”¶çš„æ—¶å€™ï¼Œå› ä¸ºå‰é¢è°ƒç”¨è¿‡ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è°ƒç”¨ finalize äº†ï¼Œè¿›è€Œäº§ç”Ÿé—®é¢˜ï¼Œå› æ­¤ä¸æ¨èä½¿ç”¨ finalize æ–¹æ³•ã€‚</p></li></ul><h2 id="å’Œ-equals-çš„åŒºåˆ«ï¼Ÿ"><a href="#å’Œ-equals-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="== å’Œ equals çš„åŒºåˆ«ï¼Ÿ"></a>== å’Œ equals çš„åŒºåˆ«ï¼Ÿ</h2><p><strong>==</strong> : å®ƒçš„ä½œâ½¤æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒâ¼€ä¸ªå¯¹è±¡ (åŸºæœ¬æ•°æ®ç±»å‹ **== **æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•â½¤æ•°æ®ç±»å‹ <code>==</code> æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)ã€‚</p><p><strong>equals()</strong> : å®ƒçš„ä½œâ½¤ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†æ˜¯è¿™ä¸ª â€œç›¸ç­‰â€ ä¸€èˆ¬ä¹Ÿåˆ†ä¸¤ç§æƒ…å†µï¼š</p><ul><li>é»˜è®¤æƒ…å†µï¼šç±»æ²¡æœ‰è¦†ç›– <code>equals()</code> â½…æ³•ã€‚åˆ™é€šè¿‡ <code>equals()</code> æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡ â€œ**==**â€ æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯ç›¸å½“äºæ¯”è¾ƒå†…å­˜åœ°å€ã€‚</li><li>è‡ªå®šä¹‰æƒ…å†µï¼šç±»è¦†ç›–äº† <code>equals()</code> â½…æ³•ã€‚æˆ‘ä»¬å¹³æ—¶è¦†ç›–çš„ <code>equals()</code> æ–¹æ³•ä¸€èˆ¬æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸åŒï¼Œè‡ªå®šä¹‰äº†ä¸€ä¸ªç›¸ç­‰çš„æ ‡å‡†ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹â¼¦ï¼Œ<code>Person</code>ï¼Œæˆ‘ä»¬è®¤ä¸ºä¸¤ä¸ªäººçš„ç¼–å·å’Œå§“åç›¸åŒï¼Œå°±æ˜¯ä¸€ä¸ªäººï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> no<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>no<span class="token punctuation">,</span> person<span class="token punctuation">.</span>no<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>                <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>no<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="hashCode-ä¸-equals"><a href="#hashCode-ä¸-equals" class="headerlink" title="hashCode ä¸ equals?"></a><code>hashCode</code> ä¸ <code>equals</code>?</h2><p>è¿™ä¸ªä¹Ÿæ˜¯é¢è¯•å¸¸é—®â€”â€”â€œä½ é‡å†™è¿‡ <code>hashcode</code> å’Œ <code>equals</code> ä¹ˆï¼Œä¸ºä»€ä¹ˆé‡å†™ equals æ—¶å¿…é¡»é‡å†™ <code>hashCode</code> â½…æ³•ï¼Ÿâ€</p><blockquote><p>ä»€ä¹ˆæ˜¯ <code>HashCode</code>ï¼Ÿ</p></blockquote><p><code>hashCode</code>() çš„ä½œâ½¤æ˜¯è·å–å“ˆå¸Œç ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›â¼€ä¸ª int æ•´æ•°ï¼Œå®šä¹‰åœ¨ Object ç±»ä¸­ï¼Œ æ˜¯ä¸€ä¸ªæœ¬åœ°â½…æ³•ï¼Œè¿™ä¸ªâ½…æ³•é€šå¸¸â½¤æ¥å°†å¯¹è±¡çš„å†…å­˜åœ°å€è½¬æ¢ä¸ºæ•´æ•°ä¹‹åè¿”å›ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å“ˆå¸Œç ä¸»è¦åœ¨å“ˆå¸Œè¡¨è¿™ç±»é›†åˆæ˜ å°„çš„æ—¶å€™ç”¨åˆ°ï¼Œå“ˆå¸Œè¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ (key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šèƒ½æ ¹æ®â€œé”®â€ å¿«é€Ÿçš„æ˜ å°„åˆ°å¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©â½¤åˆ°äº†å“ˆå¸Œç ï¼</p><blockquote><p>ä¸ºä»€ä¹ˆè¦æœ‰ <code>hashCode</code>ï¼Ÿ</p></blockquote><p>ä¸Šé¢å·²ç»è®²äº†ï¼Œä¸»è¦æ˜¯åœ¨å“ˆå¸Œè¡¨è¿™ç§ç»“æ„ä¸­ç”¨çš„åˆ°ã€‚</p><p>ä¾‹å¦‚ HashMap æ€ä¹ˆæŠŠ key æ˜ å°„åˆ°å¯¹åº”çš„ value ä¸Šå‘¢ï¼Ÿç”¨çš„å°±æ˜¯å“ˆå¸Œå–ä½™æ³•ï¼Œä¹Ÿå°±æ˜¯æ‹¿å“ˆå¸Œç å’Œå­˜å‚¨å…ƒç´ çš„æ•°ç»„çš„é•¿åº¦å–ä½™ï¼Œè·å– key å¯¹åº”çš„ value æ‰€åœ¨çš„ä¸‹æ ‡ä½ç½®ã€‚è¯¦ç»†å¯è§ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzkwODE5ODM0Ng==&mid=2247488788&idx=1&sn=01875e3e45515c2d57593cb7a01d0b6b&scene=21#wechat_redirect">é¢æ¸£é€†è¢­ï¼šJava é›†åˆè¿ç¯ä¸‰åé—®</a></p><blockquote><p>ä¸ºä»€ä¹ˆé‡å†™ <code>equals</code> æ—¶å¿…é¡»é‡å†™ <code>hashCode</code> â½…æ³•ï¼Ÿ</p></blockquote><p>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™ <code>hashcode</code> â¼€å®šä¹Ÿæ˜¯ç›¸åŒçš„ã€‚ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œå¯¹ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«è°ƒâ½¤ equals â½…æ³•éƒ½è¿”å› trueã€‚åä¹‹ï¼Œä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ hashcode å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸â¼€å®šæ˜¯ç›¸ç­‰çš„ ã€‚å› æ­¤ï¼Œ<strong>equals</strong> â½…æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™ <strong>hashCode</strong> â½…æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›–ã€‚</p><p><code>hashCode()</code> çš„é»˜è®¤â¾ä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§â½£ç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™ hashCode() ï¼Œåˆ™è¯¥ class çš„ä¸¤ä¸ªå¯¹è±¡â½†è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰</p><blockquote><p>ä¸ºä»€ä¹ˆä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ <code>hashcode</code> å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸â¼€å®šæ˜¯ç›¸ç­‰çš„ï¼Ÿ</p></blockquote><p>å› ä¸ºå¯èƒ½ä¼š<strong>ç¢°æ’</strong>ï¼Œ <code>hashCode()</code> æ‰€ä½¿â½¤çš„æ•£åˆ—ç®—æ³•ä¹Ÿè®¸åˆšå¥½ä¼šè®©å¤šä¸ªå¯¹è±¡ä¼ å›ç›¸åŒçš„æ•£åˆ—å€¼ã€‚è¶Šç³Ÿç³•çš„æ•£åˆ—ç®—æ³•è¶Šå®¹æ˜“ç¢°æ’ï¼Œä½†è¿™ä¹Ÿä¸æ•°æ®å€¼åŸŸåˆ†å¸ƒçš„ç‰¹æ€§æœ‰å…³ï¼ˆæ‰€è°“ç¢°æ’ä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯ä¸åŒçš„å¯¹è±¡å¾—åˆ°ç›¸åŒçš„ <code>hashCode()</code>ã€‚</p><h2 id="Java-æ˜¯å€¼ä¼ é€’ï¼Œè¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ"><a href="#Java-æ˜¯å€¼ä¼ é€’ï¼Œè¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ" class="headerlink" title="Java æ˜¯å€¼ä¼ é€’ï¼Œè¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ"></a>Java æ˜¯å€¼ä¼ é€’ï¼Œè¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ</h2><p>Java è¯­è¨€æ˜¯<strong>å€¼ä¼ é€’</strong>ã€‚Java è¯­è¨€çš„æ–¹æ³•è°ƒç”¨åªæ”¯æŒå‚æ•°çš„å€¼ä¼ é€’ã€‚å½“ä¸€ä¸ªå¯¹è±¡å®ä¾‹ä½œä¸ºä¸€ä¸ªå‚æ•°è¢«ä¼ é€’åˆ°æ–¹æ³•ä¸­æ—¶ï¼Œå‚æ•°çš„å€¼å°±æ˜¯å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚å¯¹è±¡çš„å±æ€§å¯ä»¥åœ¨è¢«è°ƒç”¨è¿‡ç¨‹ä¸­è¢«æ”¹å˜ï¼Œä½†å¯¹å¯¹è±¡å¼•ç”¨çš„æ”¹å˜æ˜¯ä¸ä¼šå½±å“åˆ°è°ƒç”¨è€…çš„ã€‚</p><p>JVM çš„å†…å­˜åˆ†ä¸ºå †å’Œæ ˆï¼Œå…¶ä¸­æ ˆä¸­å­˜å‚¨äº†åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹å®ä¾‹çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡åœ°å€ã€‚</p><p>è€Œå¯¹è±¡æ‰€å çš„ç©ºé—´æ˜¯åœ¨å †ä¸­å¼€è¾Ÿçš„ï¼Œæ‰€ä»¥ä¼ é€’çš„æ—¶å€™å¯ä»¥ç†è§£ä¸ºæŠŠå˜é‡å­˜å‚¨çš„å¯¹è±¡åœ°å€ç»™ä¼ é€’è¿‡å»ï¼Œå› æ­¤å¼•ç”¨ç±»å‹ä¹Ÿæ˜¯å€¼ä¼ é€’ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/LEpvqsxJHY3DBXw.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/LEpvqsxJHY3DBXw.png"></a>Java å¼•ç”¨æ•°æ®å€¼ä¼ é€’ç¤ºæ„å›¾</p><h2 id="æ·±æ‹·è´å’Œæµ…æ‹·è´"><a href="#æ·±æ‹·è´å’Œæµ…æ‹·è´" class="headerlink" title="æ·±æ‹·è´å’Œæµ…æ‹·è´?"></a>æ·±æ‹·è´å’Œæµ…æ‹·è´?</h2><ul><li><strong>æµ…æ‹·è´</strong>ï¼šä»…æ‹·è´è¢«æ‹·è´å¯¹è±¡çš„æˆå‘˜å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬æ•°æ®ç±»å‹å˜é‡çš„å€¼ï¼Œå’Œå¼•ç”¨æ•°æ®ç±»å‹å˜é‡çš„åœ°å€å€¼ï¼Œè€Œå¯¹äºå¼•ç”¨ç±»å‹å˜é‡æŒ‡å‘çš„å †ä¸­çš„å¯¹è±¡ä¸ä¼šæ‹·è´ã€‚</li><li><strong>æ·±æ‹·è´</strong>ï¼šå®Œå…¨æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œæ‹·è´è¢«æ‹·è´å¯¹è±¡çš„æˆå‘˜å˜é‡çš„å€¼ï¼Œå †ä¸­çš„å¯¹è±¡ä¹Ÿä¼šæ‹·è´ä¸€ä»½ã€‚</li></ul><p>ä¾‹å¦‚ç°åœ¨æœ‰ä¸€ä¸ª <code>order</code> å¯¹è±¡ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª <code>products</code> åˆ—è¡¨ï¼Œå®ƒçš„æµ…æ‹·è´å’Œæ·±æ‹·è´çš„ç¤ºæ„å›¾ï¼š</p><p><a href="https://s2.loli.net/2024/12/19/yaZIoNrO3vteKmi.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/yaZIoNrO3vteKmi.png"></a>æµ…æ‹·è´å’Œæ·±æ‹·è´ç¤ºæ„å›¾</p><p>å› æ­¤æ·±æ‹·è´æ˜¯å®‰å…¨çš„ï¼Œæµ…æ‹·è´çš„è¯å¦‚æœæœ‰å¼•ç”¨ç±»å‹ï¼Œé‚£ä¹ˆæ‹·è´åå¯¹è±¡ï¼Œå¼•ç”¨ç±»å‹å˜é‡ä¿®æ”¹ï¼Œä¼šå½±å“åŸå¯¹è±¡ã€‚</p><blockquote><p>æµ…æ‹·è´å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p></blockquote><p>Object ç±»æä¾›çš„ clone() æ–¹æ³•å¯ä»¥éå¸¸ç®€å•åœ°å®ç°å¯¹è±¡çš„æµ…æ‹·è´ã€‚</p><blockquote><p>æ·±æ‹·è´å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p></blockquote><ul><li>é‡å†™å…‹éš†æ–¹æ³•ï¼šé‡å†™å…‹éš†æ–¹æ³•ï¼Œå¼•ç”¨ç±»å‹å˜é‡å•ç‹¬å…‹éš†ï¼Œè¿™é‡Œå¯èƒ½ä¼šæ¶‰åŠå¤šå±‚é€’å½’ã€‚</li><li>åºåˆ—åŒ–ï¼šå¯ä»¥å…ˆè®²åŸå¯¹è±¡åºåˆ—åŒ–ï¼Œå†ååºåˆ—åŒ–æˆæ‹·è´å¯¹è±¡ã€‚</li></ul><h2 id="Java-åˆ›å»ºå¯¹è±¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"><a href="#Java-åˆ›å»ºå¯¹è±¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ" class="headerlink" title="Java åˆ›å»ºå¯¹è±¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"></a>Java åˆ›å»ºå¯¹è±¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h2><p>Java ä¸­æœ‰ä»¥ä¸‹å››ç§åˆ›å»ºå¯¹è±¡çš„æ–¹å¼:</p><p><a href="https://s2.loli.net/2024/12/19/OS6iboZhjkvMJLr.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/OS6iboZhjkvMJLr.png"></a> </p><ul><li><code>new</code> åˆ›å»ºæ–°å¯¹è±¡</li><li>é€šè¿‡åå°„æœºåˆ¶</li><li>é‡‡ç”¨ <code>clone</code> æœºåˆ¶</li><li>é€šè¿‡åºåˆ—åŒ–æœºåˆ¶</li></ul><p>å‰ä¸¤è€…éƒ½éœ€è¦æ˜¾å¼åœ°è°ƒç”¨æ„é€ æ–¹æ³•ã€‚å¯¹äº <code>clone</code> æœºåˆ¶, éœ€è¦æ³¨æ„æµ…æ‹·è´å’Œæ·±æ‹·è´çš„åŒºåˆ«ï¼Œå¯¹äºåºåˆ—åŒ–æœºåˆ¶éœ€è¦æ˜ç¡®å…¶å®ç°åŸç†ï¼Œåœ¨ <code>Java</code> ä¸­åºåˆ—åŒ–å¯ä»¥é€šè¿‡å®ç° <code>Externalizable</code> æˆ–è€… <code>Serializable</code> æ¥å®ç°ã€‚</p></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaåŸºç¡€æ ¸å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaç³»åˆ—ï¼ˆä¸€ï¼‰| åŸºç¡€è¯­æ³•</title>
      <link href="/posts/42528.html"/>
      <url>/posts/42528.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="Java-æ¦‚è¿°"><a href="#Java-æ¦‚è¿°" class="headerlink" title="Java æ¦‚è¿°"></a>Java æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯-Javaï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Javaï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Javaï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Javaï¼Ÿ</h3><p>Java æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸ä»…å¸æ”¶äº† <code>C++</code> è¯­è¨€çš„å„ç§ä¼˜ç‚¹ï¼Œè¿˜æ‘’å¼ƒäº† <code>C++</code> é‡Œéš¾ä»¥ç†è§£çš„å¤šç»§æ‰¿ã€æŒ‡é’ˆç­‰æ¦‚å¿µï¼Œå› æ­¤ <code>Java</code> è¯­è¨€å…·æœ‰åŠŸèƒ½å¼ºå¤§å’Œç®€å•æ˜“ç”¨ä¸¤ä¸ªç‰¹å¾ã€‚<code>Java</code> è¯­è¨€ä½œä¸ºé™æ€é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€çš„ä¼˜ç§€ä»£è¡¨ï¼Œæå¥½åœ°å®ç°äº†é¢å‘å¯¹è±¡ç†è®ºï¼Œå…è®¸ç¨‹åºå‘˜ä»¥ä¼˜é›…çš„æ€ç»´æ–¹å¼è¿›è¡Œå¤æ‚çš„ç¼–ç¨‹ ã€‚</p><h3 id="Java-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"><a href="#Java-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"></a>Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ</h3><p>Java è¯­è¨€æœ‰å¾ˆå¤šä¼˜ç§€ï¼ˆå¯å¹ï¼‰çš„ç‰¹ç‚¹ï¼Œä»¥ä¸‹å‡ ä¸ªæ˜¯æ¯”è¾ƒçªå‡ºçš„ï¼š</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641482.png" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641482.png"></a><strong>Java è¯­è¨€ç‰¹ç‚¹</strong></p><ul><li><strong>é¢å‘å¯¹è±¡</strong>ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼›</li><li><strong>å¹³å°æ— å…³æ€§</strong>ï¼šJava æ˜¯ â€œã€<strong>ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ</strong>ï¼ˆ<code>Write Onceï¼ŒRun any Where</code>ï¼‰ã€‘â€ çš„è¯­è¨€ï¼Œå› æ­¤é‡‡ç”¨ <code>Java</code> è¯­è¨€ç¼–å†™çš„ç¨‹åºå…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤æ€§ï¼Œè€Œä¿è¯è¿™ä¸€ç‚¹çš„æ­£æ˜¯ <code>Java</code> çš„è™šæ‹Ÿæœºæœºåˆ¶ã€‚åœ¨å¼•å…¥è™šæ‹Ÿæœºä¹‹åï¼Œ<code>Java</code> è¯­è¨€åœ¨ä¸åŒçš„å¹³å°ä¸Šè¿è¡Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</li><li><strong>æ”¯æŒå¤šçº¿ç¨‹</strong>ï¼š<code>C++</code> è¯­è¨€æ²¡æœ‰å†…ç½®çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå› æ­¤å¿…é¡»è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å¤šçº¿ç¨‹åŠŸèƒ½æ¥è¿›è¡Œå¤šçº¿ç¨‹ç¨‹åºè®¾è®¡</li><li>ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ï¼›</li></ul><h3 id="JVMã€JDK-å’Œ-JRE-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#JVMã€JDK-å’Œ-JRE-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="JVMã€JDK å’Œ JRE æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>JVMã€JDK å’Œ JRE æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><code>JVM</code>ï¼š<code>Java Virtual Machine</code>ï¼Œ<code>Java</code> è™šæ‹Ÿæœºï¼Œ<code>Java</code> ç¨‹åºè¿è¡Œåœ¨ <code>Java</code> è™šæ‹Ÿæœºä¸Šã€‚é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„å®ç°ï¼ˆ<code>Windowsï¼ŒLinuxï¼ŒmacOS</code>ï¼‰ä¸åŒçš„ <code>JVM</code>ï¼Œå› æ­¤ <code>Java</code> è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚</p><p><code>JRE</code>ï¼š<code>Java</code> è¿â¾æ—¶ç¯å¢ƒã€‚å®ƒæ˜¯è¿â¾å·²ç¼–è¯‘ <code>Java</code> ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹çš„é›†åˆï¼ŒåŒ…æ‹¬ã€ <code>Java</code> è™šæ‹Ÿæœºï¼ˆ<code>JVM</code>ï¼‰ã€<code>Java</code> ç±»åº“ã€<code>Java</code> å‘½ä»¤å’Œå…¶ä»–çš„â¼€äº›åŸºç¡€æ„ä»¶ã€‘ã€‚ä½†æ˜¯ï¼Œå®ƒä¸èƒ½â½¤äºåˆ›å»ºæ–°ç¨‹åºã€‚</p><p><code>JDK</code>: <code>Java Development Kit</code>ï¼Œå®ƒæ˜¯åŠŸèƒ½â»¬å…¨çš„ <code>Java SDKã€‚</code>å®ƒæ‹¥æœ‰ <code>JRE</code> æ‰€æ‹¥æœ‰çš„â¼€åˆ‡ï¼Œè¿˜æœ‰ç¼–è¯‘å™¨ï¼ˆ<code>javac</code>ï¼‰å’Œâ¼¯å…·ï¼ˆå¦‚ <code>javadoc</code> å’Œ <code>jdb</code>ï¼‰ã€‚å®ƒèƒ½å¤Ÿåˆ›å»ºå’Œç¼–è¯‘ç¨‹åºã€‚</p><p>ç®€å•æ¥è¯´ï¼Œ<code>JDK &gt; JRE &gt; JVM</code></p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641391.png" title="JDKã€JREã€JVM å…³ç³»" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641391.png" alt="JDKã€JREã€JVM å…³ç³»"></a></p><h3 id="è¯´è¯´ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ"><a href="#è¯´è¯´ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="è¯´è¯´ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ"></a>è¯´è¯´ä»€ä¹ˆæ˜¯è·¨å¹³å°æ€§ï¼ŸåŸç†æ˜¯ä»€ä¹ˆ</h3><p>æ‰€è°“è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡ <code>Java</code> è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘åï¼Œå¯ä»¥åœ¨å¤šä¸ªç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œã€‚</p><p>å®ç°åŸç†ï¼š<code>Java</code> ç¨‹åºæ˜¯é€šè¿‡ <code>Java</code> è™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ <code>Java</code> è™šæ‹Ÿæœºï¼Œè¯¥ç³»ç»Ÿå°±å¯ä»¥è¿è¡Œ <code>java</code> ç¨‹åºã€‚</p><h3 id="ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ"><a href="#ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?"></a>ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?</h3><p>æ‰€è°“çš„å­—èŠ‚ç ï¼Œå°±æ˜¯ <code>Java</code> ç¨‹åºç»è¿‡ç¼–è¯‘ä¹‹ç±»äº§ç”Ÿçš„<code>. class</code> æ–‡ä»¶ï¼Œå­—èŠ‚ç èƒ½å¤Ÿè¢«è™šæ‹Ÿæœºè¯†åˆ«ï¼Œä»è€Œå®ç° Java ç¨‹åºçš„è·¨å¹³å°æ€§ã€‚</p><p><strong>Java</strong> ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œä¸»è¦æœ‰ä¸‰æ­¥ï¼š</p><ul><li><strong>ç¼–è¯‘</strong>ï¼šå°†æˆ‘ä»¬çš„ä»£ç ï¼ˆ<code>.java</code>ï¼‰ç¼–è¯‘æˆè™šæ‹Ÿæœºå¯ä»¥è¯†åˆ«ç†è§£çš„å­—èŠ‚ç  (<code>.class</code>)</li><li><strong>è§£é‡Š</strong>ï¼šè™šæ‹Ÿæœºæ‰§è¡Œ <code>Java</code> å­—èŠ‚ç ï¼Œå°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨èƒ½è¯†åˆ«çš„æœºå™¨ç </li><li><strong>æ‰§è¡Œ</strong>ï¼šå¯¹åº”çš„æœºå™¨æ‰§è¡ŒäºŒè¿›åˆ¶æœºå™¨ç </li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641227.png" title="Java ç¨‹åºæ‰§è¡Œè¿‡ç¨‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641227.png" alt="Java ç¨‹åºæ‰§è¡Œè¿‡ç¨‹"></a></p><p>åªéœ€è¦æŠŠ <code>Java</code> ç¨‹åºç¼–è¯‘æˆ <code>Java</code> è™šæ‹Ÿæœºèƒ½è¯†åˆ«çš„ <code>Java</code> å­—èŠ‚ç ï¼Œä¸åŒçš„å¹³å°å®‰è£…å¯¹åº”çš„ <code>Java</code> è™šæ‹Ÿæœºï¼Œè¿™æ ·å°±å¯ä»¥å¯ä»¥å®ç° <code>Java</code> è¯­è¨€çš„å¹³å°æ— å…³æ€§ã€‚</p><h3 id="ä¸ºä»€ä¹ˆè¯´-Java-è¯­è¨€-â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¯´-Java-è¯­è¨€-â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€ â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€ â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ</h3><blockquote><p>ç¼–è¯‘å‹ï¼šä¸€æ¬¡æ€§ç¿»è¯‘<br>è§£é‡Šæ€§ï¼šé€è¡Œç¿»è¯‘<br>Java ç¨‹åº å…ˆç¼–è¯‘ åè§£é‡Š ã€.java â€“&gt;.class â€“&gt;æœºå™¨ç ã€‘</p></blockquote><p>é«˜çº§ç¼–ç¨‹è¯­è¨€æŒ‰ç…§ç¨‹åºçš„æ‰§è¡Œæ–¹å¼åˆ†ä¸º<strong>ç¼–è¯‘å‹</strong>å’Œ<strong>è§£é‡Šå‹</strong>ä¸¤ç§ã€‚</p><ul><li><strong>ç¼–è¯‘å‹è¯­è¨€</strong>ï¼šæŒ‡ç¼–è¯‘å™¨é’ˆå¯¹ç‰¹å®šçš„æ“ä½œç³»ç»Ÿå°†æºä»£ç <strong>ä¸€æ¬¡æ€§ç¿»è¯‘</strong>æˆå¯è¢«è¯¥å¹³å°æ‰§è¡Œçš„æœºå™¨ç ï¼›</li><li><strong>è§£é‡Šå‹è¯­è¨€</strong>ï¼šæŒ‡è§£é‡Šå™¨å¯¹æºç¨‹åº<strong>é€è¡Œè§£é‡Š</strong>æˆç‰¹å®šå¹³å°çš„æœºå™¨ç å¹¶ç«‹å³æ‰§è¡Œã€‚</li></ul><p><strong>Java</strong> è¯­è¨€æ—¢å…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ç‰¹å¾ï¼Œä¹Ÿå…·æœ‰è§£é‡Šå‹è¯­è¨€çš„ç‰¹å¾ã€‚å› ä¸º Java ç¨‹åºè¦ç»è¿‡<strong>å…ˆç¼–è¯‘</strong>ï¼Œ<strong>åè§£é‡Š</strong>ä¸¤ä¸ªæ­¥éª¤ã€‚</p><ol><li><p><strong>ç¼–è¯‘</strong>ï¼š<code>.java</code> ç¼–è¯‘ <code>.class</code> ã€‚<code>Java</code> ç¼–å†™çš„ç¨‹åºéœ€è¦å…ˆç»è¿‡ç¼–è¯‘æ­¥éª¤ï¼Œç”Ÿæˆå­—èŠ‚ç ï¼ˆ<code>.class</code> æ–‡ä»¶ï¼‰</p></li><li><p><strong>è§£é‡Š</strong>ï¼šè¿™ç§å­—èŠ‚ç å¿…é¡»å†ç»è¿‡ <code>JVM</code>ï¼Œè§£é‡Šæˆæ“ä½œç³»ç»Ÿèƒ½è¯†åˆ«çš„<strong>æœºå™¨ç </strong>ï¼Œåœ¨ç”±æ“ä½œç³»ç»Ÿæ‰§è¡Œã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º Java è¯­è¨€<strong>ç¼–è¯‘</strong>ä¸<strong>è§£é‡Š</strong>å¹¶å­˜ã€‚</p></li></ol><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641639.png" title="ç¼–è¯‘ä¸è§£é‡Š" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641639.png" alt="ç¼–è¯‘ä¸è§£é‡Š"></a></p><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><h3 id="Java-æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼Ÿ"><a href="#Java-æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼Ÿ" class="headerlink" title="Java æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼Ÿ"></a>Java æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼Ÿ</h3><p><strong>å®šä¹‰ï¼š</strong><code>Java</code> è¯­è¨€æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¯¹äºæ¯ä¸€ç§æ•°æ®éƒ½å®šä¹‰äº†æ˜ç¡®çš„å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…äº†ä¸åŒå¤§å°çš„å†…å­˜ç©ºé—´ã€‚</p><p><code>Java</code> è¯­è¨€æ•°æ®ç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š<strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>å’Œ<strong>å¼•ç”¨æ•°æ®ç±»å‹</strong>ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641466.png" title="Java æ•°æ®ç±»å‹" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641466.png" alt="Java æ•°æ®ç±»å‹"></a></p><p><strong>åŸºæœ¬æ•°æ®ç±»å‹ï¼š</strong></p><ul><li>æ•°å€¼å‹</li><li>æ•´æ•°ç±»å‹<code>ï¼ˆbyteã€shortã€longï¼‰</code></li><li>æµ®ç‚¹ç±»å‹<code>ï¼ˆfloatã€longï¼‰</code></li><li>å­—ç¬¦å‹<code>ï¼ˆcharï¼‰</code></li><li>å¸ƒå°”å‹<code>ï¼ˆbooleanï¼‰</code></li></ul><p><code>Java</code> åŸºæœ¬æ•°æ®ç±»å‹èŒƒå›´å’Œé»˜è®¤å€¼ï¼š</p><table><thead><tr><th>åŸºæœ¬ç±»å‹</th><th>ä½æ•°</th><th>å­—èŠ‚</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>int</code></td><td>32</td><td>4</td><td>0</td></tr><tr><td><code>short</code></td><td>16</td><td>2</td><td>0</td></tr><tr><td><code>long</code></td><td>64</td><td>8</td><td>0L</td></tr><tr><td><code>byte</code></td><td>8</td><td>1</td><td>0</td></tr><tr><td><code>char</code></td><td>16</td><td>2</td><td>'u0000'</td></tr><tr><td><code>float</code></td><td>32</td><td>4</td><td>0f</td></tr><tr><td><code>double</code></td><td>64</td><td>8</td><td>0d</td></tr><tr><td><code>boolean</code></td><td>1</td><td><br></td><td>false</td></tr></tbody></table><p><strong>å¼•ç”¨æ•°æ®ç±»å‹ï¼š</strong></p><ul><li>ç±»ï¼ˆ<code>class</code>ï¼‰</li><li>æ¥å£ï¼ˆ<code>interface</code>ï¼‰</li><li>æ•°ç»„ (<code>array</code>[])</li></ul><h3 id="è‡ªåŠ¨ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿçœ‹çœ‹è¿™å‡ è¡Œä»£ç ï¼Ÿ"><a href="#è‡ªåŠ¨ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿçœ‹çœ‹è¿™å‡ è¡Œä»£ç ï¼Ÿ" class="headerlink" title="è‡ªåŠ¨ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿçœ‹çœ‹è¿™å‡ è¡Œä»£ç ï¼Ÿ"></a>è‡ªåŠ¨ç±»å‹è½¬æ¢ã€å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿçœ‹çœ‹è¿™å‡ è¡Œä»£ç ï¼Ÿ</h3><p><code>Java</code> æ‰€æœ‰çš„æ•°å€¼å‹å˜é‡å¯ä»¥ç›¸äº’è½¬æ¢ã€‚</p><p>å½“æŠŠä¸€ä¸ªè¡¨æ•°èŒƒå›´å°çš„æ•°å€¼æˆ–å˜é‡ç›´æ¥èµ‹ç»™å¦ä¸€ä¸ªè¡¨æ•°èŒƒå›´å¤§çš„å˜é‡æ—¶ï¼Œå¯ä»¥è¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼›åä¹‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641473.png" title="Java è‡ªåŠ¨ç±»å‹è½¬æ¢æ–¹å‘" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031641473.png" alt="Java è‡ªåŠ¨ç±»å‹è½¬æ¢æ–¹å‘"></a></p><p>è¿™å°±å¥½åƒï¼Œå°æ¯é‡Œçš„æ°´å€’è¿›å¤§æ¯æ²¡é—®é¢˜ï¼Œä½†å¤§æ¯çš„æ°´å€’è¿›å°æ¯å°±ä¸è¡Œäº†ï¼Œå¯èƒ½ä¼šæº¢å‡ºã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><blockquote><p><code>float f=3.4</code>ï¼Œå¯¹å—ï¼Ÿ</p></blockquote><p>ä¸æ­£ç¡®ã€‚3.4 æ˜¯å•ç²¾åº¦æ•°ï¼Œå°†åŒç²¾åº¦å‹ï¼ˆ<code>double</code>ï¼‰èµ‹å€¼ç»™æµ®ç‚¹å‹ï¼ˆ<code>float</code>ï¼‰å±äºä¸‹è½¬å‹ï¼ˆ<code>down-castingï¼Œ</code>ä¹Ÿç§°ä¸º<strong>çª„åŒ–</strong>ï¼‰ä¼šé€ æˆ<strong>ç²¾åº¦æŸå¤±</strong>ï¼Œå› æ­¤éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢<code>float f =(float)3.4;</code>æˆ–è€…å†™æˆ<code>float f =3.4F</code></p><blockquote><p><code>short s1 = 1; s1 = s1 + 1ï¼›</code>å¯¹å—ï¼Ÿ<code>short s1 = 1; s1 += 1;</code>å¯¹å—ï¼Ÿ</p></blockquote><p>å¯¹äº <code>short s1 = 1; s1 = s1 + 1;</code> ç¼–è¯‘å‡ºé”™ï¼Œç”±äº 1 æ˜¯ <code>int</code> ç±»å‹ï¼Œå› æ­¤ <code>s1+1</code> è¿ç®—ç»“æœä¹Ÿæ˜¯ int å‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹æ‰èƒ½èµ‹å€¼ç»™ <code>short</code> å‹ã€‚</p><p>è€Œ <code>short s1 = 1; s1 += 1</code>; å¯ä»¥æ­£ç¡®ç¼–è¯‘ï¼Œå› ä¸º <code>s1+=</code> 1; ç›¸å½“äº <code>s1 = (short(s1 + 1)</code>; å…¶ä¸­æœ‰éšå«çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†ç®±-å°ç®±ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†ç®±-å°ç®±ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†ç®± / å°ç®±ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†ç®± / å°ç®±ï¼Ÿ</h3><ul><li><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›</li><li><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›</li></ul><p><code>Java</code> å¯ä»¥è‡ªåŠ¨å¯¹åŸºæœ¬æ•°æ®ç±»å‹å’Œå®ƒä»¬çš„åŒ…è£…ç±»è¿›è¡Œè£…ç®±å’Œæ‹†ç®±ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642042.png" title="è£…ç®±å’Œæ‹†ç®±" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642042.png" alt="è£…ç®±å’Œæ‹†ç®±"></a></p><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Integer i &#x3D; 10;  &#x2F;&#x2F;è£…ç®±int n &#x3D; i;   &#x2F;&#x2F;æ‹†ç®±<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="amp-å’Œ-amp-amp-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#amp-å’Œ-amp-amp-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="&amp; å’Œ &amp;&amp; æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>&amp; å’Œ &amp;&amp; æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul><li>&amp; ï¼šã€<strong>é€»è¾‘ä¸</strong>ã€‘ä¸¤è¾¹éƒ½æ˜¯<code>true</code>ï¼Œç»“æœä¸º <code>true</code>ï¼›åä¹‹ä¸º<code>false</code>ï¼›ä¸ç®¡å¦‚ä½•ä¸¤è¾¹éƒ½ä¼šè®¡ç®—</li><li>&amp;&amp; ï¼šã€<strong>çŸ­è·¯ä¸</strong>ã€‘å·¦è¾¹ä¸º false ï¼Œä¸è®¡ç®—å³è¾¹ï¼Œç»“æœä¸º <code>false</code>ï¼›å·¦è¾¹ä¸º<code>true</code>ï¼Œæ‰è®¡ç®—å³è¾¹ï¼Œè‹¥ä¸º <code>true</code> ç»“æœä¸º<code>true</code> ï¼›åä¹‹ä¸º false</li></ul><p>ä¾‹å¦‚åœ¨éªŒè¯ç”¨æˆ·ç™»å½•æ—¶åˆ¤å®šç”¨æˆ·åä¸æ˜¯ null è€Œä¸”ä¸æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œåº”å½“å†™ä¸º</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">username <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span><span class="token operator">!</span>username<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºŒè€…çš„é¡ºåºä¸èƒ½äº¤æ¢ï¼Œæ›´ä¸èƒ½ç”¨ &amp; è¿ç®—ç¬¦ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ¡ä»¶å¦‚æœä¸æˆç«‹ï¼Œæ ¹æœ¬ä¸èƒ½è¿›è¡Œå­—ç¬¦ä¸²çš„ equals æ¯”è¾ƒï¼Œå¦åˆ™ä¼šäº§ç”Ÿ <code>NullPointerException</code> å¼‚å¸¸ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šé€»è¾‘æˆ–è¿ç®—ç¬¦ï¼ˆ|ï¼‰å’ŒçŸ­è·¯æˆ–è¿ç®—ç¬¦ï¼ˆ||ï¼‰çš„å·®åˆ«ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><h3 id="switch-æ˜¯å¦èƒ½ä½œç”¨åœ¨-byte-long-String-ä¸Šï¼Ÿ"><a href="#switch-æ˜¯å¦èƒ½ä½œç”¨åœ¨-byte-long-String-ä¸Šï¼Ÿ" class="headerlink" title="switch æ˜¯å¦èƒ½ä½œç”¨åœ¨ byte/long/String ä¸Šï¼Ÿ"></a>switch æ˜¯å¦èƒ½ä½œç”¨åœ¨ byte/long/String ä¸Šï¼Ÿ</h3><ul><li>Java5 ä»¥å‰ switch(expr) ä¸­ï¼Œexpr åªèƒ½æ˜¯ byteã€shortã€charã€intã€‚</li><li>Java 5 å¼€å§‹ï¼ŒJava ä¸­å¼•å…¥äº†<strong>æšä¸¾ç±»å‹</strong>ï¼Œ expr ä¹Ÿå¯ä»¥æ˜¯ <code>enum</code> ç±»å‹ã€‚</li><li>Java 7 å¼€å§‹ï¼Œexpr è¿˜å¯ä»¥æ˜¯å­—ç¬¦ä¸² (String)ï¼Œä½†æ˜¯é•¿æ•´å‹(long) åœ¨ç›®å‰æ‰€æœ‰çš„ç‰ˆæœ¬ä¸­éƒ½æ˜¯ä¸å¯ä»¥çš„ã€‚</li><li>java 17 å¼€å§‹ï¼Œé¢„è§ˆç‰ˆï¼Œæ”¯æŒä½¿ç”¨ Long</li><li>java 21 å¼€å§‹ï¼Œä¸ºæ­£å¼ç‰ˆ</li></ul><h3 id="break-continue-return-çš„åŒºåˆ«åŠä½œç”¨ï¼Ÿ"><a href="#break-continue-return-çš„åŒºåˆ«åŠä½œç”¨ï¼Ÿ" class="headerlink" title="break ,continue ,return çš„åŒºåˆ«åŠä½œç”¨ï¼Ÿ"></a>break ,continue ,return çš„åŒºåˆ«åŠä½œç”¨ï¼Ÿ</h3><ul><li><code>break</code> è·³å‡ºæ•´ä¸ªå¾ªç¯ï¼Œä¸å†æ‰§è¡Œå¾ªç¯ (<strong>ç»“æŸå½“å‰çš„å¾ªç¯ä½“</strong>)</li><li><code>continue</code> è·³å‡ºæœ¬æ¬¡å¾ªç¯ï¼Œç»§ç»­æ‰§è¡Œä¸‹æ¬¡å¾ªç¯ (<strong>ç»“æŸæ­£åœ¨æ‰§è¡Œçš„å¾ªç¯ è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ¡ä»¶</strong>)</li><li><code>return</code> ç¨‹åºè¿”å›ï¼Œä¸å†æ‰§è¡Œä¸‹é¢çš„ä»£ç  (<strong>ç»“æŸå½“å‰çš„æ–¹æ³• ç›´æ¥è¿”å›</strong>)</li></ul><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642283.png" title="break ã€continue ã€return" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/img/2022/03/202203031642283.png" alt="break ã€continue ã€return"></a></p><h3 id="ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®—-2-ä¹˜ä»¥-8ï¼Ÿ"><a href="#ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®—-2-ä¹˜ä»¥-8ï¼Ÿ" class="headerlink" title="ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®— 2 ä¹˜ä»¥ 8ï¼Ÿ"></a>ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®— 2 ä¹˜ä»¥ 8ï¼Ÿ</h3><p><code>2 &lt;&lt; 3</code>ã€‚<strong>ä½è¿ç®—</strong>ï¼Œæ•°å­—çš„äºŒè¿›åˆ¶ä½å·¦ç§»ä¸‰ä½ç›¸å½“äºä¹˜ä»¥ <code>2</code> çš„ä¸‰æ¬¡æ–¹ã€‚</p><p><a href="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171707119.png" title="ä½ç§»" class="gallery-item"><img src="https://gcore.jsdelivr.net/gh/lingzhexi/blogImage/2024/12/202412171707119.png" alt="ä½ç§»"></a></p><h3 id="è¯´è¯´è‡ªå¢è‡ªå‡è¿ç®—ï¼Ÿçœ‹ä¸‹è¿™å‡ ä¸ªä»£ç è¿è¡Œç»“æœï¼Ÿ"><a href="#è¯´è¯´è‡ªå¢è‡ªå‡è¿ç®—ï¼Ÿçœ‹ä¸‹è¿™å‡ ä¸ªä»£ç è¿è¡Œç»“æœï¼Ÿ" class="headerlink" title="è¯´è¯´è‡ªå¢è‡ªå‡è¿ç®—ï¼Ÿçœ‹ä¸‹è¿™å‡ ä¸ªä»£ç è¿è¡Œç»“æœï¼Ÿ"></a>è¯´è¯´è‡ªå¢è‡ªå‡è¿ç®—ï¼Ÿçœ‹ä¸‹è¿™å‡ ä¸ªä»£ç è¿è¡Œç»“æœï¼Ÿ</h3><p>åœ¨å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¸¸è§çš„ä¸€ç§æƒ…å†µæ˜¯éœ€è¦æŸä¸ªæ•´æ•°ç±»å‹å˜é‡å¢åŠ  1 æˆ–å‡å°‘ 1ï¼Œ<code>Java</code> æä¾›äº†ä¸€ç§ç‰¹æ®Šçš„è¿ç®—ç¬¦ï¼Œç”¨äºè¿™ç§è¡¨è¾¾å¼ï¼Œå«åšè‡ªå¢è¿ç®—ç¬¦<code>ï¼ˆ++)</code> å’Œè‡ªå‡è¿ç®—ç¬¦ï¼ˆâ€“ï¼‰ã€‚</p><p><code>++ å’Œ --</code> è¿ç®—ç¬¦å¯ä»¥æ”¾åœ¨å˜é‡ä¹‹å‰ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨å˜é‡ä¹‹åã€‚</p><p>å½“è¿ç®—ç¬¦æ”¾åœ¨å˜é‡ä¹‹å‰æ—¶ (å‰ç¼€)ï¼Œå…ˆè‡ªå¢ / å‡ï¼Œå†èµ‹å€¼ï¼›å½“è¿ç®—ç¬¦æ”¾åœ¨å˜é‡ä¹‹åæ—¶ (åç¼€)ï¼Œå…ˆèµ‹å€¼ï¼Œå†è‡ªå¢ / å‡ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“ <code>b = ++a</code> æ—¶ï¼Œå…ˆè‡ªå¢ï¼ˆè‡ªå·±å¢åŠ  1ï¼‰ï¼Œå†èµ‹å€¼ï¼ˆèµ‹å€¼ç»™ bï¼‰ï¼›å½“ <code>b = a++</code> æ—¶ï¼Œå…ˆèµ‹å€¼ (èµ‹å€¼ç»™ b)ï¼Œå†è‡ªå¢ï¼ˆè‡ªå·±å¢åŠ  1ï¼‰ã€‚ä¹Ÿå°±æ˜¯ï¼Œ++a è¾“å‡ºçš„æ˜¯ a+1 çš„å€¼ï¼Œa++ è¾“å‡ºçš„æ˜¯ a å€¼ã€‚</p><p>ç”¨ä¸€å¥å£è¯€å°±æ˜¯ï¼šâ€œç¬¦å·åœ¨å‰å°±å…ˆåŠ  / å‡ï¼Œç¬¦å·åœ¨åå°±ååŠ  / å‡â€ã€‚</p><blockquote><p>çœ‹ä¸€ä¸‹è¿™æ®µä»£ç è¿è¡Œç»“æœï¼Ÿ</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> i  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">=</span> i<span class="token operator">++</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç­”æ¡ˆæ˜¯ 1ã€‚æœ‰ç‚¹ç¦»è°±å¯¹ä¸å¯¹ã€‚</p><p>å¯¹äº <code>JVM</code> è€Œè¨€ï¼Œå®ƒå¯¹è‡ªå¢è¿ç®—çš„å¤„ç†ï¼Œæ˜¯ä¼šå…ˆå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥æ¥æ”¶ i çš„å€¼ï¼Œç„¶åè¿›è¡Œè‡ªå¢è¿ç®—ï¼Œæœ€ååˆå°†ä¸´æ—¶å˜é‡èµ‹ç»™äº†å€¼ä¸º 2 çš„ iï¼Œæ‰€ä»¥æœ€åçš„ç»“æœä¸º 1ã€‚</p><p>ç›¸å½“äºè¿™æ ·çš„ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span>ï¼›<span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>i<span class="token operator">++</span>ï¼›i <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ®µä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    count <span class="token operator">=</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"count = "</span><span class="token operator">+</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç­”æ¡ˆæ˜¯ 0ã€‚</p><p>å’Œä¸Šé¢çš„é¢˜ç›®ä¸€æ ·çš„é“ç†ï¼ŒåŒæ ·æ˜¯ç”¨äº†ä¸´æ—¶å˜é‡ï¼Œcount å®é™…æ˜¯ç­‰äºä¸´æ—¶å˜é‡çš„å€¼ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> <span class="token function">autoAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> count<span class="token punctuation">;</span>    count <span class="token operator">=</span> coutn <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaåŸºç¡€æ ¸å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo ç³»åˆ—ï¼ˆäºŒï¼‰| GitHub éƒ¨ç½²</title>
      <link href="/posts/29807.html"/>
      <url>/posts/29807.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬æ–‡è½¬è½½ï¼š<a href="https://zhuanlan.zhihu.com/p/60578464">ä½¿ç”¨ Hexo+GitHub æ­å»ºä¸ªäººå…è´¹åšå®¢æ•™ç¨‹ï¼ˆå°ç™½å‘ï¼‰</a><br>æœ¬æ–‡åªä»‹ç»å¦‚ä½•éƒ¨ç½²åˆ°GitPageï¼Œé»˜è®¤Hexoå·²æ­å»º</p></blockquote><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="GitHub-Pages-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#GitHub-Pages-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="GitHub Pages æ˜¯ä»€ä¹ˆï¼Ÿ"></a>GitHub Pages æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li><a href="https://help.github.com/en/articles/what-is-github-pages">What is GitHub Pages? - GitHub Help</a></li></ul><p>GitHub Pages æ˜¯ç”± GitHub å®˜æ–¹æä¾›çš„ä¸€ç§å…è´¹çš„é™æ€ç«™ç‚¹æ‰˜ç®¡æœåŠ¡ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨ GitHub ä»“åº“é‡Œæ‰˜ç®¡å’Œå‘å¸ƒè‡ªå·±çš„é™æ€ç½‘ç«™é¡µé¢ã€‚</p><h3 id="Hexo-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Hexo-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Hexo æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Hexo æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>å®˜ç½‘ï¼š<a href="https://hexo.io/zh-cn/">hexo.io</a></li></ul><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„é™æ€åšå®¢æ¡†æ¶ï¼Œå®ƒåŸºäº Node.js è¿è¡Œï¼Œå¯ä»¥å°†æˆ‘ä»¬æ’°å†™çš„ Markdown æ–‡æ¡£è§£ææ¸²æŸ“æˆé™æ€çš„ HTML ç½‘é¡µã€‚</p><h3 id="Hexo-GitHub-æ–‡ç« å‘å¸ƒåŸç†"><a href="#Hexo-GitHub-æ–‡ç« å‘å¸ƒåŸç†" class="headerlink" title="Hexo + GitHub æ–‡ç« å‘å¸ƒåŸç†"></a>Hexo + GitHub æ–‡ç« å‘å¸ƒåŸç†</h3><p>åœ¨æœ¬åœ°æ’°å†™ Markdown æ ¼å¼æ–‡ç« åï¼Œé€šè¿‡ Hexo è§£ææ–‡æ¡£ï¼Œæ¸²æŸ“ç”Ÿæˆå…·æœ‰ä¸»é¢˜æ ·å¼çš„ HTML é™æ€ç½‘é¡µï¼Œå†æ¨é€åˆ° GitHub ä¸Šå®Œæˆåšæ–‡çš„å‘å¸ƒã€‚</p><p><a href="https://pic3.zhimg.com/v2-a193a47cf70fe6ecf156e5f3d34920ea_r.jpg" class="gallery-item"><img src="https://pic3.zhimg.com/v2-a193a47cf70fe6ecf156e5f3d34920ea_r.jpg"></a></p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><h3 id="è¿æ¥Github"><a href="#è¿æ¥Github" class="headerlink" title="è¿æ¥Github"></a>è¿æ¥Github</h3><p>è®¾ç½®<code>Github</code> ä¿¡æ¯<br>è®¾ç½® git é…ç½®çš„ç”¨æˆ·åé‚®ç®± (å°†<code>lingzhexi</code> / <code>lingzhexi@gmail.com</code> åˆ†åˆ«æ›¿æ¢æˆè‡ªå·±çš„ç”¨æˆ·åå’Œé‚®ç®±)</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git config --global user.name &quot;lingzhexi&quot;git config --global user.email &quot;lingzhexi@gmail.com&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="åˆ›å»º-SSH-å¯†åŒ™"><a href="#åˆ›å»º-SSH-å¯†åŒ™" class="headerlink" title="åˆ›å»º SSH å¯†åŒ™"></a>åˆ›å»º SSH å¯†åŒ™</h4><p>è¾“å…¥ <code>ssh-keygen -t rsa -C &quot;GitHub é‚®ç®±&quot;</code>ï¼Œç„¶åä¸€è·¯å›è½¦ã€‚<br><a href="https://s2.loli.net/2024/12/19/Lw8hY5UT7lEMQV9.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/Lw8hY5UT7lEMQV9.png"></a> </p><p><a href="https://s2.loli.net/2024/12/19/WOCxrBDXbZvVoaF.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/WOCxrBDXbZvVoaF.png"></a> </p><h4 id="æ·»åŠ å¯†åŒ™"><a href="#æ·»åŠ å¯†åŒ™" class="headerlink" title="æ·»åŠ å¯†åŒ™"></a>æ·»åŠ å¯†åŒ™</h4><p>è¿›å…¥ <code>[C:\Users \ ç”¨æˆ·å \.ssh]</code> ç›®å½•ï¼ˆè¦å‹¾é€‰æ˜¾ç¤º â€œéšè—çš„é¡¹ç›®â€ï¼‰ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å…¬é’¥ <code>id_rsa.pu</code>b æ–‡ä»¶å¹¶å¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚</p><p>ç™»é™† <code>GitHub</code> ï¼Œè¿›å…¥ <code>Settings</code> é¡µé¢ï¼Œé€‰æ‹©å·¦è¾¹æ çš„ <code>SSH and GPG keys</code>ï¼Œç‚¹å‡» <code>New SSH key</code>ã€‚</p><p>Title éšä¾¿å–ä¸ªåå­—ï¼Œç²˜è´´å¤åˆ¶çš„ <code>id_rsa.pub</code> å†…å®¹åˆ° <code>Key</code> ä¸­ï¼Œç‚¹å‡» <code>Add SSH key</code> å®Œæˆæ·»åŠ ã€‚<br><a href="https://s2.loli.net/2024/12/19/sWiTnIvDSXNB7kZ.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/sWiTnIvDSXNB7kZ.png"></a></p><h4 id="éªŒè¯è¿æ¥"><a href="#éªŒè¯è¿æ¥" class="headerlink" title="éªŒè¯è¿æ¥"></a>éªŒè¯è¿æ¥</h4><p>æ‰“å¼€ <code>Git Bash</code>ï¼Œè¾“å…¥ <code>ssh -T git@github.com</code> å‡ºç° <code>â€œAre you sureâ€¦â€¦â€</code>ï¼Œè¾“å…¥ <code>yes</code> å›è½¦ç¡®è®¤ã€‚</p><p><a href="https://s2.loli.net/2024/12/19/Xv3xzZFGwiYyCmI.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/Xv3xzZFGwiYyCmI.png"></a> </p><p>æ˜¾ç¤º <code>â€œHi xxx! You&#39;ve successfullyâ€¦â€¦</code>â€ å³è¿æ¥æˆåŠŸã€‚</p><h3 id="åˆ›å»º-Github-Pages-ä»“åº“"><a href="#åˆ›å»º-Github-Pages-ä»“åº“" class="headerlink" title="åˆ›å»º Github Pages ä»“åº“"></a>åˆ›å»º Github Pages ä»“åº“</h3><hr><p><code>GitHub</code> ä¸»é¡µå³ä¸Šè§’åŠ å· -&gt; <code>New</code> <code>repository</code>ï¼š</p><ul><li><code>Repository</code> <code>name</code> ä¸­è¾“å…¥ <code>ç”¨æˆ·å.github.io</code></li><li>å‹¾é€‰ â€œ<code>Initialize</code> this repository with a READMEâ€</li><li><code>Description</code> é€‰å¡«</li></ul><p>å¡«å¥½åç‚¹å‡» <code>Create repository</code> åˆ›å»ºã€‚</p><p><a href="https://s2.loli.net/2024/12/19/hBGbJU5gMAKx9Vk.jpg" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/hBGbJU5gMAKx9Vk.jpg"></a> </p><p>åˆ›å»ºåé»˜è®¤è‡ªåŠ¨å¯ç”¨ <code>HTTPS</code>ï¼Œåšå®¢åœ°å€ä¸ºï¼š<code>https://ç”¨æˆ·å.github.io</code></p><h3 id="éƒ¨ç½²-Hexo-åˆ°-GitHub-Pages"><a href="#éƒ¨ç½²-Hexo-åˆ°-GitHub-Pages" class="headerlink" title="éƒ¨ç½² Hexo åˆ° GitHub Pages"></a>éƒ¨ç½² Hexo åˆ° GitHub Pages</h3><hr><p>æœ¬åœ°åšå®¢æµ‹è¯•æˆåŠŸåï¼Œå°±æ˜¯ä¸Šä¼ åˆ° GitHub è¿›è¡Œéƒ¨ç½²ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨ç½‘ç»œä¸Šè®¿é—®ã€‚</p><p>é¦–å…ˆ<strong>å®‰è£… hexo-deployer-git</strong>ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install hexo-deployer-git --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶å<strong>ä¿®æ”¹ _config.yml</strong> æ–‡ä»¶æœ«å°¾çš„ Deployment éƒ¨åˆ†ï¼Œä¿®æ”¹æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> git  <span class="token key atrule">repository</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>lingzhexi/lingzhexi.github.io.git  <span class="token key atrule">branch</span><span class="token punctuation">:</span> master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å®Œæˆåè¿è¡Œ <code>hexo d</code> å°†ç½‘ç«™ä¸Šä¼ éƒ¨ç½²åˆ° <code>GitHub Pagesã€‚</code></p><p>å®Œæˆï¼è¿™æ—¶è®¿é—®æˆ‘ä»¬çš„ <code>GitHub</code> åŸŸå <code>https://lingzhexi.github.io</code> å°±å¯ä»¥çœ‹åˆ° Hexo ç½‘ç«™äº†ã€‚</p><h2 id="é—®é¢˜æ±‡æ€»"><a href="#é—®é¢˜æ±‡æ€»" class="headerlink" title="é—®é¢˜æ±‡æ€»"></a>é—®é¢˜æ±‡æ€»</h2><h3 id="gitæç¤ºï¼šwarning-LF-will-be-replaced-by-CRLF"><a href="#gitæç¤ºï¼šwarning-LF-will-be-replaced-by-CRLF" class="headerlink" title="gitæç¤ºï¼šwarning: LF will be replaced by CRLF"></a>gitæç¤ºï¼šwarning: LF will be replaced by CRLF</h3><p>åœ¨éƒ¨ç½²çš„æäº¤é™æ€æ–‡ä»¶åˆ°Githubä¸Šæ—¶ï¼š</p><blockquote><p>hexo d</p></blockquote><p><a href="https://s2.loli.net/2024/12/19/XDUYZtglH2QmwC3.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/XDUYZtglH2QmwC3.png"></a> </p><h3 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h3><p>Git å¯ä»¥åœ¨ä½ æäº¤æ—¶è‡ªåŠ¨åœ°æŠŠå›è½¦ï¼ˆCRï¼‰å’Œæ¢è¡Œï¼ˆLFï¼‰è½¬æ¢æˆæ¢è¡Œï¼ˆLFï¼‰ï¼Œè€Œåœ¨æ£€å‡ºä»£ç æ—¶æŠŠæ¢è¡Œï¼ˆLFï¼‰è½¬æ¢æˆå›è½¦ï¼ˆCRï¼‰å’Œæ¢è¡Œï¼ˆLFï¼‰ã€‚ ä½ å¯ä»¥ç”¨<code>git config --global core.autocrlf true</code> æ¥æ‰“å¼€æ­¤é¡¹åŠŸèƒ½ã€‚ å¦‚æœæ˜¯åœ¨ Windows ç³»ç»Ÿä¸Šï¼ŒæŠŠå®ƒè®¾ç½®æˆ trueï¼Œè¿™æ ·åœ¨æ£€å‡ºä»£ç æ—¶ï¼Œæ¢è¡Œä¼šè¢«è½¬æ¢æˆå›è½¦å’Œæ¢è¡Œï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#æäº¤æ—¶è½¬æ¢ä¸ºLFï¼Œæ£€å‡ºæ—¶è½¬æ¢ä¸ºCRLFgit config --global core.autocrlf true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é—®é¢˜è§£å†³</p><p><a href="https://s2.loli.net/2024/12/19/Iytk1CxJeobAY69.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/Iytk1CxJeobAY69.png"></a> </p><h3 id="åˆ†æé—®é¢˜"><a href="#åˆ†æé—®é¢˜" class="headerlink" title="åˆ†æé—®é¢˜"></a><strong>åˆ†æé—®é¢˜</strong></h3><blockquote><p>æ ¼å¼åŒ–ä¸å¤šä½™çš„ç©ºç™½å­—ç¬¦ï¼Œç‰¹åˆ«æ˜¯åœ¨è·¨å¹³å°æƒ…å†µä¸‹ï¼Œæœ‰æ—¶å€™æ˜¯ä¸€ä¸ªä»¤äººå‘æŒ‡çš„é—®é¢˜ã€‚ç”±äºç¼–è¾‘å™¨çš„ä¸åŒæˆ–è€…æ–‡ä»¶è¡Œå°¾çš„æ¢è¡Œç¬¦åœ¨ Windows ä¸‹è¢«æ›¿æ¢äº†ï¼Œä¸€äº›ç»†å¾®çš„ç©ºæ ¼å˜åŒ–ä¼šä¸ç»æ„åœ°æ··å…¥æäº¤ï¼Œé€ æˆéº»çƒ¦ã€‚è™½ç„¶è¿™æ˜¯å°é—®é¢˜ï¼Œä½†å®ƒä¼šæå¤§åœ°æ‰°ä¹±è·¨å¹³å°åä½œã€‚<br>å…¶å®ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ–‡æœ¬å¤„ç†ä¸­ï¼Œ</p></blockquote><p><a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Carriage_return">CR</a>ï¼ˆ<strong>C</strong>arriage<strong>R</strong>eturnï¼‰ï¼Œ<a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Line_feed">LF</a>ï¼ˆ<strong>L</strong>ine<strong>F</strong>eedï¼‰ï¼Œ<code>CR/LF</code>æ˜¯ä¸åŒæ“ä½œç³»ç»Ÿä¸Šä½¿ç”¨çš„æ¢è¡Œç¬¦ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><h3 id="æ¢è¡Œç¬¦â€˜-nâ€™å’Œå›è½¦ç¬¦â€˜-râ€™"><a href="#æ¢è¡Œç¬¦â€˜-nâ€™å’Œå›è½¦ç¬¦â€˜-râ€™" class="headerlink" title="æ¢è¡Œç¬¦â€˜\nâ€™å’Œå›è½¦ç¬¦â€˜\râ€™"></a>æ¢è¡Œç¬¦â€˜\nâ€™å’Œå›è½¦ç¬¦â€˜\râ€™</h3><ul><li>å›è½¦ç¬¦å°±æ˜¯å›åˆ°ä¸€è¡Œçš„å¼€å¤´ï¼Œç”¨ç¬¦å·rè¡¨ç¤ºï¼Œåè¿›åˆ¶<code>ASCII</code>ä»£ç æ˜¯13ï¼Œåå…­è¿›åˆ¶ä»£ç ä¸º<code>0x0D</code>ï¼Œå›è½¦ï¼ˆ<code>return</code>ï¼‰ï¼›</li><li>æ¢è¡Œç¬¦å°±æ˜¯å¦èµ·ä¸€è¡Œï¼Œç”¨nç¬¦å·è¡¨ç¤ºï¼Œ<code>ASCII</code>ä»£ç æ˜¯10ï¼Œåå…­åˆ¶ä¸º<code>0x0A</code>ï¼Œ æ¢è¡Œï¼ˆ<code>newline</code>ï¼‰ã€‚</li></ul><p>æ‰€ä»¥æˆ‘ä»¬å¹³æ—¶ç¼–å†™æ–‡ä»¶çš„å›è½¦ç¬¦åº”è¯¥ç¡®åˆ‡æ¥è¯´å«åšå›è½¦æ¢è¡Œç¬¦ã€‚</p><h3 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h3><ul><li>ä¸€ä¸ªç›´æ¥åæœæ˜¯ï¼Œ<code>Unix/Mac</code>ç³»ç»Ÿä¸‹çš„æ–‡ä»¶åœ¨<code>Windows</code>é‡Œæ‰“å¼€çš„è¯ï¼Œæ‰€æœ‰æ–‡å­—ä¼šå˜æˆä¸€è¡Œï¼›</li><li>è€Œ<code>Windows</code>é‡Œçš„æ–‡ä»¶åœ¨<code>Unix/Mac</code>ä¸‹æ‰“å¼€çš„è¯ï¼Œåœ¨æ¯è¡Œçš„ç»“å°¾å¯èƒ½ä¼šå¤šå‡ºä¸€ä¸ª^ç¬¦å·ã€‚</li><li><code>Linux</code>ä¿å­˜çš„æ–‡ä»¶åœ¨<code>windows</code>ä¸Šç”¨è®°äº‹æœ¬çœ‹çš„è¯ä¼šå‡ºç°é»‘ç‚¹ã€‚</li></ul><p>è¿™äº›é—®é¢˜éƒ½å¯ä»¥é€šè¿‡ä¸€å®šæ–¹å¼è¿›è¡Œè½¬æ¢ç»Ÿä¸€ï¼Œä¾‹å¦‚ï¼Œåœ¨<code>linux</code>ä¸‹ï¼Œå‘½ä»¤<code>unix2dos</code> æ˜¯æŠŠ<code>linux</code>æ–‡ä»¶æ ¼å¼è½¬æ¢æˆ<code>windows</code>æ–‡ä»¶æ ¼å¼ï¼Œå‘½ä»¤<code>dos2unix</code> æ˜¯æŠŠwindowsæ ¼å¼è½¬æ¢æˆ<code>linux</code>æ–‡ä»¶æ ¼å¼ã€‚</p><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><ul><li><a href="https://hexo.bootcss.com/docs/github-pages.html">Hexo/GitPage éƒ¨ç½²</a></li><li><a href="https://zhuanlan.zhihu.com/p/60578464">ä½¿ç”¨ Hexo+GitHub æ­å»ºä¸ªäººå…è´¹åšå®¢æ•™ç¨‹ï¼ˆå°ç™½å‘ï¼‰</a></li><li><a href="https://zhuanlan.zhihu.com/p/26625249">GitHub+Hexo æ­å»ºä¸ªäººç½‘ç«™è¯¦ç»†æ•™ç¨‹</a></li><li><a href="https://www.jianshu.com/p/450cd21b36a4">è§£å†³git LF/CRLF</a></li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoç³»åˆ—ï¼ˆä¸€ï¼‰|åŸºç¡€é…ç½®</title>
      <link href="/posts/2889.html"/>
      <url>/posts/2889.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="æ–‡ç« æ‘˜è¦"><a href="#æ–‡ç« æ‘˜è¦" class="headerlink" title="æ–‡ç« æ‘˜è¦"></a>æ–‡ç« æ‘˜è¦</h1><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><blockquote><p><code>Hexo</code> ä¸­æœ‰ä¸¤ç§å½¢å¼æ·»åŠ æ‘˜è¦ï¼š</p><ul><li>æ–‡ç« å¼€å¤´é…ç½® <code>description</code></li><li>åœ¨æ–‡ç« ä¸­ç›´æ¥æ·»åŠ  <code>&lt;!-- more --&gt;</code></li></ul></blockquote><h2 id="æ·»åŠ -description"><a href="#æ·»åŠ -description" class="headerlink" title="æ·»åŠ  description"></a>æ·»åŠ  <code>description</code></h2><p><code>Hexo</code> æ¯ç¯‡æ–‡ç« çš„å¼€å¤´å¯ä»¥è¡¨ç¤ºæ–‡ç« çš„ä¿¡æ¯,å…¶ä¸­å¯ä»¥æ·»åŠ  <code>descrption</code> æ¥è¡¨ç¤ºæ­£ç¯‡æ–‡ç« çš„æ‘˜è¦</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token front-matter-block"><span class="token punctuation">---</span><span class="token front-matter yaml language-yaml">title: Hexo æ˜¾ç¤ºæ–‡ç« æ‘˜è¦date: 2021-09-24 13:47:10tags: Hexocategories: Hexodescription: æ˜¾ç¤ºæ–‡ç« æ‘˜è¦ # è¿™é‡Œè¡¨ç¤ºæ·»åŠ æ–‡ç« æ‘˜è¦</span><span class="token punctuation">---</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ·»åŠ -more"><a href="#æ·»åŠ -more" class="headerlink" title="æ·»åŠ  more"></a>æ·»åŠ  more</h2><p>åœ¨æ–‡ç« çš„é€‚å½“å¤„ç›´æ¥æ·»åŠ </p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token hr punctuation">---</span><span class="token title important"><span class="token punctuation">#</span> å‰è¨€</span><span class="token blockquote punctuation">></span> Hexo é»˜è®¤çš„æ–‡ç« æ˜¯å…¨éƒ¨å±•ç¤ºï¼Œå¯¹äºé˜…è¯»çš„ä½“éªŒæ„Ÿå¾ˆå·®ï¼Œæ‰€ä»¥å°±éœ€è¦å¯¹æ–‡ç« è¿›è¡Œæ‘˜è¦æ˜¾ç¤ºéƒ¨åˆ†æ–‡ç« å†…å®¹<span class="token title important"><span class="token punctuation">#</span> Start</span><span class="token blockquote punctuation">></span> Hexo ä¸­æœ‰ä¸¤ç§å½¢å¼æ·»åŠ æ‘˜è¦ï¼š<span class="token blockquote punctuation">></span>   <span class="token list punctuation">-</span> æ–‡ç« å¼€å¤´é…ç½® <span class="token code-snippet code keyword">`description`</span>  <span class="token blockquote punctuation">></span>   <span class="token list punctuation">-</span> åœ¨æ–‡ç« ä¸­ç›´æ¥æ·»åŠ  <span class="token code-snippet code keyword">`&lt;!-- more -->`</span><span class="token comment">&lt;!-- more --></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><a href="https://s2.loli.net/2024/12/19/jfPqYSBeoyFEJaQ.png" title="202109241407073.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/jfPqYSBeoyFEJaQ.png" alt="202109241407073.png"></a></p><h1 id="æ–‡ç« ç½®é¡¶ğŸ”"><a href="#æ–‡ç« ç½®é¡¶ğŸ”" class="headerlink" title="æ–‡ç« ç½®é¡¶ğŸ”"></a>æ–‡ç« ç½®é¡¶ğŸ”</h1><h2 id="å¸è½½é»˜è®¤çš„ç½®é¡¶æ–¹å¼"><a href="#å¸è½½é»˜è®¤çš„ç½®é¡¶æ–¹å¼" class="headerlink" title="å¸è½½é»˜è®¤çš„ç½®é¡¶æ–¹å¼"></a>å¸è½½é»˜è®¤çš„ç½®é¡¶æ–¹å¼</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ npm uninstall hexo-generator-index --save$ npm install hexo-generator-index-pin-top --save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨éœ€è¦ç½®é¡¶çš„æ–‡ç« çš„Front-matterä¸­åŠ ä¸Štop: true æˆ–è€…top: ä»»æ„æ•°å­—ï¼Œæ¯”å¦‚ï¼š</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token front-matter-block"><span class="token punctuation">---</span><span class="token front-matter yaml language-yaml">title: Java åŸºç¡€date: 2021-09-18 10:29:39top: true</span><span class="token punctuation">---</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è®¾ç½®ç½®é¡¶å›¾æ ‡"><a href="#è®¾ç½®ç½®é¡¶å›¾æ ‡" class="headerlink" title="è®¾ç½®ç½®é¡¶å›¾æ ‡"></a>è®¾ç½®ç½®é¡¶å›¾æ ‡</h2><p>æˆ‘ä½¿ç”¨ä¸»é¢˜æ˜¯<code>Next</code>,å…¶ä¸­<code>Next</code>çš„å„ç‰ˆæœ¬ä¹‹é—´ç•¥æœ‰å·®å¼‚ï¼Œæˆ‘çš„ç‰ˆæœ¬æ˜¯8.7.1<br>æ‰“å¼€<code>/themes/next/layout/_macro/</code> ç›®å½•ä¸‹çš„<code>post.njk</code>æ–‡ä»¶<br>åœ¨<code>&lt;div class=&quot;post-meta-container&quot;&gt;</code> å†…æ‰¾åˆ° <code>post-meta.njk</code> æ–‡ä»¶è·¯å¾„ï¼š</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  &#123;&#123; partial('_partials/post/post-meta.njk') &#125;&#125; # å®é™…åœ¨ post-meta.njk è¿™ä¸ªæ–‡ä»¶é‡Œé¢å»ä¿®æ”¹  &#123;%- if post.description and (not theme.excerpt_description or not is_index) %&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-description<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; post.description &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  &#123;%- endif %&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€<code>/themes/hexo-theme-next/layout/_partials/post/post-meta.njk</code>ï¼Œåœ¨ <code>&lt;div class=&quot;post-meta&quot;&gt;</code> æ’å…¥ï¼š</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&#123;% if post.top %&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta-item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fas fa-thumbtack<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç½®é¡¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>&#123;% endif %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ·»åŠ ä½ç½®</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  &#123;%- set date_diff = date(post.date) != date(post.updated) %&#125;  &#123;%- set time_diff = time(post.date) != time(post.updated) %&#125;  # æ’å…¥ä¸‹é¢çš„å†…å®¹  &#123;% if post.top %&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta-item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fas fa-thumbtack<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç½®é¡¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  &#123;% endif %&#125;   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ç½®é¡¶å‰çš„æ ‡ç­¾å¯ä»¥åœ¨ <a href="https://fontawesome.com/v5.15/icons?d=gallery&p=1"><code>Fontawesome</code></a> æ›¿æ¢ä½ å–œæ¬¢çš„</p><h1 id="æ–‡ç« æ·»åŠ å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿"><a href="#æ–‡ç« æ·»åŠ å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿" class="headerlink" title="æ–‡ç« æ·»åŠ å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿"></a>æ–‡ç« æ·»åŠ å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿</h1><h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>å¦‚æœæ²¡æœ‰å®‰è£… <code>hexo-wordcount</code> æ’ä»¶ï¼Œå…ˆå®‰è£…è¯¥æ’ä»¶ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i --save hexo-wordcount<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p><code>Next</code> ä¸»é¢˜é»˜è®¤é›†æˆäº†æ–‡ç«  ã€å­—æ•°ç»Ÿè®¡ã€‘å’Œã€é˜…è¯»æ—¶é•¿ã€‘ï¼Œæˆ‘ä»¬åªéœ€è¦å¼€å¯é…ç½®å³å¯ï¼Œ</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Post wordcount display settings</span><span class="token comment"># Dependencies: https://github.com/willin/hexo-wordcount</span><span class="token key atrule">post_wordcount</span><span class="token punctuation">:</span>  <span class="token key atrule">item_text</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">wordcount</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>         <span class="token comment"># å•ç¯‡ å­—æ•°ç»Ÿè®¡</span>  <span class="token key atrule">min2read</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>          <span class="token comment"># å•ç¯‡ é˜…è¯»æ—¶é•¿</span>  <span class="token key atrule">totalcount</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>       <span class="token comment"># ç½‘ç«™ å­—æ•°ç»Ÿè®¡</span>  <span class="token key atrule">separated_meta</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ·»åŠ æ ·å¼"><a href="#æ·»åŠ æ ·å¼" class="headerlink" title="æ·»åŠ æ ·å¼"></a>æ·»åŠ æ ·å¼</h2><p>æ‰“å¼€ <code>/themes/hexo-theme-next/layout/_partials/post/post-meta.njk</code> æ–‡ä»¶ï¼Œåœ¨  <code>div</code> çš„æœ€ä¸‹é¢æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; __('post.wordcount') &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta-divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&amp;nbsp&amp;nbsp|&amp;nbsp&amp;nbsphe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fas fa-book<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>  å­—æ•°ç»Ÿè®¡:&#123;&#123; wordcount(post.content) &#125;&#125;å­—<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; __('post.min2read') &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta-divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&amp;nbsp&amp;nbsp|&amp;nbsp&amp;nbsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>far fa-clock<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>  é˜…è¯»æ—¶é•¿â‰ˆ&#123;&#123; min2read(post.content) &#125;&#125;åˆ†é’Ÿ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ•ˆæœ-1"><a href="#æ•ˆæœ-1" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><a href="https://s2.loli.net/2024/12/19/c6CWtaduSs3lyHm.png" title="202109241340113.png" class="gallery-item"><img src="https://s2.loli.net/2024/12/19/c6CWtaduSs3lyHm.png" alt="202109241340113.png"></a></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://www.jianshu.com/p/a9922c3ebb61">Hexo nexTä¸»é¢˜ä¹‹æ–‡ç« ç½®é¡¶</a></li><li><a href="https://juejin.cn/post/6844904037465194503">Hexo Nextä¸»é¢˜è®¾ç½®æ–‡ç« ç½®é¡¶</a></li><li><a href="http://wangwlj.com/2018/01/09/blog_pin_post/">Hexoåšå®¢å½»åº•è§£å†³ç½®é¡¶é—®é¢˜</a></li><li><a href="https://fontawesome.com/v5.15/icons?d=gallery&p=1">FontAwesome æ ‡ç­¾åº“</a></li><li><a href="https://ryderchan.github.io/2017/01/26/hexo%E5%B0%8F%E6%8A%80%E5%B7%A7-%E9%A6%96%E9%A1%B5%E6%98%BE%E7%A4%BA%E6%96%87%E7%AB%A0%E6%91%98%E8%A6%81%E5%8F%8A%E5%9B%BE%E7%89%87/">hexoå°æŠ€å·§-é¦–é¡µæ˜¾ç¤ºæ–‡ç« æ‘˜è¦åŠå›¾ç‰‡</a></li><li><a href="https://www.jianshu.com/p/baea8c95e39b">Hexoæ·»åŠ å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿</a></li><li><a href="https://lingzhexi.github.io/2021/09/24/%E6%96%87%E7%AB%A0%E7%BD%AE%E9%A1%B6/">Hexo æ–‡å­—ç½®é¡¶</a></li></ul></div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {        var options = {            selector: '.gallery-item'        };        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);        }</script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
